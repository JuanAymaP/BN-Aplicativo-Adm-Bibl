Ô6
cC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\frmLogin.aspx.vb
Public 
Class 
FrmLogin 
Inherits 
System 
. 
Web 
. 
UI 
. 
Page 
	Protected 
Sub 
	Page_Load 
( 
ByVal !
sender" (
As) +
Object, 2
,2 3
ByVal4 9
e: ;
As< >
System? E
.E F
	EventArgsF O
)O P
HandlesQ X
MeY [
.[ \
Load\ `
If 

Session 
( 
$str 
) 
= 
$str "
Then# '
lbl_Mensaje 
. 
Text 
= 
$str V
Session 
( 
$str 
) 
= 
$str  #
Else 
If		 
Not		 

IsPostBack		 
Then		 "
txt_Usuario

 
.

 
Focus

 !
(

! "
)

" #
End 
If 
End 
If 
End 
Sub 
	Protected 
Sub 
btn_Iniciar_Click #
(# $
ByVal$ )
sender* 0
As1 3
Object4 :
,: ;
ByVal< A
eB C
AsD F
	EventArgsG P
)P Q
HandlesR Y
btn_IniciarZ e
.e f
Clickf k
Try 
If 
varficarCampos 
( 
) 
Then  $
If 
ValidarLogin 
(  
UCase  %
(% &
Trim& *
(* +
txt_Usuario+ 6
.6 7
Text7 ;
); <
)< =
,= >
UCase? D
(D E
TrimE I
(I J
	txt_ClaveJ S
.S T
TextT X
)X Y
)Y Z
)Z [
Then\ `
Response 
. 
Redirect %
(% &
$str& 7
)7 8
Else 
lbl_Mensaje 
.  
Text  $
=% &
$str' m
End 
If 
End 
If 
Catch 
ex 
As 
	Exception 
lbl_Mensaje 
. 
Text 
= 
ex !
.! "
Message" )
End 
Try 
End 
Sub 
Public 

Function 
ValidarLogin  
(  !
ByVal! &
user' +
As, .
String/ 5
,5 6
ByVal7 <
pass= A
AsB D
StringE K
)K L
AsM O
BooleanP W
Dim 
result 
As 
Boolean 
= 
False  %
If 

user 
= 
$str 
And 
pass !
=" #
$str$ ,
Then- 1
result 
= 
True 
Session   
(   
$str   
)   
=   
$str    ,
Session!! 
(!! 
$str!! "
)!!" #
=!!$ %
$str!!& ,
Session"" 
("" 
$str"" "
)""" #
=""$ %
txt_Usuario""& 1
.""1 2
Text""2 6
.""6 7
Trim""7 ;
Session## 
(## 
$str## #
)### $
=##% &
$str##' 0
Session$$ 
($$ 
$str$$ "
)$$" #
=$$$ %
$str$$& D
Session%% 
(%% 
$str%% "
)%%" #
=%%$ %
$str%%& 1
ElseIf'' 
user'' 
='' 
$str'' 
And''  
pass''! %
=''& '
$str''( 0
Then''1 5
result(( 
=(( 
True(( 
Session)) 
()) 
$str)) 
))) 
=)) 
$str))  *
Session** 
(** 
$str** "
)**" #
=**$ %
$str**& ,
Session++ 
(++ 
$str++ "
)++" #
=++$ %
txt_Usuario++& 1
.++1 2
Text++2 6
.++6 7
Trim++7 ;
Session,, 
(,, 
$str,, #
),,# $
=,,% &
$str,,' 0
Session-- 
(-- 
$str-- "
)--" #
=--$ %
$str--& @
Session.. 
(.. 
$str.. "
).." #
=..$ %
$str..& 1
ElseIf00 
user00 
=00 
$str00 
And00  
pass00! %
=00& '
$str00( 0
Then001 5
result11 
=11 
True11 
Session22 
(22 
$str22 
)22 
=22 
$str22  +
Session33 
(33 
$str33 "
)33" #
=33$ %
$str33& ,
Session44 
(44 
$str44 "
)44" #
=44$ %
txt_Usuario44& 1
.441 2
Text442 6
.446 7
Trim447 ;
Session55 
(55 
$str55 #
)55# $
=55% &
$str55' 0
Session66 
(66 
$str66 "
)66" #
=66$ %
$str66& H
Session77 
(77 
$str77 "
)77" #
=77$ %
$str77& 1
End88 
If88 
Return:: 
result:: 
End;; 
Function;; 
Public== 

Function== 
varficarCampos== "
(==" #
)==# $
As==% '
Boolean==( /
If>> 

txt_Usuario>> 
.>> 
Text>> 
.>> 
Trim>>  
<>>>! #
$str>>$ &
Then>>' +
If?? 
	txt_Clave?? 
.?? 
Text?? 
.?? 
Trim?? "
<>??# %
$str??& (
Then??) -
Return@@ 
True@@ 
ElseAA 
lbl_MensajeBB 
.BB 
TextBB  
=BB! "
$strBB# 5
	txt_ClaveCC 
.CC 
FocusCC 
(CC  
)CC  !
ReturnDD 
FalseDD 
EndEE 
IfEE 
ElseFF 
lbl_MensajeHH 
.HH 
TextHH 
=HH 
$strHH 3
txt_UsuarioJJ 
.JJ 
FocusJJ 
(JJ 
)JJ 
ReturnKK 
FalseKK 
EndLL 
IfLL 
ReturnMM 
FalseMM 
EndNN 
FunctionNN 
EndOO 
ClassOO 	≤Ç
lC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\frm_Configuracion.aspx.vb
Public 
Class 
frm_Configuracion 
Inherits 
System 
. 
Web 
. 
UI 
. 
Page 
	Protected 
Sub 
	Page_Load 
( 
ByVal !
sender" (
As) +
Object, 2
,2 3
ByVal4 9
e: ;
As< >
System? E
.E F
	EventArgsF O
)O P
HandlesQ X
MeY [
.[ \
Load\ `
Session 
( 
$str 
) 
= 
$str -
If		 

f_validarSesion		 
(		 
)		 
=		 
True		 #
Then		$ (
If 
Not 

IsPostBack 
Then "
Try 
cls_Metodos 
.  
culture_info  ,
(, -
)- .

Validacion 
( 
$str *
)* +

txtParrafo 
. 

Attributes )
.) *
Add* -
(- .
$str. 9
,9 :
$str; O
)O P
	btnGrabar 
. 
Enabled %
=& '
False( -
CargarDatos 
(  
)  !
Catch 
ex 
As 
	Exception %

lbl_Valida 
. 
Text #
=$ %
ex& (
.( )
Message) 0

lbl_Valida 
. 
	ForeColor (
=) *
System+ 1
.1 2
Drawing2 9
.9 :
Color: ?
.? @
Red@ C
End 
Try 

txtParrafo 
. 
CssClass #
=$ %
$str& 3
End 
If 
Else 
Session 
( 
$str 
) 
= 
$str  #
Response 
. 
Redirect 
( 
$str m
)m n
End 
If 
End 
Sub 
Public   

Function   
f_validarSesion   #
(  # $
)  $ %
As  & (
Boolean  ) 0
If!! 

Session!! 
(!! 
$str!! !
)!!! "
Is!!# %
Nothing!!& -
Then!!. 2
Return"" 
False"" 
End## 
If## 
Return$$ 
True$$ 
End%% 
Function%% 
Private(( 
Sub(( 

Validacion(( 
((( 
ByVal((  

Validacion((! +
As((, .
String((/ 5
)((5 6
If++ 


Validacion++ 
=++ 
$str++ *
Then+++ /
btnCancelar,, 
.,, 
Enabled,, 
=,,  !
True,," &
	btnGrabar-- 
.-- 
Visible-- 
=-- 
False--  %
btnModificar.. 
... 
Enabled..  
=..! "
True..# '
ElseIf// 

Validacion// 
=// 
$str// '
Then//( ,

txtParrafo00 
.00 
ReadOnly00 
=00  !
False00" '
	btnGrabar11 
.11 
Visible11 
=11 
True11  $
	btnGrabar22 
.22 
Enabled22 
=22 
True22  $
btnModificar33 
.33 
Enabled33  
=33! "
False33# (
btnCancelar44 
.44 
Enabled44 
=44  !
True44" &
ElseIf55 

Validacion55 
=55 
$str55 '
Then55( ,

txtParrafo66 
.66 
ReadOnly66 
=66  !
True66" &
	btnGrabar77 
.77 
Visible77 
=77 
True77  $
	btnGrabar88 
.88 
Enabled88 
=88 
False88  %
btnModificar99 
.99 
Enabled99  
=99! "
False99# (
btnCancelar:: 
.:: 
Enabled:: 
=::  !
True::" &
End;; 
If;; 
End<< 
Sub<< 
Sub>> 
CargarDatos>> 
(>> 
)>> 
grv_parrafo?? 
.?? 

DataSource?? 
=??  
cls_Metodos??! ,
.??, -
MostrarParrafo??- ;
(??; <
$str??< ?
,??? @
$str??A C
)??C D
grv_parrafo@@ 
.@@ 
DataBind@@ 
(@@ 
)@@ 
EndAA 
SubAA 
	ProtectedDD 
SubDD 
btnGrabar_ClickDD !
(DD! "
ByValDD" '
senderDD( .
AsDD/ 1
ObjectDD2 8
,DD8 9
ByValDD: ?
eDD@ A
AsDDB D
	EventArgsDDE N
)DDN O
HandlesDDP W
	btnGrabarDDX a
.DDa b
ClickDDb g
TryEE 
CallFF 
grabarFF 
(FF 
)FF 
CatchGG 
exGG 
AsGG 
	ExceptionGG 
EndJJ 
TryJJ 
EndKK 
SubKK 
PrivateNN 
SubNN 
btnCancelar_ClickNN !
(NN! "
senderNN" (
AsNN) +
ObjectNN, 2
,NN2 3
eNN4 5
AsNN6 8
	EventArgsNN9 B
)NNB C
HandlesNND K
btnCancelarNNL W
.NNW X
ClickNNX ]
TryOO 
ResponsePP 
.PP 
RedirectPP 
(PP 
$strPP 6
)PP6 7
CatchQQ 
exQQ 
AsQQ 
	ExceptionQQ 

lbl_ValidaRR 
.RR 
TextRR 
=RR 
exRR  
.RR  !
MessageRR! (

lbl_ValidaSS 
.SS 
	ForeColorSS  
=SS! "
SystemSS# )
.SS) *
DrawingSS* 1
.SS1 2
ColorSS2 7
.SS7 8
RedSS8 ;
EndTT 
TryTT 
EndUU 
SubUU 
PrivateXX 
SubXX 
grabarXX 
(XX 
)XX 
DimZZ 
	v_ParrafoZZ 
AsZZ 
StringZZ 
=ZZ  !

txtParrafoZZ" ,
.ZZ, -
TextZZ- 1
.ZZ1 2
TrimZZ2 6
cls_Metodos[[ 
.[[ 
Actualizar_Parrafo[[ &
([[& '
$str[[' *
,[[* +
	v_Parrafo[[, 5
)[[5 6
	btnGrabar\\ 
.\\ 
Enabled\\ 
=\\ 
False\\ !

Validacion]] 
(]] 
$str]] 
)]] 

lbl_Valida^^ 
.^^ 
	ForeColor^^ 
=^^ 
System^^ %
.^^% &
Drawing^^& -
.^^- .
Color^^. 3
.^^3 4
Green^^4 9

lbl_Valida__ 
.__ 
Visible__ 
=__ 
True__ !

lbl_Valida`` 
.`` 
Text`` 
=`` 
$str`` >
CargarDatosaa 
(aa 
)aa 
Endcc 
Subcc 
Privateff 
Subff 
btnModificar_Clickff "
(ff" #
senderff# )
Asff* ,
Objectff- 3
,ff3 4
eff5 6
Asff7 9
	EventArgsff: C
)ffC D
HandlesffE L
btnModificarffM Y
.ffY Z
ClickffZ _
Trygg 
Sessionii 
(ii 
$strii !
)ii! "
=ii# $
$strii% 0

lbl_Validakk 
.kk 
	ForeColorkk  
=kk! "
Systemkk# )
.kk) *
Drawingkk* 1
.kk1 2
Colorkk2 7
.kk7 8

DarkOrangekk8 B

lbl_Validall 
.ll 
Textll 
=ll 
$strll 7

Validacionmm 
(mm 
$strmm "
)mm" #
Catchnn 
exnn 
Asnn 
	Exceptionnn 

lbl_Validaoo 
.oo 
Textoo 
=oo 
exoo  
.oo  !
Messageoo! (

lbl_Validapp 
.pp 
	ForeColorpp  
=pp! "
Systempp# )
.pp) *
Drawingpp* 1
.pp1 2
Colorpp2 7
.pp7 8
Redpp8 ;
Endqq 
Tryqq 
Endrr 
Subrr 
	Protecteduu 
Subuu &
grv_parrafo_OnRowDataBounduu ,
(uu, -
ByValuu- 2
senderuu3 9
Asuu: <
Objectuu= C
,uuC D
ByValuuE J
euuK L
AsuuM O 
GridViewRowEventArgsuuP d
)uud e
Tryvv 
Ifww 
eww 
.ww 
Rowww 
.ww 
RowTypeww 
=ww 
DataControlRowTypeww 1
.ww1 2
DataRowww2 9
Thenww: >
Dimxx 
drxx 
Asxx 
DataRowViewxx %
=xx& '
CTypexx( -
(xx- .
exx. /
.xx/ 0
Rowxx0 3
.xx3 4
DataItemxx4 <
,xx< =
DataRowViewxx> I
)xxI J
Dimzz 

c_cParrafozz 
Aszz !
Stringzz" (
If{{ 
Not{{ 
IsDBNull{{ 
({{  
dr{{  "
({{" #
$str{{# -
){{- .
){{. /
Then{{0 4

c_cParrafo|| 
=||  
dr||! #
(||# $
$str||$ .
)||. /
Else}} 

c_cParrafo~~ 
=~~  
$str~~! $
End 
If 
Dim
ÅÅ 
c_cIdParrafo
ÅÅ  
As
ÅÅ! #
String
ÅÅ$ *
If
ÇÇ 
Not
ÇÇ 
IsDBNull
ÇÇ 
(
ÇÇ  
dr
ÇÇ  "
(
ÇÇ" #
$str
ÇÇ# 6
)
ÇÇ6 7
)
ÇÇ7 8
Then
ÇÇ9 =
c_cIdParrafo
ÉÉ  
=
ÉÉ! "
dr
ÉÉ# %
(
ÉÉ% &
$str
ÉÉ& 9
)
ÉÉ9 :
Else
ÑÑ 
c_cIdParrafo
ÖÖ  
=
ÖÖ! "
$str
ÖÖ# &
End
ÜÜ 
If
ÜÜ 
CType
àà 
(
àà 
e
àà 
.
àà 
Row
àà 
.
àà 
FindControl
àà '
(
àà' (
$str
àà( 0
)
àà0 1
,
àà1 2
WebControls
àà3 >
.
àà> ?
Label
àà? D
)
ààD E
.
ààE F
Text
ààF J
=
ààK L
c_cIdParrafo
ààM Y
CType
ââ 
(
ââ 
e
ââ 
.
ââ 
Row
ââ 
.
ââ 
FindControl
ââ '
(
ââ' (
$str
ââ( 5
)
ââ5 6
,
ââ6 7
WebControls
ââ8 C
.
ââC D
Label
ââD I
)
ââI J
.
ââJ K
Text
ââK O
=
ââP Q

c_cParrafo
ââR \
End
ãã 
If
ãã 
Catch
åå 
ex
åå 
As
åå 
	Exception
åå 

lbl_Valida
éé 
.
éé 
Text
éé 
=
éé 
ex
éé  
.
éé  !
Message
éé! (

lbl_Valida
èè 
.
èè 
	ForeColor
èè  
=
èè! "
System
èè# )
.
èè) *
Drawing
èè* 1
.
èè1 2
Color
èè2 7
.
èè7 8
Red
èè8 ;
End
ëë 
Try
ëë 
End
íí 
Sub
íí 
	Protected
ïï 
Sub
ïï +
grv_parrafo_PageIndexChanging
ïï /
(
ïï/ 0
ByVal
ïï0 5
sender
ïï6 <
As
ïï= ?
Object
ïï@ F
,
ïïF G
ByVal
ïïH M
e
ïïN O
As
ïïP R
System
ïïS Y
.
ïïY Z
Web
ïïZ ]
.
ïï] ^
UI
ïï^ `
.
ïï` a
WebControls
ïïa l
.
ïïl m$
GridViewPageEventArgsïïm Ç
)ïïÇ É
HandlesïïÑ ã
grv_parrafoïïå ó
.ïïó ò!
PageIndexChangingïïò ©
Try
ññ 
grv_parrafo
òò 
.
òò 
	PageIndex
òò !
=
òò" #
e
òò$ %
.
òò% &
NewPageIndex
òò& 2
If
ôô 
Session
ôô 
(
ôô 
$str
ôô "
)
ôô" #
=
ôô$ %
$str
ôô& )
Then
ôô* .
ElseIf
úú 
Session
úú 
(
úú 
$str
úú &
)
úú& '
=
úú( )
$str
úú* -
Then
úú. 2
Dim
ùù 
valor
ùù 
As
ùù 
String
ùù #
=
ùù$ %
Session
ùù& -
(
ùù- .
$str
ùù. 9
)
ùù9 :
Dim
üü 
vBandera
üü 
As
üü 
String
üü  &
=
üü' (
Session
üü) 0
(
üü0 1
$str
üü1 ;
)
üü; <
End
°° 
If
°° 
Catch
•• 
ex
•• 
As
•• 
	Exception
•• 

lbl_Valida
¶¶ 
.
¶¶ 
Text
¶¶ 
=
¶¶ 
ex
¶¶  
.
¶¶  !
Message
¶¶! (

lbl_Valida
ßß 
.
ßß 
	ForeColor
ßß  
=
ßß! "
System
ßß# )
.
ßß) *
Drawing
ßß* 1
.
ßß1 2
Color
ßß2 7
.
ßß7 8
Red
ßß8 ;
End
©© 
Try
©© 
End
™™ 
Sub
™™ 
	Protected
ÆÆ 
Sub
ÆÆ /
!grv_parrrafo_SelectedIndexChanged
ÆÆ 3
(
ÆÆ3 4
sender
ÆÆ4 :
As
ÆÆ; =
Object
ÆÆ> D
,
ÆÆD E
e
ÆÆF G
As
ÆÆH J
	EventArgs
ÆÆK T
)
ÆÆT U
Handles
ÆÆV ]
grv_parrafo
ÆÆ^ i
.
ÆÆi j"
SelectedIndexChanged
ÆÆj ~
Try
ØØ 
Dim
∞∞ 
v_idParrafo
∞∞ 
As
∞∞ 
String
∞∞ %
=
∞∞& '
TryCast
∞∞( /
(
∞∞/ 0
grv_parrafo
∞∞0 ;
.
∞∞; <
SelectedRow
∞∞< G
.
∞∞G H
FindControl
∞∞H S
(
∞∞S T
$str
∞∞T \
)
∞∞\ ]
,
∞∞] ^
Label
∞∞_ d
)
∞∞d e
.
∞∞e f
Text
∞∞f j$
Listar_RegistroParrafo
±± "
(
±±" #
v_idParrafo
±±# .
)
±±. /

lbl_Valida
≤≤ 
.
≤≤ 
Text
≤≤ 
=
≤≤ 
$str
≤≤ H

lbl_Valida
≥≥ 
.
≥≥ 
	ForeColor
≥≥  
=
≥≥! "
System
≥≥# )
.
≥≥) *
Drawing
≥≥* 1
.
≥≥1 2
Color
≥≥2 7
.
≥≥7 8

DarkOrange
≥≥8 B

Validacion
µµ 
(
µµ 
$str
µµ )
)
µµ) *
Catch
∑∑ 
ex
∑∑ 
As
∑∑ 
	Exception
∑∑ 

lbl_Valida
∏∏ 
.
∏∏ 
Text
∏∏ 
=
∏∏ 
ex
∏∏  
.
∏∏  !
Message
∏∏! (

lbl_Valida
ππ 
.
ππ 
	ForeColor
ππ  
=
ππ! "
System
ππ# )
.
ππ) *
Drawing
ππ* 1
.
ππ1 2
Color
ππ2 7
.
ππ7 8
Red
ππ8 ;
End
∫∫ 
Try
∫∫ 
End
ªª 
Sub
ªª 
Private
ææ 
Sub
ææ $
Listar_RegistroParrafo
ææ &
(
ææ& '
ByVal
ææ' ,
v_idParrafo
ææ- 8
As
ææ9 ;
String
ææ< B
)
ææB C
Dim
øø 
dt_Movimiento
øø 
As
øø 
	DataTable
øø &
dt_Movimiento
¡¡ 
=
¡¡ 
CapaNegocio
¡¡ #
.
¡¡# $
cls_Metodos
¡¡$ /
.
¡¡/ 0
MostrarParrafo
¡¡0 >
(
¡¡> ?
$str
¡¡? B
,
¡¡B C
$str
¡¡D F
)
¡¡F G
.
¡¡G H
Tables
¡¡H N
(
¡¡N O
$num
¡¡O P
)
¡¡P Q
Dim
¬¬ 

c_cParrafo
¬¬ 
As
¬¬ 
String
¬¬  
=
¬¬! "
dt_Movimiento
¬¬# 0
.
¬¬0 1
Rows
¬¬1 5
(
¬¬5 6
$num
¬¬6 7
)
¬¬7 8
(
¬¬8 9
$str
¬¬9 C
)
¬¬C D
.
¬¬D E
ToString
¬¬E M
(
¬¬M N
)
¬¬N O

txtParrafo
√√ 
.
√√ 
Text
√√ 
=
√√ 

c_cParrafo
√√ $
End
ƒƒ 
Sub
ƒƒ 
End∆∆ 
Class
∆∆ 	Ú
gC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\frm_Contacto.aspx.vb
Public 
Class 
frm_Contacto 
Inherits 
System 
. 
Web 
. 
UI 
. 
Page 
	Protected 
Sub 
	Page_Load 
( 
ByVal !
sender" (
As) +
Object, 2
,2 3
ByVal4 9
e: ;
As< >
System? E
.E F
	EventArgsF O
)O P
HandlesQ X
MeY [
.[ \
Load\ `
Session 
( 
$str 
) 
= 
$str (
If 

f_validarSesion 
( 
) 
= 
True #
Then$ (
Else 
Session 
( 
$str 
) 
= 
$str  #
Response 
. 
Redirect 
( 
$str m
)m n
End 
If 
End 
Sub 
Public 

Function 
f_validarSesion #
(# $
)$ %
As& (
Boolean) 0
If 

Session 
( 
$str !
)! "
Is# %
Nothing& -
Then. 2
Return 
False 
End 
If 
Return 
True 
End 
Function 
End 
Class 	ÅŒ	
qC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\frm_mantenimientoLibro.aspx.vb
Public 
Class "
frm_mantenimientoLibro #
Inherits 
System 
. 
Web 
. 
UI 
. 
Page 
	Protected 
Sub 
	Page_Load 
( 
ByVal !
sender" (
As) +
Object, 2
,2 3
ByVal4 9
e: ;
As< >
System? E
.E F
	EventArgsF O
)O P
HandlesQ X
MeY [
.[ \
Load\ `
Session		 
(		 
$str		 
)		 
=		 
$str		 -
If 

f_validarSesion 
( 
) 
= 
True #
Then$ (
If 
Not 
Page 
. 

IsPostBack "
Then# '
Try 
cls_Metodos 
.  
culture_info  ,
(, -
)- .

Validacion 
( 
$str *
)* +%
listar_ultimosCincuentaGV -
(- .
). /
Catch 
ex 
As 
	Exception %

lbl_Valida 
. 
Text #
=$ %
ex& (
.( )
Message) 0

lbl_Valida 
. 
	ForeColor (
=) *
System+ 1
.1 2
Drawing2 9
.9 :
Color: ?
.? @
Red@ C
	btnBuscar 
. 
Visible %
=& '
False( -
End 
Try 
End 
If 
Else 
Session 
( 
$str 
) 
= 
$str  #
Response 
. 
Redirect 
( 
$str m
)m n
End 
If 
End 
Sub 
Public 

Function 
f_validarSesion #
(# $
)$ %
As& (
Boolean) 0
If   

Session   
(   
$str   !
)  ! "
Is  # %
Nothing  & -
Then  . 2
Return!! 
False!! 
End"" 
If"" 
Return## 
True## 
End$$ 
Function$$ 
	Protected'' 
Sub'' 
btn_Buscar_Click'' "
(''" #
ByVal''# (
sender'') /
As''0 2
Object''3 9
,''9 :
ByVal''; @
e''A B
As''C E
	EventArgs''F O
)''O P
Handles''Q X
	btnBuscar''Y b
.''b c
Click''c h
Try(( 
Limpiar)) 
()) 
$str)) 
))) 
Busqueda** 
(** 
)** 
Catch++ 
ex++ 
As++ 
	Exception++ 

lbl_Valida,, 
.,, 
Text,, 
=,, 
ex,,  
.,,  !
Message,,! (

lbl_Valida-- 
.-- 
	ForeColor--  
=--! "
System--# )
.--) *
Drawing--* 1
.--1 2
Color--2 7
.--7 8
Red--8 ;
	btnBuscar.. 
... 
Visible.. 
=.. 
False..  %
End// 
Try// 
End00 
Sub00 
	Protected33 
Sub33 
btnGrabar_Click33 !
(33! "
ByVal33" '
sender33( .
As33/ 1
Object332 8
,338 9
ByVal33: ?
e33@ A
As33B D
	EventArgs33E N
)33N O
Handles33P W
	btnGrabar33X a
.33a b
Click33b g
Try44 
Call55 
grabar55 
(55 
$str55 !
)55! "
Catch66 
ex66 
As66 
	Exception66 
lblMsjMantLibro77 
.77 
Text77  
=77! "
ex77# %
.77% &
Message77& -
lblMsjMantLibro88 
.88 
	ForeColor88 %
=88& '
Drawing88( /
.88/ 0
Color880 5
.885 6
Red886 9
End99 
Try99 
End:: 
Sub:: 
	Protected<< 
Sub<< 
btnGrabar2_Click<< "
(<<" #
sender<<# )
As<<* ,
Object<<- 3
,<<3 4
e<<5 6
As<<7 9
	EventArgs<<: C
)<<C D
Handles<<E L

btnGrabar2<<M W
.<<W X
Click<<X ]
Try== 
grabar>> 
(>> 
$str>> 
)>> 
Catch?? 
ex?? 
As?? 
	Exception?? 

lbl_Valida@@ 
.@@ 
Text@@ 
=@@ 
ex@@  
.@@  !
Message@@! (

lbl_ValidaAA 
.AA 
	ForeColorAA  
=AA! "
SystemAA# )
.AA) *
DrawingAA* 1
.AA1 2
ColorAA2 7
.AA7 8
RedAA8 ;
	btnBuscarBB 
.BB 
VisibleBB 
=BB 
FalseBB  %
EndCC 
TryCC 
EndDD 
SubDD 
PrivateGG 
SubGG 
btn_Agregar_ClickGG !
(GG! "
senderGG" (
AsGG) +
ObjectGG, 2
,GG2 3
eGG4 5
AsGG6 8
	EventArgsGG9 B
)GGB C
HandlesGGD K

btnAgregarGGL V
.GGV W
ClickGGW \
TryHH 
CallII 
LimpiarII 
(II 
$strII "
)II" #
CallJJ 

ValidacionJJ 
(JJ 
$strJJ %
)JJ% &

lbl_ValidaLL 
.LL 
	ForeColorLL  
=LL! "
SystemLL# )
.LL) *
DrawingLL* 1
.LL1 2
ColorLL2 7
.LL7 8

DarkOrangeLL8 B

lbl_ValidaMM 
.MM 
TextMM 
=MM 
$strMM 5
CatchNN 
exNN 
AsNN 
	ExceptionNN 

lbl_ValidaOO 
.OO 
TextOO 
=OO 
exOO  
.OO  !
MessageOO! (

lbl_ValidaPP 
.PP 
	ForeColorPP  
=PP! "
SystemPP# )
.PP) *
DrawingPP* 1
.PP1 2
ColorPP2 7
.PP7 8
RedPP8 ;
	btnBuscarQQ 
.QQ 
VisibleQQ 
=QQ 
FalseQQ  %
EndRR 
TryRR 
EndSS 
SubSS 
PrivateVV 
SubVV 
btn_Modificar_ClickVV #
(VV# $
senderVV$ *
AsVV+ -
ObjectVV. 4
,VV4 5
eVV6 7
AsVV8 :
	EventArgsVV; D
)VVD E
HandlesVVF M
btnModificarVVN Z
.VVZ [
ClickVV[ `
TryWW 
LimpiarXX 
(XX 
$strXX 
)XX  
SessionYY 
(YY 
$strYY !
)YY! "
=YY# $
$strYY% 0

lbl_Valida[[ 
.[[ 
	ForeColor[[  
=[[! "
System[[# )
.[[) *
Drawing[[* 1
.[[1 2
Color[[2 7
.[[7 8

DarkOrange[[8 B

lbl_Valida\\ 
.\\ 
Text\\ 
=\\ 
$str\\ 7

Validacion]] 
(]] 
$str]] "
)]]" #
Catch^^ 
ex^^ 
As^^ 
	Exception^^ 

lbl_Valida__ 
.__ 
Text__ 
=__ 
ex__  
.__  !
Message__! (

lbl_Valida`` 
.`` 
	ForeColor``  
=``! "
System``# )
.``) *
Drawing``* 1
.``1 2
Color``2 7
.``7 8
Red``8 ;
	btnBuscaraa 
.aa 
Visibleaa 
=aa 
Falseaa  %
Endbb 
Trybb 
Endcc 
Subcc 
Privateff 
Subff 
btnCancelar_Clickff !
(ff! "
senderff" (
Asff) +
Objectff, 2
,ff2 3
eff4 5
Asff6 8
	EventArgsff9 B
)ffB C
HandlesffD K
btnCancelarffL W
.ffW X
ClickffX ]
Trygg 
Responsehh 
.hh 
Redirecthh 
(hh 
$strhh ;
)hh; <
Catchii 
exii 
Asii 
	Exceptionii 

lbl_Validajj 
.jj 
Textjj 
=jj 
exjj  
.jj  !
Messagejj! (

lbl_Validakk 
.kk 
	ForeColorkk  
=kk! "
Systemkk# )
.kk) *
Drawingkk* 1
.kk1 2
Colorkk2 7
.kk7 8
Redkk8 ;
	btnBuscarll 
.ll 
Visiblell 
=ll 
Falsell  %
Endmm 
Trymm 
Endnn 
Subnn 
Privatepp 
Subpp 

Validacionpp 
(pp 
ByValpp  

Validacionpp! +
Aspp, .
Stringpp/ 5
)pp5 6 
txt_LibroPrecioSolesqq 
.qq 

Attributesqq '
.qq' (
Addqq( +
(qq+ ,
$strqq, 5
,qq5 6
$strqq7 U
)qqU V 
txt_LibroPrecioSolesrr 
.rr 
	MaxLengthrr &
=rr' (
$numrr) *"
txt_LibroprecioDolaresss 
.ss 

Attributesss )
.ss) *
Addss* -
(ss- .
$strss. 7
,ss7 8
$strss9 W
)ssW X"
txt_LibroprecioDolarestt 
.tt 
	MaxLengthtt (
=tt) *
$numtt+ ,
txt_numPaginasuu 
.uu 

Attributesuu !
.uu! "
Adduu" %
(uu% &
$struu& /
,uu/ 0
$struu1 I
)uuI J
txt_numPaginasvv 
.vv 
	MaxLengthvv  
=vv! "
$numvv# $
txt_anioEdicww 
.ww 

Attributesww 
.ww  
Addww  #
(ww# $
$strww$ -
,ww- .
$strww/ G
)wwG H
txt_anioEdicxx 
.xx 
	MaxLengthxx 
=xx  
$numxx! "
txt_FechaSist_Ingzz 
.zz 
ReadOnlyzz "
=zz# $
Truezz% )
txt_HoraSist_Ing{{ 
.{{ 
ReadOnly{{ !
={{" #
True{{$ (
txt_UsActivo|| 
.|| 
ReadOnly|| 
=|| 
True||  $
txt_Usuario}} 
.}} 
ReadOnly}} 
=}} 
True}} #
txt_NoIP~~ 
.~~ 
ReadOnly~~ 
=~~ 
True~~  
Dim
ÄÄ 
tupla_FechaHora
ÄÄ 
As
ÄÄ 
Tuple
ÄÄ $
(
ÄÄ$ %
Of
ÄÄ% '
String
ÄÄ( .
,
ÄÄ. /
String
ÄÄ0 6
)
ÄÄ6 7
=
ÄÄ8 9 
Formato_Fecha_Hora
ÄÄ: L
(
ÄÄL M
)
ÄÄM N
Dim
ÅÅ 
IPAdd
ÅÅ 
As
ÅÅ 
String
ÅÅ 
=
ÅÅ 
	CapturaIP
ÅÅ '
(
ÅÅ' (
)
ÅÅ( )
txt_UsActivo
ÇÇ 
.
ÇÇ 
Text
ÇÇ 
=
ÇÇ 
Session
ÇÇ #
(
ÇÇ# $
$str
ÇÇ$ /
)
ÇÇ/ 0
If
ÖÖ 


Validacion
ÖÖ 
=
ÖÖ 
$str
ÖÖ *
Then
ÖÖ+ /
btnVerFichaDet
ÜÜ 
.
ÜÜ 
Enabled
ÜÜ "
=
ÜÜ# $
True
ÜÜ% )
btnVerFichaDet
áá 
.
áá 
Visible
áá "
=
áá# $
True
áá% )
btnCancelar
àà 
.
àà 
Enabled
àà 
=
àà  !
True
àà" &

btnGrabar2
ââ 
.
ââ 
Enabled
ââ 
=
ââ  
False
ââ! &

btnGrabar2
ää 
.
ää 
Visible
ää 
=
ää  
True
ää! %
	btnGrabar
ãã 
.
ãã 
Visible
ãã 
=
ãã 
False
ãã  %

btnAgregar
åå 
.
åå 
Enabled
åå 
=
åå  
False
åå! &
btnModificar
çç 
.
çç 
Enabled
çç  
=
çç! "
True
çç# '
	btnBuscar
éé 
.
éé 
Enabled
éé 
=
éé 
False
éé  %
btn_Limpiar
èè 
.
èè 
Disabled
èè  
=
èè! "
True
èè# '
ElseIf
êê 

Validacion
êê 
=
êê 
$str
êê %
Then
êê& *
Dim
íí 
	dt_NumReg
íí 
As
íí 
	DataTable
íí &
=
íí' (
cls_Metodos
íí) 4
.
íí4 5(
validacionContadorCodLibro
íí5 O
.
ííO P
Tables
ííP V
(
ííV W
$num
ííW X
)
ííX Y
Dim
ìì 
vValor_Maximo
ìì 
As
ìì  
String
ìì! '
=
ìì( )
Val
ìì* -
(
ìì- .
	dt_NumReg
ìì. 7
.
ìì7 8
Rows
ìì8 <
(
ìì< =
$num
ìì= >
)
ìì> ?
(
ìì? @
$str
ìì@ I
)
ììI J
)
ììJ K
.
ììK L
ToString
ììL T
(
ììT U
)
ììU V
txt_codRegistro
ïï 
.
ïï 
Text
ïï  
=
ïï! "
vValor_Maximo
ïï# 0
+
ïï1 2
$num
ïï3 4
txt_TituloLibro
òò 
.
òò 
	InnerText
òò %
=
òò& '
$str
òò( *"
txt_LibroPrecioSoles
ôô  
.
ôô  !
Text
ôô! %
=
ôô& '
$str
ôô( *
txt_codClasif
öö 
.
öö 
Text
öö 
=
öö  
$str
öö! #
txt_TituloLibro
õõ 
.
õõ 
	InnerText
õõ %
=
õõ& '
$str
õõ( *
	txt_lugar
úú 
.
úú 
Text
úú 
=
úú 
$str
úú 
	txt_autor
ùù 
.
ùù 
Text
ùù 
=
ùù 
$str
ùù 
txt_Editorial
ûû 
.
ûû 
Text
ûû 
=
ûû  
$str
ûû! #
txt_Editorial
üü 
.
üü 
Text
üü 
=
üü  
$str
üü! #
txt_numEdicion
†† 
.
†† 
Text
†† 
=
††  !
$str
††" $
txt_anioEdic
°° 
.
°° 
Text
°° 
=
°° 
$str
°°  "
txt_proveedor
¢¢ 
.
¢¢ 
	InnerText
¢¢ #
=
¢¢$ %
$str
¢¢& (
txt_numPaginas
££ 
.
££ 
Text
££ 
=
££  !
$str
££" $
txt_numEjemplares
§§ 
.
§§ 
Text
§§ "
=
§§# $
$str
§§% '$
txt_LibroprecioDolares
•• "
.
••" #
Text
••# '
=
••( )
$str
••* ,"
txt_LibroPrecioSoles
¶¶  
.
¶¶  !
Text
¶¶! %
=
¶¶& '
$str
¶¶( *
txt_materias
ßß 
.
ßß 
	InnerText
ßß "
=
ßß# $
$str
ßß% '
txt_Detalles
®® 
.
®® 
	InnerText
®® "
=
®®# $
$str
®®% '
txt_ISBN
©© 
.
©© 
Text
©© 
=
©© 
$str
©© $
txt_MesAnioCompraLibro
™™ "
.
™™" #
Text
™™# '
=
™™( )
$str
™™* ,
txt_FechaSist_Ing
´´ 
.
´´ 
Text
´´ "
=
´´# $
(
´´% &
tupla_FechaHora
´´& 5
.
´´5 6
Item1
´´6 ;
)
´´; <
txt_HoraSist_Ing
¨¨ 
.
¨¨ 
Text
¨¨ !
=
¨¨" #
(
¨¨$ %
tupla_FechaHora
¨¨% 4
.
¨¨4 5
Item2
¨¨5 :
)
¨¨: ;!
cboxLibro_Categoria
ÆÆ 
.
ÆÆ  
SelectedIndex
ÆÆ  -
=
ÆÆ. /
-
ÆÆ0 1
$num
ÆÆ1 2
cboxTipo
ØØ 
.
ØØ 
SelectedIndex
ØØ "
=
ØØ# $
-
ØØ% &
$num
ØØ& '
cboxLibro_Modo
∞∞ 
.
∞∞ 
SelectedIndex
∞∞ (
=
∞∞) *
-
∞∞+ ,
$num
∞∞, -
cboxLibro_Estado
±± 
.
±± 
Enabled
±± $
=
±±% &
False
±±' ,
cboxLibro_Estado
≤≤ 
.
≤≤ 
SelectedIndex
≤≤ *
=
≤≤+ ,
$num
≤≤- .
cboxLibro_Idioma
≥≥ 
.
≥≥ 
SelectedIndex
≥≥ *
=
≥≥+ ,
-
≥≥- .
$num
≥≥. /
ckhLibro_CD
µµ 
.
µµ 
Checked
µµ 
=
µµ  !
False
µµ" '
txt_TituloLibro
∏∏ 
.
∏∏ 
Disabled
∏∏ $
=
∏∏% &
False
∏∏' ,"
txt_LibroPrecioSoles
ππ  
.
ππ  !
Enabled
ππ! (
=
ππ) *
True
ππ+ /
txt_codClasif
∫∫ 
.
∫∫ 
Enabled
∫∫ !
=
∫∫" #
True
∫∫$ (
txt_TituloLibro
ªª 
.
ªª 
Disabled
ªª $
=
ªª% &
False
ªª' ,
	txt_lugar
ºº 
.
ºº 
Enabled
ºº 
=
ºº 
True
ºº  $
	txt_autor
ΩΩ 
.
ΩΩ 
Enabled
ΩΩ 
=
ΩΩ 
True
ΩΩ  $
txt_Editorial
ææ 
.
ææ 
Enabled
ææ !
=
ææ" #
True
ææ$ (
txt_Editorial
øø 
.
øø 
Enabled
øø !
=
øø" #
True
øø$ (
txt_numEdicion
¿¿ 
.
¿¿ 
Enabled
¿¿ "
=
¿¿# $
True
¿¿% )
txt_anioEdic
¡¡ 
.
¡¡ 
Enabled
¡¡  
=
¡¡! "
True
¡¡# '
txt_proveedor
¬¬ 
.
¬¬ 
Disabled
¬¬ "
=
¬¬# $
False
¬¬% *
txt_numPaginas
√√ 
.
√√ 
Enabled
√√ "
=
√√# $
True
√√% )
txt_numEjemplares
ƒƒ 
.
ƒƒ 
Enabled
ƒƒ %
=
ƒƒ& '
True
ƒƒ( ,$
txt_LibroprecioDolares
≈≈ "
.
≈≈" #
Enabled
≈≈# *
=
≈≈+ ,
True
≈≈- 1"
txt_LibroPrecioSoles
∆∆  
.
∆∆  !
Enabled
∆∆! (
=
∆∆) *
True
∆∆+ /
txt_materias
«« 
.
«« 
Disabled
«« !
=
««" #
False
««$ )
txt_Detalles
»» 
.
»» 
Disabled
»» !
=
»»" #
False
»»$ )
txt_ISBN
…… 
.
…… 
Enabled
…… 
=
…… 
True
…… #$
txt_MesAnioCompraLibro
   "
.
  " #
Enabled
  # *
=
  + ,
True
  - 1!
cboxLibro_Categoria
ÕÕ 
.
ÕÕ  
Enabled
ÕÕ  '
=
ÕÕ( )
True
ÕÕ* .
cboxLibro_Idioma
œœ 
.
œœ 
Enabled
œœ $
=
œœ% &
True
œœ' +
cboxLibro_Modo
–– 
.
–– 
Enabled
–– "
=
––# $
True
––% )
cboxTipo
—— 
.
—— 
Enabled
—— 
=
—— 
True
—— #
ckhLibro_CD
““ 
.
““ 
Enabled
““ 
=
““  !
True
““" &

btnAgregar
’’ 
.
’’ 
Enabled
’’ 
=
’’  
False
’’! &
btnCancelar
÷÷ 
.
÷÷ 
Enabled
÷÷ 
=
÷÷  !
True
÷÷" &
	btnGrabar
◊◊ 
.
◊◊ 
Enabled
◊◊ 
=
◊◊ 
True
◊◊  $

btnGrabar2
ÿÿ 
.
ÿÿ 
Enabled
ÿÿ 
=
ÿÿ  
False
ÿÿ! &
btnModificar
ŸŸ 
.
ŸŸ 
Enabled
ŸŸ  
=
ŸŸ! "
False
ŸŸ# (
	btnBuscar
⁄⁄ 
.
⁄⁄ 
Enabled
⁄⁄ 
=
⁄⁄ 
False
⁄⁄  %
	btnGrabar
€€ 
.
€€ 
Visible
€€ 
=
€€ 
True
€€  $

btnGrabar2
‹‹ 
.
‹‹ 
Visible
‹‹ 
=
‹‹  
False
‹‹! &
btn_Limpiar
›› 
.
›› 
Disabled
››  
=
››! "
False
››# (
ElseIf
ﬂﬂ 

Validacion
ﬂﬂ 
=
ﬂﬂ 
$str
ﬂﬂ '
Then
ﬂﬂ( ,
txt_TituloLibro
·· 
.
·· 
Disabled
·· $
=
··% &
False
··' ,"
txt_LibroPrecioSoles
‚‚  
.
‚‚  !
Enabled
‚‚! (
=
‚‚) *
True
‚‚+ /
txt_codClasif
„„ 
.
„„ 
Enabled
„„ !
=
„„" #
True
„„$ (
txt_TituloLibro
‰‰ 
.
‰‰ 
Disabled
‰‰ $
=
‰‰% &
False
‰‰' ,
	txt_lugar
ÂÂ 
.
ÂÂ 
Enabled
ÂÂ 
=
ÂÂ 
True
ÂÂ  $
	txt_autor
ÊÊ 
.
ÊÊ 
Enabled
ÊÊ 
=
ÊÊ 
True
ÊÊ  $
txt_Editorial
ÁÁ 
.
ÁÁ 
Enabled
ÁÁ !
=
ÁÁ" #
True
ÁÁ$ (
txt_Editorial
ËË 
.
ËË 
Enabled
ËË !
=
ËË" #
True
ËË$ (
txt_numEdicion
ÈÈ 
.
ÈÈ 
Enabled
ÈÈ "
=
ÈÈ# $
True
ÈÈ% )
txt_anioEdic
ÍÍ 
.
ÍÍ 
Enabled
ÍÍ  
=
ÍÍ! "
True
ÍÍ# '
txt_proveedor
ÎÎ 
.
ÎÎ 
Disabled
ÎÎ "
=
ÎÎ# $
False
ÎÎ% *
txt_numPaginas
ÏÏ 
.
ÏÏ 
Enabled
ÏÏ "
=
ÏÏ# $
True
ÏÏ% )
txt_numEjemplares
ÌÌ 
.
ÌÌ 
Enabled
ÌÌ %
=
ÌÌ& '
True
ÌÌ( ,$
txt_LibroprecioDolares
ÓÓ "
.
ÓÓ" #
Enabled
ÓÓ# *
=
ÓÓ+ ,
True
ÓÓ- 1"
txt_LibroPrecioSoles
ÔÔ  
.
ÔÔ  !
Enabled
ÔÔ! (
=
ÔÔ) *
True
ÔÔ+ /
txt_materias
 
.
 
Disabled
 !
=
" #
False
$ )
txt_Detalles
ÒÒ 
.
ÒÒ 
Disabled
ÒÒ !
=
ÒÒ" #
False
ÒÒ$ )
txt_ISBN
ÚÚ 
.
ÚÚ 
Enabled
ÚÚ 
=
ÚÚ 
True
ÚÚ #$
txt_MesAnioCompraLibro
ÛÛ "
.
ÛÛ" #
Enabled
ÛÛ# *
=
ÛÛ+ ,
True
ÛÛ- 1!
cboxLibro_Categoria
ˆˆ 
.
ˆˆ  
Enabled
ˆˆ  '
=
ˆˆ( )
True
ˆˆ* .
cboxLibro_Estado
˜˜ 
.
˜˜ 
Enabled
˜˜ $
=
˜˜% &
True
˜˜' +
cboxLibro_Idioma
¯¯ 
.
¯¯ 
Enabled
¯¯ $
=
¯¯% &
True
¯¯' +
cboxLibro_Modo
˘˘ 
.
˘˘ 
Enabled
˘˘ "
=
˘˘# $
True
˘˘% )
cboxTipo
˙˙ 
.
˙˙ 
Enabled
˙˙ 
=
˙˙ 
True
˙˙ #
ckhLibro_CD
¸¸ 
.
¸¸ 
Enabled
¸¸ 
=
¸¸  !
True
¸¸" &
btnModificar
˛˛ 
.
˛˛ 
Enabled
˛˛  
=
˛˛! "
False
˛˛# (
btnCancelar
ˇˇ 
.
ˇˇ 
Enabled
ˇˇ 
=
ˇˇ  !
True
ˇˇ" &

btnGrabar2
ÄÄ 
.
ÄÄ 
Enabled
ÄÄ 
=
ÄÄ  
True
ÄÄ! %

btnGrabar2
ÅÅ 
.
ÅÅ 
Visible
ÅÅ 
=
ÅÅ  
True
ÅÅ! %
	btnGrabar
ÇÇ 
.
ÇÇ 
Enabled
ÇÇ 
=
ÇÇ 
False
ÇÇ  %
	btnGrabar
ÉÉ 
.
ÉÉ 
Visible
ÉÉ 
=
ÉÉ 
False
ÉÉ  %

btnAgregar
ÑÑ 
.
ÑÑ 
Enabled
ÑÑ 
=
ÑÑ  
False
ÑÑ! &
	btnBuscar
ÖÖ 
.
ÖÖ 
Enabled
ÖÖ 
=
ÖÖ 
False
ÖÖ  %
btn_Limpiar
ÜÜ 
.
ÜÜ 
Disabled
ÜÜ  
=
ÜÜ! "
True
ÜÜ# '
ElseIf
àà 

Validacion
àà 
=
àà 
$str
àà '
Then
àà( ,
TxtBusqueda
ää 
.
ää 
	MaxLength
ää !
=
ää" #
$num
ää$ %
TxtBusqueda
ãã 
.
ãã 

Attributes
ãã "
.
ãã" #
Add
ãã# &
(
ãã& '
$str
ãã' 0
,
ãã0 1
$str
ãã2 d
)
ããd e
Session
çç 
(
çç 
$str
çç 
)
çç  
=
çç! "
$str
çç# &
Session
éé 
(
éé 
$str
éé 
)
éé  
=
éé! "
$str
éé# %
Session
èè 
(
èè 
$str
èè 
)
èè 
=
èè  !
$str
èè" $
txt_codRegistro
ëë 
.
ëë 
Enabled
ëë #
=
ëë$ %
False
ëë& +
txt_codClasif
íí 
.
íí 
Enabled
íí !
=
íí" #
False
íí$ )
txt_TituloLibro
ìì 
.
ìì 
Disabled
ìì $
=
ìì% &
True
ìì' +
	txt_lugar
îî 
.
îî 
Enabled
îî 
=
îî 
False
îî  %
	txt_autor
ïï 
.
ïï 
Enabled
ïï 
=
ïï 
False
ïï  %
txt_Editorial
ññ 
.
ññ 
Enabled
ññ !
=
ññ" #
False
ññ$ )
txt_numEdicion
óó 
.
óó 
Enabled
óó "
=
óó# $
False
óó% *
txt_anioEdic
òò 
.
òò 
Enabled
òò  
=
òò! "
False
òò# (
txt_proveedor
ôô 
.
ôô 
Disabled
ôô "
=
ôô# $
True
ôô% )
txt_numPaginas
öö 
.
öö 
Enabled
öö "
=
öö# $
False
öö% *
txt_numEjemplares
õõ 
.
õõ 
Enabled
õõ %
=
õõ& '
False
õõ( -$
txt_LibroprecioDolares
úú "
.
úú" #
Enabled
úú# *
=
úú+ ,
False
úú- 2"
txt_LibroPrecioSoles
ùù  
.
ùù  !
Enabled
ùù! (
=
ùù) *
False
ùù+ 0
txt_materias
ûû 
.
ûû 
Disabled
ûû !
=
ûû" #
True
ûû$ (
txt_Detalles
üü 
.
üü 
Disabled
üü !
=
üü" #
True
üü$ (
txt_ISBN
†† 
.
†† 
Enabled
†† 
=
†† 
False
†† $$
txt_MesAnioCompraLibro
°° "
.
°°" #
Enabled
°°# *
=
°°+ ,
False
°°- 2!
cboxLibro_Categoria
££ 
.
££  
Enabled
££  '
=
££( )
False
££* /
cboxLibro_Estado
§§ 
.
§§ 
Enabled
§§ $
=
§§% &
False
§§' ,
cboxLibro_Idioma
•• 
.
•• 
Enabled
•• $
=
••% &
False
••' ,
cboxLibro_Modo
¶¶ 
.
¶¶ 
Enabled
¶¶ "
=
¶¶# $
False
¶¶% *
cboxTipo
ßß 
.
ßß 
Enabled
ßß 
=
ßß 
False
ßß $
ckhLibro_CD
©© 
.
©© 
Enabled
©© 
=
©©  !
False
©©" '
btnVerFichaDet
´´ 
.
´´ 
Enabled
´´ "
=
´´# $
False
´´% *
btnVerFichaDet
¨¨ 
.
¨¨ 
Visible
¨¨ "
=
¨¨# $
False
¨¨% *
	btnGrabar
≠≠ 
.
≠≠ 
Enabled
≠≠ 
=
≠≠ 
True
≠≠  $
	btnGrabar
ÆÆ 
.
ÆÆ 
Visible
ÆÆ 
=
ÆÆ 
True
ÆÆ  $
	btnGrabar
ØØ 
.
ØØ 
Enabled
ØØ 
=
ØØ 
False
ØØ  %

btnGrabar2
∞∞ 
.
∞∞ 
Visible
∞∞ 
=
∞∞  
False
∞∞! &

btnGrabar2
±± 
.
±± 
Enabled
±± 
=
±±  
False
±±! &
btnModificar
≤≤ 
.
≤≤ 
Enabled
≤≤  
=
≤≤! "
False
≤≤# (
btnCancelar
≥≥ 
.
≥≥ 
Enabled
≥≥ 
=
≥≥  !
True
≥≥" &
	btnBuscar
¥¥ 
.
¥¥ 
Enabled
¥¥ 
=
¥¥ 
True
¥¥  $
btn_Limpiar
µµ 
.
µµ 
Disabled
µµ  
=
µµ! "
False
µµ# (
txt_NoIP
∑∑ 
.
∑∑ 
Text
∑∑ 
=
∑∑ 
IPAdd
∑∑ !
Listar_Registro
ππ 
(
ππ 
$str
ππ ,
,
ππ, -
$str
ππ. 1
)
ππ1 2
End
∫∫ 
If
∫∫ 
End
ªª 
Sub
ªª 
Private
ºº 
Sub
ºº '
listar_ultimosCincuentaGV
ºº )
(
ºº) *
)
ºº* +
cargarLista
ΩΩ 
(
ΩΩ 
)
ΩΩ 
End
ææ 
Sub
ææ 
Private
øø 
Sub
øø 
cargarLista
øø 
(
øø 
)
øø 
	gdv_Lista
¿¿ 
.
¿¿ 

DataSource
¿¿ 
=
¿¿ 
cls_Metodos
¿¿ *
.
¿¿* +
Listar_Movimiento
¿¿+ <
	gdv_Lista
¡¡ 
.
¡¡ 
DataBind
¡¡ 
(
¡¡ 
)
¡¡ 
End
¬¬ 
Sub
¬¬ 
Private
≈≈ 
Sub
≈≈ 
Busqueda
≈≈ 
(
≈≈ 
)
≈≈ 
If
«« 

Len
«« 
(
«« 
Trim
«« 
(
«« 
TxtBusqueda
«« 
.
««  
Text
««  $
)
««$ %
)
««% &
=
««' (
$num
««) *
Then
««+ /

lbl_Valida
»» 
.
»» 
	ForeColor
»»  
=
»»! "
System
»»# )
.
»») *
Drawing
»»* 1
.
»»1 2
Color
»»2 7
.
»»7 8
Red
»»8 ;

lbl_Valida
…… 
.
…… 
Text
…… 
=
…… 
$str
…… >
TxtBusqueda
   
.
   
Text
   
=
   
$str
   !
TxtBusqueda
ÀÀ 
.
ÀÀ 
Focus
ÀÀ 
(
ÀÀ 
)
ÀÀ 
Exit
ÃÃ 
Sub
ÃÃ 
End
ÕÕ 
If
ÕÕ 
Session
œœ 
(
œœ 
$str
œœ 
)
œœ 
=
œœ 
$str
œœ "
Session
–– 
(
–– 
$str
–– 
)
–– 
=
–– 
$str
–– !
Session
—— 
(
—— 
$str
—— 
)
—— 
=
—— 
$str
——  
Dim
”” 
Valor
”” 
As
”” 
String
”” 
=
”” 
TxtBusqueda
”” )
.
””) *
Text
””* .
.
””. /
Trim
””/ 3
Dim
‘‘ 
vBandera
‘‘ 
As
‘‘ 
String
‘‘ 
If
÷÷ 

cboxBusqueda
÷÷ 
.
÷÷ 
SelectedIndex
÷÷ %
=
÷÷& '
$num
÷÷( )
Then
÷÷* .
vBandera
◊◊ 
=
◊◊ 
$str
◊◊ 
ElseIf
ÿÿ 
cboxBusqueda
ÿÿ 
.
ÿÿ 
SelectedIndex
ÿÿ )
=
ÿÿ* +
$num
ÿÿ, -
Then
ÿÿ. 2
vBandera
ŸŸ 
=
ŸŸ 
$str
ŸŸ 
ElseIf
⁄⁄ 
cboxBusqueda
⁄⁄ 
.
⁄⁄ 
SelectedIndex
⁄⁄ )
=
⁄⁄* +
$num
⁄⁄, -
Then
⁄⁄. 2
vBandera
€€ 
=
€€ 
$str
€€ 
ElseIf
‹‹ 
cboxBusqueda
‹‹ 
.
‹‹ 
SelectedIndex
‹‹ )
=
‹‹* +
$num
‹‹, -
Then
‹‹. 2
vBandera
›› 
=
›› 
$str
›› 
ElseIf
ﬁﬁ 
cboxBusqueda
ﬁﬁ 
.
ﬁﬁ 
SelectedIndex
ﬁﬁ )
=
ﬁﬁ* +
$num
ﬁﬁ, -
Then
ﬁﬁ. 2
vBandera
ﬂﬂ 
=
ﬂﬂ 
$str
ﬂﬂ 
ElseIf
‡‡ 
cboxBusqueda
‡‡ 
.
‡‡ 
SelectedIndex
‡‡ )
=
‡‡* +
$num
‡‡, -
Then
‡‡. 2
vBandera
·· 
=
·· 
$str
·· 
End
‚‚ 
If
‚‚ 
Session
‰‰ 
(
‰‰ 
$str
‰‰ 
)
‰‰ 
=
‰‰ 
Valor
‰‰ $
Session
ÂÂ 
(
ÂÂ 
$str
ÂÂ 
)
ÂÂ 
=
ÂÂ 
vBandera
ÂÂ &
Dim
ËË 
ds
ËË 
As
ËË 
DataSet
ËË 
=
ËË 
cls_Metodos
ËË '
.
ËË' (
BuscarLibro
ËË( 3
(
ËË3 4
Valor
ËË4 9
,
ËË9 :
vBandera
ËË; C
)
ËËC D
	gdv_Lista
ÍÍ 
.
ÍÍ 

DataSource
ÍÍ 
=
ÍÍ 
ds
ÍÍ !
	gdv_Lista
ÎÎ 
.
ÎÎ 
DataBind
ÎÎ 
(
ÎÎ 
)
ÎÎ 

lbl_Valida
ÏÏ 
.
ÏÏ 
Visible
ÏÏ 
=
ÏÏ 
True
ÏÏ !

lbl_Valida
ÌÌ 
.
ÌÌ 
	ForeColor
ÌÌ 
=
ÌÌ 
System
ÌÌ %
.
ÌÌ% &
Drawing
ÌÌ& -
.
ÌÌ- .
Color
ÌÌ. 3
.
ÌÌ3 4
Green
ÌÌ4 9

lbl_Valida
ÓÓ 
.
ÓÓ 
Text
ÓÓ 
=
ÓÓ 
$str
ÓÓ )
&
ÓÓ* +
ds
ÓÓ, .
.
ÓÓ. /
Tables
ÓÓ/ 5
(
ÓÓ5 6
$num
ÓÓ6 7
)
ÓÓ7 8
.
ÓÓ8 9
Rows
ÓÓ9 =
.
ÓÓ= >
Count
ÓÓ> C
Dim
 

countLista
 
=
 
ds
 
.
 
Tables
 "
(
" #
$num
# $
)
$ %
.
% &
Rows
& *
.
* +
Count
+ 0
	GeneraLog
ÚÚ 
(
ÚÚ 
vBandera
ÚÚ 
,
ÚÚ 
Valor
ÚÚ !
)
ÚÚ! "
End
ÛÛ 
Sub
ÛÛ 
Private
ıı 
Sub
ıı 
listarUltimo
ıı 
(
ıı 
)
ıı 
Listar_Registro
ˆˆ 
(
ˆˆ 
$str
ˆˆ (
,
ˆˆ( )
$str
ˆˆ* -
)
ˆˆ- .'
listar_ultimosCincuentaGV
˜˜ !
(
˜˜! "
)
˜˜" #
Limpiar
¯¯ 
(
¯¯ 
$str
¯¯ 
)
¯¯ 
End
˘˘ 
Sub
˘˘ 
Private
¸¸ 
Sub
¸¸ 
Limpiar
¸¸ 
(
¸¸ 
ByVal
¸¸ 
Accion
¸¸ $
As
¸¸% '
String
¸¸( .
)
¸¸. /
If
˛˛ 

Accion
˛˛ 
=
˛˛ 
$str
˛˛ 
Then
˛˛ "
txt_TituloLibro
ˇˇ 
.
ˇˇ 
	InnerText
ˇˇ %
=
ˇˇ& '
$str
ˇˇ( *
ElseIf
ÄÄ 
Accion
ÄÄ 
=
ÄÄ 
$str
ÄÄ  
Then
ÄÄ! %
txt_TituloLibro
ÅÅ 
.
ÅÅ 
	InnerText
ÅÅ %
=
ÅÅ& '
$str
ÅÅ( *
txt_TituloLibro
ÇÇ 
.
ÇÇ 
	InnerText
ÇÇ %
=
ÇÇ& '
$str
ÇÇ( *"
txt_LibroPrecioSoles
ÉÉ  
.
ÉÉ  !
Text
ÉÉ! %
=
ÉÉ& '
$str
ÉÉ( *
txt_codClasif
ÑÑ 
.
ÑÑ 
Text
ÑÑ 
=
ÑÑ  
$str
ÑÑ! #
txt_TituloLibro
ÖÖ 
.
ÖÖ 
	InnerText
ÖÖ %
=
ÖÖ& '
$str
ÖÖ( *
	txt_lugar
ÜÜ 
.
ÜÜ 
Text
ÜÜ 
=
ÜÜ 
$str
ÜÜ 
	txt_autor
áá 
.
áá 
Text
áá 
=
áá 
$str
áá 
txt_Editorial
àà 
.
àà 
Text
àà 
=
àà  
$str
àà! #
txt_Editorial
ââ 
.
ââ 
Text
ââ 
=
ââ  
$str
ââ! #
txt_numEdicion
ää 
.
ää 
Text
ää 
=
ää  !
$str
ää" $
txt_anioEdic
ãã 
.
ãã 
Text
ãã 
=
ãã 
$str
ãã  "
txt_proveedor
åå 
.
åå 
	InnerText
åå #
=
åå$ %
$str
åå& (
txt_numPaginas
çç 
.
çç 
Text
çç 
=
çç  !
$str
çç" $
txt_numEjemplares
éé 
.
éé 
Text
éé "
=
éé# $
$str
éé% '$
txt_LibroprecioDolares
èè "
.
èè" #
Text
èè# '
=
èè( )
$str
èè* ,"
txt_LibroPrecioSoles
êê  
.
êê  !
Text
êê! %
=
êê& '
$str
êê( *
txt_materias
ëë 
.
ëë 
	InnerText
ëë "
=
ëë# $
$str
ëë% '
txt_Detalles
íí 
.
íí 
	InnerText
íí "
=
íí# $
$str
íí% '
txt_ISBN
ìì 
.
ìì 
Text
ìì 
=
ìì 
$str
ìì $
txt_MesAnioCompraLibro
îî "
.
îî" #
Text
îî# '
=
îî( )
$str
îî* ,!
cboxLibro_Categoria
ññ 
.
ññ  
SelectedIndex
ññ  -
=
ññ. /
-
ññ0 1
$num
ññ1 2
cboxTipo
óó 
.
óó 
SelectedIndex
óó "
=
óó# $
-
óó% &
$num
óó& '
cboxLibro_Modo
òò 
.
òò 
SelectedIndex
òò (
=
òò) *
-
òò+ ,
$num
òò, -
cboxLibro_Estado
ôô 
.
ôô 
SelectedIndex
ôô *
=
ôô+ ,
-
ôô- .
$num
ôô. /
cboxLibro_Idioma
öö 
.
öö 
SelectedIndex
öö *
=
öö+ ,
-
öö- .
$num
öö. /
ckhLibro_CD
úú 
.
úú 
Checked
úú 
=
úú  !
False
úú" '
ElseIf
ûû 
Accion
ûû 
=
ûû 
$str
ûû #
Then
ûû$ (
ElseIf
†† 
Accion
†† 
=
†† 
$str
†† #
Or
††$ &
Accion
††' -
=
††. /
$str
††0 8
Then
††9 =
End
¢¢ 
If
¢¢ 
End
££ 
Sub
££ 
	Protected
¶¶ 
Sub
¶¶ &
gdv_Lista_OnRowDataBound
¶¶ *
(
¶¶* +
ByVal
¶¶+ 0
sender
¶¶1 7
As
¶¶8 :
Object
¶¶; A
,
¶¶A B
ByVal
¶¶C H
e
¶¶I J
As
¶¶K M"
GridViewRowEventArgs
¶¶N b
)
¶¶b c
Try
ßß 
If
®® 
e
®® 
.
®® 
Row
®® 
.
®® 
RowType
®® 
=
®®  
DataControlRowType
®® 1
.
®®1 2
DataRow
®®2 9
Then
®®: >
Dim
©© 
dr
©© 
As
©© 
DataRowView
©© %
=
©©& '
CType
©©( -
(
©©- .
e
©©. /
.
©©/ 0
Row
©©0 3
.
©©3 4
DataItem
©©4 <
,
©©< =
DataRowView
©©> I
)
©©I J
Dim
´´ 
c_cFechaRegistro
´´ $
As
´´% '
String
´´( .
If
¨¨ 
Not
¨¨ 
IsDBNull
¨¨ 
(
¨¨  
dr
¨¨  "
(
¨¨" #
$str
¨¨# 4
)
¨¨4 5
)
¨¨5 6
Then
¨¨7 ;
c_cFechaRegistro
≠≠ $
=
≠≠% &
dr
≠≠' )
(
≠≠) *
$str
≠≠* ;
)
≠≠; <
Else
ÆÆ 
c_cFechaRegistro
ØØ $
=
ØØ% &
$str
ØØ' 1
End
∞∞ 
If
∞∞ 
Dim
≤≤ 
c_cHoraRegistro
≤≤ #
As
≤≤$ &
String
≤≤' -
If
≥≥ 
Not
≥≥ 
IsDBNull
≥≥ 
(
≥≥  
dr
≥≥  "
(
≥≥" #
$str
≥≥# 3
)
≥≥3 4
)
≥≥4 5
Then
≥≥6 :
c_cHoraRegistro
¥¥ #
=
¥¥$ %
dr
¥¥& (
(
¥¥( )
$str
¥¥) 9
)
¥¥9 :
Else
µµ 
c_cHoraRegistro
∂∂ #
=
∂∂$ %
$str
∂∂& ,
End
∑∑ 
If
∑∑ 
Dim
ππ 
	c_cTitulo
ππ 
As
ππ  
String
ππ! '
If
∫∫ 
Not
∫∫ 
IsDBNull
∫∫ 
(
∫∫  
dr
∫∫  "
(
∫∫" #
$str
∫∫# 2
)
∫∫2 3
)
∫∫3 4
Then
∫∫5 9
	c_cTitulo
ªª 
=
ªª 
dr
ªª  "
(
ªª" #
$str
ªª# 2
)
ªª2 3
Else
ºº 
	c_cTitulo
ΩΩ 
=
ΩΩ 
$str
ΩΩ  #
End
ææ 
If
ææ 
Dim
¿¿ 
c_cCodigoRegistro
¿¿ %
As
¿¿& (
String
¿¿) /
If
¡¡ 
Not
¡¡ 
IsDBNull
¡¡ 
(
¡¡  
dr
¡¡  "
(
¡¡" #
$str
¡¡# 7
)
¡¡7 8
)
¡¡8 9
Then
¡¡: >
c_cCodigoRegistro
¬¬ %
=
¬¬& '
dr
¬¬( *
(
¬¬* +
$str
¬¬+ ?
)
¬¬? @
Else
√√ 
c_cCodigoRegistro
ƒƒ %
=
ƒƒ& '
$str
ƒƒ( +
End
≈≈ 
If
≈≈ 
Dim
«« 
c_cAutor
«« 
As
«« 
String
««  &
If
»» 
Not
»» 
IsDBNull
»» 
(
»»  
dr
»»  "
(
»»" #
$str
»»# 1
)
»»1 2
)
»»2 3
Then
»»4 8
c_cAutor
…… 
=
…… 
dr
…… !
(
……! "
$str
……" 0
)
……0 1
Else
   
c_cAutor
ÀÀ 
=
ÀÀ 
$str
ÀÀ "
End
ÃÃ 
If
ÃÃ 
Dim
ŒŒ !
c_cCodClasificacion
ŒŒ '
As
ŒŒ( *
String
ŒŒ+ 1
If
œœ 
Not
œœ 
IsDBNull
œœ 
(
œœ  
dr
œœ  "
(
œœ" #
$str
œœ# <
)
œœ< =
)
œœ= >
Then
œœ? C!
c_cCodClasificacion
–– '
=
––( )
dr
––* ,
(
––, -
$str
––- F
)
––F G
Else
—— !
c_cCodClasificacion
““ '
=
““( )
$str
““* -
End
”” 
If
”” 
Dim
÷÷ 
c_cEstadoViejo
÷÷ "
As
÷÷# %
String
÷÷& ,
If
◊◊ 
Not
◊◊ 
IsDBNull
◊◊ 
(
◊◊  
dr
◊◊  "
(
◊◊" #
$str
◊◊# 2
)
◊◊2 3
)
◊◊3 4
Then
◊◊5 9
c_cEstadoViejo
ÿÿ "
=
ÿÿ# $
dr
ÿÿ% '
(
ÿÿ' (
$str
ÿÿ( 7
)
ÿÿ7 8
Else
ŸŸ 
c_cEstadoViejo
⁄⁄ "
=
⁄⁄# $
$str
⁄⁄% (
End
€€ 
If
€€ 
Dim
ﬁﬁ 
	c_cEstado
ﬁﬁ 
As
ﬁﬁ  
String
ﬁﬁ! '
If
ﬂﬂ 
Not
ﬂﬂ 
IsDBNull
ﬂﬂ 
(
ﬂﬂ  
dr
ﬂﬂ  "
(
ﬂﬂ" #
$str
ﬂﬂ# 2
)
ﬂﬂ2 3
)
ﬂﬂ3 4
Then
ﬂﬂ5 9
	c_cEstado
‡‡ 
=
‡‡ 
dr
‡‡  "
(
‡‡" #
$str
‡‡# 2
)
‡‡2 3
Else
·· 
	c_cEstado
‚‚ 
=
‚‚ 
$str
‚‚  #
End
„„ 
If
„„ 
Dim
ÂÂ 

c_cUsuario
ÂÂ 
As
ÂÂ !
String
ÂÂ" (
If
ÊÊ 
Not
ÊÊ 
IsDBNull
ÊÊ 
(
ÊÊ  
dr
ÊÊ  "
(
ÊÊ" #
$str
ÊÊ# 2
)
ÊÊ2 3
)
ÊÊ3 4
Then
ÊÊ5 9

c_cUsuario
ÁÁ 
=
ÁÁ  
dr
ÁÁ! #
(
ÁÁ# $
$str
ÁÁ$ 3
)
ÁÁ3 4
Else
ËË 

c_cUsuario
ÈÈ 
=
ÈÈ  
$str
ÈÈ! $
End
ÍÍ 
If
ÍÍ 
Dim
ÏÏ 

c_cLibroCD
ÏÏ 
As
ÏÏ !
String
ÏÏ" (
If
ÌÌ 
Not
ÌÌ 
IsDBNull
ÌÌ 
(
ÌÌ  
dr
ÌÌ  "
(
ÌÌ" #
$str
ÌÌ# .
)
ÌÌ. /
)
ÌÌ/ 0
Then
ÌÌ1 5

c_cLibroCD
ÓÓ 
=
ÓÓ  
dr
ÓÓ! #
(
ÓÓ# $
$str
ÓÓ$ /
)
ÓÓ/ 0
Else
ÔÔ 

c_cLibroCD
 
=
  
$str
! $
End
ÒÒ 
If
ÒÒ 
Dim
ÛÛ 
c_cMesAnioCompra
ÛÛ $
As
ÛÛ% '
String
ÛÛ( .
If
ÙÙ 
Not
ÙÙ 
IsDBNull
ÙÙ 
(
ÙÙ  
dr
ÙÙ  "
(
ÙÙ" #
$str
ÙÙ# =
)
ÙÙ= >
)
ÙÙ> ?
Then
ÙÙ@ D
c_cMesAnioCompra
ıı $
=
ıı% &
dr
ıı' )
(
ıı) *
$str
ıı* D
)
ııD E
Else
ˆˆ 
c_cMesAnioCompra
˜˜ $
=
˜˜% &
$str
˜˜' 2
End
¯¯ 
If
¯¯ 
Dim
˙˙ 
c_cLugarLibro
˙˙ !
As
˙˙" $
String
˙˙% +
If
˚˚ 
Not
˚˚ 
IsDBNull
˚˚ 
(
˚˚  
dr
˚˚  "
(
˚˚" #
$str
˚˚# 1
)
˚˚1 2
)
˚˚2 3
Then
˚˚4 8
c_cLugarLibro
¸¸ !
=
¸¸" #
dr
¸¸$ &
(
¸¸& '
$str
¸¸' 5
)
¸¸5 6
Else
˝˝ 
c_cLugarLibro
˛˛ !
=
˛˛" #
$str
˛˛$ '
End
ˇˇ 
If
ˇˇ 
Dim
ÅÅ 
c_cNumEdicion
ÅÅ !
As
ÅÅ" $
String
ÅÅ% +
If
ÇÇ 
Not
ÇÇ 
IsDBNull
ÇÇ 
(
ÇÇ  
dr
ÇÇ  "
(
ÇÇ" #
$str
ÇÇ# 7
)
ÇÇ7 8
)
ÇÇ8 9
Then
ÇÇ: >
c_cNumEdicion
ÉÉ !
=
ÉÉ" #
dr
ÉÉ$ &
(
ÉÉ& '
$str
ÉÉ' ;
)
ÉÉ; <
Else
ÑÑ 
c_cNumEdicion
ÖÖ !
=
ÖÖ" #
$str
ÖÖ$ '
End
ÜÜ 
If
ÜÜ 
CType
àà 
(
àà 
e
àà 
.
àà 
Row
àà 
.
àà 
FindControl
àà '
(
àà' (
$str
àà( ;
)
àà; <
,
àà< =
WebControls
àà> I
.
ààI J
Label
ààJ O
)
ààO P
.
ààP Q
Text
ààQ U
=
ààV W
c_cFechaRegistro
ààX h
CType
ââ 
(
ââ 
e
ââ 
.
ââ 
Row
ââ 
.
ââ 
FindControl
ââ '
(
ââ' (
$str
ââ( :
)
ââ: ;
,
ââ; <
WebControls
ââ= H
.
ââH I
Label
ââI N
)
ââN O
.
ââO P
Text
ââP T
=
ââU V
c_cHoraRegistro
ââW f
CType
ää 
(
ää 
e
ää 
.
ää 
Row
ää 
.
ää 
FindControl
ää '
(
ää' (
$str
ää( 4
)
ää4 5
,
ää5 6
WebControls
ää7 B
.
ääB C
Label
ääC H
)
ääH I
.
ääI J
Text
ääJ N
=
ääO P
	c_cTitulo
ääQ Z
CType
ãã 
(
ãã 
e
ãã 
.
ãã 
Row
ãã 
.
ãã 
FindControl
ãã '
(
ãã' (
$str
ãã( 9
)
ãã9 :
,
ãã: ;
WebControls
ãã< G
.
ããG H
Label
ããH M
)
ããM N
.
ããN O
Text
ããO S
=
ããT U
c_cCodigoRegistro
ããV g
CType
åå 
(
åå 
e
åå 
.
åå 
Row
åå 
.
åå 
FindControl
åå '
(
åå' (
$str
åå( 3
)
åå3 4
,
åå4 5
WebControls
åå6 A
.
ååA B
Label
ååB G
)
ååG H
.
ååH I
Text
ååI M
=
ååN O
c_cAutor
ååP X
CType
çç 
(
çç 
e
çç 
.
çç 
Row
çç 
.
çç 
FindControl
çç '
(
çç' (
$str
çç( >
)
çç> ?
,
çç? @
WebControls
ççA L
.
ççL M
Label
ççM R
)
ççR S
.
ççS T
Text
ççT X
=
ççY Z!
c_cCodClasificacion
çç[ n
CType
éé 
(
éé 
e
éé 
.
éé 
Row
éé 
.
éé 
FindControl
éé '
(
éé' (
$str
éé( 4
)
éé4 5
,
éé5 6
WebControls
éé7 B
.
ééB C
Label
ééC H
)
ééH I
.
ééI J
Text
ééJ N
=
ééO P
c_cEstadoViejo
ééQ _
CType
èè 
(
èè 
e
èè 
.
èè 
Row
èè 
.
èè 
FindControl
èè '
(
èè' (
$str
èè( 5
)
èè5 6
,
èè6 7
WebControls
èè8 C
.
èèC D
Label
èèD I
)
èèI J
.
èèJ K
Text
èèK O
=
èèP Q
	c_cEstado
èèR [
CType
êê 
(
êê 
e
êê 
.
êê 
Row
êê 
.
êê 
FindControl
êê '
(
êê' (
$str
êê( 5
)
êê5 6
,
êê6 7
WebControls
êê8 C
.
êêC D
Label
êêD I
)
êêI J
.
êêJ K
Text
êêK O
=
êêP Q

c_cUsuario
êêR \
CType
ëë 
(
ëë 
e
ëë 
.
ëë 
Row
ëë 
.
ëë 
FindControl
ëë '
(
ëë' (
$str
ëë( 7
)
ëë7 8
,
ëë8 9
WebControls
ëë: E
.
ëëE F
Label
ëëF K
)
ëëK L
.
ëëL M
Text
ëëM Q
=
ëëR S

c_cLibroCD
ëëT ^
CType
íí 
(
íí 
e
íí 
.
íí 
Row
íí 
.
íí 
FindControl
íí '
(
íí' (
$str
íí( ;
)
íí; <
,
íí< =
WebControls
íí> I
.
ííI J
Label
ííJ O
)
ííO P
.
ííP Q
Text
ííQ U
=
ííV W
c_cMesAnioCompra
ííX h
CType
ìì 
(
ìì 
e
ìì 
.
ìì 
Row
ìì 
.
ìì 
FindControl
ìì '
(
ìì' (
$str
ìì( 8
)
ìì8 9
,
ìì9 :
WebControls
ìì; F
.
ììF G
Label
ììG L
)
ììL M
.
ììM N
Text
ììN R
=
ììS T
c_cLugarLibro
ììU b
CType
îî 
(
îî 
e
îî 
.
îî 
Row
îî 
.
îî 
FindControl
îî '
(
îî' (
$str
îî( 8
)
îî8 9
,
îî9 :
WebControls
îî; F
.
îîF G
Label
îîG L
)
îîL M
.
îîM N
Text
îîN R
=
îîS T
c_cNumEdicion
îîU b
End
ïï 
If
ïï 
Catch
ññ 
ex
ññ 
As
ññ 
	Exception
ññ 

lbl_Valida
óó 
.
óó 
Text
óó 
=
óó 
ex
óó  
.
óó  !
Message
óó! (

lbl_Valida
òò 
.
òò 
	ForeColor
òò  
=
òò! "
System
òò# )
.
òò) *
Drawing
òò* 1
.
òò1 2
Color
òò2 7
.
òò7 8
Red
òò8 ;
	btnBuscar
ôô 
.
ôô 
Visible
ôô 
=
ôô 
False
ôô  %
End
öö 
Try
öö 
End
õõ 
Sub
õõ 
	Protected
ûû 
Sub
ûû )
gdv_Lista_PageIndexChanging
ûû -
(
ûû- .
ByVal
ûû. 3
sender
ûû4 :
As
ûû; =
Object
ûû> D
,
ûûD E
ByVal
ûûF K
e
ûûL M
As
ûûN P
System
ûûQ W
.
ûûW X
Web
ûûX [
.
ûû[ \
UI
ûû\ ^
.
ûû^ _
WebControls
ûû_ j
.
ûûj k$
GridViewPageEventArgsûûk Ä
)ûûÄ Å
HandlesûûÇ â
	gdv_Listaûûä ì
.ûûì î!
PageIndexChangingûûî •
Try
üü 
	gdv_Lista
°° 
.
°° 
	PageIndex
°° 
=
°°  !
e
°°" #
.
°°# $
NewPageIndex
°°$ 0
If
¢¢ 
Session
¢¢ 
(
¢¢ 
$str
¢¢ "
)
¢¢" #
=
¢¢$ %
$str
¢¢& )
Then
¢¢* .
cargarLista
££ 
(
££ 
)
££ 
ElseIf
§§ 
Session
§§ 
(
§§ 
$str
§§ &
)
§§& '
=
§§( )
$str
§§* -
Then
§§. 2
Dim
•• 
valor
•• 
As
•• 
String
•• #
=
••$ %
Session
••& -
(
••- .
$str
••. 9
)
••9 :
Dim
¶¶ 
vBandera
¶¶ 
As
¶¶ 
String
¶¶  &
=
¶¶' (
Session
¶¶) 0
(
¶¶0 1
$str
¶¶1 ;
)
¶¶; <
	gdv_Lista
©© 
.
©© 

DataSource
©© $
=
©©% &
cls_Metodos
©©' 2
.
©©2 3
BuscarLibro
©©3 >
(
©©> ?
valor
©©? D
,
©©D E
vBandera
©©F N
)
©©N O
	gdv_Lista
™™ 
.
™™ 
DataBind
™™ "
(
™™" #
)
™™# $
End
´´ 
If
´´ 
Datos_Sistemas
¨¨ 
.
¨¨ 
Focus
¨¨  
(
¨¨  !
)
¨¨! "
Catch
≠≠ 
ex
≠≠ 
As
≠≠ 
	Exception
≠≠ 

lbl_Valida
ÆÆ 
.
ÆÆ 
Text
ÆÆ 
=
ÆÆ 
ex
ÆÆ  
.
ÆÆ  !
Message
ÆÆ! (

lbl_Valida
ØØ 
.
ØØ 
	ForeColor
ØØ  
=
ØØ! "
System
ØØ# )
.
ØØ) *
Drawing
ØØ* 1
.
ØØ1 2
Color
ØØ2 7
.
ØØ7 8
Red
ØØ8 ;
	btnBuscar
∞∞ 
.
∞∞ 
Visible
∞∞ 
=
∞∞ 
False
∞∞  %
End
±± 
Try
±± 
End
≤≤ 
Sub
≤≤ 
	Protected
µµ 
Sub
µµ ,
gdv_Lista_SelectedIndexChanged
µµ 0
(
µµ0 1
sender
µµ1 7
As
µµ8 :
Object
µµ; A
,
µµA B
e
µµC D
As
µµE G
	EventArgs
µµH Q
)
µµQ R
Handles
µµS Z
	gdv_Lista
µµ[ d
.
µµd e"
SelectedIndexChanged
µµe y
Try
∂∂ 
Dim
∑∑ 
v_codRegistro
∑∑ 
As
∑∑  
String
∑∑! '
=
∑∑( )
TryCast
∑∑* 1
(
∑∑1 2
	gdv_Lista
∑∑2 ;
.
∑∑; <
SelectedRow
∑∑< G
.
∑∑G H
FindControl
∑∑H S
(
∑∑S T
$str
∑∑T e
)
∑∑e f
,
∑∑f g
Label
∑∑h m
)
∑∑m n
.
∑∑n o
Text
∑∑o s
Session
∏∏ 
(
∏∏ 
$str
∏∏ (
)
∏∏( )
=
∏∏* +
v_codRegistro
∏∏, 9
Listar_Registro
ππ 
(
ππ 
$str
ππ 2
,
ππ2 3
v_codRegistro
ππ4 A
)
ππA B

lbl_Valida
∫∫ 
.
∫∫ 
Text
∫∫ 
=
∫∫ 
$str
∫∫ H

lbl_Valida
ªª 
.
ªª 
	ForeColor
ªª  
=
ªª! "
System
ªª# )
.
ªª) *
Drawing
ªª* 1
.
ªª1 2
Color
ªª2 7
.
ªª7 8

DarkOrange
ªª8 B

Validacion
ºº 
(
ºº 
$str
ºº )
)
ºº) *
	GeneraLog
ΩΩ 
(
ΩΩ 
$str
ΩΩ 
,
ΩΩ 
v_codRegistro
ΩΩ (
)
ΩΩ( )
Catch
ææ 
ex
ææ 
As
ææ 
	Exception
ææ 

lbl_Valida
øø 
.
øø 
Text
øø 
=
øø 
ex
øø  
.
øø  !
Message
øø! (

lbl_Valida
¿¿ 
.
¿¿ 
	ForeColor
¿¿  
=
¿¿! "
System
¿¿# )
.
¿¿) *
Drawing
¿¿* 1
.
¿¿1 2
Color
¿¿2 7
.
¿¿7 8
Red
¿¿8 ;
	btnBuscar
¡¡ 
.
¡¡ 
Visible
¡¡ 
=
¡¡ 
False
¡¡  %
End
¬¬ 
Try
¬¬ 
End
√√ 
Sub
√√ 
Private
≈≈ 
Sub
≈≈ 
Listar_Registro
≈≈ 
(
≈≈  
ByVal
≈≈  %
	tipoLista
≈≈& /
As
≈≈0 2
String
≈≈3 9
,
≈≈9 :
ByVal
≈≈; @
v_CodRegistro
≈≈A N
As
≈≈O Q
String
≈≈R X
)
≈≈X Y
Dim
∆∆ 
dt_Movimiento
∆∆ 
As
∆∆ 
	DataTable
∆∆ &
If
…… 

	tipoLista
…… 
=
…… 
$str
…… '
Then
……( ,
dt_Movimiento
   
=
   
cls_Metodos
   '
.
  ' (
ListarFormLibro
  ( 7
(
  7 8
	tipoLista
  8 A
,
  A B
$str
  C F
)
  F G
.
  G H
tables
  H N
(
  N O
$num
  O P
)
  P Q
Dim
ÃÃ 

v_CodLibro
ÃÃ 
As
ÃÃ 
String
ÃÃ $
=
ÃÃ% &
dt_Movimiento
ÃÃ' 4
.
ÃÃ4 5
Rows
ÃÃ5 9
(
ÃÃ9 :
$num
ÃÃ: ;
)
ÃÃ; <
(
ÃÃ< =
$str
ÃÃ= Q
)
ÃÃQ R
.
ÃÃR S
ToString
ÃÃS [
(
ÃÃ[ \
)
ÃÃ\ ]
Dim
ÕÕ  
v_codClasificacion
ÕÕ "
As
ÕÕ# %
String
ÕÕ& ,
=
ÕÕ- .
dt_Movimiento
ÕÕ/ <
.
ÕÕ< =
Rows
ÕÕ= A
(
ÕÕA B
$num
ÕÕB C
)
ÕÕC D
(
ÕÕD E
$str
ÕÕE ^
)
ÕÕ^ _
.
ÕÕ_ `
ToString
ÕÕ` h
(
ÕÕh i
)
ÕÕi j
Dim
œœ 
v_TituloLibro
œœ 
As
œœ  
String
œœ! '
=
œœ( )
dt_Movimiento
œœ* 7
.
œœ7 8
Rows
œœ8 <
(
œœ< =
$num
œœ= >
)
œœ> ?
(
œœ? @
$str
œœ@ O
)
œœO P
.
œœP Q
ToString
œœQ Y
(
œœY Z
)
œœZ [
Dim
–– 
v_lugar
–– 
As
–– 
String
–– !
=
––" #
dt_Movimiento
––$ 1
.
––1 2
Rows
––2 6
(
––6 7
$num
––7 8
)
––8 9
(
––9 :
$str
––: H
)
––H I
.
––I J
ToString
––J R
(
––R S
)
––S T
Dim
—— 
v_autor
—— 
As
—— 
String
—— !
=
——" #
dt_Movimiento
——$ 1
.
——1 2
Rows
——2 6
(
——6 7
$num
——7 8
)
——8 9
(
——9 :
$str
——: H
)
——H I
.
——I J
ToString
——J R
(
——R S
)
——S T
Dim
”” 
v_Editorial
”” 
As
”” 
String
”” %
=
””& '
dt_Movimiento
””( 5
.
””5 6
Rows
””6 :
(
””: ;
$num
””; <
)
””< =
(
””= >
$str
””> N
)
””N O
.
””O P
ToString
””P X
(
””X Y
)
””Y Z
Dim
‘‘ 
v_numEdicion
‘‘ 
As
‘‘ 
String
‘‘  &
=
‘‘' (
dt_Movimiento
‘‘) 6
.
‘‘6 7
Rows
‘‘7 ;
(
‘‘; <
$num
‘‘< =
)
‘‘= >
(
‘‘> ?
$str
‘‘? S
)
‘‘S T
.
‘‘T U
ToString
‘‘U ]
(
‘‘] ^
)
‘‘^ _
Dim
’’ 
v_anioEdicion
’’ 
As
’’  
String
’’! '
=
’’( )
dt_Movimiento
’’* 7
.
’’7 8
Rows
’’8 <
(
’’< =
$num
’’= >
)
’’> ?
(
’’? @
$str
’’@ M
)
’’M N
.
’’N O
ToString
’’O W
(
’’W X
)
’’X Y
Dim
◊◊ 
v_proveedor
◊◊ 
As
◊◊ 
String
◊◊ %
=
◊◊& '
dt_Movimiento
◊◊( 5
.
◊◊5 6
Rows
◊◊6 :
(
◊◊: ;
$num
◊◊; <
)
◊◊< =
(
◊◊= >
$str
◊◊> M
)
◊◊M N
.
◊◊N O
ToString
◊◊O W
(
◊◊W X
)
◊◊X Y
Dim
ÿÿ 
v_numPaginas
ÿÿ 
As
ÿÿ 
String
ÿÿ  &
=
ÿÿ' (
dt_Movimiento
ÿÿ) 6
.
ÿÿ6 7
Rows
ÿÿ7 ;
(
ÿÿ; <
$num
ÿÿ< =
)
ÿÿ= >
(
ÿÿ> ?
$str
ÿÿ? L
)
ÿÿL M
.
ÿÿM N
ToString
ÿÿN V
(
ÿÿV W
)
ÿÿW X
Dim
ŸŸ 
v_numEjemplares
ŸŸ 
As
ŸŸ  "
String
ŸŸ# )
=
ŸŸ* +
dt_Movimiento
ŸŸ, 9
.
ŸŸ9 :
Rows
ŸŸ: >
(
ŸŸ> ?
$num
ŸŸ? @
)
ŸŸ@ A
(
ŸŸA B
$str
ŸŸB S
)
ŸŸS T
.
ŸŸT U
ToString
ŸŸU ]
(
ŸŸ] ^
)
ŸŸ^ _
Dim
€€ 
	v_precioD
€€ 
As
€€ 
String
€€ #
=
€€$ %
dt_Movimiento
€€& 3
.
€€3 4
Rows
€€4 8
(
€€8 9
$num
€€9 :
)
€€: ;
(
€€; <
$str
€€< L
)
€€L M
.
€€M N
ToString
€€N V
(
€€V W
)
€€W X
Dim
‹‹ 
	v_precioS
‹‹ 
As
‹‹ 
String
‹‹ #
=
‹‹$ %
dt_Movimiento
‹‹& 3
.
‹‹3 4
Rows
‹‹4 8
(
‹‹8 9
$num
‹‹9 :
)
‹‹: ;
(
‹‹; <
$str
‹‹< L
)
‹‹L M
.
‹‹M N
ToString
‹‹N V
(
‹‹V W
)
‹‹W X
Dim
ﬁﬁ 
	v_Materia
ﬁﬁ 
As
ﬁﬁ 
String
ﬁﬁ #
=
ﬁﬁ$ %
dt_Movimiento
ﬁﬁ& 3
.
ﬁﬁ3 4
Rows
ﬁﬁ4 8
(
ﬁﬁ8 9
$num
ﬁﬁ9 :
)
ﬁﬁ: ;
(
ﬁﬁ; <
$str
ﬁﬁ< G
)
ﬁﬁG H
.
ﬁﬁH I
ToString
ﬁﬁI Q
(
ﬁﬁQ R
)
ﬁﬁR S
Dim
ﬂﬂ 
	v_Detalle
ﬂﬂ 
As
ﬂﬂ 
String
ﬂﬂ #
=
ﬂﬂ$ %
dt_Movimiento
ﬂﬂ& 3
.
ﬂﬂ3 4
Rows
ﬂﬂ4 8
(
ﬂﬂ8 9
$num
ﬂﬂ9 :
)
ﬂﬂ: ;
(
ﬂﬂ; <
$str
ﬂﬂ< M
)
ﬂﬂM N
.
ﬂﬂN O
ToString
ﬂﬂO W
(
ﬂﬂW X
)
ﬂﬂX Y
Dim
·· 
	v_numISBN
·· 
As
·· 
String
·· #
=
··$ %
dt_Movimiento
··& 3
.
··3 4
Rows
··4 8
(
··8 9
$num
··9 :
)
··: ;
(
··; <
$str
··< I
)
··I J
.
··J K
ToString
··K S
(
··S T
)
··T U
Dim
‚‚ 
v_MesAnioCompra
‚‚ 
As
‚‚  "
String
‚‚# )
=
‚‚* +
dt_Movimiento
‚‚, 9
.
‚‚9 :
Rows
‚‚: >
(
‚‚> ?
$num
‚‚? @
)
‚‚@ A
(
‚‚A B
$str
‚‚B \
)
‚‚\ ]
.
‚‚] ^
ToString
‚‚^ f
(
‚‚f g
)
‚‚g h
Dim
ÂÂ 
c_cModo
ÂÂ 
As
ÂÂ 
String
ÂÂ !
=
ÂÂ" #
dt_Movimiento
ÂÂ$ 1
.
ÂÂ1 2
Rows
ÂÂ2 6
(
ÂÂ6 7
$num
ÂÂ7 8
)
ÂÂ8 9
(
ÂÂ9 :
$str
ÂÂ: G
)
ÂÂG H
.
ÂÂH I
ToString
ÂÂI Q
(
ÂÂQ R
)
ÂÂR S
Dim
ÊÊ 
	c_cIdioma
ÊÊ 
As
ÊÊ 
String
ÊÊ #
=
ÊÊ$ %
dt_Movimiento
ÊÊ& 3
.
ÊÊ3 4
Rows
ÊÊ4 8
(
ÊÊ8 9
$num
ÊÊ9 :
)
ÊÊ: ;
(
ÊÊ; <
$str
ÊÊ< K
)
ÊÊK L
.
ÊÊL M
ToString
ÊÊM U
(
ÊÊU V
)
ÊÊV W
Dim
ÁÁ 
c_cCategoria
ÁÁ 
As
ÁÁ 
String
ÁÁ  &
=
ÁÁ' (
dt_Movimiento
ÁÁ) 6
.
ÁÁ6 7
Rows
ÁÁ7 ;
(
ÁÁ; <
$num
ÁÁ< =
)
ÁÁ= >
(
ÁÁ> ?
$str
ÁÁ? Q
)
ÁÁQ R
.
ÁÁR S
ToString
ÁÁS [
(
ÁÁ[ \
)
ÁÁ\ ]
Dim
ËË 
	c_cEstado
ËË 
As
ËË 
String
ËË #
=
ËË$ %
dt_Movimiento
ËË& 3
.
ËË3 4
Rows
ËË4 8
(
ËË8 9
$num
ËË9 :
)
ËË: ;
(
ËË; <
$str
ËË< K
)
ËËK L
.
ËËL M
ToString
ËËM U
(
ËËU V
)
ËËV W
Dim
ÈÈ 
c_cTipo
ÈÈ 
As
ÈÈ 
String
ÈÈ !
=
ÈÈ" #
dt_Movimiento
ÈÈ$ 1
.
ÈÈ1 2
Rows
ÈÈ2 6
(
ÈÈ6 7
$num
ÈÈ7 8
)
ÈÈ8 9
(
ÈÈ9 :
$str
ÈÈ: A
)
ÈÈA B
.
ÈÈB C
ToString
ÈÈC K
(
ÈÈK L
)
ÈÈL M
Dim
ÏÏ 
	Cd_Button
ÏÏ 
As
ÏÏ 
String
ÏÏ #
=
ÏÏ$ %
dt_Movimiento
ÏÏ& 3
.
ÏÏ3 4
Rows
ÏÏ4 8
(
ÏÏ8 9
$num
ÏÏ9 :
)
ÏÏ: ;
(
ÏÏ; <
$str
ÏÏ< G
)
ÏÏG H
.
ÏÏH I
ToString
ÏÏI Q
.
ÏÏQ R
Trim
ÏÏR V
txt_codRegistro
ÓÓ 
.
ÓÓ 
Text
ÓÓ  
=
ÓÓ! "

v_CodLibro
ÓÓ# -
.
ÓÓ- .
Trim
ÓÓ. 2
txt_codClasif
ÔÔ 
.
ÔÔ 
Text
ÔÔ 
=
ÔÔ   
v_codClasificacion
ÔÔ! 3
.
ÔÔ3 4
Trim
ÔÔ4 8
txt_TituloLibro
ÒÒ 
.
ÒÒ 
	InnerText
ÒÒ %
=
ÒÒ& '
v_TituloLibro
ÒÒ( 5
.
ÒÒ5 6
Trim
ÒÒ6 :
	txt_lugar
ÚÚ 
.
ÚÚ 
Text
ÚÚ 
=
ÚÚ 
v_lugar
ÚÚ $
.
ÚÚ$ %
Trim
ÚÚ% )
	txt_autor
ÛÛ 
.
ÛÛ 
Text
ÛÛ 
=
ÛÛ 
v_autor
ÛÛ $
.
ÛÛ$ %
Trim
ÛÛ% )
txt_Editorial
ıı 
.
ıı 
Text
ıı 
=
ıı  
v_Editorial
ıı! ,
.
ıı, -
Trim
ıı- 1
txt_numEdicion
ˆˆ 
.
ˆˆ 
Text
ˆˆ 
=
ˆˆ  !
v_numEdicion
ˆˆ" .
.
ˆˆ. /
Trim
ˆˆ/ 3
txt_anioEdic
˜˜ 
.
˜˜ 
Text
˜˜ 
=
˜˜ 
v_anioEdicion
˜˜  -
.
˜˜- .
Trim
˜˜. 2
txt_proveedor
˘˘ 
.
˘˘ 
	InnerText
˘˘ #
=
˘˘$ %
v_proveedor
˘˘& 1
.
˘˘1 2
Trim
˘˘2 6
txt_numPaginas
˙˙ 
.
˙˙ 
Text
˙˙ 
=
˙˙  !
v_numPaginas
˙˙" .
.
˙˙. /
Trim
˙˙/ 3
txt_numEjemplares
˚˚ 
.
˚˚ 
Text
˚˚ "
=
˚˚# $
v_numEjemplares
˚˚% 4
.
˚˚4 5
Trim
˚˚5 9$
txt_LibroprecioDolares
˝˝ "
.
˝˝" #
Text
˝˝# '
=
˝˝( )
	v_precioD
˝˝* 3
.
˝˝3 4
Trim
˝˝4 8"
txt_LibroPrecioSoles
˛˛  
.
˛˛  !
Text
˛˛! %
=
˛˛& '
	v_precioS
˛˛( 1
.
˛˛1 2
Trim
˛˛2 6
txt_materias
ÄÄ 
.
ÄÄ 
	InnerText
ÄÄ "
=
ÄÄ# $
	v_Materia
ÄÄ% .
.
ÄÄ. /
Trim
ÄÄ/ 3
txt_Detalles
ÅÅ 
.
ÅÅ 
	InnerText
ÅÅ "
=
ÅÅ# $
	v_Detalle
ÅÅ% .
.
ÅÅ. /
Trim
ÅÅ/ 3
txt_ISBN
ÉÉ 
.
ÉÉ 
Text
ÉÉ 
=
ÉÉ 
	v_numISBN
ÉÉ %
.
ÉÉ% &
Trim
ÉÉ& *$
txt_MesAnioCompraLibro
ÑÑ "
.
ÑÑ" #
Text
ÑÑ# '
=
ÑÑ( )
v_MesAnioCompra
ÑÑ* 9
.
ÑÑ9 :
Trim
ÑÑ: >
cboxLibro_Modo
ÜÜ 
.
ÜÜ 
SelectedIndex
ÜÜ (
=
ÜÜ) *
-
ÜÜ+ ,
$num
ÜÜ, -
If
áá 
IsDBNull
áá 
(
áá 
c_cModo
áá 
.
áá  
ToString
áá  (
)
áá( )
Or
áá* ,
c_cModo
áá- 4
.
áá4 5
ToString
áá5 =
=
áá> ?
$str
áá@ B
Then
ááC G
cboxLibro_Modo
àà 
.
àà 
Items
àà $
.
àà$ %
FindByValue
àà% 0
(
àà0 1
$str
àà1 5
)
àà5 6
.
àà6 7
Selected
àà7 ?
=
àà@ A
True
ààB F
ElseIf
ââ 
Trim
ââ 
(
ââ 
Left
ââ 
(
ââ 
c_cModo
ââ $
.
ââ$ %
ToString
ââ% -
,
ââ- .
$num
ââ/ 0
)
ââ0 1
)
ââ1 2
=
ââ3 4
$str
ââ5 9
Then
ââ: >
cboxLibro_Modo
ää 
.
ää 
Items
ää $
.
ää$ %
FindByValue
ää% 0
(
ää0 1
$str
ää1 5
)
ää5 6
.
ää6 7
Selected
ää7 ?
=
ää@ A
True
ääB F
ElseIf
ãã 
Trim
ãã 
(
ãã 
Left
ãã 
(
ãã 
c_cModo
ãã $
.
ãã$ %
ToString
ãã% -
,
ãã- .
$num
ãã/ 0
)
ãã0 1
)
ãã1 2
=
ãã3 4
$str
ãã5 9
Then
ãã: >
cboxLibro_Modo
åå 
.
åå 
Items
åå $
.
åå$ %
FindByValue
åå% 0
(
åå0 1
$str
åå1 5
)
åå5 6
.
åå6 7
Selected
åå7 ?
=
åå@ A
True
ååB F
End
çç 
If
çç !
cboxLibro_Categoria
èè 
.
èè  
SelectedIndex
èè  -
=
èè. /
-
èè0 1
$num
èè1 2
If
êê 
IsDBNull
êê 
(
êê 
c_cCategoria
êê $
.
êê$ %
ToString
êê% -
)
êê- .
Or
êê/ 1
c_cCategoria
êê2 >
.
êê> ?
ToString
êê? G
=
êêH I
$str
êêJ L
Then
êêM Q!
cboxLibro_Categoria
ëë #
.
ëë# $
Items
ëë$ )
.
ëë) *
FindByValue
ëë* 5
(
ëë5 6
$str
ëë6 :
)
ëë: ;
.
ëë; <
Selected
ëë< D
=
ëëE F
True
ëëG K
ElseIf
íí 
Trim
íí 
(
íí 
Left
íí 
(
íí 
c_cCategoria
íí )
.
íí) *
ToString
íí* 2
,
íí2 3
$num
íí4 5
)
íí5 6
)
íí6 7
=
íí8 9
$str
íí: >
Then
íí? C!
cboxLibro_Categoria
ìì #
.
ìì# $
Items
ìì$ )
.
ìì) *
FindByValue
ìì* 5
(
ìì5 6
$str
ìì6 :
)
ìì: ;
.
ìì; <
Selected
ìì< D
=
ììE F
True
ììG K
ElseIf
îî 
Trim
îî 
(
îî 
Left
îî 
(
îî 
c_cCategoria
îî )
.
îî) *
ToString
îî* 2
,
îî2 3
$num
îî4 5
)
îî5 6
)
îî6 7
=
îî8 9
$str
îî: >
Then
îî? C!
cboxLibro_Categoria
ïï #
.
ïï# $
Items
ïï$ )
.
ïï) *
FindByValue
ïï* 5
(
ïï5 6
$str
ïï6 :
)
ïï: ;
.
ïï; <
Selected
ïï< D
=
ïïE F
True
ïïG K
ElseIf
ññ 
Trim
ññ 
(
ññ 
Left
ññ 
(
ññ 
c_cCategoria
ññ )
.
ññ) *
ToString
ññ* 2
,
ññ2 3
$num
ññ4 5
)
ññ5 6
)
ññ6 7
=
ññ8 9
$str
ññ: >
Then
ññ? C!
cboxLibro_Categoria
óó #
.
óó# $
Items
óó$ )
.
óó) *
FindByValue
óó* 5
(
óó5 6
$str
óó6 :
)
óó: ;
.
óó; <
Selected
óó< D
=
óóE F
True
óóG K
ElseIf
òò 
Trim
òò 
(
òò 
Left
òò 
(
òò 
c_cCategoria
òò )
.
òò) *
ToString
òò* 2
,
òò2 3
$num
òò4 5
)
òò5 6
)
òò6 7
=
òò8 9
$str
òò: >
Then
òò? C!
cboxLibro_Categoria
ôô #
.
ôô# $
Items
ôô$ )
.
ôô) *
FindByValue
ôô* 5
(
ôô5 6
$str
ôô6 :
)
ôô: ;
.
ôô; <
Selected
ôô< D
=
ôôE F
True
ôôG K
ElseIf
öö 
Trim
öö 
(
öö 
Left
öö 
(
öö 
c_cCategoria
öö )
.
öö) *
ToString
öö* 2
,
öö2 3
$num
öö4 5
)
öö5 6
)
öö6 7
=
öö8 9
$str
öö: >
Then
öö? C!
cboxLibro_Categoria
õõ #
.
õõ# $
Items
õõ$ )
.
õõ) *
FindByValue
õõ* 5
(
õõ5 6
$str
õõ6 :
)
õõ: ;
.
õõ; <
Selected
õõ< D
=
õõE F
True
õõG K
ElseIf
úú 
Trim
úú 
(
úú 
Left
úú 
(
úú 
c_cCategoria
úú )
.
úú) *
ToString
úú* 2
,
úú2 3
$num
úú4 5
)
úú5 6
)
úú6 7
=
úú8 9
$str
úú: >
Then
úú? C!
cboxLibro_Categoria
ùù #
.
ùù# $
Items
ùù$ )
.
ùù) *
FindByValue
ùù* 5
(
ùù5 6
$str
ùù6 :
)
ùù: ;
.
ùù; <
Selected
ùù< D
=
ùùE F
True
ùùG K
ElseIf
ûû 
Trim
ûû 
(
ûû 
Left
ûû 
(
ûû 
c_cCategoria
ûû )
.
ûû) *
ToString
ûû* 2
,
ûû2 3
$num
ûû4 5
)
ûû5 6
)
ûû6 7
=
ûû8 9
$str
ûû: >
Then
ûû? C!
cboxLibro_Categoria
üü #
.
üü# $
Items
üü$ )
.
üü) *
FindByValue
üü* 5
(
üü5 6
$str
üü6 :
)
üü: ;
.
üü; <
Selected
üü< D
=
üüE F
True
üüG K
ElseIf
†† 
Trim
†† 
(
†† 
Left
†† 
(
†† 
c_cCategoria
†† )
.
††) *
ToString
††* 2
,
††2 3
$num
††4 5
)
††5 6
)
††6 7
=
††8 9
$str
††: >
Then
††? C!
cboxLibro_Categoria
°° #
.
°°# $
Items
°°$ )
.
°°) *
FindByValue
°°* 5
(
°°5 6
$str
°°6 :
)
°°: ;
.
°°; <
Selected
°°< D
=
°°E F
True
°°G K
ElseIf
¢¢ 
Trim
¢¢ 
(
¢¢ 
Left
¢¢ 
(
¢¢ 
c_cCategoria
¢¢ )
.
¢¢) *
ToString
¢¢* 2
,
¢¢2 3
$num
¢¢4 5
)
¢¢5 6
)
¢¢6 7
=
¢¢8 9
$str
¢¢: >
Then
¢¢? C!
cboxLibro_Categoria
££ #
.
££# $
Items
££$ )
.
££) *
FindByValue
££* 5
(
££5 6
$str
££6 :
)
££: ;
.
££; <
Selected
££< D
=
££E F
True
££G K
ElseIf
§§ 
Trim
§§ 
(
§§ 
Left
§§ 
(
§§ 
c_cCategoria
§§ )
.
§§) *
ToString
§§* 2
,
§§2 3
$num
§§4 5
)
§§5 6
)
§§6 7
=
§§8 9
$str
§§: >
Then
§§? C!
cboxLibro_Categoria
•• #
.
••# $
Items
••$ )
.
••) *
FindByValue
••* 5
(
••5 6
$str
••6 :
)
••: ;
.
••; <
Selected
••< D
=
••E F
True
••G K
ElseIf
¶¶ 
Trim
¶¶ 
(
¶¶ 
Left
¶¶ 
(
¶¶ 
c_cCategoria
¶¶ )
.
¶¶) *
ToString
¶¶* 2
,
¶¶2 3
$num
¶¶4 5
)
¶¶5 6
)
¶¶6 7
=
¶¶8 9
$str
¶¶: >
Then
¶¶? C!
cboxLibro_Categoria
ßß #
.
ßß# $
Items
ßß$ )
.
ßß) *
FindByValue
ßß* 5
(
ßß5 6
$str
ßß6 :
)
ßß: ;
.
ßß; <
Selected
ßß< D
=
ßßE F
True
ßßG K
ElseIf
®® 
Trim
®® 
(
®® 
Left
®® 
(
®® 
c_cCategoria
®® )
.
®®) *
ToString
®®* 2
,
®®2 3
$num
®®4 5
)
®®5 6
)
®®6 7
=
®®8 9
$str
®®: >
Then
®®? C!
cboxLibro_Categoria
©© #
.
©©# $
Items
©©$ )
.
©©) *
FindByValue
©©* 5
(
©©5 6
$str
©©6 :
)
©©: ;
.
©©; <
Selected
©©< D
=
©©E F
True
©©G K
End
™™ 
If
™™ 
cboxTipo
¨¨ 
.
¨¨ 
SelectedIndex
¨¨ "
=
¨¨# $
-
¨¨% &
$num
¨¨& '
If
≠≠ 
IsDBNull
≠≠ 
(
≠≠ 
c_cTipo
≠≠ 
.
≠≠  
ToString
≠≠  (
)
≠≠( )
=
≠≠* +
True
≠≠, 0
Or
≠≠1 3
Len
≠≠4 7
(
≠≠7 8
Trim
≠≠8 <
(
≠≠< =
c_cTipo
≠≠= D
.
≠≠D E
ToString
≠≠E M
)
≠≠M N
)
≠≠N O
=
≠≠P Q
$num
≠≠R S
Then
≠≠T X
cboxTipo
ÆÆ 
.
ÆÆ 
Items
ÆÆ 
.
ÆÆ 
FindByValue
ÆÆ *
(
ÆÆ* +
$str
ÆÆ+ /
)
ÆÆ/ 0
.
ÆÆ0 1
Selected
ÆÆ1 9
=
ÆÆ: ;
True
ÆÆ< @
ElseIf
ØØ 
Trim
ØØ 
(
ØØ 
Left
ØØ 
(
ØØ 
c_cTipo
ØØ $
.
ØØ$ %
ToString
ØØ% -
,
ØØ- .
$num
ØØ/ 0
)
ØØ0 1
)
ØØ1 2
=
ØØ3 4
$str
ØØ5 9
Then
ØØ: >
cboxTipo
∞∞ 
.
∞∞ 
Items
∞∞ 
.
∞∞ 
FindByValue
∞∞ *
(
∞∞* +
$str
∞∞+ /
)
∞∞/ 0
.
∞∞0 1
Selected
∞∞1 9
=
∞∞: ;
True
∞∞< @
ElseIf
±± 
Trim
±± 
(
±± 
Left
±± 
(
±± 
c_cTipo
±± $
.
±±$ %
ToString
±±% -
,
±±- .
$num
±±/ 0
)
±±0 1
)
±±1 2
=
±±3 4
$str
±±5 9
Then
±±: >
cboxTipo
≤≤ 
.
≤≤ 
Items
≤≤ 
.
≤≤ 
FindByValue
≤≤ *
(
≤≤* +
$str
≤≤+ /
)
≤≤/ 0
.
≤≤0 1
Selected
≤≤1 9
=
≤≤: ;
True
≤≤< @
ElseIf
≥≥ 
Trim
≥≥ 
(
≥≥ 
Left
≥≥ 
(
≥≥ 
c_cTipo
≥≥ $
.
≥≥$ %
ToString
≥≥% -
,
≥≥- .
$num
≥≥/ 0
)
≥≥0 1
)
≥≥1 2
=
≥≥3 4
$str
≥≥5 9
Then
≥≥: >
cboxTipo
¥¥ 
.
¥¥ 
Items
¥¥ 
.
¥¥ 
FindByValue
¥¥ *
(
¥¥* +
$str
¥¥+ /
)
¥¥/ 0
.
¥¥0 1
Selected
¥¥1 9
=
¥¥: ;
True
¥¥< @
ElseIf
µµ 
Trim
µµ 
(
µµ 
Left
µµ 
(
µµ 
c_cTipo
µµ $
.
µµ$ %
ToString
µµ% -
,
µµ- .
$num
µµ/ 0
)
µµ0 1
)
µµ1 2
=
µµ3 4
$str
µµ5 9
Then
µµ: >
cboxTipo
∂∂ 
.
∂∂ 
Items
∂∂ 
.
∂∂ 
FindByValue
∂∂ *
(
∂∂* +
$str
∂∂+ /
)
∂∂/ 0
.
∂∂0 1
Selected
∂∂1 9
=
∂∂: ;
True
∂∂< @
End
∑∑ 
If
∑∑ 
cboxLibro_Estado
ππ 
.
ππ 
SelectedIndex
ππ *
=
ππ+ ,
-
ππ- .
$num
ππ. /
If
∫∫ 
IsDBNull
∫∫ 
(
∫∫ 
	c_cEstado
∫∫ !
.
∫∫! "
ToString
∫∫" *
)
∫∫* +
=
∫∫, -
True
∫∫. 2
Or
∫∫3 5
Len
∫∫6 9
(
∫∫9 :
Trim
∫∫: >
(
∫∫> ?
	c_cEstado
∫∫? H
.
∫∫H I
ToString
∫∫I Q
)
∫∫Q R
)
∫∫R S
=
∫∫T U
$num
∫∫V W
Then
∫∫X \
cboxLibro_Estado
ªª  
.
ªª  !
Items
ªª! &
.
ªª& '
FindByValue
ªª' 2
(
ªª2 3
$str
ªª3 6
)
ªª6 7
.
ªª7 8
Selected
ªª8 @
=
ªªA B
True
ªªC G
ElseIf
ºº 
Trim
ºº 
(
ºº 
Left
ºº 
(
ºº 
	c_cEstado
ºº &
.
ºº& '
ToString
ºº' /
,
ºº/ 0
$num
ºº1 2
)
ºº2 3
)
ºº3 4
=
ºº5 6
$str
ºº7 :
Then
ºº; ?
cboxLibro_Estado
ΩΩ  
.
ΩΩ  !
Items
ΩΩ! &
.
ΩΩ& '
FindByValue
ΩΩ' 2
(
ΩΩ2 3
$str
ΩΩ3 6
)
ΩΩ6 7
.
ΩΩ7 8
Selected
ΩΩ8 @
=
ΩΩA B
True
ΩΩC G
ElseIf
ææ 
Trim
ææ 
(
ææ 
Left
ææ 
(
ææ 
	c_cEstado
ææ &
.
ææ& '
ToString
ææ' /
,
ææ/ 0
$num
ææ1 2
)
ææ2 3
)
ææ3 4
=
ææ5 6
$str
ææ7 :
Then
ææ; ?
cboxLibro_Estado
øø  
.
øø  !
Items
øø! &
.
øø& '
FindByValue
øø' 2
(
øø2 3
$str
øø3 6
)
øø6 7
.
øø7 8
Selected
øø8 @
=
øøA B
True
øøC G
ElseIf
¿¿ 
Trim
¿¿ 
(
¿¿ 
Left
¿¿ 
(
¿¿ 
	c_cEstado
¿¿ &
.
¿¿& '
ToString
¿¿' /
,
¿¿/ 0
$num
¿¿1 2
)
¿¿2 3
)
¿¿3 4
=
¿¿5 6
$str
¿¿7 :
Then
¿¿; ?
cboxLibro_Estado
¡¡  
.
¡¡  !
Items
¡¡! &
.
¡¡& '
FindByValue
¡¡' 2
(
¡¡2 3
$str
¡¡3 6
)
¡¡6 7
.
¡¡7 8
Selected
¡¡8 @
=
¡¡A B
True
¡¡C G
ElseIf
¬¬ 
Trim
¬¬ 
(
¬¬ 
Left
¬¬ 
(
¬¬ 
	c_cEstado
¬¬ &
.
¬¬& '
ToString
¬¬' /
,
¬¬/ 0
$num
¬¬1 2
)
¬¬2 3
)
¬¬3 4
=
¬¬5 6
$str
¬¬7 :
Then
¬¬; ?
cboxLibro_Estado
√√  
.
√√  !
Items
√√! &
.
√√& '
FindByValue
√√' 2
(
√√2 3
$str
√√3 6
)
√√6 7
.
√√7 8
Selected
√√8 @
=
√√A B
True
√√C G
ElseIf
ƒƒ 
Trim
ƒƒ 
(
ƒƒ 
Left
ƒƒ 
(
ƒƒ 
	c_cEstado
ƒƒ &
.
ƒƒ& '
ToString
ƒƒ' /
,
ƒƒ/ 0
$num
ƒƒ1 2
)
ƒƒ2 3
)
ƒƒ3 4
=
ƒƒ5 6
$str
ƒƒ7 :
Then
ƒƒ; ?
cboxLibro_Estado
≈≈  
.
≈≈  !
Items
≈≈! &
.
≈≈& '
FindByValue
≈≈' 2
(
≈≈2 3
$str
≈≈3 6
)
≈≈6 7
.
≈≈7 8
Selected
≈≈8 @
=
≈≈A B
True
≈≈C G
ElseIf
∆∆ 
Trim
∆∆ 
(
∆∆ 
Left
∆∆ 
(
∆∆ 
	c_cEstado
∆∆ &
.
∆∆& '
ToString
∆∆' /
,
∆∆/ 0
$num
∆∆1 2
)
∆∆2 3
)
∆∆3 4
=
∆∆5 6
$str
∆∆7 :
Then
∆∆; ?
cboxLibro_Estado
««  
.
««  !
Items
««! &
.
««& '
FindByValue
««' 2
(
««2 3
$str
««3 6
)
««6 7
.
««7 8
Selected
««8 @
=
««A B
True
««C G
End
»» 
If
»» 
cboxLibro_Idioma
   
.
   
SelectedIndex
   *
=
  + ,
-
  - .
$num
  . /
If
ÀÀ 
IsDBNull
ÀÀ 
(
ÀÀ 
	c_cIdioma
ÀÀ !
.
ÀÀ! "
ToString
ÀÀ" *
)
ÀÀ* +
Or
ÀÀ, .
Len
ÀÀ/ 2
(
ÀÀ2 3
Trim
ÀÀ3 7
(
ÀÀ7 8
	c_cIdioma
ÀÀ8 A
.
ÀÀA B
ToString
ÀÀB J
)
ÀÀJ K
)
ÀÀK L
=
ÀÀM N
$num
ÀÀO P
Then
ÀÀQ U
cboxLibro_Idioma
ÃÃ  
.
ÃÃ  !
Items
ÃÃ! &
.
ÃÃ& '
FindByValue
ÃÃ' 2
(
ÃÃ2 3
$str
ÃÃ3 ;
)
ÃÃ; <
.
ÃÃ< =
Selected
ÃÃ= E
=
ÃÃF G
True
ÃÃH L
Else
ÕÕ 
cboxLibro_Idioma
ŒŒ  
.
ŒŒ  !
Items
ŒŒ! &
.
ŒŒ& '
FindByValue
ŒŒ' 2
(
ŒŒ2 3
Trim
ŒŒ3 7
(
ŒŒ7 8
	c_cIdioma
ŒŒ8 A
.
ŒŒA B
ToString
ŒŒB J
)
ŒŒJ K
)
ŒŒK L
.
ŒŒL M
Selected
ŒŒM U
=
ŒŒV W
True
ŒŒX \
End
œœ 
If
œœ 
If
—— 
	Cd_Button
—— 
=
—— 
$str
—— 
Then
——  $
ckhLibro_CD
““ 
.
““ 
Checked
““ #
=
““$ %
False
““& +
ElseIf
‘‘ 
	Cd_Button
‘‘ 
=
‘‘ 
$str
‘‘ #
Then
‘‘$ (
ckhLibro_CD
’’ 
.
’’ 
Checked
’’ #
=
’’$ %
True
’’& *
End
÷÷ 
If
÷÷ 
ElseIf
ÿÿ 
	tipoLista
ÿÿ 
=
ÿÿ 
$str
ÿÿ 1
Then
ÿÿ2 6
dt_Movimiento
⁄⁄ 
=
⁄⁄ 
CapaNegocio
⁄⁄ '
.
⁄⁄' (
cls_Metodos
⁄⁄( 3
.
⁄⁄3 4%
ListarFormLibroGridView
⁄⁄4 K
(
⁄⁄K L
	tipoLista
⁄⁄L U
,
⁄⁄U V
v_CodRegistro
⁄⁄W d
)
⁄⁄d e
.
⁄⁄e f
Tables
⁄⁄f l
(
⁄⁄l m
$num
⁄⁄m n
)
⁄⁄n o
Dim
‹‹ 
c_cFechaRegistro
‹‹  
As
‹‹! #
String
‹‹$ *
If
›› 
Not
›› 
IsDBNull
›› 
(
›› 
dt_Movimiento
›› )
.
››) *
Rows
››* .
(
››. /
$num
››/ 0
)
››0 1
(
››1 2
$str
››2 C
)
››C D
)
››D E
Then
››F J
c_cFechaRegistro
ﬁﬁ  
=
ﬁﬁ! "
dt_Movimiento
ﬁﬁ# 0
.
ﬁﬁ0 1
Rows
ﬁﬁ1 5
(
ﬁﬁ5 6
$num
ﬁﬁ6 7
)
ﬁﬁ7 8
(
ﬁﬁ8 9
$str
ﬁﬁ9 J
)
ﬁﬁJ K
.
ﬁﬁK L
ToString
ﬁﬁL T
Else
ﬂﬂ 
c_cFechaRegistro
‡‡  
=
‡‡! "
$str
‡‡# -
End
·· 
If
·· 
Dim
‰‰ 
c_cHoraRegistro
‰‰ 
As
‰‰  "
String
‰‰# )
=
‰‰* +
dt_Movimiento
‰‰, 9
.
‰‰9 :
Rows
‰‰: >
(
‰‰> ?
$num
‰‰? @
)
‰‰@ A
(
‰‰A B
$str
‰‰B R
)
‰‰R S
.
‰‰S T
ToString
‰‰T \
(
‰‰\ ]
)
‰‰] ^
Dim
ÂÂ 
	c_cTitulo
ÂÂ 
As
ÂÂ 
String
ÂÂ #
=
ÂÂ$ %
dt_Movimiento
ÂÂ& 3
.
ÂÂ3 4
Rows
ÂÂ4 8
(
ÂÂ8 9
$num
ÂÂ9 :
)
ÂÂ: ;
(
ÂÂ; <
$str
ÂÂ< K
)
ÂÂK L
.
ÂÂL M
ToString
ÂÂM U
(
ÂÂU V
)
ÂÂV W
Dim
ÊÊ 
c_cCodRegistro
ÊÊ 
As
ÊÊ !
String
ÊÊ" (
=
ÊÊ) *
dt_Movimiento
ÊÊ+ 8
.
ÊÊ8 9
Rows
ÊÊ9 =
(
ÊÊ= >
$num
ÊÊ> ?
)
ÊÊ? @
(
ÊÊ@ A
$str
ÊÊA U
)
ÊÊU V
.
ÊÊV W
ToString
ÊÊW _
(
ÊÊ_ `
)
ÊÊ` a
Dim
ÁÁ 
c_cAutor
ÁÁ 
As
ÁÁ 
String
ÁÁ "
=
ÁÁ# $
dt_Movimiento
ÁÁ% 2
.
ÁÁ2 3
Rows
ÁÁ3 7
(
ÁÁ7 8
$num
ÁÁ8 9
)
ÁÁ9 :
(
ÁÁ: ;
$str
ÁÁ; I
)
ÁÁI J
.
ÁÁJ K
ToString
ÁÁK S
(
ÁÁS T
)
ÁÁT U
Dim
ËË !
c_cCodClasificacion
ËË #
As
ËË$ &
String
ËË' -
=
ËË. /
dt_Movimiento
ËË0 =
.
ËË= >
Rows
ËË> B
(
ËËB C
$num
ËËC D
)
ËËD E
(
ËËE F
$str
ËËF _
)
ËË_ `
.
ËË` a
ToString
ËËa i
(
ËËi j
)
ËËj k
Dim
ÈÈ 

c_cUsuario
ÈÈ 
As
ÈÈ 
String
ÈÈ $
=
ÈÈ% &
dt_Movimiento
ÈÈ' 4
.
ÈÈ4 5
Rows
ÈÈ5 9
(
ÈÈ9 :
$num
ÈÈ: ;
)
ÈÈ; <
(
ÈÈ< =
$str
ÈÈ= L
)
ÈÈL M
.
ÈÈM N
ToString
ÈÈN V
(
ÈÈV W
)
ÈÈW X
Dim
ÍÍ 

c_cLibroCD
ÍÍ 
As
ÍÍ 
String
ÍÍ $
=
ÍÍ% &
dt_Movimiento
ÍÍ' 4
.
ÍÍ4 5
Rows
ÍÍ5 9
(
ÍÍ9 :
$num
ÍÍ: ;
)
ÍÍ; <
(
ÍÍ< =
$str
ÍÍ= H
)
ÍÍH I
.
ÍÍI J
ToString
ÍÍJ R
(
ÍÍR S
)
ÍÍS T
Dim
ÎÎ 
c_cMesA√±oCompra
ÎÎ 
As
ÎÎ  "
String
ÎÎ# )
=
ÎÎ* +
dt_Movimiento
ÎÎ, 9
.
ÎÎ9 :
Rows
ÎÎ: >
(
ÎÎ> ?
$num
ÎÎ? @
)
ÎÎ@ A
(
ÎÎA B
$str
ÎÎB \
)
ÎÎ\ ]
.
ÎÎ] ^
ToString
ÎÎ^ f
(
ÎÎf g
)
ÎÎg h
Dim
ÏÏ 
c_cLugarLibro
ÏÏ 
As
ÏÏ  
String
ÏÏ! '
=
ÏÏ( )
dt_Movimiento
ÏÏ* 7
.
ÏÏ7 8
Rows
ÏÏ8 <
(
ÏÏ< =
$num
ÏÏ= >
)
ÏÏ> ?
(
ÏÏ? @
$str
ÏÏ@ N
)
ÏÏN O
.
ÏÏO P
ToString
ÏÏP X
(
ÏÏX Y
)
ÏÏY Z
Dim
ÌÌ 
c_cNumEdicion
ÌÌ 
As
ÌÌ  
String
ÌÌ! '
=
ÌÌ( )
dt_Movimiento
ÌÌ* 7
.
ÌÌ7 8
Rows
ÌÌ8 <
(
ÌÌ< =
$num
ÌÌ= >
)
ÌÌ> ?
(
ÌÌ? @
$str
ÌÌ@ T
)
ÌÌT U
.
ÌÌU V
ToString
ÌÌV ^
(
ÌÌ^ _
)
ÌÌ_ `
Dim
ÓÓ 
c_cEditorial
ÓÓ 
As
ÓÓ 
String
ÓÓ  &
=
ÓÓ' (
dt_Movimiento
ÓÓ) 6
.
ÓÓ6 7
Rows
ÓÓ7 ;
(
ÓÓ; <
$num
ÓÓ< =
)
ÓÓ= >
(
ÓÓ> ?
$str
ÓÓ? O
)
ÓÓO P
.
ÓÓP Q
ToString
ÓÓQ Y
(
ÓÓY Z
)
ÓÓZ [
Dim
 
c_cAnioEdicion
 
As
 !
String
" (
=
) *
dt_Movimiento
+ 8
.
8 9
Rows
9 =
(
= >
$num
> ?
)
? @
(
@ A
$str
A N
)
N O
.
O P
ToString
P X
(
X Y
)
Y Z
Dim
ÒÒ 
c_cproveedor
ÒÒ 
As
ÒÒ 
String
ÒÒ  &
=
ÒÒ' (
dt_Movimiento
ÒÒ) 6
.
ÒÒ6 7
Rows
ÒÒ7 ;
(
ÒÒ; <
$num
ÒÒ< =
)
ÒÒ= >
(
ÒÒ> ?
$str
ÒÒ? N
)
ÒÒN O
.
ÒÒO P
ToString
ÒÒP X
(
ÒÒX Y
)
ÒÒY Z
Dim
ÚÚ 
c_cNumPaginas
ÚÚ 
As
ÚÚ  
String
ÚÚ! '
=
ÚÚ( )
dt_Movimiento
ÚÚ* 7
.
ÚÚ7 8
Rows
ÚÚ8 <
(
ÚÚ< =
$num
ÚÚ= >
)
ÚÚ> ?
(
ÚÚ? @
$str
ÚÚ@ M
)
ÚÚM N
.
ÚÚN O
ToString
ÚÚO W
(
ÚÚW X
)
ÚÚX Y
Dim
ÛÛ 
c_cNumEjemplares
ÛÛ  
As
ÛÛ! #
String
ÛÛ$ *
=
ÛÛ+ ,
dt_Movimiento
ÛÛ- :
.
ÛÛ: ;
Rows
ÛÛ; ?
(
ÛÛ? @
$num
ÛÛ@ A
)
ÛÛA B
(
ÛÛB C
$str
ÛÛC T
)
ÛÛT U
.
ÛÛU V
ToString
ÛÛV ^
(
ÛÛ^ _
)
ÛÛ_ `
Dim
ÙÙ #
c_cLibroPrecioDolares
ÙÙ %
As
ÙÙ& (
String
ÙÙ) /
=
ÙÙ0 1
dt_Movimiento
ÙÙ2 ?
.
ÙÙ? @
Rows
ÙÙ@ D
(
ÙÙD E
$num
ÙÙE F
)
ÙÙF G
(
ÙÙG H
$str
ÙÙH X
)
ÙÙX Y
.
ÙÙY Z
ToString
ÙÙZ b
(
ÙÙb c
)
ÙÙc d
Dim
ıı !
c_cLibroPrecioSoles
ıı #
As
ıı$ &
String
ıı' -
=
ıı. /
dt_Movimiento
ıı0 =
.
ıı= >
Rows
ıı> B
(
ııB C
$num
ııC D
)
ııD E
(
ııE F
$str
ııF V
)
ııV W
.
ııW X
ToString
ııX `
(
ıı` a
)
ııa b
Dim
ˆˆ 
c_cLibroISBN
ˆˆ 
As
ˆˆ 
String
ˆˆ  &
=
ˆˆ' (
dt_Movimiento
ˆˆ) 6
.
ˆˆ6 7
Rows
ˆˆ7 ;
(
ˆˆ; <
$num
ˆˆ< =
)
ˆˆ= >
(
ˆˆ> ?
$str
ˆˆ? L
)
ˆˆL M
.
ˆˆM N
ToString
ˆˆN V
(
ˆˆV W
)
ˆˆW X
Dim
˘˘ 
c_cMaterias
˘˘ 
As
˘˘ 
String
˘˘ %
=
˘˘& '
dt_Movimiento
˘˘( 5
.
˘˘5 6
Rows
˘˘6 :
(
˘˘: ;
$num
˘˘; <
)
˘˘< =
(
˘˘= >
$str
˘˘> I
)
˘˘I J
.
˘˘J K
ToString
˘˘K S
(
˘˘S T
)
˘˘T U
Dim
˙˙ 
c_cDetalles
˙˙ 
As
˙˙ 
String
˙˙ %
=
˙˙& '
dt_Movimiento
˙˙( 5
.
˙˙5 6
Rows
˙˙6 :
(
˙˙: ;
$num
˙˙; <
)
˙˙< =
(
˙˙= >
$str
˙˙> O
)
˙˙O P
.
˙˙P Q
ToString
˙˙Q Y
(
˙˙Y Z
)
˙˙Z [
Dim
˝˝ 
c_cModo
˝˝ 
As
˝˝ 
String
˝˝ !
=
˝˝" #
dt_Movimiento
˝˝$ 1
.
˝˝1 2
Rows
˝˝2 6
(
˝˝6 7
$num
˝˝7 8
)
˝˝8 9
(
˝˝9 :
$str
˝˝: G
)
˝˝G H
.
˝˝H I
ToString
˝˝I Q
(
˝˝Q R
)
˝˝R S
Dim
˛˛ 
	c_cIdioma
˛˛ 
As
˛˛ 
String
˛˛ #
=
˛˛$ %
dt_Movimiento
˛˛& 3
.
˛˛3 4
Rows
˛˛4 8
(
˛˛8 9
$num
˛˛9 :
)
˛˛: ;
(
˛˛; <
$str
˛˛< K
)
˛˛K L
.
˛˛L M
ToString
˛˛M U
(
˛˛U V
)
˛˛V W
Dim
ˇˇ 
c_cCategoria
ˇˇ 
As
ˇˇ 
String
ˇˇ  &
=
ˇˇ' (
dt_Movimiento
ˇˇ) 6
.
ˇˇ6 7
Rows
ˇˇ7 ;
(
ˇˇ; <
$num
ˇˇ< =
)
ˇˇ= >
(
ˇˇ> ?
$str
ˇˇ? Q
)
ˇˇQ R
.
ˇˇR S
ToString
ˇˇS [
(
ˇˇ[ \
)
ˇˇ\ ]
Dim
ÄÄ 
	c_cEstado
ÄÄ 
As
ÄÄ 
String
ÄÄ #
=
ÄÄ$ %
dt_Movimiento
ÄÄ& 3
.
ÄÄ3 4
Rows
ÄÄ4 8
(
ÄÄ8 9
$num
ÄÄ9 :
)
ÄÄ: ;
(
ÄÄ; <
$str
ÄÄ< K
)
ÄÄK L
.
ÄÄL M
ToString
ÄÄM U
(
ÄÄU V
)
ÄÄV W
Dim
ÅÅ 
c_cTipo
ÅÅ 
As
ÅÅ 
String
ÅÅ !
=
ÅÅ" #
dt_Movimiento
ÅÅ$ 1
.
ÅÅ1 2
Rows
ÅÅ2 6
(
ÅÅ6 7
$num
ÅÅ7 8
)
ÅÅ8 9
(
ÅÅ9 :
$str
ÅÅ: A
)
ÅÅA B
.
ÅÅB C
ToString
ÅÅC K
(
ÅÅK L
)
ÅÅL M
Dim
ÑÑ 
	Cd_Button
ÑÑ 
As
ÑÑ 
String
ÑÑ #
=
ÑÑ$ %
dt_Movimiento
ÑÑ& 3
.
ÑÑ3 4
Rows
ÑÑ4 8
(
ÑÑ8 9
$num
ÑÑ9 :
)
ÑÑ: ;
(
ÑÑ; <
$str
ÑÑ< G
)
ÑÑG H
.
ÑÑH I
ToString
ÑÑI Q
.
ÑÑQ R
Trim
ÑÑR V
cboxLibro_Modo
ÜÜ 
.
ÜÜ 
SelectedIndex
ÜÜ (
=
ÜÜ) *
-
ÜÜ+ ,
$num
ÜÜ, -
If
áá 
IsDBNull
áá 
(
áá 
c_cModo
áá 
.
áá  
ToString
áá  (
)
áá( )
Or
áá* ,
c_cModo
áá- 4
.
áá4 5
ToString
áá5 =
=
áá> ?
$str
áá@ B
Then
ááC G
cboxLibro_Modo
àà 
.
àà 
Items
àà $
.
àà$ %
FindByValue
àà% 0
(
àà0 1
$str
àà1 5
)
àà5 6
.
àà6 7
Selected
àà7 ?
=
àà@ A
True
ààB F
ElseIf
ââ 
Trim
ââ 
(
ââ 
Left
ââ 
(
ââ 
c_cModo
ââ $
.
ââ$ %
ToString
ââ% -
,
ââ- .
$num
ââ/ 0
)
ââ0 1
)
ââ1 2
=
ââ3 4
$str
ââ5 9
Then
ââ: >
cboxLibro_Modo
ää 
.
ää 
Items
ää $
.
ää$ %
FindByValue
ää% 0
(
ää0 1
$str
ää1 5
)
ää5 6
.
ää6 7
Selected
ää7 ?
=
ää@ A
True
ääB F
ElseIf
ãã 
Trim
ãã 
(
ãã 
Left
ãã 
(
ãã 
c_cModo
ãã $
.
ãã$ %
ToString
ãã% -
,
ãã- .
$num
ãã/ 0
)
ãã0 1
)
ãã1 2
=
ãã3 4
$str
ãã5 9
Then
ãã: >
cboxLibro_Modo
åå 
.
åå 
Items
åå $
.
åå$ %
FindByValue
åå% 0
(
åå0 1
$str
åå1 5
)
åå5 6
.
åå6 7
Selected
åå7 ?
=
åå@ A
True
ååB F
End
çç 
If
çç !
cboxLibro_Categoria
èè 
.
èè  
SelectedIndex
èè  -
=
èè. /
-
èè0 1
$num
èè1 2
If
êê 
IsDBNull
êê 
(
êê 
c_cCategoria
êê $
.
êê$ %
ToString
êê% -
)
êê- .
Or
êê/ 1
c_cCategoria
êê2 >
.
êê> ?
ToString
êê? G
=
êêH I
$str
êêJ L
Then
êêM Q!
cboxLibro_Categoria
ëë #
.
ëë# $
Items
ëë$ )
.
ëë) *
FindByValue
ëë* 5
(
ëë5 6
$str
ëë6 :
)
ëë: ;
.
ëë; <
Selected
ëë< D
=
ëëE F
True
ëëG K
ElseIf
íí 
Trim
íí 
(
íí 
Left
íí 
(
íí 
c_cCategoria
íí )
.
íí) *
ToString
íí* 2
,
íí2 3
$num
íí4 5
)
íí5 6
)
íí6 7
=
íí8 9
$str
íí: >
Then
íí? C!
cboxLibro_Categoria
ìì #
.
ìì# $
Items
ìì$ )
.
ìì) *
FindByValue
ìì* 5
(
ìì5 6
$str
ìì6 :
)
ìì: ;
.
ìì; <
Selected
ìì< D
=
ììE F
True
ììG K
ElseIf
îî 
Trim
îî 
(
îî 
Left
îî 
(
îî 
c_cCategoria
îî )
.
îî) *
ToString
îî* 2
,
îî2 3
$num
îî4 5
)
îî5 6
)
îî6 7
=
îî8 9
$str
îî: >
Then
îî? C!
cboxLibro_Categoria
ïï #
.
ïï# $
Items
ïï$ )
.
ïï) *
FindByValue
ïï* 5
(
ïï5 6
$str
ïï6 :
)
ïï: ;
.
ïï; <
Selected
ïï< D
=
ïïE F
True
ïïG K
ElseIf
ññ 
Trim
ññ 
(
ññ 
Left
ññ 
(
ññ 
c_cCategoria
ññ )
.
ññ) *
ToString
ññ* 2
,
ññ2 3
$num
ññ4 5
)
ññ5 6
)
ññ6 7
=
ññ8 9
$str
ññ: >
Then
ññ? C!
cboxLibro_Categoria
óó #
.
óó# $
Items
óó$ )
.
óó) *
FindByValue
óó* 5
(
óó5 6
$str
óó6 :
)
óó: ;
.
óó; <
Selected
óó< D
=
óóE F
True
óóG K
ElseIf
òò 
Trim
òò 
(
òò 
Left
òò 
(
òò 
c_cCategoria
òò )
.
òò) *
ToString
òò* 2
,
òò2 3
$num
òò4 5
)
òò5 6
)
òò6 7
=
òò8 9
$str
òò: >
Then
òò? C!
cboxLibro_Categoria
ôô #
.
ôô# $
Items
ôô$ )
.
ôô) *
FindByValue
ôô* 5
(
ôô5 6
$str
ôô6 :
)
ôô: ;
.
ôô; <
Selected
ôô< D
=
ôôE F
True
ôôG K
ElseIf
öö 
Trim
öö 
(
öö 
Left
öö 
(
öö 
c_cCategoria
öö )
.
öö) *
ToString
öö* 2
,
öö2 3
$num
öö4 5
)
öö5 6
)
öö6 7
=
öö8 9
$str
öö: >
Then
öö? C!
cboxLibro_Categoria
õõ #
.
õõ# $
Items
õõ$ )
.
õõ) *
FindByValue
õõ* 5
(
õõ5 6
$str
õõ6 :
)
õõ: ;
.
õõ; <
Selected
õõ< D
=
õõE F
True
õõG K
ElseIf
úú 
Trim
úú 
(
úú 
Left
úú 
(
úú 
c_cCategoria
úú )
.
úú) *
ToString
úú* 2
,
úú2 3
$num
úú4 5
)
úú5 6
)
úú6 7
=
úú8 9
$str
úú: >
Then
úú? C!
cboxLibro_Categoria
ùù #
.
ùù# $
Items
ùù$ )
.
ùù) *
FindByValue
ùù* 5
(
ùù5 6
$str
ùù6 :
)
ùù: ;
.
ùù; <
Selected
ùù< D
=
ùùE F
True
ùùG K
ElseIf
ûû 
Trim
ûû 
(
ûû 
Left
ûû 
(
ûû 
c_cCategoria
ûû )
.
ûû) *
ToString
ûû* 2
,
ûû2 3
$num
ûû4 5
)
ûû5 6
)
ûû6 7
=
ûû8 9
$str
ûû: >
Then
ûû? C!
cboxLibro_Categoria
üü #
.
üü# $
Items
üü$ )
.
üü) *
FindByValue
üü* 5
(
üü5 6
$str
üü6 :
)
üü: ;
.
üü; <
Selected
üü< D
=
üüE F
True
üüG K
ElseIf
†† 
Trim
†† 
(
†† 
Left
†† 
(
†† 
c_cCategoria
†† )
.
††) *
ToString
††* 2
,
††2 3
$num
††4 5
)
††5 6
)
††6 7
=
††8 9
$str
††: >
Then
††? C!
cboxLibro_Categoria
°° #
.
°°# $
Items
°°$ )
.
°°) *
FindByValue
°°* 5
(
°°5 6
$str
°°6 :
)
°°: ;
.
°°; <
Selected
°°< D
=
°°E F
True
°°G K
ElseIf
¢¢ 
Trim
¢¢ 
(
¢¢ 
Left
¢¢ 
(
¢¢ 
c_cCategoria
¢¢ )
.
¢¢) *
ToString
¢¢* 2
,
¢¢2 3
$num
¢¢4 5
)
¢¢5 6
)
¢¢6 7
=
¢¢8 9
$str
¢¢: >
Then
¢¢? C!
cboxLibro_Categoria
££ #
.
££# $
Items
££$ )
.
££) *
FindByValue
££* 5
(
££5 6
$str
££6 :
)
££: ;
.
££; <
Selected
££< D
=
££E F
True
££G K
ElseIf
§§ 
Trim
§§ 
(
§§ 
Left
§§ 
(
§§ 
c_cCategoria
§§ )
.
§§) *
ToString
§§* 2
,
§§2 3
$num
§§4 5
)
§§5 6
)
§§6 7
=
§§8 9
$str
§§: >
Then
§§? C!
cboxLibro_Categoria
•• #
.
••# $
Items
••$ )
.
••) *
FindByValue
••* 5
(
••5 6
$str
••6 :
)
••: ;
.
••; <
Selected
••< D
=
••E F
True
••G K
ElseIf
¶¶ 
Trim
¶¶ 
(
¶¶ 
Left
¶¶ 
(
¶¶ 
c_cCategoria
¶¶ )
.
¶¶) *
ToString
¶¶* 2
,
¶¶2 3
$num
¶¶4 5
)
¶¶5 6
)
¶¶6 7
=
¶¶8 9
$str
¶¶: >
Then
¶¶? C!
cboxLibro_Categoria
ßß #
.
ßß# $
Items
ßß$ )
.
ßß) *
FindByValue
ßß* 5
(
ßß5 6
$str
ßß6 :
)
ßß: ;
.
ßß; <
Selected
ßß< D
=
ßßE F
True
ßßG K
ElseIf
®® 
Trim
®® 
(
®® 
Left
®® 
(
®® 
c_cCategoria
®® )
.
®®) *
ToString
®®* 2
,
®®2 3
$num
®®4 5
)
®®5 6
)
®®6 7
=
®®8 9
$str
®®: >
Then
®®? C!
cboxLibro_Categoria
©© #
.
©©# $
Items
©©$ )
.
©©) *
FindByValue
©©* 5
(
©©5 6
$str
©©6 :
)
©©: ;
.
©©; <
Selected
©©< D
=
©©E F
True
©©G K
End
™™ 
If
™™ 
cboxTipo
¨¨ 
.
¨¨ 
SelectedIndex
¨¨ "
=
¨¨# $
-
¨¨% &
$num
¨¨& '
If
≠≠ 
IsDBNull
≠≠ 
(
≠≠ 
c_cTipo
≠≠ 
.
≠≠  
ToString
≠≠  (
)
≠≠( )
=
≠≠* +
True
≠≠, 0
Or
≠≠1 3
Len
≠≠4 7
(
≠≠7 8
Trim
≠≠8 <
(
≠≠< =
c_cTipo
≠≠= D
.
≠≠D E
ToString
≠≠E M
)
≠≠M N
)
≠≠N O
=
≠≠P Q
$num
≠≠R S
Then
≠≠T X
cboxTipo
ÆÆ 
.
ÆÆ 
Items
ÆÆ 
.
ÆÆ 
FindByValue
ÆÆ *
(
ÆÆ* +
$str
ÆÆ+ /
)
ÆÆ/ 0
.
ÆÆ0 1
Selected
ÆÆ1 9
=
ÆÆ: ;
True
ÆÆ< @
ElseIf
ØØ 
Trim
ØØ 
(
ØØ 
Left
ØØ 
(
ØØ 
c_cTipo
ØØ $
.
ØØ$ %
ToString
ØØ% -
,
ØØ- .
$num
ØØ/ 0
)
ØØ0 1
)
ØØ1 2
=
ØØ3 4
$str
ØØ5 9
Then
ØØ: >
cboxTipo
∞∞ 
.
∞∞ 
Items
∞∞ 
.
∞∞ 
FindByValue
∞∞ *
(
∞∞* +
$str
∞∞+ /
)
∞∞/ 0
.
∞∞0 1
Selected
∞∞1 9
=
∞∞: ;
True
∞∞< @
ElseIf
±± 
Trim
±± 
(
±± 
Left
±± 
(
±± 
c_cTipo
±± $
.
±±$ %
ToString
±±% -
,
±±- .
$num
±±/ 0
)
±±0 1
)
±±1 2
=
±±3 4
$str
±±5 9
Then
±±: >
cboxTipo
≤≤ 
.
≤≤ 
Items
≤≤ 
.
≤≤ 
FindByValue
≤≤ *
(
≤≤* +
$str
≤≤+ /
)
≤≤/ 0
.
≤≤0 1
Selected
≤≤1 9
=
≤≤: ;
True
≤≤< @
ElseIf
≥≥ 
Trim
≥≥ 
(
≥≥ 
Left
≥≥ 
(
≥≥ 
c_cTipo
≥≥ $
.
≥≥$ %
ToString
≥≥% -
,
≥≥- .
$num
≥≥/ 0
)
≥≥0 1
)
≥≥1 2
=
≥≥3 4
$str
≥≥5 9
Then
≥≥: >
cboxTipo
¥¥ 
.
¥¥ 
Items
¥¥ 
.
¥¥ 
FindByValue
¥¥ *
(
¥¥* +
$str
¥¥+ /
)
¥¥/ 0
.
¥¥0 1
Selected
¥¥1 9
=
¥¥: ;
True
¥¥< @
ElseIf
µµ 
Trim
µµ 
(
µµ 
Left
µµ 
(
µµ 
c_cTipo
µµ $
.
µµ$ %
ToString
µµ% -
,
µµ- .
$num
µµ/ 0
)
µµ0 1
)
µµ1 2
=
µµ3 4
$str
µµ5 9
Then
µµ: >
cboxTipo
∂∂ 
.
∂∂ 
Items
∂∂ 
.
∂∂ 
FindByValue
∂∂ *
(
∂∂* +
$str
∂∂+ /
)
∂∂/ 0
.
∂∂0 1
Selected
∂∂1 9
=
∂∂: ;
True
∂∂< @
End
∑∑ 
If
∑∑ 
cboxLibro_Estado
ππ 
.
ππ 
SelectedIndex
ππ *
=
ππ+ ,
-
ππ- .
$num
ππ. /
If
∫∫ 
IsDBNull
∫∫ 
(
∫∫ 
	c_cEstado
∫∫ !
.
∫∫! "
ToString
∫∫" *
)
∫∫* +
=
∫∫, -
True
∫∫. 2
Or
∫∫3 5
Len
∫∫6 9
(
∫∫9 :
Trim
∫∫: >
(
∫∫> ?
	c_cEstado
∫∫? H
.
∫∫H I
ToString
∫∫I Q
)
∫∫Q R
)
∫∫R S
=
∫∫T U
$num
∫∫V W
Then
∫∫X \
cboxLibro_Estado
ªª  
.
ªª  !
Items
ªª! &
.
ªª& '
FindByValue
ªª' 2
(
ªª2 3
$str
ªª3 6
)
ªª6 7
.
ªª7 8
Selected
ªª8 @
=
ªªA B
True
ªªC G
ElseIf
ºº 
Trim
ºº 
(
ºº 
Left
ºº 
(
ºº 
	c_cEstado
ºº &
.
ºº& '
ToString
ºº' /
,
ºº/ 0
$num
ºº1 2
)
ºº2 3
)
ºº3 4
=
ºº5 6
$str
ºº7 :
Then
ºº; ?
cboxLibro_Estado
ΩΩ  
.
ΩΩ  !
Items
ΩΩ! &
.
ΩΩ& '
FindByValue
ΩΩ' 2
(
ΩΩ2 3
$str
ΩΩ3 6
)
ΩΩ6 7
.
ΩΩ7 8
Enabled
ΩΩ8 ?
=
ΩΩ@ A
True
ΩΩB F
cboxLibro_Estado
ææ  
.
ææ  !
Items
ææ! &
.
ææ& '
FindByValue
ææ' 2
(
ææ2 3
$str
ææ3 6
)
ææ6 7
.
ææ7 8
Selected
ææ8 @
=
ææA B
True
ææC G
cboxLibro_Estado
øø  
.
øø  !
Items
øø! &
.
øø& '
FindByValue
øø' 2
(
øø2 3
$str
øø3 6
)
øø6 7
.
øø7 8
Enabled
øø8 ?
=
øø@ A
True
øøB F
cboxLibro_Estado
¿¿  
.
¿¿  !
Items
¿¿! &
.
¿¿& '
FindByValue
¿¿' 2
(
¿¿2 3
$str
¿¿3 6
)
¿¿6 7
.
¿¿7 8
Enabled
¿¿8 ?
=
¿¿@ A
True
¿¿B F
cboxLibro_Estado
¡¡  
.
¡¡  !
Items
¡¡! &
.
¡¡& '
FindByValue
¡¡' 2
(
¡¡2 3
$str
¡¡3 6
)
¡¡6 7
.
¡¡7 8
Enabled
¡¡8 ?
=
¡¡@ A
False
¡¡B G
cboxLibro_Estado
¬¬  
.
¬¬  !
Items
¬¬! &
.
¬¬& '
FindByValue
¬¬' 2
(
¬¬2 3
$str
¬¬3 6
)
¬¬6 7
.
¬¬7 8
Enabled
¬¬8 ?
=
¬¬@ A
False
¬¬B G
cboxLibro_Estado
√√  
.
√√  !
Items
√√! &
.
√√& '
FindByValue
√√' 2
(
√√2 3
$str
√√3 6
)
√√6 7
.
√√7 8
Enabled
√√8 ?
=
√√@ A
False
√√B G
cboxLibro_Estado
ƒƒ  
.
ƒƒ  !
Items
ƒƒ! &
.
ƒƒ& '
FindByValue
ƒƒ' 2
(
ƒƒ2 3
$str
ƒƒ3 7
)
ƒƒ7 8
.
ƒƒ8 9
Enabled
ƒƒ9 @
=
ƒƒA B
False
ƒƒC H
ElseIf
∆∆ 
Trim
∆∆ 
(
∆∆ 
Left
∆∆ 
(
∆∆ 
	c_cEstado
∆∆ &
.
∆∆& '
ToString
∆∆' /
,
∆∆/ 0
$num
∆∆1 2
)
∆∆2 3
)
∆∆3 4
=
∆∆5 6
$str
∆∆7 :
Then
∆∆; ?
cboxLibro_Estado
««  
.
««  !
Items
««! &
.
««& '
FindByValue
««' 2
(
««2 3
$str
««3 6
)
««6 7
.
««7 8
Enabled
««8 ?
=
««@ A
True
««B F
cboxLibro_Estado
»»  
.
»»  !
Items
»»! &
.
»»& '
FindByValue
»»' 2
(
»»2 3
$str
»»3 6
)
»»6 7
.
»»7 8
Selected
»»8 @
=
»»A B
True
»»C G
cboxLibro_Estado
……  
.
……  !
Items
……! &
.
……& '
FindByValue
……' 2
(
……2 3
$str
……3 6
)
……6 7
.
……7 8
Enabled
……8 ?
=
……@ A
False
……B G
cboxLibro_Estado
    
.
    !
Items
  ! &
.
  & '
FindByValue
  ' 2
(
  2 3
$str
  3 6
)
  6 7
.
  7 8
Enabled
  8 ?
=
  @ A
False
  B G
cboxLibro_Estado
ÀÀ  
.
ÀÀ  !
Items
ÀÀ! &
.
ÀÀ& '
FindByValue
ÀÀ' 2
(
ÀÀ2 3
$str
ÀÀ3 6
)
ÀÀ6 7
.
ÀÀ7 8
Enabled
ÀÀ8 ?
=
ÀÀ@ A
False
ÀÀB G
cboxLibro_Estado
ÃÃ  
.
ÃÃ  !
Items
ÃÃ! &
.
ÃÃ& '
FindByValue
ÃÃ' 2
(
ÃÃ2 3
$str
ÃÃ3 6
)
ÃÃ6 7
.
ÃÃ7 8
Enabled
ÃÃ8 ?
=
ÃÃ@ A
False
ÃÃB G
cboxLibro_Estado
ÕÕ  
.
ÕÕ  !
Items
ÕÕ! &
.
ÕÕ& '
FindByValue
ÕÕ' 2
(
ÕÕ2 3
$str
ÕÕ3 6
)
ÕÕ6 7
.
ÕÕ7 8
Enabled
ÕÕ8 ?
=
ÕÕ@ A
False
ÕÕB G
cboxLibro_Estado
ŒŒ  
.
ŒŒ  !
Items
ŒŒ! &
.
ŒŒ& '
FindByValue
ŒŒ' 2
(
ŒŒ2 3
$str
ŒŒ3 7
)
ŒŒ7 8
.
ŒŒ8 9
Enabled
ŒŒ9 @
=
ŒŒA B
False
ŒŒC H
ElseIf
œœ 
Trim
œœ 
(
œœ 
Left
œœ 
(
œœ 
	c_cEstado
œœ &
.
œœ& '
ToString
œœ' /
,
œœ/ 0
$num
œœ1 2
)
œœ2 3
)
œœ3 4
=
œœ5 6
$str
œœ7 :
Then
œœ; ?
cboxLibro_Estado
––  
.
––  !
Items
––! &
.
––& '
FindByValue
––' 2
(
––2 3
$str
––3 6
)
––6 7
.
––7 8
Enabled
––8 ?
=
––@ A
True
––B F
cboxLibro_Estado
——  
.
——  !
Items
——! &
.
——& '
FindByValue
——' 2
(
——2 3
$str
——3 6
)
——6 7
.
——7 8
Selected
——8 @
=
——A B
True
——C G
cboxLibro_Estado
““  
.
““  !
Items
““! &
.
““& '
FindByValue
““' 2
(
““2 3
$str
““3 6
)
““6 7
.
““7 8
Enabled
““8 ?
=
““@ A
False
““B G
cboxLibro_Estado
””  
.
””  !
Items
””! &
.
””& '
FindByValue
””' 2
(
””2 3
$str
””3 6
)
””6 7
.
””7 8
Enabled
””8 ?
=
””@ A
False
””B G
cboxLibro_Estado
‘‘  
.
‘‘  !
Items
‘‘! &
.
‘‘& '
FindByValue
‘‘' 2
(
‘‘2 3
$str
‘‘3 6
)
‘‘6 7
.
‘‘7 8
Enabled
‘‘8 ?
=
‘‘@ A
False
‘‘B G
cboxLibro_Estado
’’  
.
’’  !
Items
’’! &
.
’’& '
FindByValue
’’' 2
(
’’2 3
$str
’’3 6
)
’’6 7
.
’’7 8
Enabled
’’8 ?
=
’’@ A
False
’’B G
cboxLibro_Estado
÷÷  
.
÷÷  !
Items
÷÷! &
.
÷÷& '
FindByValue
÷÷' 2
(
÷÷2 3
$str
÷÷3 6
)
÷÷6 7
.
÷÷7 8
Enabled
÷÷8 ?
=
÷÷@ A
False
÷÷B G
cboxLibro_Estado
◊◊  
.
◊◊  !
Items
◊◊! &
.
◊◊& '
FindByValue
◊◊' 2
(
◊◊2 3
$str
◊◊3 7
)
◊◊7 8
.
◊◊8 9
Enabled
◊◊9 @
=
◊◊A B
False
◊◊C H
ElseIf
ÿÿ 
Trim
ÿÿ 
(
ÿÿ 
Left
ÿÿ 
(
ÿÿ 
	c_cEstado
ÿÿ &
.
ÿÿ& '
ToString
ÿÿ' /
,
ÿÿ/ 0
$num
ÿÿ1 2
)
ÿÿ2 3
)
ÿÿ3 4
=
ÿÿ5 6
$str
ÿÿ7 :
Then
ÿÿ; ?
cboxLibro_Estado
ŸŸ  
.
ŸŸ  !
Items
ŸŸ! &
.
ŸŸ& '
FindByValue
ŸŸ' 2
(
ŸŸ2 3
$str
ŸŸ3 6
)
ŸŸ6 7
.
ŸŸ7 8
Enabled
ŸŸ8 ?
=
ŸŸ@ A
True
ŸŸB F
cboxLibro_Estado
⁄⁄  
.
⁄⁄  !
Items
⁄⁄! &
.
⁄⁄& '
FindByValue
⁄⁄' 2
(
⁄⁄2 3
$str
⁄⁄3 6
)
⁄⁄6 7
.
⁄⁄7 8
Selected
⁄⁄8 @
=
⁄⁄A B
True
⁄⁄C G
cboxLibro_Estado
‹‹  
.
‹‹  !
Items
‹‹! &
.
‹‹& '
FindByValue
‹‹' 2
(
‹‹2 3
$str
‹‹3 6
)
‹‹6 7
.
‹‹7 8
Enabled
‹‹8 ?
=
‹‹@ A
False
‹‹B G
cboxLibro_Estado
››  
.
››  !
Items
››! &
.
››& '
FindByValue
››' 2
(
››2 3
$str
››3 6
)
››6 7
.
››7 8
Enabled
››8 ?
=
››@ A
False
››B G
cboxLibro_Estado
ﬁﬁ  
.
ﬁﬁ  !
Items
ﬁﬁ! &
.
ﬁﬁ& '
FindByValue
ﬁﬁ' 2
(
ﬁﬁ2 3
$str
ﬁﬁ3 6
)
ﬁﬁ6 7
.
ﬁﬁ7 8
Enabled
ﬁﬁ8 ?
=
ﬁﬁ@ A
False
ﬁﬁB G
cboxLibro_Estado
ﬂﬂ  
.
ﬂﬂ  !
Items
ﬂﬂ! &
.
ﬂﬂ& '
FindByValue
ﬂﬂ' 2
(
ﬂﬂ2 3
$str
ﬂﬂ3 6
)
ﬂﬂ6 7
.
ﬂﬂ7 8
Enabled
ﬂﬂ8 ?
=
ﬂﬂ@ A
False
ﬂﬂB G
cboxLibro_Estado
‡‡  
.
‡‡  !
Items
‡‡! &
.
‡‡& '
FindByValue
‡‡' 2
(
‡‡2 3
$str
‡‡3 6
)
‡‡6 7
.
‡‡7 8
Enabled
‡‡8 ?
=
‡‡@ A
False
‡‡B G
cboxLibro_Estado
··  
.
··  !
Items
··! &
.
··& '
FindByValue
··' 2
(
··2 3
$str
··3 7
)
··7 8
.
··8 9
Enabled
··9 @
=
··A B
False
··C H
ElseIf
„„ 
Trim
„„ 
(
„„ 
Left
„„ 
(
„„ 
	c_cEstado
„„ &
.
„„& '
ToString
„„' /
,
„„/ 0
$num
„„1 2
)
„„2 3
)
„„3 4
=
„„5 6
$str
„„7 :
Then
„„; ?
cboxLibro_Estado
‰‰  
.
‰‰  !
Items
‰‰! &
.
‰‰& '
FindByValue
‰‰' 2
(
‰‰2 3
$str
‰‰3 6
)
‰‰6 7
.
‰‰7 8
Enabled
‰‰8 ?
=
‰‰@ A
True
‰‰B F
cboxLibro_Estado
ÂÂ  
.
ÂÂ  !
Items
ÂÂ! &
.
ÂÂ& '
FindByValue
ÂÂ' 2
(
ÂÂ2 3
$str
ÂÂ3 6
)
ÂÂ6 7
.
ÂÂ7 8
Selected
ÂÂ8 @
=
ÂÂA B
True
ÂÂC G
cboxLibro_Estado
ÁÁ  
.
ÁÁ  !
Items
ÁÁ! &
.
ÁÁ& '
FindByValue
ÁÁ' 2
(
ÁÁ2 3
$str
ÁÁ3 6
)
ÁÁ6 7
.
ÁÁ7 8
Enabled
ÁÁ8 ?
=
ÁÁ@ A
True
ÁÁB F
cboxLibro_Estado
ËË  
.
ËË  !
Items
ËË! &
.
ËË& '
FindByValue
ËË' 2
(
ËË2 3
$str
ËË3 6
)
ËË6 7
.
ËË7 8
Enabled
ËË8 ?
=
ËË@ A
True
ËËB F
cboxLibro_Estado
ÈÈ  
.
ÈÈ  !
Items
ÈÈ! &
.
ÈÈ& '
FindByValue
ÈÈ' 2
(
ÈÈ2 3
$str
ÈÈ3 6
)
ÈÈ6 7
.
ÈÈ7 8
Enabled
ÈÈ8 ?
=
ÈÈ@ A
False
ÈÈB G
cboxLibro_Estado
ÍÍ  
.
ÍÍ  !
Items
ÍÍ! &
.
ÍÍ& '
FindByValue
ÍÍ' 2
(
ÍÍ2 3
$str
ÍÍ3 6
)
ÍÍ6 7
.
ÍÍ7 8
Enabled
ÍÍ8 ?
=
ÍÍ@ A
False
ÍÍB G
cboxLibro_Estado
ÎÎ  
.
ÎÎ  !
Items
ÎÎ! &
.
ÎÎ& '
FindByValue
ÎÎ' 2
(
ÎÎ2 3
$str
ÎÎ3 6
)
ÎÎ6 7
.
ÎÎ7 8
Enabled
ÎÎ8 ?
=
ÎÎ@ A
False
ÎÎB G
cboxLibro_Estado
ÏÏ  
.
ÏÏ  !
Items
ÏÏ! &
.
ÏÏ& '
FindByValue
ÏÏ' 2
(
ÏÏ2 3
$str
ÏÏ3 7
)
ÏÏ7 8
.
ÏÏ8 9
Enabled
ÏÏ9 @
=
ÏÏA B
False
ÏÏC H
ElseIf
ÓÓ 
Trim
ÓÓ 
(
ÓÓ 
Left
ÓÓ 
(
ÓÓ 
	c_cEstado
ÓÓ &
.
ÓÓ& '
ToString
ÓÓ' /
,
ÓÓ/ 0
$num
ÓÓ1 2
)
ÓÓ2 3
)
ÓÓ3 4
=
ÓÓ5 6
$str
ÓÓ7 :
Then
ÓÓ; ?
cboxLibro_Estado
ÔÔ  
.
ÔÔ  !
Items
ÔÔ! &
.
ÔÔ& '
FindByValue
ÔÔ' 2
(
ÔÔ2 3
$str
ÔÔ3 6
)
ÔÔ6 7
.
ÔÔ7 8
Enabled
ÔÔ8 ?
=
ÔÔ@ A
True
ÔÔB F
cboxLibro_Estado
  
.
  !
Items
! &
.
& '
FindByValue
' 2
(
2 3
$str
3 6
)
6 7
.
7 8
Selected
8 @
=
A B
True
C G
cboxLibro_Estado
ÒÒ  
.
ÒÒ  !
Items
ÒÒ! &
.
ÒÒ& '
FindByValue
ÒÒ' 2
(
ÒÒ2 3
$str
ÒÒ3 6
)
ÒÒ6 7
.
ÒÒ7 8
Enabled
ÒÒ8 ?
=
ÒÒ@ A
True
ÒÒB F
cboxLibro_Estado
ÚÚ  
.
ÚÚ  !
Items
ÚÚ! &
.
ÚÚ& '
FindByValue
ÚÚ' 2
(
ÚÚ2 3
$str
ÚÚ3 6
)
ÚÚ6 7
.
ÚÚ7 8
Enabled
ÚÚ8 ?
=
ÚÚ@ A
True
ÚÚB F
cboxLibro_Estado
ÛÛ  
.
ÛÛ  !
Items
ÛÛ! &
.
ÛÛ& '
FindByValue
ÛÛ' 2
(
ÛÛ2 3
$str
ÛÛ3 6
)
ÛÛ6 7
.
ÛÛ7 8
Enabled
ÛÛ8 ?
=
ÛÛ@ A
False
ÛÛB G
cboxLibro_Estado
ÙÙ  
.
ÙÙ  !
Items
ÙÙ! &
.
ÙÙ& '
FindByValue
ÙÙ' 2
(
ÙÙ2 3
$str
ÙÙ3 6
)
ÙÙ6 7
.
ÙÙ7 8
Enabled
ÙÙ8 ?
=
ÙÙ@ A
False
ÙÙB G
cboxLibro_Estado
ıı  
.
ıı  !
Items
ıı! &
.
ıı& '
FindByValue
ıı' 2
(
ıı2 3
$str
ıı3 6
)
ıı6 7
.
ıı7 8
Enabled
ıı8 ?
=
ıı@ A
False
ııB G
cboxLibro_Estado
ˆˆ  
.
ˆˆ  !
Items
ˆˆ! &
.
ˆˆ& '
FindByValue
ˆˆ' 2
(
ˆˆ2 3
$str
ˆˆ3 7
)
ˆˆ7 8
.
ˆˆ8 9
Enabled
ˆˆ9 @
=
ˆˆA B
False
ˆˆC H
End
˜˜ 
If
˜˜ 
cboxLibro_Idioma
˘˘ 
.
˘˘ 
SelectedIndex
˘˘ *
=
˘˘+ ,
-
˘˘- .
$num
˘˘. /
If
˙˙ 
IsDBNull
˙˙ 
(
˙˙ 
	c_cIdioma
˙˙ !
.
˙˙! "
ToString
˙˙" *
)
˙˙* +
Or
˙˙, .
Len
˙˙/ 2
(
˙˙2 3
Trim
˙˙3 7
(
˙˙7 8
	c_cIdioma
˙˙8 A
.
˙˙A B
ToString
˙˙B J
)
˙˙J K
)
˙˙K L
=
˙˙M N
$num
˙˙O P
Then
˙˙Q U
cboxLibro_Idioma
˚˚  
.
˚˚  !
Items
˚˚! &
.
˚˚& '
FindByValue
˚˚' 2
(
˚˚2 3
$str
˚˚3 ;
)
˚˚; <
.
˚˚< =
Selected
˚˚= E
=
˚˚F G
True
˚˚H L
Else
¸¸ 
cboxLibro_Idioma
˝˝  
.
˝˝  !
Items
˝˝! &
.
˝˝& '
FindByValue
˝˝' 2
(
˝˝2 3
Trim
˝˝3 7
(
˝˝7 8
	c_cIdioma
˝˝8 A
.
˝˝A B
ToString
˝˝B J
)
˝˝J K
)
˝˝K L
.
˝˝L M
Selected
˝˝M U
=
˝˝V W
True
˝˝X \
End
˛˛ 
If
˛˛ 
txt_codRegistro
ÄÄ 
.
ÄÄ 
Text
ÄÄ  
=
ÄÄ! "
Trim
ÄÄ# '
(
ÄÄ' (
c_cCodRegistro
ÄÄ( 6
)
ÄÄ6 7
txt_codClasif
ÅÅ 
.
ÅÅ 
Text
ÅÅ 
=
ÅÅ  
Trim
ÅÅ! %
(
ÅÅ% &!
c_cCodClasificacion
ÅÅ& 9
)
ÅÅ9 :
txt_TituloLibro
ÇÇ 
.
ÇÇ 
	InnerText
ÇÇ %
=
ÇÇ& '
Trim
ÇÇ( ,
(
ÇÇ, -
	c_cTitulo
ÇÇ- 6
)
ÇÇ6 7
	txt_lugar
ÉÉ 
.
ÉÉ 
Text
ÉÉ 
=
ÉÉ 
Trim
ÉÉ !
(
ÉÉ! "
c_cLugarLibro
ÉÉ" /
)
ÉÉ/ 0
	txt_autor
ÑÑ 
.
ÑÑ 
Text
ÑÑ 
=
ÑÑ 
Trim
ÑÑ !
(
ÑÑ! "
c_cAutor
ÑÑ" *
)
ÑÑ* +
txt_Editorial
ÖÖ 
.
ÖÖ 
Text
ÖÖ 
=
ÖÖ  
Trim
ÖÖ! %
(
ÖÖ% &
c_cEditorial
ÖÖ& 2
)
ÖÖ2 3
txt_numEdicion
ÜÜ 
.
ÜÜ 
Text
ÜÜ 
=
ÜÜ  !
Trim
ÜÜ" &
(
ÜÜ& '
c_cNumEdicion
ÜÜ' 4
)
ÜÜ4 5
txt_anioEdic
áá 
.
áá 
Text
áá 
=
áá 
Trim
áá  $
(
áá$ %
c_cAnioEdicion
áá% 3
)
áá3 4
txt_proveedor
àà 
.
àà 
	InnerText
àà #
=
àà$ %
Trim
àà& *
(
àà* +
c_cproveedor
àà+ 7
)
àà7 8
txt_numPaginas
ââ 
.
ââ 
Text
ââ 
=
ââ  !
Trim
ââ" &
(
ââ& '
c_cNumPaginas
ââ' 4
)
ââ4 5
txt_numEjemplares
ää 
.
ää 
Text
ää "
=
ää# $
Trim
ää% )
(
ää) *
c_cNumEjemplares
ää* :
)
ää: ;$
txt_LibroprecioDolares
ãã "
.
ãã" #
Text
ãã# '
=
ãã( )
Trim
ãã* .
(
ãã. /#
c_cLibroPrecioDolares
ãã/ D
)
ããD E"
txt_LibroPrecioSoles
åå  
.
åå  !
Text
åå! %
=
åå& '
Trim
åå( ,
(
åå, -!
c_cLibroPrecioSoles
åå- @
)
åå@ A
txt_ISBN
çç 
.
çç 
Text
çç 
=
çç 
Trim
çç  
(
çç  !
c_cLibroISBN
çç! -
)
çç- .
txt_materias
èè 
.
èè 
	InnerText
èè "
=
èè# $
c_cMaterias
èè% 0
txt_Detalles
êê 
.
êê 
	InnerText
êê "
=
êê# $
c_cDetalles
êê% 0
If
íí 
	Cd_Button
íí 
=
íí 
$str
íí 
Then
íí  $
ckhLibro_CD
ìì 
.
ìì 
Checked
ìì #
=
ìì$ %
False
ìì& +
ElseIf
ïï 
	Cd_Button
ïï 
=
ïï 
$str
ïï #
Then
ïï$ (
ckhLibro_CD
ññ 
.
ññ 
Checked
ññ #
=
ññ$ %
True
ññ& *
End
óó 
If
óó 
End
ôô 
If
ôô 
End
õõ 
Sub
õõ 
Private
ùù 
Sub
ùù 
grabar
ùù 
(
ùù 
ByVal
ùù 

TipoGrabar
ùù '
As
ùù( *
String
ùù+ 1
)
ùù1 2
Dim
ûû 
dtFecha
ûû 
As
ûû 
DateTime
ûû 
=
ûû  !
DateTime
ûû" *
.
ûû* +
Now
ûû+ .
Dim
üü 
v_FechaRegistro
üü 
=
üü 
dtFecha
üü %
.
üü% &
ToString
üü& .
(
üü. /
$str
üü/ ;
)
üü; <
Dim
†† 
v_HoraRegistro
†† 
As
†† 
String
†† $
=
††% &
txt_HoraSist_Ing
††' 7
.
††7 8
Text
††8 <
.
††< =
Trim
††= A
Dim
°° 
tituloLibro
°° 
As
°° 
String
°° !
=
°°" #
txt_TituloLibro
°°$ 3
.
°°3 4
	InnerText
°°4 =
.
°°= >
Trim
°°> B
Dim
¢¢ 
codNumerico
¢¢ 
As
¢¢ 
String
¢¢ !
=
¢¢" #
txt_codRegistro
¢¢$ 3
.
¢¢3 4
Text
¢¢4 8
.
¢¢8 9
Trim
¢¢9 =
Dim
££  
v_codClasificacion
££ 
As
££ !
String
££" (
=
££) *
txt_codClasif
££+ 8
.
££8 9
Text
££9 =
.
££= >
Trim
££> B
Dim
§§ 
v_lugar
§§ 
As
§§ 
String
§§ 
=
§§ 
	txt_lugar
§§  )
.
§§) *
Text
§§* .
.
§§. /
Trim
§§/ 3
Dim
•• 
v_autor
•• 
As
•• 
String
•• 
=
•• 
	txt_autor
••  )
.
••) *
Text
••* .
.
••. /
Trim
••/ 3
Dim
¶¶ 
v_Editorial
¶¶ 
As
¶¶ 
String
¶¶ !
=
¶¶" #
txt_Editorial
¶¶$ 1
.
¶¶1 2
Text
¶¶2 6
.
¶¶6 7
Trim
¶¶7 ;
Dim
ßß 
v_numEdicion
ßß 
As
ßß 
String
ßß "
=
ßß# $
txt_numEdicion
ßß% 3
.
ßß3 4
Text
ßß4 8
.
ßß8 9
Trim
ßß9 =
Dim
®® 
v_anioEdicion
®® 
As
®® 
String
®® #
=
®®$ %
txt_anioEdic
®®& 2
.
®®2 3
Text
®®3 7
.
®®7 8
Trim
®®8 <
Dim
©© 
v_pieImprenta
©© 
As
©© 
String
©© #
=
©©$ %
txt_proveedor
©©& 3
.
©©3 4
	InnerText
©©4 =
.
©©= >
Trim
©©> B
Dim
™™ 
v_numPaginas
™™ 
As
™™ 
String
™™ "
=
™™# $
txt_numPaginas
™™% 3
.
™™3 4
Text
™™4 8
.
™™8 9
Trim
™™9 =
Dim
´´ 
v_numejemplares
´´ 
As
´´ 
String
´´ %
=
´´& '
txt_numEjemplares
´´( 9
.
´´9 :
Text
´´: >
.
´´> ?
Trim
´´? C
Dim
¨¨ 
	v_precioD
¨¨ 
As
¨¨ 
String
¨¨ 
=
¨¨  !$
txt_LibroprecioDolares
¨¨" 8
.
¨¨8 9
Text
¨¨9 =
.
¨¨= >
Trim
¨¨> B
Dim
≠≠ 
	v_precioS
≠≠ 
As
≠≠ 
String
≠≠ 
=
≠≠  !"
txt_LibroPrecioSoles
≠≠" 6
.
≠≠6 7
Text
≠≠7 ;
.
≠≠; <
Trim
≠≠< @
Dim
ÆÆ 
v_isbn
ÆÆ 
As
ÆÆ 
String
ÆÆ 
=
ÆÆ 
txt_ISBN
ÆÆ '
.
ÆÆ' (
Text
ÆÆ( ,
.
ÆÆ, -
Trim
ÆÆ- 1
Dim
ØØ "
v_mesAnnoCompraLibro
ØØ  
As
ØØ! #
String
ØØ$ *
=
ØØ+ ,$
txt_MesAnioCompraLibro
ØØ- C
.
ØØC D
Text
ØØD H
.
ØØH I
Trim
ØØI M
Dim
∞∞ 
v_nroIP
∞∞ 
As
∞∞ 
String
∞∞ 
=
∞∞ 
txt_NoIP
∞∞  (
.
∞∞( )
Text
∞∞) -
.
∞∞- .
Trim
∞∞. 2
Dim
±± 
v_usuarioSistema
±± 
As
±± 
String
±±  &
=
±±' (
txt_UsActivo
±±) 5
.
±±5 6
Text
±±6 :
.
±±: ;
Trim
±±; ?
Dim
¥¥ 

v_detalles
¥¥ 
As
¥¥ 
String
¥¥  
=
¥¥! "
txt_Detalles
¥¥# /
.
¥¥/ 0
	InnerText
¥¥0 9
.
¥¥9 :
Trim
¥¥: >
Dim
µµ 
	v_materia
µµ 
As
µµ 
String
µµ 
=
µµ  !
txt_materias
µµ" .
.
µµ. /
	InnerText
µµ/ 8
.
µµ8 9
Trim
µµ9 =
Dim
∑∑ 
v_Modo
∑∑ 
As
∑∑ 
String
∑∑ 
=
∑∑ 
cboxLibro_Modo
∑∑ -
.
∑∑- .
SelectedValue
∑∑. ;
Dim
∏∏ 
v_Idioma
∏∏ 
As
∏∏ 
String
∏∏ 
=
∏∏  
cboxLibro_Idioma
∏∏! 1
.
∏∏1 2
SelectedValue
∏∏2 ?
Dim
ππ 
v_Estado
ππ 
As
ππ 
String
ππ 
=
ππ  
cboxLibro_Estado
ππ! 1
.
ππ1 2
SelectedValue
ππ2 ?
Dim
∫∫ 
v_Tipo
∫∫ 
As
∫∫ 
String
∫∫ 
=
∫∫ 
cboxTipo
∫∫ '
.
∫∫' (
SelectedValue
∫∫( 5
Dim
ªª 
v_Categoria
ªª 
As
ªª 
String
ªª !
=
ªª" #!
cboxLibro_Categoria
ªª$ 7
.
ªª7 8
SelectedValue
ªª8 E
Dim
ææ 
	v_librocd
ææ 
As
ææ 
String
ææ 
If
øø 

(
øø 
ckhLibro_CD
øø 
.
øø 
Checked
øø 
=
øø  !
True
øø" &
)
øø& '
Then
øø( ,
	v_librocd
¿¿ 
=
¿¿ 
$str
¿¿ 
Else
¡¡ 
	v_librocd
¬¬ 
=
¬¬ 
$str
¬¬ 
End
√√ 
If
√√ 
If
≈≈ 


TipoGrabar
≈≈ 
=
≈≈ 
$str
≈≈ !
Then
≈≈" &
Dim
«« 
	dt_NumReg
«« 
As
«« 
	DataTable
«« &
=
««' (
cls_Metodos
««) 4
.
««4 5(
validacionContadorCodLibro
««5 O
.
««O P
Tables
««P V
(
««V W
$num
««W X
)
««X Y
Dim
»» 
vValor_Maximo
»» 
As
»»  
String
»»! '
=
»»( )
Val
»»* -
(
»»- .
	dt_NumReg
»». 7
.
»»7 8
Rows
»»8 <
(
»»< =
$num
»»= >
)
»»> ?
(
»»? @
$str
»»@ I
)
»»I J
)
»»J K
.
»»K L
ToString
»»L T
(
»»T U
)
»»U V
txt_codRegistro
…… 
.
…… 
Text
……  
=
……! "
vValor_Maximo
……# 0
+
……1 2
$num
……3 4
codNumerico
   
=
   
txt_codRegistro
   )
.
  ) *
Text
  * .
.
  . /
Trim
  / 3
cls_Metodos
ÃÃ 
.
ÃÃ 
Registrar_Libro
ÃÃ '
(
ÃÃ' (
v_FechaRegistro
ÃÃ( 7
,
ÃÃ7 8
v_HoraRegistro
ÃÃ9 G
,
ÃÃG H
tituloLibro
ÃÃI T
,
ÃÃT U
codNumerico
ÃÃV a
,
ÃÃa b
v_Editorial
ÃÃc n
,
ÃÃn o
v_anioEdicion
ÃÃp }
,
ÃÃ} ~
v_autor
ÕÕ 
,
ÕÕ   
v_codClasificacion
ÕÕ! 3
,
ÕÕ3 4
v_Categoria
ÕÕ5 @
,
ÕÕ@ A

v_detalles
ÕÕB L
,
ÕÕL M
v_Idioma
ÕÕN V
,
ÕÕV W
v_numejemplares
ŒŒ '
,
ŒŒ' (
v_Modo
ŒŒ) /
,
ŒŒ/ 0
v_pieImprenta
ŒŒ1 >
,
ŒŒ> ?
v_Tipo
ŒŒ@ F
,
ŒŒF G
v_numEdicion
ŒŒH T
,
ŒŒT U
v_lugar
ŒŒV ]
,
ŒŒ] ^
	v_precioS
œœ !
,
œœ! "
	v_precioD
œœ# ,
,
œœ, -
	v_materia
œœ. 7
,
œœ7 8
v_Estado
œœ9 A
,
œœA B
v_nroIP
œœC J
,
œœJ K
v_usuarioSistema
–– (
,
––( )
v_numPaginas
––* 6
,
––6 7
v_isbn
––8 >
,
––> ?
	v_librocd
––@ I
,
––I J"
v_mesAnnoCompraLibro
––K _
)
––_ `
	btnGrabar
““ 
.
““ 
Enabled
““ 
=
““ 
False
““  %
	GeneraLog
‘‘ 
(
‘‘ 
$str
‘‘ 
,
‘‘ 
codNumerico
‘‘ &
)
‘‘& '

Validacion
’’ 
(
’’ 
$str
’’ "
)
’’" #

lbl_Valida
÷÷ 
.
÷÷ 
	ForeColor
÷÷  
=
÷÷! "
System
÷÷# )
.
÷÷) *
Drawing
÷÷* 1
.
÷÷1 2
Color
÷÷2 7
.
÷÷7 8
Green
÷÷8 =

lbl_Valida
◊◊ 
.
◊◊ 
Visible
◊◊ 
=
◊◊  
True
◊◊! %

lbl_Valida
ÿÿ 
.
ÿÿ 
Text
ÿÿ 
=
ÿÿ 
$str
ÿÿ ?
ElseIf
⁄⁄ 

TipoGrabar
⁄⁄ 
=
⁄⁄ 
$str
⁄⁄ %
Then
⁄⁄& *
cls_Metodos
€€ 
.
€€ 
Actualizar_Libro
€€ (
(
€€( )
tituloLibro
€€) 4
,
€€4 5
codNumerico
€€6 A
,
€€A B
v_Editorial
€€C N
,
€€N O
v_anioEdicion
€€P ]
,
€€] ^
v_autor
‹‹ 
,
‹‹   
v_codClasificacion
‹‹! 3
,
‹‹3 4
v_Categoria
‹‹5 @
,
‹‹@ A

v_detalles
‹‹B L
,
‹‹L M
v_Idioma
‹‹N V
,
‹‹V W
v_numejemplares
›› '
,
››' (
v_Modo
››) /
,
››/ 0
v_pieImprenta
››1 >
,
››> ?
v_Tipo
››@ F
,
››F G
v_numEdicion
››H T
,
››T U
v_lugar
››V ]
,
››] ^
	v_precioS
ﬁﬁ !
,
ﬁﬁ! "
	v_precioD
ﬁﬁ# ,
,
ﬁﬁ, -
	v_materia
ﬁﬁ. 7
,
ﬁﬁ7 8
v_Estado
ﬁﬁ9 A
,
ﬁﬁA B
v_nroIP
ﬁﬁC J
,
ﬁﬁJ K
v_usuarioSistema
ﬂﬂ (
,
ﬂﬂ( )
v_numPaginas
ﬂﬂ* 6
,
ﬂﬂ6 7
v_isbn
ﬂﬂ8 >
,
ﬂﬂ> ?
	v_librocd
ﬂﬂ@ I
,
ﬂﬂI J"
v_mesAnnoCompraLibro
ﬂﬂK _
)
ﬂﬂ_ `

btnGrabar2
·· 
.
·· 
Enabled
·· 
=
··  
False
··! &
	GeneraLog
‚‚ 
(
‚‚ 
$str
‚‚ 
,
‚‚ 
codNumerico
‚‚ &
)
‚‚& '

Validacion
„„ 
(
„„ 
$str
„„ "
)
„„" #

lbl_Valida
‰‰ 
.
‰‰ 
	ForeColor
‰‰  
=
‰‰! "
System
‰‰# )
.
‰‰) *
Drawing
‰‰* 1
.
‰‰1 2
Color
‰‰2 7
.
‰‰7 8
Green
‰‰8 =

lbl_Valida
ÂÂ 
.
ÂÂ 
Visible
ÂÂ 
=
ÂÂ  
True
ÂÂ! %

lbl_Valida
ÊÊ 
.
ÊÊ 
Text
ÊÊ 
=
ÊÊ 
$str
ÊÊ B
End
ÁÁ 
If
ÁÁ 
listarUltimo
ÈÈ 
(
ÈÈ 
)
ÈÈ 
End
ÍÍ 
Sub
ÍÍ 
Private
ÌÌ 
Function
ÌÌ 
	CapturaIP
ÌÌ 
(
ÌÌ 
)
ÌÌ  
Dim
ÓÓ 
IPAdd
ÓÓ 
As
ÓÓ 
String
ÓÓ 
=
ÓÓ 
String
ÓÓ $
.
ÓÓ$ %
Empty
ÓÓ% *
IPAdd
ÔÔ 
=
ÔÔ 
Request
ÔÔ 
.
ÔÔ 
ServerVariables
ÔÔ '
(
ÔÔ' (
$str
ÔÔ( >
)
ÔÔ> ?
If
 

String
 
.
 
IsNullOrEmpty
 
(
  
IPAdd
  %
)
% &
Then
' +
IPAdd
ÒÒ 
=
ÒÒ 
Request
ÒÒ 
.
ÒÒ 
ServerVariables
ÒÒ +
(
ÒÒ+ ,
$str
ÒÒ, 9
)
ÒÒ9 :
End
ÚÚ 
If
ÚÚ 
Return
ÛÛ 
IPAdd
ÛÛ 
End
ÙÙ 
Function
ÙÙ 
Private
˜˜ 
Function
˜˜  
Formato_Fecha_Hora
˜˜ '
(
˜˜' (
)
˜˜( )
As
˜˜* ,
Tuple
˜˜- 2
(
˜˜2 3
Of
˜˜3 5
String
˜˜6 <
,
˜˜< =
String
˜˜> D
)
˜˜D E
Dim
˘˘ 
dd
˘˘ 
As
˘˘ 
String
˘˘ 
=
˘˘ 
Day
˘˘ 
(
˘˘ 
Now
˘˘ "
)
˘˘" #
If
˙˙ 

Len
˙˙ 
(
˙˙ 
dd
˙˙ 
)
˙˙ 
=
˙˙ 
$num
˙˙ 
Then
˙˙ 
dd
˙˙ 
=
˙˙  
$str
˙˙! $
&
˙˙% &
dd
˙˙' )
Dim
¸¸ 
mm
¸¸ 
As
¸¸ 
String
¸¸ 
=
¸¸ 
Month
¸¸  
(
¸¸  !
Now
¸¸! $
)
¸¸$ %
If
˝˝ 

Len
˝˝ 
(
˝˝ 
mm
˝˝ 
)
˝˝ 
=
˝˝ 
$num
˝˝ 
Then
˝˝ 
mm
˝˝ 
=
˝˝  
$str
˝˝! $
&
˝˝% &
mm
˝˝' )
Dim
ˇˇ 
aaaa
ˇˇ 
As
ˇˇ 
String
ˇˇ 
=
ˇˇ 
Year
ˇˇ !
(
ˇˇ! "
Now
ˇˇ" %
)
ˇˇ% &
Dim
ÄÄ 
formato_Fecha
ÄÄ 
=
ÄÄ 
dd
ÄÄ 
&
ÄÄ  
$str
ÄÄ! $
&
ÄÄ% &
mm
ÄÄ' )
&
ÄÄ* +
$str
ÄÄ, /
&
ÄÄ0 1
aaaa
ÄÄ2 6
Dim
ÉÉ 
hor
ÉÉ 
As
ÉÉ 
String
ÉÉ 
=
ÉÉ 
Hour
ÉÉ  
(
ÉÉ  !
Now
ÉÉ! $
)
ÉÉ$ %
Dim
ÑÑ 
min
ÑÑ 
As
ÑÑ 
String
ÑÑ 
=
ÑÑ 
Minute
ÑÑ "
(
ÑÑ" #
Now
ÑÑ# &
)
ÑÑ& '
Dim
ÖÖ 
seg
ÖÖ 
As
ÖÖ 
String
ÖÖ 
=
ÖÖ 
Second
ÖÖ "
(
ÖÖ" #
Now
ÖÖ# &
)
ÖÖ& '
If
áá 

Len
áá 
(
áá 
hor
áá 
)
áá 
=
áá 
$num
áá 
Then
áá 
hor
áá  
=
áá! "
$str
áá# &
&
áá' (
hor
áá) ,
If
àà 

Len
àà 
(
àà 
min
àà 
)
àà 
=
àà 
$num
àà 
Then
àà 
min
àà  
=
àà! "
$str
àà# &
&
àà' (
min
àà) ,
If
ââ 

Len
ââ 
(
ââ 
seg
ââ 
)
ââ 
=
ââ 
$num
ââ 
Then
ââ 
seg
ââ  
=
ââ! "
$str
ââ# &
&
ââ' (
seg
ââ) ,
Dim
ãã 
formato_hora
ãã 
=
ãã 
hor
ãã 
&
ãã  
$str
ãã! $
&
ãã% &
min
ãã' *
&
ãã+ ,
$str
ãã- 0
&
ãã1 2
seg
ãã3 6
Return
åå 
New
åå 
Tuple
åå 
(
åå 
Of
åå 
String
åå "
,
åå" #
String
åå$ *
)
åå* +
(
åå+ ,
formato_Fecha
åå, 9
,
åå9 :
formato_hora
åå; G
)
ååG H
End
çç 
Function
çç 
Private
ëë 
Sub
ëë 
	GeneraLog
ëë 
(
ëë 
ByVal
ëë 
v_opcion
ëë  (
As
ëë) +
String
ëë, 2
,
ëë2 3
ByVal
ëë4 9
v_valor
ëë: A
As
ëëB D
String
ëëE K
)
ëëK L
Try
íí 
Dim
ìì 
tupla_FechaHora
ìì 
As
ìì  "
Tuple
ìì# (
(
ìì( )
Of
ìì) +
String
ìì, 2
,
ìì2 3
String
ìì4 :
)
ìì: ;
=
ìì< = 
Formato_Fecha_Hora
ìì> P
(
ììP Q
)
ììQ R
Dim
îî 
cUser_Fecha_Ing
îî 
As
îî  "
String
îî# )
=
îî* +
tupla_FechaHora
îî, ;
.
îî; <
Item1
îî< A
Dim
ïï 
cUser_Hora_Ing
ïï 
As
ïï !
String
ïï" (
=
ïï) *
tupla_FechaHora
ïï+ :
.
ïï: ;
Item2
ïï; @
Dim
ññ "
cUser_quien_consulta
ññ $
As
ññ% '
String
ññ( .
=
ññ/ 0
Session
ññ1 8
(
ññ8 9
$str
ññ9 G
)
ññG H
Dim
óó 
IPAdd
óó 
As
óó 
String
óó 
=
óó  !
	CapturaIP
óó" +
(
óó+ ,
)
óó, -
Dim
òò 
cUser_TemaBuscado
òò !
As
òò" $
String
òò% +
=
òò, -
v_valor
òò. 5
Dim
ôô 
cUser_Accion
ôô 
As
ôô 
String
ôô  &
=
ôô' (
$str
ôô) +
Dim
öö 
cUser_Modulo
öö 
As
öö 
String
öö  &
=
öö' (
$str
öö) /
If
úú 
v_opcion
úú 
=
úú 
$num
úú 
Then
úú  
cUser_Accion
ùù 
=
ùù 
$str
ùù :
ElseIf
ûû 
v_opcion
ûû 
=
ûû 
$num
ûû 
Then
ûû  $
cUser_Accion
üü 
=
üü 
$str
üü ?
ElseIf
†† 
v_opcion
†† 
=
†† 
$num
†† 
Then
††  $
cUser_Accion
°° 
=
°° 
$str
°° 1
ElseIf
¢¢ 
v_opcion
¢¢ 
=
¢¢ 
$num
¢¢ 
Then
¢¢  $
cUser_Accion
££ 
=
££ 
$str
££ 0
ElseIf
§§ 
v_opcion
§§ 
=
§§ 
$num
§§ 
Then
§§  $
cUser_Accion
•• 
=
•• 
$str
•• 0
ElseIf
¶¶ 
v_opcion
¶¶ 
=
¶¶ 
$num
¶¶ 
Then
¶¶  $
cUser_Accion
ßß 
=
ßß 
$str
ßß 2
ElseIf
®® 
v_opcion
®® 
=
®® 
$num
®® 
Then
®®  $
cUser_Accion
©© 
=
©© 
$str
©© G
ElseIf
™™ 
v_opcion
™™ 
=
™™ 
$num
™™ 
Then
™™  $
cUser_Accion
´´ 
=
´´ 
$str
´´ 3
ElseIf
¨¨ 
v_opcion
¨¨ 
=
¨¨ 
$num
¨¨ 
Then
¨¨  $
cUser_Accion
≠≠ 
=
≠≠ 
$str
≠≠ 9
End
ÆÆ 
If
ÆÆ 
cls_Metodos
∞∞ 
.
∞∞ 
RegistrarLog
∞∞ $
(
∞∞$ %
cUser_Fecha_Ing
∞∞% 4
,
∞∞4 5
cUser_Hora_Ing
∞∞6 D
,
∞∞D E"
cUser_quien_consulta
±±$ 8
,
±±8 9
IPAdd
±±: ?
,
±±? @
cUser_Accion
≤≤$ 0
,
≤≤0 1
cUser_TemaBuscado
≤≤2 C
,
≤≤C D
cUser_Modulo
≤≤E Q
)
≤≤Q R
Catch
≥≥ 
ex
≥≥ 
As
≥≥ 
	Exception
≥≥ 

lbl_Valida
¥¥ 
.
¥¥ 
Text
¥¥ 
=
¥¥ 
ex
¥¥  
.
¥¥  !
Message
¥¥! (

lbl_Valida
µµ 
.
µµ 
	ForeColor
µµ  
=
µµ! "
System
µµ# )
.
µµ) *
Drawing
µµ* 1
.
µµ1 2
Color
µµ2 7
.
µµ7 8
Red
µµ8 ;
	btnBuscar
∂∂ 
.
∂∂ 
Visible
∂∂ 
=
∂∂ 
False
∂∂  %
End
∑∑ 
Try
∑∑ 
End
∏∏ 
Sub
∏∏ 
Private
∫∫ 
Sub
∫∫ /
!cboxBusqueda_SelectedIndexChanged
∫∫ 1
(
∫∫1 2
sender
∫∫2 8
As
∫∫9 ;
Object
∫∫< B
,
∫∫B C
e
∫∫D E
As
∫∫F H
	EventArgs
∫∫I R
)
∫∫R S
Handles
∫∫T [
cboxBusqueda
∫∫\ h
.
∫∫h i"
SelectedIndexChanged
∫∫i }
TxtBusqueda
ªª 
.
ªª 
Text
ªª 
=
ªª 
$str
ªª 
If
ΩΩ 

cboxBusqueda
ΩΩ 
.
ΩΩ 
SelectedIndex
ΩΩ %
=
ΩΩ& '
$num
ΩΩ( )
Then
ΩΩ* .
TxtBusqueda
ææ 
.
ææ 
	MaxLength
ææ !
=
ææ" #
$num
ææ$ %
TxtBusqueda
øø 
.
øø 

Attributes
øø "
.
øø" #
Add
øø# &
(
øø& '
$str
øø' 0
,
øø0 1
$str
øø2 d
)
øød e
TxtBusqueda
¿¿ 
.
¿¿ 

Attributes
¿¿ "
.
¿¿" #
Add
¿¿# &
(
¿¿& '
$str
¿¿' 4
,
¿¿4 5
$str
¿¿6 T
)
¿¿T U
ElseIf
¬¬ 
cboxBusqueda
¬¬ 
.
¬¬ 
SelectedIndex
¬¬ )
=
¬¬* +
$num
¬¬, -
Then
¬¬. 2
TxtBusqueda
√√ 
.
√√ 
	MaxLength
√√ !
=
√√" #
$num
√√$ &
TxtBusqueda
ƒƒ 
.
ƒƒ 

Attributes
ƒƒ "
.
ƒƒ" #
Add
ƒƒ# &
(
ƒƒ& '
$str
ƒƒ' 0
,
ƒƒ0 1
$str
ƒƒ2 d
)
ƒƒd e
TxtBusqueda
≈≈ 
.
≈≈ 

Attributes
≈≈ "
.
≈≈" #
Add
≈≈# &
(
≈≈& '
$str
≈≈' 4
,
≈≈4 5
$str
≈≈6 Y
)
≈≈Y Z
ElseIf
«« 
cboxBusqueda
«« 
.
«« 
SelectedIndex
«« )
=
««* +
$num
««, -
Then
««. 2
TxtBusqueda
»» 
.
»» 
	MaxLength
»» !
=
»»" #
$num
»»$ &
TxtBusqueda
…… 
.
…… 

Attributes
…… "
.
……" #
Add
……# &
(
……& '
$str
……' 0
,
……0 1
$str
……2 d
)
……d e
TxtBusqueda
   
.
   

Attributes
   "
.
  " #
Add
  # &
(
  & '
$str
  ' 4
,
  4 5
$str
  6 K
)
  K L
ElseIf
ÃÃ 
cboxBusqueda
ÃÃ 
.
ÃÃ 
SelectedIndex
ÃÃ )
=
ÃÃ* +
$num
ÃÃ, -
Then
ÃÃ. 2
TxtBusqueda
ÕÕ 
.
ÕÕ 
	MaxLength
ÕÕ !
=
ÕÕ" #
$num
ÕÕ$ &
TxtBusqueda
ŒŒ 
.
ŒŒ 

Attributes
ŒŒ "
.
ŒŒ" #
Add
ŒŒ# &
(
ŒŒ& '
$str
ŒŒ' 0
,
ŒŒ0 1
$str
ŒŒ2 d
)
ŒŒd e
TxtBusqueda
œœ 
.
œœ 

Attributes
œœ "
.
œœ" #
Add
œœ# &
(
œœ& '
$str
œœ' 4
,
œœ4 5
$str
œœ6 J
)
œœJ K
ElseIf
—— 
cboxBusqueda
—— 
.
—— 
SelectedIndex
—— )
=
——* +
$num
——, -
Then
——. 2
TxtBusqueda
““ 
.
““ 
	MaxLength
““ !
=
““" #
$num
““$ &
TxtBusqueda
”” 
.
”” 

Attributes
”” "
.
””" #
Add
””# &
(
””& '
$str
””' 0
,
””0 1
$str
””2 d
)
””d e
TxtBusqueda
‘‘ 
.
‘‘ 

Attributes
‘‘ "
.
‘‘" #
Add
‘‘# &
(
‘‘& '
$str
‘‘' 4
,
‘‘4 5
$str
‘‘6 L
)
‘‘L M
ElseIf
÷÷ 
cboxBusqueda
÷÷ 
.
÷÷ 
SelectedIndex
÷÷ )
=
÷÷* +
$num
÷÷, -
Then
÷÷. 2
TxtBusqueda
◊◊ 
.
◊◊ 
	MaxLength
◊◊ !
=
◊◊" #
$num
◊◊$ &
TxtBusqueda
ÿÿ 
.
ÿÿ 

Attributes
ÿÿ "
.
ÿÿ" #
Add
ÿÿ# &
(
ÿÿ& '
$str
ÿÿ' 0
,
ÿÿ0 1
$str
ÿÿ2 d
)
ÿÿd e
End
ŸŸ 
If
ŸŸ 
End
⁄⁄ 
Sub
⁄⁄ 
Private
‹‹ 
Sub
‹‹ "
btnVerFichaDet_Click
‹‹ $
(
‹‹$ %
sender
‹‹% +
As
‹‹, .
Object
‹‹/ 5
,
‹‹5 6
e
‹‹7 8
As
‹‹9 ;
	EventArgs
‹‹< E
)
‹‹E F
Handles
‹‹G N
btnVerFichaDet
‹‹O ]
.
‹‹] ^
Click
‹‹^ c
Try
›› 
Dim
ﬁﬁ 
v_FormatoReporte
ﬁﬁ  
As
ﬁﬁ! #
String
ﬁﬁ$ *
=
ﬁﬁ+ ,
$str
ﬁﬁ- 2$
Exportar_Reporte_Libro
ﬂﬂ "
(
ﬂﬂ" #
v_FormatoReporte
ﬂﬂ# 3
,
ﬂﬂ3 4
$str
ﬂﬂ5 K
)
ﬂﬂK L
Catch
‡‡ 
ex
‡‡ 
As
‡‡ 
	Exception
‡‡ 

lbl_Valida
·· 
.
·· 
Text
·· 
=
·· 
ex
··  
.
··  !
Message
··! (

lbl_Valida
‚‚ 
.
‚‚ 
	ForeColor
‚‚  
=
‚‚! "
System
‚‚# )
.
‚‚) *
Drawing
‚‚* 1
.
‚‚1 2
Color
‚‚2 7
.
‚‚7 8
Red
‚‚8 ;
End
„„ 
Try
„„ 
End
‰‰ 
Sub
‰‰ 
Private
ÊÊ 
Sub
ÊÊ $
Exportar_Reporte_Libro
ÊÊ &
(
ÊÊ& '
ByVal
ÊÊ' ,
FormatoReporte
ÊÊ- ;
As
ÊÊ< >
String
ÊÊ? E
,
ÊÊE F
ByVal
ÊÊG L
v_TipoReporte
ÊÊM Z
As
ÊÊ[ ]
String
ÊÊ^ d
)
ÊÊd e
Dim
ËË 
vLibro
ËË 
As
ËË 
String
ËË 
Dim
ÈÈ 
vBandera
ÈÈ 
As
ÈÈ 
String
ÈÈ 
vLibro
ÎÎ 
=
ÎÎ 
Session
ÎÎ 
(
ÎÎ 
$str
ÎÎ -
)
ÎÎ- .
vBandera
ÏÏ 
=
ÏÏ 
$str
ÏÏ 
If
ÔÔ 

v_TipoReporte
ÔÔ 
=
ÔÔ 
$str
ÔÔ 1
Then
ÔÔ2 6
v_TipoReporte
 
=
 
$str
 2
ElseIf
ÒÒ 
v_TipoReporte
ÒÒ 
=
ÒÒ 
$str
ÒÒ <
Then
ÒÒ= A
v_TipoReporte
ÚÚ 
=
ÚÚ 
$str
ÚÚ 9
Else
ÛÛ 

lbl_Valida
ÙÙ 
.
ÙÙ 
	ForeColor
ÙÙ  
=
ÙÙ! "
System
ÙÙ# )
.
ÙÙ) *
Drawing
ÙÙ* 1
.
ÙÙ1 2
Color
ÙÙ2 7
.
ÙÙ7 8
Red
ÙÙ8 ;

lbl_Valida
ıı 
.
ıı 
Text
ıı 
=
ıı 
$str
ıı L
Exit
ˆˆ 
Sub
ˆˆ 
End
˜˜ 
If
˜˜ 
Dim
˙˙ #
ds_Consulta_Reporte01
˙˙ !
As
˙˙" $
DataSet
˙˙% ,
=
˙˙- .
cls_Metodos
˙˙/ :
.
˙˙: ;
BuscarLibro
˙˙; F
(
˙˙F G
vLibro
˙˙G M
,
˙˙M N
vBandera
˙˙O W
)
˙˙W X
Dim
˝˝ 
dtsFichaDetalle
˝˝ 
As
˝˝ 
New
˝˝ "
dtsFichaDetalle
˝˝# 2
(
˝˝2 3
)
˝˝3 4
For
ˇˇ 
Each
ˇˇ #
dr_Consulta_Reporte01
ˇˇ &
As
ˇˇ' )
DataRow
ˇˇ* 1
In
ˇˇ2 4#
ds_Consulta_Reporte01
ˇˇ5 J
.
ˇˇJ K
Tables
ˇˇK Q
(
ˇˇQ R
$num
ˇˇR S
)
ˇˇS T
.
ˇˇT U
Rows
ˇˇU Y
dtsFichaDetalle
Ä	Ä	 
.
Ä	Ä	 
Tables
Ä	Ä	 "
(
Ä	Ä	" #
$num
Ä	Ä	# $
)
Ä	Ä	$ %
.
Ä	Ä	% &
Rows
Ä	Ä	& *
.
Ä	Ä	* +
Add
Ä	Ä	+ .
(
Ä	Ä	. /#
dr_Consulta_Reporte01
Ä	Ä	/ D
.
Ä	Ä	D E
	ItemArray
Ä	Ä	E N
)
Ä	Ä	N O
Next
Å	Å	 

rv_General
É	É	 
.
É	É	 
ProcessingMode
É	É	 !
=
É	É	" #
ProcessingMode
É	É	$ 2
.
É	É	2 3
Local
É	É	3 8

rv_General
Ñ	Ñ	 
.
Ñ	Ñ	 
LocalReport
Ñ	Ñ	 
.
Ñ	Ñ	 

ReportPath
Ñ	Ñ	 )
=
Ñ	Ñ	* +
Server
Ñ	Ñ	, 2
.
Ñ	Ñ	2 3
MapPath
Ñ	Ñ	3 :
(
Ñ	Ñ	: ;
$str
Ñ	Ñ	; H
&
Ñ	Ñ	I J
v_TipoReporte
Ñ	Ñ	K X
&
Ñ	Ñ	Y Z
$str
Ñ	Ñ	[ b
)
Ñ	Ñ	b c
Dim
Ü	Ü	 
Movimiento_Rpt
Ü	Ü	 
As
Ü	Ü	 
New
Ü	Ü	 !
ReportDataSource
Ü	Ü	" 2
(
Ü	Ü	2 3
$str
Ü	Ü	3 K
,
Ü	Ü	K L
dtsFichaDetalle
Ü	Ü	M \
.
Ü	Ü	\ ]
Tables
Ü	Ü	] c
(
Ü	Ü	c d
$num
Ü	Ü	d e
)
Ü	Ü	e f
)
Ü	Ü	f g

rv_General
á	á	 
.
á	á	 
LocalReport
á	á	 
.
á	á	 
DataSources
á	á	 *
.
á	á	* +
Clear
á	á	+ 0
(
á	á	0 1
)
á	á	1 2

rv_General
à	à	 
.
à	à	 
LocalReport
à	à	 
.
à	à	 
DataSources
à	à	 *
.
à	à	* +
Add
à	à	+ .
(
à	à	. /
Movimiento_Rpt
à	à	/ =
)
à	à	= >
Dim
ã	ã	 
warnings
ã	ã	 
As
ã	ã	 
Warning
ã	ã	 
(
ã	ã	  
)
ã	ã	  !
=
ã	ã	" #
Nothing
ã	ã	$ +
Dim
å	å	 
	streamids
å	å	 
As
å	å	 
String
å	å	 
(
å	å	  
)
å	å	  !
=
å	å	" #
Nothing
å	å	$ +
Dim
ç	ç	 
mimeType
ç	ç	 
As
ç	ç	 
String
ç	ç	 
=
ç	ç	  
Nothing
ç	ç	! (
Dim
é	é	 
contentType
é	é	 
As
é	é	 
String
é	é	 !
=
é	é	" #
Nothing
é	é	$ +
Dim
è	è	 
encoding
è	è	 
As
è	è	 
String
è	è	 
=
è	è	  
Nothing
è	è	! (
Dim
ê	ê	 
	extension
ê	ê	 
As
ê	ê	 
String
ê	ê	 
=
ê	ê	  !
Nothing
ê	ê	" )
Dim
ì	ì	 
bytes
ì	ì	 
As
ì	ì	 
Byte
ì	ì	 
(
ì	ì	 
)
ì	ì	 
=
ì	ì	 

rv_General
ì	ì	 (
.
ì	ì	( )
LocalReport
ì	ì	) 4
.
ì	ì	4 5
Render
ì	ì	5 ;
(
ì	ì	; <
FormatoReporte
ì	ì	< J
,
ì	ì	J K
Nothing
ì	ì	L S
,
ì	ì	S T
mimeType
ì	ì	U ]
,
ì	ì	] ^
contentType
ì	ì	_ j
,
ì	ì	j k
encoding
ì	ì	l t
,
ì	ì	t u
	extension
ì	ì	v 
,ì	ì	 Ä
	streamidsì	ì	Å ä
,ì	ì	ä ã
warningsì	ì	å î
)ì	ì	î ï
Response
ñ	ñ	 
.
ñ	ñ	 
Clear
ñ	ñ	 
(
ñ	ñ	 
)
ñ	ñ	 
Response
ó	ó	 
.
ó	ó	 
Buffer
ó	ó	 
=
ó	ó	 
True
ó	ó	 
Response
ò	ò	 
.
ò	ò	 
Charset
ò	ò	 
=
ò	ò	 
$str
ò	ò	 
Response
ô	ô	 
.
ô	ô	 
Cache
ô	ô	 
.
ô	ô	 
SetCacheability
ô	ô	 &
(
ô	ô	& '
HttpCacheability
ô	ô	' 7
.
ô	ô	7 8
NoCache
ô	ô	8 ?
)
ô	ô	? @
Response
ö	ö	 
.
ö	ö	 
ContentType
ö	ö	 
=
ö	ö	 
contentType
ö	ö	 *
Response
õ	õ	 
.
õ	õ	 
AppendHeader
õ	õ	 
(
õ	õ	 
$str
õ	õ	 3
,
õ	õ	3 4
$str
õ	õ	5 L
&
õ	õ	M N
v_TipoReporte
õ	õ	O \
&
õ	õ	] ^
$str
õ	õ	_ b
&
õ	õ	c d
	extension
õ	õ	e n
)
õ	õ	n o
Response
ú	ú	 
.
ú	ú	 
BinaryWrite
ú	ú	 
(
ú	ú	 
bytes
ú	ú	 "
)
ú	ú	" #
Response
ù	ù	 
.
ù	ù	 
Flush
ù	ù	 
(
ù	ù	 
)
ù	ù	 
Response
û	û	 
.
û	û	 
End
û	û	 
(
û	û	 
)
û	û	 
End
ü	ü	 
Sub
ü	ü	 
End†	†	 
Class
†	†	 	∞ﬁ

lC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\frm_prestamoLibro.aspx.vb
Public 
Class 
frm_prestamoLibro 
Inherits 
System 
. 
Web 
. 
UI 
. 
Page 
	Protected

 
Sub

 
	Page_Load

 
(

 
ByVal

 !
sender

" (
As

) +
Object

, 2
,

2 3
ByVal

4 9
e

: ;
As

< >
System

? E
.

E F
	EventArgs

F O
)

O P
Handles

Q X
Me

Y [
.

[ \
Load

\ `
Session 
( 
$str 
) 
= 
$str ,
If 

f_validarSesion 
( 
) 
= 
True #
Then$ (
If 
Not 
Page 
. 

IsPostBack "
Then# '
Try 
If 
Session 
( 
$str ,
), -
=. /
$str0 3
Then4 8
cls_Metodos #
.# $
culture_info$ 0
(0 1
)1 2

Validacion "
(" #
$str# /
)/ 0
cargarLista50 %
(% &
)& '
Else 
cls_Metodos #
.# $
culture_info$ 0
(0 1
)1 2

Validacion "
(" #
$str# .
). /
cargarLista50 %
(% &
)& '
End 
If 
Catch 
ex 
As 
	Exception %"
lbl_LectorNoSeEncontro *
.* +
Text+ /
=0 1
ex2 4
.4 5
Message5 <"
lbl_LectorNoSeEncontro *
.* +
	ForeColor+ 4
=5 6
System7 =
.= >
Drawing> E
.E F
ColorF K
.K L
RedL O
End 
Try 
End 
If 
Else 
Session   
(   
$str   
)   
=   
$str    #
Response!! 
.!! 
Redirect!! 
(!! 
$str!! m
)!!m n
End"" 
If"" 
End## 
Sub## 
Public&& 

Function&& 
f_validarSesion&& #
(&&# $
)&&$ %
As&&& (
Boolean&&) 0
If'' 

Session'' 
('' 
$str'' !
)''! "
Is''# %
Nothing''& -
Then''. 2
Return(( 
False(( 
End)) 
If)) 
Return** 
True** 
End++ 
Function++ 
Private-- 
Sub-- 

Validacion-- 
(-- 
ByVal--  

Validacion--! +
As--, .
String--/ 5
)--5 6
Dim.. 
tupla_FechaHora.. 
As.. 
Tuple.. $
(..$ %
Of..% '
String..( .
,... /
String..0 6
)..6 7
=..8 9
Formato_Fecha_Hora..: L
(..L M
)..M N
Dim// 
dtHora// 
As// 
Date// 
=// 
Date// !
.//! "
Now//" %
Dim00 
hora00 
As00 
String00 
=00 
dtHora00 #
.00# $
Hour00$ (
.00( )
ToString00) 1
(001 2
$str002 6
)006 7
Dim11 
minuto11 
As11 
String11 
=11 
dtHora11 %
.11% &
Minute11& ,
.11, -
ToString11- 5
(115 6
$str116 :
)11: ;
Dim22 
segundo22 
As22 
String22 
=22 
dtHora22  &
.22& '
Second22' -
.22- .
ToString22. 6
(226 7
$str227 ;
)22; <
lbl_horaPrestamo33 
.33 
Text33 
=33 
hora33  $
&33% &
$str33' *
&33+ ,
minuto33- 3
&334 5
$str336 9
&33: ;
segundo33< C
If66 


Validacion66 
=66 
$str66 *
Then66+ /
btnCancelar88 
.88 
Enabled88 
=88  !
True88" &

btnGrabar299 
.99 
Enabled99 
=99  
False99! &

btnGrabar2:: 
.:: 
Visible:: 
=::  
True::! %
	btnGrabar;; 
.;; 
Visible;; 
=;; 
False;;  %
btnModificar<< 
.<< 
Enabled<<  
=<<! "
True<<# '
btn_BuscarPrestamo== 
.== 
Enabled== &
===' (
False==) .
btnModificar>> 
.>> 
Visible>>  
=>>! "
True>># '
	btnGrabar?? 
.?? 
Visible?? 
=?? 
False??  %
btnVerFicha2@@ 
.@@ 
Enabled@@  
=@@! "
True@@# '
txt_FechaPrestamoBB 
.BB 
ReadOnlyBB &
=BB' (
TrueBB) -
txt_FechaDevolucionCC 
.CC  
ReadOnlyCC  (
=CC) *
TrueCC+ /
txt_FechaReservaDD 
.DD 
ReadOnlyDD %
=DD& '
TrueDD( ,
cbox_EstadoPrestamoFF 
.FF  
EnabledFF  '
=FF( )
FalseFF* /
ElseIfGG 

ValidacionGG 
=GG 
$strGG %
ThenGG& *
btnCancelarII 
.II 
EnabledII 
=II  !
TrueII" &
	btnGrabarJJ 
.JJ 
EnabledJJ 
=JJ 
TrueJJ  $
	btnGrabarKK 
.KK 
VisibleKK 
=KK 
TrueKK  $

btnGrabar2LL 
.LL 
EnabledLL 
=LL  
FalseLL! &

btnGrabar2MM 
.MM 
VisibleMM 
=MM  
FalseMM! &
btnModificarNN 
.NN 
EnabledNN  
=NN! "
FalseNN# (
btn_BuscarPrestamoOO 
.OO 
EnabledOO &
=OO' (
FalseOO) .
	btnGrabarPP 
.PP 
EnabledPP 
=PP 
TruePP  $
btnCancelarQQ 
.QQ 
EnabledQQ 
=QQ  !
TrueQQ" &
btn_BuscarPrestamoRR 
.RR 
EnabledRR &
=RR' (
FalseRR) .
txt_FechaPrestamoTT 
.TT 
TextTT "
=TT# $
(TT% &
tupla_FechaHoraTT& 5
.TT5 6
Item1TT6 ;
)TT; <
ElseIfVV 

ValidacionVV 
=VV 
$strVV '
ThenVV( ,
IfXX 
rdb_devolucionXX 
.XX 
CheckedXX %
ThenXX& *
btnModificarYY 
.YY 
EnabledYY $
=YY% &
FalseYY' ,
btnCancelarZZ 
.ZZ 
EnabledZZ #
=ZZ$ %
TrueZZ& *

btnGrabar2[[ 
.[[ 
Enabled[[ "
=[[# $
True[[% )

btnGrabar2\\ 
.\\ 
Visible\\ "
=\\# $
True\\% )
	btnGrabar]] 
.]] 
Enabled]] !
=]]" #
False]]$ )
	btnGrabar^^ 
.^^ 
Visible^^ !
=^^" #
False^^$ )
btn_BuscarPrestamo__ "
.__" #
Enabled__# *
=__+ ,
False__- 2
txt_FechaPrestamoaa !
.aa! "
ReadOnlyaa" *
=aa+ ,
Falseaa- 2
txt_FechaDevolucionbb #
.bb# $
ReadOnlybb$ ,
=bb- .
Falsebb/ 4
txt_FechaReservacc  
.cc  !
ReadOnlycc! )
=cc* +
Falsecc, 1
cbox_EstadoPrestamoee #
.ee# $
Enabledee$ +
=ee, -
Trueee. 2
ElseIfgg #
rdb_PrestarReservasAnulgg *
.gg* +
Checkedgg+ 2
Thengg3 7
btnModificarhh 
.hh 
Enabledhh $
=hh% &
Falsehh' ,
btnCancelarii 
.ii 
Enabledii #
=ii$ %
Trueii& *

btnGrabar2jj 
.jj 
Enabledjj "
=jj# $
Truejj% )

btnGrabar2kk 
.kk 
Visiblekk "
=kk# $
Truekk% )
	btnGrabarll 
.ll 
Enabledll !
=ll" #
Falsell$ )
	btnGrabarmm 
.mm 
Visiblemm !
=mm" #
Falsemm$ )
btn_BuscarPrestamonn "
.nn" #
Enablednn# *
=nn+ ,
Falsenn- 2
btnMas8oo 
.oo 
Enabledoo 
=oo  !
Trueoo" &
txt_FechaPrestamopp !
.pp! "
ReadOnlypp" *
=pp+ ,
Falsepp- 2
txt_FechaDevolucionqq #
.qq# $
ReadOnlyqq$ ,
=qq- .
Falseqq/ 4
txt_FechaDevolucionrr #
.rr# $
Enabledrr$ +
=rr, -
Truerr. 2
txt_FechaReservass  
.ss  !
ReadOnlyss! )
=ss* +
Falsess, 1
cbox_EstadoPrestamott #
.tt# $
Enabledtt$ +
=tt, -
Truett. 2
Enduu 
Ifuu 
ElseIfww 

Validacionww 
=ww 
$strww '
Thenww( ,
txt_valorLectorxx 
.xx 
	MaxLengthxx %
=xx& '
$numxx( )
txt_valorLectoryy 
.yy 

Attributesyy &
.yy& '
Addyy' *
(yy* +
$stryy+ 4
,yy4 5
$stryy6 S
)yyS T
txt_ValorLibrozz 
.zz 
	MaxLengthzz $
=zz% &
$numzz' (
txt_ValorLibro{{ 
.{{ 

Attributes{{ %
.{{% &
Add{{& )
({{) *
$str{{* 3
,{{3 4
$str{{5 Z
){{Z [
txt_FechaPrestamo|| 
.|| 
Text|| "
=||# $
(||% &
tupla_FechaHora||& 5
.||5 6
Item1||6 ;
)||; <
Session~~ 
(~~ 
$str~~ 
)~~  
=~~! "
$str~~# &
Session 
( 
$str 
)  
=! "
$str# %
Session
ÄÄ 
(
ÄÄ 
$str
ÄÄ 
)
ÄÄ 
=
ÄÄ  !
$str
ÄÄ" $
txt_A_apeYNombres
ÇÇ 
.
ÇÇ 
Disabled
ÇÇ &
=
ÇÇ' (
True
ÇÇ) -
txt_A_tituloLibro
ÉÉ 
.
ÉÉ 
Disabled
ÉÉ &
=
ÉÉ' (
True
ÉÉ) -
txt_codEmpleado
ÑÑ 
.
ÑÑ 
Enabled
ÑÑ #
=
ÑÑ$ %
False
ÑÑ& +"
txt_A_NombreEmpleado
ÖÖ  
.
ÖÖ  !
Disabled
ÖÖ! )
=
ÖÖ* +
True
ÖÖ, 0"
txt_codRegistroLibro
ÜÜ  
.
ÜÜ  !
Enabled
ÜÜ! (
=
ÜÜ) *
False
ÜÜ+ 0
txt_A_Librotitulo
áá 
.
áá 
Disabled
áá &
=
áá' (
True
áá) -
txt_FechaReserva
àà 
.
àà 
ReadOnly
àà %
=
àà& '
True
àà( ,
txt_FechaReserva
ââ 
.
ââ 
Visible
ââ $
=
ââ% &
False
ââ' ,
lbl_fechaReserva
ää 
.
ää 
Visible
ää $
=
ää% &
False
ää' ,
chk_PProvincia
åå 
.
åå 
Enabled
åå "
=
åå# $
False
åå% *
chk_PEspecial
çç 
.
çç 
Enabled
çç !
=
çç" #
False
çç$ )!
cbox_EstadoPrestamo
èè 
.
èè  
SelectedValue
èè  -
=
èè. /
$str
èè0 3!
cbox_EstadoPrestamo
êê 
.
êê  
Enabled
êê  '
=
êê( )
False
êê* /(
btn_Limpiar_BusquedaLector
íí &
.
íí& '
Disabled
íí' /
=
íí0 1
False
íí2 7
btn_BuscarLector
ìì 
.
ìì 
Enabled
ìì $
=
ìì% &
True
ìì' +!
btn_HistorialLector
îî 
.
îî  
Enabled
îî  '
=
îî( )
False
îî* / 
btn_historialLibro
ïï 
.
ïï 
Enabled
ïï &
=
ïï' (
False
ïï) .
	fs_lector
óó 
.
óó 
Visible
óó 
=
óó 
False
óó  %
fs_libro
òò 
.
òò 
Visible
òò 
=
òò 
True
òò #
fs_seleccionados
ôô 
.
ôô 
Visible
ôô $
=
ôô% &
True
ôô' +
fs_prestLector
öö 
.
öö 
Visible
öö "
=
öö# $
False
öö% *
fs_prestLibro
õõ 
.
õõ 
Visible
õõ !
=
õõ" #
False
õõ$ )
fs_prestamo
úú 
.
úú 
Visible
úú 
=
úú  !
False
úú" '

fs_botones
ùù 
.
ùù 
Visible
ùù 
=
ùù  
False
ùù! &
	fs_buscar
ûû 
.
ûû 
Visible
ûû 
=
ûû 
False
ûû  %
fs_gvPrestamos
üü 
.
üü 
Visible
üü "
=
üü# $
False
üü% *
	btn_Libro
°° 
.
°° 

Attributes
°°  
.
°°  !
Add
°°! $
(
°°$ %
$str
°°% ,
,
°°, -
$str
°°. N
)
°°N O

btn_Lector
¢¢ 
.
¢¢ 

Attributes
¢¢ !
.
¢¢! "
Remove
¢¢" (
(
¢¢( )
$str
¢¢) 0
)
¢¢0 1

btn_Lector
££ 
.
££ 
Disabled
££ 
=
££  !
False
££" '
	btn_Libro
§§ 
.
§§ 
Disabled
§§ 
=
§§  
True
§§! %
btn_Prestamo
•• 
.
•• 
Disabled
•• !
=
••" #
False
••$ )
btn_Devolver
¶¶ 
.
¶¶ 
Visible
¶¶  
=
¶¶! "
False
¶¶# (!
btn_ReservasOAnular
ßß 
.
ßß  
Visible
ßß  '
=
ßß( )
False
ßß* /

btnGrabar2
®® 
.
®® 
Visible
®® 
=
®®  
False
®®! &
btnVerFicha
©© 
.
©© 
Enabled
©© 
=
©©  !
False
©©" '
btnModificar
™™ 
.
™™ 
Visible
™™  
=
™™! "
False
™™# (
	pnl_Visor
¨¨ 
.
¨¨ 
Visible
¨¨ 
=
¨¨ 
False
¨¨  %
ElseIf
ÆÆ 

Validacion
ÆÆ 
=
ÆÆ 
$str
ÆÆ (
Then
ÆÆ) -
Busqueda
ØØ 
(
ØØ 
$str
ØØ 
)
ØØ  %
rdb_PrestarReservasAnul
∞∞ #
.
∞∞# $
Checked
∞∞$ +
=
∞∞, -
True
∞∞. 2
txt_codEmpleado
±± 
.
±± 
Enabled
±± #
=
±±$ %
False
±±& +
txt_codEmpleado
≤≤ 
.
≤≤ 
Text
≤≤  
=
≤≤! "
Session
≤≤# *
(
≤≤* +
$str
≤≤+ @
)
≤≤@ A"
txt_A_NombreEmpleado
≥≥  
.
≥≥  !
Disabled
≥≥! )
=
≥≥* +
True
≥≥, 0"
txt_A_NombreEmpleado
¥¥  
.
¥¥  !
	InnerText
¥¥! *
=
¥¥+ ,
Session
¥¥- 4
(
¥¥4 5
$str
¥¥5 J
)
¥¥J K"
txt_codRegistroLibro
µµ  
.
µµ  !
Enabled
µµ! (
=
µµ) *
False
µµ+ 0"
txt_codRegistroLibro
∂∂  
.
∂∂  !
Text
∂∂! %
=
∂∂& '
Session
∂∂( /
(
∂∂/ 0
$str
∂∂0 F
)
∂∂F G
txt_A_Librotitulo
∑∑ 
.
∑∑ 
Disabled
∑∑ &
=
∑∑' (
True
∑∑) -
txt_A_Librotitulo
∏∏ 
.
∏∏ 
	InnerText
∏∏ '
=
∏∏( )
Session
∏∏* 1
(
∏∏1 2
$str
∏∏2 I
)
∏∏I J
txt_CodPrestamo2
∫∫ 
.
∫∫ 
Text
∫∫ !
=
∫∫" #
Session
∫∫$ +
(
∫∫+ ,
$str
∫∫, <
)
∫∫< =
lbl_IdPrestamo
ªª 
.
ªª 
Text
ªª 
=
ªª  !
Session
ªª" )
(
ªª) *
$str
ªª* :
)
ªª: ;
txt_CodPrestamo2
ºº 
.
ºº 
Enabled
ºº $
=
ºº% &
False
ºº' ,
txt_FechaPrestamo
ΩΩ 
.
ΩΩ 
Text
ΩΩ "
=
ΩΩ# $
(
ΩΩ% &
tupla_FechaHora
ΩΩ& 5
.
ΩΩ5 6
Item1
ΩΩ6 ;
)
ΩΩ; <
txt_FechaPrestamo
ææ 
.
ææ 
Enabled
ææ %
=
ææ& '
False
ææ( -!
txt_FechaDevolucion
øø 
.
øø  
Text
øø  $
=
øø% &
$str
øø' )!
txt_FechaDevolucion
¿¿ 
.
¿¿  
Enabled
¿¿  '
=
¿¿( )
True
¿¿* .
txt_FechaReserva
¡¡ 
.
¡¡ 
Enabled
¡¡ $
=
¡¡% &
False
¡¡' ,
txt_FechaReserva
¬¬ 
.
¬¬ 
Text
¬¬ !
=
¬¬" #
Session
¬¬$ +
(
¬¬+ ,
$str
¬¬, D
)
¬¬D E
btnMas8
ƒƒ 
.
ƒƒ 
Enabled
ƒƒ 
=
ƒƒ 
True
ƒƒ "
lbl_Busqueda
∆∆ 
.
∆∆ 
Text
∆∆ 
=
∆∆ 
$str
∆∆  "

lbl_Valida
«« 
.
«« 
Text
«« 
=
«« 
$str
««  
	lblNomDia
»» 
.
»» 
Text
»» 
=
»» 
$str
»» 
chk_PEspecial
   
.
   
Enabled
   !
=
  " #
False
  $ )
chk_PEspecial
ÀÀ 
.
ÀÀ 
Checked
ÀÀ !
=
ÀÀ" #
False
ÀÀ$ )
chk_PProvincia
ÃÃ 
.
ÃÃ 
Enabled
ÃÃ "
=
ÃÃ# $
False
ÃÃ% *
chk_PProvincia
ÕÕ 
.
ÕÕ 
Checked
ÕÕ "
=
ÕÕ# $
False
ÕÕ% *!
cbox_EstadoPrestamo
œœ 
.
œœ  
SelectedIndex
œœ  -
=
œœ. /
-
œœ0 1
$num
œœ1 2!
cbox_EstadoPrestamo
–– 
.
––  
Items
––  %
.
––% &
FindByValue
––& 1
(
––1 2
$str
––2 5
)
––5 6
.
––6 7
Selected
––7 ?
=
––@ A
True
––B F
	fs_lector
““ 
.
““ 
Visible
““ 
=
““ 
False
““  %
fs_libro
”” 
.
”” 
Visible
”” 
=
”” 
False
”” $
fs_seleccionados
‘‘ 
.
‘‘ 
Visible
‘‘ $
=
‘‘% &
True
‘‘' +
fs_prestLector
’’ 
.
’’ 
Visible
’’ "
=
’’# $
True
’’% )
fs_prestLibro
÷÷ 
.
÷÷ 
Visible
÷÷ !
=
÷÷" #
True
÷÷$ (
fs_prestamo
◊◊ 
.
◊◊ 
Visible
◊◊ 
=
◊◊  !
True
◊◊" &

fs_botones
ÿÿ 
.
ÿÿ 
Visible
ÿÿ 
=
ÿÿ  
True
ÿÿ! %
fs_gvPrestamos
ŸŸ 
.
ŸŸ 
Visible
ŸŸ "
=
ŸŸ# $
True
ŸŸ% )
	fs_buscar
⁄⁄ 
.
⁄⁄ 
Visible
⁄⁄ 
=
⁄⁄ 
True
⁄⁄  $

fs_botones
€€ 
.
€€ 
Visible
€€ 
=
€€  
False
€€! &
fs_seleccionados
‹‹ 
.
‹‹ 
Visible
‹‹ $
=
‹‹% &
False
‹‹' ,

btn_Lector
ﬁﬁ 
.
ﬁﬁ 
Visible
ﬁﬁ 
=
ﬁﬁ  
False
ﬁﬁ! &
	btn_Libro
ﬂﬂ 
.
ﬂﬂ 
Visible
ﬂﬂ 
=
ﬂﬂ 
False
ﬂﬂ  %
btn_Prestamo
‡‡ 
.
‡‡ 
Visible
‡‡  
=
‡‡! "
False
‡‡# (
btn_Devolver
·· 
.
·· 
Visible
··  
=
··! "
False
··# (!
btn_ReservasOAnular
‚‚ 
.
‚‚  
Visible
‚‚  '
=
‚‚( )
True
‚‚* . 
btn_BuscarPrestamo
„„ 
.
„„ 
Enabled
„„ &
=
„„' (
True
„„) - 
btn_BuscarPrestamo
‰‰ 
.
‰‰ 
Visible
‰‰ &
=
‰‰' (
True
‰‰) -
btnModificar
ÂÂ 
.
ÂÂ 
Visible
ÂÂ  
=
ÂÂ! "
False
ÂÂ# (

btnGrabar2
ÊÊ 
.
ÊÊ 
Visible
ÊÊ 
=
ÊÊ  
True
ÊÊ! %
btnVerFicha2
ÁÁ 
.
ÁÁ 
Visible
ÁÁ  
=
ÁÁ! "
True
ÁÁ# '
btnVerFicha2
ËË 
.
ËË 
Enabled
ËË  
=
ËË! "
False
ËË# (
btn_Prestamo
ÈÈ 
.
ÈÈ 
Disabled
ÈÈ !
=
ÈÈ" #
True
ÈÈ$ (

btn_Lector
ÍÍ 
.
ÍÍ 
Disabled
ÍÍ 
=
ÍÍ  !
True
ÍÍ" &
	btn_Libro
ÎÎ 
.
ÎÎ 
Disabled
ÎÎ 
=
ÎÎ  
True
ÎÎ! %!
btn_ReservasOAnular
ÏÏ 
.
ÏÏ  
Disabled
ÏÏ  (
=
ÏÏ) *
True
ÏÏ+ /!
btn_ReservasOAnular
ÌÌ 
.
ÌÌ  

Attributes
ÌÌ  *
.
ÌÌ* +
Add
ÌÌ+ .
(
ÌÌ. /
$str
ÌÌ/ 6
,
ÌÌ6 7
$str
ÌÌ8 X
)
ÌÌX Y!
cbox_EstadoPrestamo
ÓÓ 
.
ÓÓ  
Enabled
ÓÓ  '
=
ÓÓ( )
False
ÓÓ* / 
lbl_TituloPrestamo
ÔÔ 
.
ÔÔ 
Text
ÔÔ #
=
ÔÔ$ %
$str
ÔÔ& 0
txt_FechaPrestamo
 
.
 
Enabled
 %
=
& '
False
( -
ElseIf
ÚÚ 

Validacion
ÚÚ 
=
ÚÚ 
$str
ÚÚ %
Then
ÚÚ& *
txt_codEmpleado
ÛÛ 
.
ÛÛ 
ReadOnly
ÛÛ $
=
ÛÛ% &
True
ÛÛ' +"
txt_A_NombreEmpleado
ÙÙ  
.
ÙÙ  !
Disabled
ÙÙ! )
=
ÙÙ* +
True
ÙÙ, 0"
txt_codRegistroLibro
ıı  
.
ıı  !
ReadOnly
ıı! )
=
ıı* +
True
ıı, 0
txt_A_Librotitulo
ˆˆ 
.
ˆˆ 
Disabled
ˆˆ &
=
ˆˆ' (
True
ˆˆ) -
txt_FechaPrestamo
˜˜ 
.
˜˜ 
ReadOnly
˜˜ &
=
˜˜' (
True
˜˜) -!
txt_FechaDevolucion
¯¯ 
.
¯¯  
ReadOnly
¯¯  (
=
¯¯) *
True
¯¯+ /
btn_BuscarLector
˙˙ 
.
˙˙ 
Enabled
˙˙ $
=
˙˙% &
True
˙˙' +!
btn_HistorialLector
˚˚ 
.
˚˚  
Enabled
˚˚  '
=
˚˚( )
False
˚˚* /
	fs_lector
˝˝ 
.
˝˝ 
Visible
˝˝ 
=
˝˝ 
False
˝˝  %
fs_libro
˛˛ 
.
˛˛ 
Visible
˛˛ 
=
˛˛ 
False
˛˛ $
fs_seleccionados
ˇˇ 
.
ˇˇ 
Visible
ˇˇ $
=
ˇˇ% &
True
ˇˇ' +
fs_prestLector
ÄÄ 
.
ÄÄ 
Visible
ÄÄ "
=
ÄÄ# $
True
ÄÄ% )
fs_prestLibro
ÅÅ 
.
ÅÅ 
Visible
ÅÅ !
=
ÅÅ" #
True
ÅÅ$ (
fs_prestamo
ÇÇ 
.
ÇÇ 
Visible
ÇÇ 
=
ÇÇ  !
True
ÇÇ" &

fs_botones
ÉÉ 
.
ÉÉ 
Visible
ÉÉ 
=
ÉÉ  
True
ÉÉ! %
ElseIf
ÖÖ 

Validacion
ÖÖ 
=
ÖÖ 
$str
ÖÖ (
Then
ÖÖ) -
txt_A_apeYNombres
ÜÜ 
.
ÜÜ 
Disabled
ÜÜ &
=
ÜÜ' (
True
ÜÜ) -
txt_A_tituloLibro
áá 
.
áá 
Disabled
áá &
=
áá' (
True
áá) -
txt_codEmpleado
àà 
.
àà 
ReadOnly
àà $
=
àà% &
True
àà' +"
txt_A_NombreEmpleado
ââ  
.
ââ  !
Disabled
ââ! )
=
ââ* +
True
ââ, 0"
txt_codRegistroLibro
ää  
.
ää  !
ReadOnly
ää! )
=
ää* +
True
ää, 0
txt_A_Librotitulo
ãã 
.
ãã 
Disabled
ãã &
=
ãã' (
True
ãã) -
btn_BuscarLector
çç 
.
çç 
Enabled
çç $
=
çç% &
True
çç' +!
btn_HistorialLector
éé 
.
éé  
Enabled
éé  '
=
éé( )
False
éé* /
	fs_lector
êê 
.
êê 
Visible
êê 
=
êê 
False
êê  %
fs_libro
ëë 
.
ëë 
Visible
ëë 
=
ëë 
False
ëë $
fs_seleccionados
íí 
.
íí 
Visible
íí $
=
íí% &
True
íí' +
fs_prestLector
ìì 
.
ìì 
Visible
ìì "
=
ìì# $
True
ìì% )
fs_prestLibro
îî 
.
îî 
Visible
îî !
=
îî" #
True
îî$ (
fs_prestamo
ïï 
.
ïï 
Visible
ïï 
=
ïï  !
True
ïï" &
fs_gvPrestamos
ññ 
.
ññ 
Visible
ññ "
=
ññ# $
True
ññ% )

btn_Lector
òò 
.
òò 

Attributes
òò !
.
òò! "
Add
òò" %
(
òò% &
$str
òò& -
,
òò- .
$str
òò/ O
)
òòO P

btn_Lector
ôô 
.
ôô 
Disabled
ôô 
=
ôô  !
True
ôô" &
	btn_Libro
öö 
.
öö 
Disabled
öö 
=
öö  
False
öö! &
btn_Prestamo
õõ 
.
õõ 
Disabled
õõ !
=
õõ" #
False
õõ$ )
End
úú 
If
úú 
End
ùù 
Sub
ùù 
Private
°° 
Function
°°  
Formato_Fecha_Hora
°° '
(
°°' (
)
°°( )
As
°°* ,
Tuple
°°- 2
(
°°2 3
Of
°°3 5
String
°°6 <
,
°°< =
String
°°> D
)
°°D E
Dim
££ 
dd
££ 
As
££ 
String
££ 
=
££ 
Day
££ 
(
££ 
Now
££ "
)
££" #
If
§§ 

Len
§§ 
(
§§ 
dd
§§ 
)
§§ 
=
§§ 
$num
§§ 
Then
§§ 
dd
§§ 
=
§§  
$str
§§! $
&
§§% &
dd
§§' )
Dim
•• 
mm
•• 
As
•• 
String
•• 
=
•• 
Month
••  
(
••  !
Now
••! $
)
••$ %
If
¶¶ 

Len
¶¶ 
(
¶¶ 
mm
¶¶ 
)
¶¶ 
=
¶¶ 
$num
¶¶ 
Then
¶¶ 
mm
¶¶ 
=
¶¶  
$str
¶¶! $
&
¶¶% &
mm
¶¶' )
Dim
®® 
aaaa
®® 
As
®® 
String
®® 
=
®® 
Year
®® !
(
®®! "
Now
®®" %
)
®®% &
Dim
©© 
formato_Fecha
©© 
=
©© 
dd
©© 
&
©©  
$str
©©! $
&
©©% &
mm
©©' )
&
©©* +
$str
©©, /
&
©©0 1
aaaa
©©2 6
Dim
¨¨ 
hor
¨¨ 
As
¨¨ 
String
¨¨ 
=
¨¨ 
Hour
¨¨  
(
¨¨  !
Now
¨¨! $
)
¨¨$ %
Dim
≠≠ 
min
≠≠ 
As
≠≠ 
String
≠≠ 
=
≠≠ 
Minute
≠≠ "
(
≠≠" #
Now
≠≠# &
)
≠≠& '
Dim
ÆÆ 
seg
ÆÆ 
As
ÆÆ 
String
ÆÆ 
=
ÆÆ 
Second
ÆÆ "
(
ÆÆ" #
Now
ÆÆ# &
)
ÆÆ& '
If
∞∞ 

Len
∞∞ 
(
∞∞ 
hor
∞∞ 
)
∞∞ 
=
∞∞ 
$num
∞∞ 
Then
∞∞ 
hor
∞∞  
=
∞∞! "
$str
∞∞# &
&
∞∞' (
hor
∞∞) ,
If
±± 

Len
±± 
(
±± 
min
±± 
)
±± 
=
±± 
$num
±± 
Then
±± 
min
±±  
=
±±! "
$str
±±# &
&
±±' (
min
±±) ,
If
≤≤ 

Len
≤≤ 
(
≤≤ 
seg
≤≤ 
)
≤≤ 
=
≤≤ 
$num
≤≤ 
Then
≤≤ 
seg
≤≤  
=
≤≤! "
$str
≤≤# &
&
≤≤' (
seg
≤≤) ,
Dim
¥¥ 
formato_hora
¥¥ 
=
¥¥ 
hor
¥¥ 
&
¥¥  
$str
¥¥! $
&
¥¥% &
min
¥¥' *
&
¥¥+ ,
$str
¥¥- 0
&
¥¥1 2
seg
¥¥3 6
Return
µµ 
New
µµ 
Tuple
µµ 
(
µµ 
Of
µµ 
String
µµ "
,
µµ" #
String
µµ$ *
)
µµ* +
(
µµ+ ,
formato_Fecha
µµ, 9
,
µµ9 :
formato_hora
µµ; G
)
µµG H
End
∂∂ 
Function
∂∂ 
Private
ππ 
Sub
ππ $
btn_Lector_ServerClick
ππ &
(
ππ& '
sender
ππ' -
As
ππ. 0
Object
ππ1 7
,
ππ7 8
e
ππ9 :
As
ππ; =
	EventArgs
ππ> G
)
ππG H
Handles
ππI P

btn_Lector
ππQ [
.
ππ[ \
ServerClick
ππ\ g
	fs_lector
∫∫ 
.
∫∫ 
Visible
∫∫ 
=
∫∫ 
True
∫∫  
fs_libro
ªª 
.
ªª 
Visible
ªª 
=
ªª 
False
ªª  
fs_seleccionados
ºº 
.
ºº 
Visible
ºº  
=
ºº! "
True
ºº# '
fs_prestLector
ΩΩ 
.
ΩΩ 
Visible
ΩΩ 
=
ΩΩ  
False
ΩΩ! &
fs_prestLibro
ææ 
.
ææ 
Visible
ææ 
=
ææ 
False
ææ  %
fs_prestamo
øø 
.
øø 
Visible
øø 
=
øø 
False
øø #

fs_botones
¿¿ 
.
¿¿ 
Visible
¿¿ 
=
¿¿ 
False
¿¿ "
fs_gvPrestamos
¡¡ 
.
¡¡ 
Visible
¡¡ 
=
¡¡  
False
¡¡! &

btn_Lector
√√ 
.
√√ 

Attributes
√√ 
.
√√ 
Add
√√ !
(
√√! "
$str
√√" )
,
√√) *
$str
√√+ K
)
√√K L
	btn_Libro
ƒƒ 
.
ƒƒ 

Attributes
ƒƒ 
.
ƒƒ 
Remove
ƒƒ #
(
ƒƒ# $
$str
ƒƒ$ +
)
ƒƒ+ ,
btn_Prestamo
≈≈ 
.
≈≈ 

Attributes
≈≈ 
.
≈≈  
Remove
≈≈  &
(
≈≈& '
$str
≈≈' .
)
≈≈. /

btn_Lector
∆∆ 
.
∆∆ 
Disabled
∆∆ 
=
∆∆ 
True
∆∆ "
	btn_Libro
«« 
.
«« 
Disabled
«« 
=
«« 
False
«« "
btn_Prestamo
»» 
.
»» 
Disabled
»» 
=
»» 
False
»»  %
End
…… 
Sub
…… 
Private
ÀÀ 
Sub
ÀÀ #
btn_Libro_ServerClick
ÀÀ %
(
ÀÀ% &
sender
ÀÀ& ,
As
ÀÀ- /
Object
ÀÀ0 6
,
ÀÀ6 7
e
ÀÀ8 9
As
ÀÀ: <
	EventArgs
ÀÀ= F
)
ÀÀF G
Handles
ÀÀH O
	btn_Libro
ÀÀP Y
.
ÀÀY Z
ServerClick
ÀÀZ e
	fs_lector
ÃÃ 
.
ÃÃ 
Visible
ÃÃ 
=
ÃÃ 
False
ÃÃ !
fs_libro
ÕÕ 
.
ÕÕ 
Visible
ÕÕ 
=
ÕÕ 
True
ÕÕ 
fs_seleccionados
ŒŒ 
.
ŒŒ 
Visible
ŒŒ  
=
ŒŒ! "
True
ŒŒ# '
fs_prestLector
œœ 
.
œœ 
Visible
œœ 
=
œœ  
False
œœ! &
fs_prestLibro
–– 
.
–– 
Visible
–– 
=
–– 
False
––  %
fs_prestamo
—— 
.
—— 
Visible
—— 
=
—— 
False
—— #

fs_botones
““ 
.
““ 
Visible
““ 
=
““ 
False
““ "
fs_gvPrestamos
”” 
.
”” 
Visible
”” 
=
””  
False
””! &

btn_Lector
’’ 
.
’’ 

Attributes
’’ 
.
’’ 
Remove
’’ $
(
’’$ %
$str
’’% ,
)
’’, -
	btn_Libro
÷÷ 
.
÷÷ 

Attributes
÷÷ 
.
÷÷ 
Add
÷÷  
(
÷÷  !
$str
÷÷! (
,
÷÷( )
$str
÷÷* J
)
÷÷J K
btn_Prestamo
◊◊ 
.
◊◊ 

Attributes
◊◊ 
.
◊◊  
Remove
◊◊  &
(
◊◊& '
$str
◊◊' .
)
◊◊. /

btn_Lector
ÿÿ 
.
ÿÿ 
Disabled
ÿÿ 
=
ÿÿ 
False
ÿÿ #
	btn_Libro
ŸŸ 
.
ŸŸ 
Disabled
ŸŸ 
=
ŸŸ 
True
ŸŸ !
btn_Prestamo
⁄⁄ 
.
⁄⁄ 
Disabled
⁄⁄ 
=
⁄⁄ 
False
⁄⁄  %
End
€€ 
Sub
€€ 
Private
›› 
Sub
›› &
btn_Prestamo_ServerClick
›› (
(
››( )
sender
››) /
As
››0 2
Object
››3 9
,
››9 :
e
››; <
As
››= ?
	EventArgs
››@ I
)
››I J
Handles
››K R
btn_Prestamo
››S _
.
››_ `
ServerClick
››` k
If
ﬁﬁ 

Len
ﬁﬁ 
(
ﬁﬁ 
Trim
ﬁﬁ 
(
ﬁﬁ 
txt_A_apeYNombres
ﬁﬁ %
.
ﬁﬁ% &
	InnerText
ﬁﬁ& /
)
ﬁﬁ/ 0
)
ﬁﬁ0 1
=
ﬁﬁ2 3
$num
ﬁﬁ4 5
Or
ﬁﬁ6 8
Len
ﬁﬁ9 <
(
ﬁﬁ< =
Trim
ﬁﬁ= A
(
ﬁﬁA B
txt_A_tituloLibro
ﬁﬁB S
.
ﬁﬁS T
	InnerText
ﬁﬁT ]
)
ﬁﬁ] ^
)
ﬁﬁ^ _
=
ﬁﬁ` a
$num
ﬁﬁb c
Then
ﬁﬁd h
lbl_validaLibro
ﬂﬂ 
.
ﬂﬂ 
Visible
ﬂﬂ #
=
ﬂﬂ$ %
True
ﬂﬂ& *
lbl_validaLibro
‡‡ 
.
‡‡ 
	ForeColor
‡‡ %
=
‡‡& '
System
‡‡( .
.
‡‡. /
Drawing
‡‡/ 6
.
‡‡6 7
Color
‡‡7 <
.
‡‡< =
Red
‡‡= @
lbl_validaLibro
·· 
.
·· 
Text
··  
=
··! "
$str
··# B
Else
‚‚ 
	fs_lector
„„ 
.
„„ 
Visible
„„ 
=
„„ 
False
„„  %
fs_libro
‰‰ 
.
‰‰ 
Visible
‰‰ 
=
‰‰ 
False
‰‰ $
fs_seleccionados
ÂÂ 
.
ÂÂ 
Visible
ÂÂ $
=
ÂÂ% &
True
ÂÂ' +
fs_prestamo
ÊÊ 
.
ÊÊ 
Visible
ÊÊ 
=
ÊÊ  !
True
ÊÊ" &
fs_prestLector
ÁÁ 
.
ÁÁ 
Visible
ÁÁ "
=
ÁÁ# $
True
ÁÁ% )
fs_prestLibro
ËË 
.
ËË 
Visible
ËË !
=
ËË" #
True
ËË$ (

fs_botones
ÈÈ 
.
ÈÈ 
Visible
ÈÈ 
=
ÈÈ  
True
ÈÈ! %
	fs_buscar
ÍÍ 
.
ÍÍ 
Visible
ÍÍ 
=
ÍÍ 
False
ÍÍ  %
fs_gvPrestamos
ÎÎ 
.
ÎÎ 
Visible
ÎÎ "
=
ÎÎ# $
False
ÎÎ% *

btn_Lector
ÌÌ 
.
ÌÌ 

Attributes
ÌÌ !
.
ÌÌ! "
Remove
ÌÌ" (
(
ÌÌ( )
$str
ÌÌ) 0
)
ÌÌ0 1
	btn_Libro
ÓÓ 
.
ÓÓ 

Attributes
ÓÓ  
.
ÓÓ  !
Remove
ÓÓ! '
(
ÓÓ' (
$str
ÓÓ( /
)
ÓÓ/ 0
btn_Prestamo
ÔÔ 
.
ÔÔ 

Attributes
ÔÔ #
.
ÔÔ# $
Add
ÔÔ$ '
(
ÔÔ' (
$str
ÔÔ( /
,
ÔÔ/ 0
$str
ÔÔ1 Q
)
ÔÔQ R

btn_Lector
 
.
 
Disabled
 
=
  !
False
" '
	btn_Libro
ÒÒ 
.
ÒÒ 
Disabled
ÒÒ 
=
ÒÒ  
False
ÒÒ! &
btn_Prestamo
ÚÚ 
.
ÚÚ 
Disabled
ÚÚ !
=
ÚÚ" #
True
ÚÚ$ (
Dim
ÙÙ 
	dt_NumReg
ÙÙ 
As
ÙÙ 
	DataTable
ÙÙ &
=
ÙÙ' (
cls_Metodos
ÙÙ) 4
.
ÙÙ4 5*
validacionContadorIdPrestamo
ÙÙ5 Q
.
ÙÙQ R
Tables
ÙÙR X
(
ÙÙX Y
$num
ÙÙY Z
)
ÙÙZ [
Dim
ıı 
vValor_Maximo
ıı 
As
ıı  
String
ıı! '
=
ıı( )
Val
ıı* -
(
ıı- .
	dt_NumReg
ıı. 7
.
ıı7 8
Rows
ıı8 <
(
ıı< =
$num
ıı= >
)
ıı> ?
(
ıı? @
$str
ıı@ I
)
ııI J
)
ııJ K
.
ııK L
ToString
ııL T
(
ııT U
)
ııU V
txt_CodPrestamo2
˜˜ 
.
˜˜ 
Text
˜˜ !
=
˜˜" #
vValor_Maximo
˜˜$ 1
+
˜˜2 3
$num
˜˜4 5
chk_PProvincia
¯¯ 
.
¯¯ 
Enabled
¯¯ "
=
¯¯# $
True
¯¯% )
chk_PEspecial
˘˘ 
.
˘˘ 
Enabled
˘˘ !
=
˘˘" #
True
˘˘$ (
End
˙˙ 
If
˙˙ 
End
˚˚ 
Sub
˚˚ 
	Protected
˛˛ 
Sub
˛˛ '
rdb_NuevoPrestamo_Checked
˛˛ +
(
˛˛+ ,
ByVal
˛˛, 1
sender
˛˛2 8
As
˛˛9 ;
Object
˛˛< B
,
˛˛B C
ByVal
˛˛D I
e
˛˛J K
As
˛˛L N
	EventArgs
˛˛O X
)
˛˛X Y
Handles
˛˛Z a
rdb_NuevoPrestamo
˛˛b s
.
˛˛s t
CheckedChanged˛˛t Ç
Response
ˇˇ 
.
ˇˇ 
Redirect
ˇˇ 
(
ˇˇ 
$str
ˇˇ 2
)
ˇˇ2 3
End
ÄÄ 
Sub
ÄÄ 
	Protected
ÉÉ 
Sub
ÉÉ $
rdb_devolucion_Checked
ÉÉ (
(
ÉÉ( )
ByVal
ÉÉ) .
sender
ÉÉ/ 5
As
ÉÉ6 8
Object
ÉÉ9 ?
,
ÉÉ? @
ByVal
ÉÉA F
e
ÉÉG H
As
ÉÉI K
	EventArgs
ÉÉL U
)
ÉÉU V
Handles
ÉÉW ^
rdb_devolucion
ÉÉ_ m
.
ÉÉm n
CheckedChanged
ÉÉn |
txt_CodPrestamo2
ÖÖ 
.
ÖÖ 
Text
ÖÖ 
=
ÖÖ 
$str
ÖÖ  "
txt_FechaPrestamo
ÜÜ 
.
ÜÜ 
Text
ÜÜ 
=
ÜÜ  
$str
ÜÜ! #!
txt_FechaDevolucion
áá 
.
áá 
Text
áá  
=
áá! "
$str
áá# %
lbl_Busqueda
àà 
.
àà 
Text
àà 
=
àà 
$str
àà 

lbl_Valida
ââ 
.
ââ 
Text
ââ 
=
ââ 
$str
ââ 
	lblNomDia
ää 
.
ää 
Text
ää 
=
ää 
$str
ää 
chk_PEspecial
åå 
.
åå 
Enabled
åå 
=
åå 
False
åå  %
chk_PEspecial
çç 
.
çç 
Checked
çç 
=
çç 
False
çç  %
chk_PProvincia
éé 
.
éé 
Enabled
éé 
=
éé  
False
éé! &
chk_PProvincia
èè 
.
èè 
Checked
èè 
=
èè  
False
èè! &!
cbox_EstadoPrestamo
ëë 
.
ëë 
SelectedIndex
ëë )
=
ëë* +
-
ëë, -
$num
ëë- .!
cbox_EstadoPrestamo
íí 
.
íí 
Items
íí !
.
íí! "
FindByValue
íí" -
(
íí- .
$str
íí. 1
)
íí1 2
.
íí2 3
Selected
íí3 ;
=
íí< =
True
íí> B
	fs_lector
îî 
.
îî 
Visible
îî 
=
îî 
False
îî !
fs_libro
ïï 
.
ïï 
Visible
ïï 
=
ïï 
False
ïï  
fs_seleccionados
ññ 
.
ññ 
Visible
ññ  
=
ññ! "
True
ññ# '
fs_prestLector
óó 
.
óó 
Visible
óó 
=
óó  
True
óó! %
fs_prestLibro
òò 
.
òò 
Visible
òò 
=
òò 
True
òò  $
fs_prestamo
ôô 
.
ôô 
Visible
ôô 
=
ôô 
True
ôô "

fs_botones
öö 
.
öö 
Visible
öö 
=
öö 
True
öö !
fs_gvPrestamos
õõ 
.
õõ 
Visible
õõ 
=
õõ  
True
õõ! %
	fs_buscar
úú 
.
úú 
Visible
úú 
=
úú 
True
úú  

fs_botones
ùù 
.
ùù 
Visible
ùù 
=
ùù 
False
ùù "
fs_seleccionados
ûû 
.
ûû 
Visible
ûû  
=
ûû! "
False
ûû# (

btn_Lector
†† 
.
†† 
Visible
†† 
=
†† 
False
†† "
	btn_Libro
°° 
.
°° 
Visible
°° 
=
°° 
False
°° !
btn_Prestamo
¢¢ 
.
¢¢ 
Visible
¢¢ 
=
¢¢ 
False
¢¢ $
btn_Devolver
££ 
.
££ 
Visible
££ 
=
££ 
True
££ #!
btn_ReservasOAnular
§§ 
.
§§ 
Visible
§§ #
=
§§$ %
False
§§& + 
btn_BuscarPrestamo
•• 
.
•• 
Enabled
•• "
=
••# $
True
••% ) 
btn_BuscarPrestamo
¶¶ 
.
¶¶ 
Visible
¶¶ "
=
¶¶# $
True
¶¶% )
btnModificar
ßß 
.
ßß 
Visible
ßß 
=
ßß 
False
ßß $

btnGrabar2
®® 
.
®® 
Visible
®® 
=
®® 
False
®® "
btnVerFicha2
©© 
.
©© 
Visible
©© 
=
©© 
True
©© #
btnVerFicha2
™™ 
.
™™ 
Enabled
™™ 
=
™™ 
False
™™ $
btn_Prestamo
´´ 
.
´´ 
Disabled
´´ 
=
´´ 
True
´´  $

btn_Lector
¨¨ 
.
¨¨ 
Disabled
¨¨ 
=
¨¨ 
True
¨¨ "
	btn_Libro
≠≠ 
.
≠≠ 
Disabled
≠≠ 
=
≠≠ 
True
≠≠ !
btn_Devolver
ÆÆ 
.
ÆÆ 
Disabled
ÆÆ 
=
ÆÆ 
True
ÆÆ  $
btn_Devolver
ØØ 
.
ØØ 

Attributes
ØØ 
.
ØØ  
Add
ØØ  #
(
ØØ# $
$str
ØØ$ +
,
ØØ+ ,
$str
ØØ- M
)
ØØM N

btn_Lector
∞∞ 
.
∞∞ 

Attributes
∞∞ 
.
∞∞ 
Remove
∞∞ $
(
∞∞$ %
$str
∞∞% ,
)
∞∞, -
	btn_Libro
±± 
.
±± 

Attributes
±± 
.
±± 
Remove
±± #
(
±±# $
$str
±±$ +
)
±±+ ,!
cbox_EstadoPrestamo
≥≥ 
.
≥≥ 
Enabled
≥≥ #
=
≥≥$ %
False
≥≥& + 
lbl_TituloPrestamo
µµ 
.
µµ 
Text
µµ 
=
µµ  !
$str
µµ" ,
txt_FechaPrestamo
∑∑ 
.
∑∑ 
Text
∑∑ 
=
∑∑  
$str
∑∑! #
txt_FechaPrestamo
∏∏ 
.
∏∏ 
Enabled
∏∏ !
=
∏∏" #
False
∏∏$ )!
txt_FechaDevolucion
ππ 
.
ππ 
Text
ππ  
=
ππ! "
$str
ππ# %!
txt_FechaDevolucion
∫∫ 
.
∫∫ 
Enabled
∫∫ #
=
∫∫$ %
False
∫∫& +
btnMas8
ªª 
.
ªª 
Enabled
ªª 
=
ªª 
False
ªª 
txt_codEmpleado
ºº 
.
ºº 
Text
ºº 
=
ºº 
$str
ºº !"
txt_A_NombreEmpleado
ΩΩ 
.
ΩΩ 
	InnerText
ΩΩ &
=
ΩΩ' (
$str
ΩΩ) +"
txt_codRegistroLibro
ææ 
.
ææ 
Text
ææ !
=
ææ" #
$str
ææ$ &
txt_A_Librotitulo
øø 
.
øø 
	InnerText
øø #
=
øø$ %
$str
øø& (
txt_A_apeYNombres
¿¿ 
.
¿¿ 
	InnerText
¿¿ #
=
¿¿$ %
$str
¿¿& (
txt_A_tituloLibro
¡¡ 
.
¡¡ 
	InnerText
¡¡ #
=
¡¡$ %
$str
¡¡& (
cargarLista50
¬¬ 
(
¬¬ 
)
¬¬ 
End
√√ 
Sub
√√ 
	Protected
≈≈ 
Sub
≈≈ -
rdb_PrestarReservasAnul_Checked
≈≈ 1
(
≈≈1 2
ByVal
≈≈2 7
sender
≈≈8 >
As
≈≈? A
Object
≈≈B H
,
≈≈H I
ByVal
≈≈J O
e
≈≈P Q
As
≈≈R T
	EventArgs
≈≈U ^
)
≈≈^ _
Handles
≈≈` g%
rdb_PrestarReservasAnul
≈≈h 
.≈≈ Ä
CheckedChanged≈≈Ä é
txt_CodPrestamo2
∆∆ 
.
∆∆ 
Text
∆∆ 
=
∆∆ 
$str
∆∆  "
txt_FechaPrestamo
«« 
.
«« 
Text
«« 
=
««  
$str
««! #!
txt_FechaDevolucion
»» 
.
»» 
Text
»»  
=
»»! "
$str
»»# %
lbl_Busqueda
…… 
.
…… 
Text
…… 
=
…… 
$str
…… 

lbl_Valida
   
.
   
Text
   
=
   
$str
   
	lblNomDia
ÀÀ 
.
ÀÀ 
Text
ÀÀ 
=
ÀÀ 
$str
ÀÀ 
chk_PEspecial
ÕÕ 
.
ÕÕ 
Enabled
ÕÕ 
=
ÕÕ 
False
ÕÕ  %
chk_PEspecial
ŒŒ 
.
ŒŒ 
Checked
ŒŒ 
=
ŒŒ 
False
ŒŒ  %
chk_PProvincia
œœ 
.
œœ 
Enabled
œœ 
=
œœ  
False
œœ! &
chk_PProvincia
–– 
.
–– 
Checked
–– 
=
––  
False
––! &
	fs_lector
““ 
.
““ 
Visible
““ 
=
““ 
False
““ !
fs_libro
”” 
.
”” 
Visible
”” 
=
”” 
False
””  
fs_seleccionados
‘‘ 
.
‘‘ 
Visible
‘‘  
=
‘‘! "
True
‘‘# '
fs_prestLector
’’ 
.
’’ 
Visible
’’ 
=
’’  
True
’’! %
fs_prestLibro
÷÷ 
.
÷÷ 
Visible
÷÷ 
=
÷÷ 
True
÷÷  $
fs_prestamo
◊◊ 
.
◊◊ 
Visible
◊◊ 
=
◊◊ 
True
◊◊ "

fs_botones
ÿÿ 
.
ÿÿ 
Visible
ÿÿ 
=
ÿÿ 
True
ÿÿ !
fs_gvPrestamos
ŸŸ 
.
ŸŸ 
Visible
ŸŸ 
=
ŸŸ  
True
ŸŸ! %
	fs_buscar
⁄⁄ 
.
⁄⁄ 
Visible
⁄⁄ 
=
⁄⁄ 
True
⁄⁄  

fs_botones
€€ 
.
€€ 
Visible
€€ 
=
€€ 
False
€€ "
fs_seleccionados
‹‹ 
.
‹‹ 
Visible
‹‹  
=
‹‹! "
False
‹‹# (

btn_Lector
ﬁﬁ 
.
ﬁﬁ 
Visible
ﬁﬁ 
=
ﬁﬁ 
False
ﬁﬁ "
	btn_Libro
ﬂﬂ 
.
ﬂﬂ 
Visible
ﬂﬂ 
=
ﬂﬂ 
False
ﬂﬂ !
btn_Prestamo
‡‡ 
.
‡‡ 
Visible
‡‡ 
=
‡‡ 
False
‡‡ $
btn_Devolver
·· 
.
·· 
Visible
·· 
=
·· 
False
·· $!
btn_ReservasOAnular
‚‚ 
.
‚‚ 
Visible
‚‚ #
=
‚‚$ %
True
‚‚& * 
btn_BuscarPrestamo
„„ 
.
„„ 
Enabled
„„ "
=
„„# $
True
„„% )!
cbox_EstadoPrestamo
‰‰ 
.
‰‰ 
SelectedValue
‰‰ )
=
‰‰* +
$str
‰‰, 0!
cbox_EstadoPrestamo
ÂÂ 
.
ÂÂ 
Enabled
ÂÂ #
=
ÂÂ$ %
False
ÂÂ& +
txt_FechaPrestamo
ÊÊ 
.
ÊÊ 
Enabled
ÊÊ !
=
ÊÊ" #
False
ÊÊ$ )!
txt_FechaDevolucion
ÁÁ 
.
ÁÁ 
Enabled
ÁÁ #
=
ÁÁ$ %
False
ÁÁ& +
btnMas8
ËË 
.
ËË 
Enabled
ËË 
=
ËË 
False
ËË 

btnGrabar2
ÈÈ 
.
ÈÈ 
Visible
ÈÈ 
=
ÈÈ 
False
ÈÈ "
btnModificar
ÍÍ 
.
ÍÍ 
Visible
ÍÍ 
=
ÍÍ 
False
ÍÍ $
btnVerFicha2
ÎÎ 
.
ÎÎ 
Enabled
ÎÎ 
=
ÎÎ 
False
ÎÎ $
btnVerFicha2
ÏÏ 
.
ÏÏ 
Visible
ÏÏ 
=
ÏÏ 
True
ÏÏ #
btn_Prestamo
ÌÌ 
.
ÌÌ 
Disabled
ÌÌ 
=
ÌÌ 
True
ÌÌ  $

btn_Lector
ÓÓ 
.
ÓÓ 
Disabled
ÓÓ 
=
ÓÓ 
True
ÓÓ "
	btn_Libro
ÔÔ 
.
ÔÔ 
Disabled
ÔÔ 
=
ÔÔ 
True
ÔÔ !!
btn_ReservasOAnular
 
.
 
Disabled
 $
=
% &
True
' +!
btn_ReservasOAnular
ÒÒ 
.
ÒÒ 

Attributes
ÒÒ &
.
ÒÒ& '
Add
ÒÒ' *
(
ÒÒ* +
$str
ÒÒ+ 2
,
ÒÒ2 3
$str
ÒÒ4 T
)
ÒÒT U

btn_Lector
ÚÚ 
.
ÚÚ 

Attributes
ÚÚ 
.
ÚÚ 
Remove
ÚÚ $
(
ÚÚ$ %
$str
ÚÚ% ,
)
ÚÚ, -
	btn_Libro
ÛÛ 
.
ÛÛ 

Attributes
ÛÛ 
.
ÛÛ 
Remove
ÛÛ #
(
ÛÛ# $
$str
ÛÛ$ +
)
ÛÛ+ , 
lbl_TituloPrestamo
ıı 
.
ıı 
Text
ıı 
=
ıı  !
$str
ıı" 4
txt_codEmpleado
˜˜ 
.
˜˜ 
Text
˜˜ 
=
˜˜ 
$str
˜˜ !"
txt_A_NombreEmpleado
¯¯ 
.
¯¯ 
	InnerText
¯¯ &
=
¯¯' (
$str
¯¯) +"
txt_codRegistroLibro
˘˘ 
.
˘˘ 
Text
˘˘ !
=
˘˘" #
$str
˘˘$ &
txt_A_Librotitulo
˙˙ 
.
˙˙ 
	InnerText
˙˙ #
=
˙˙$ %
$str
˙˙& (
txt_A_apeYNombres
˚˚ 
.
˚˚ 
	InnerText
˚˚ #
=
˚˚$ %
$str
˚˚& (
txt_A_tituloLibro
¸¸ 
.
¸¸ 
	InnerText
¸¸ #
=
¸¸$ %
$str
¸¸& (
cargarLista50
˝˝ 
(
˝˝ 
)
˝˝ 
End
˛˛ 
Sub
˛˛ 
	Protected
ÇÇ 
Sub
ÇÇ $
btn_BuscarLector_Click
ÇÇ (
(
ÇÇ( )
sender
ÇÇ) /
As
ÇÇ0 2
Object
ÇÇ3 9
,
ÇÇ9 :
e
ÇÇ; <
As
ÇÇ= ?
	EventArgs
ÇÇ@ I
)
ÇÇI J
Handles
ÇÇK R
btn_BuscarLector
ÇÇS c
.
ÇÇc d
Click
ÇÇd i
Session
ÉÉ 
(
ÉÉ 
$str
ÉÉ 
)
ÉÉ 
=
ÉÉ 
$str
ÉÉ "
Session
ÑÑ 
(
ÑÑ 
$str
ÑÑ 
)
ÑÑ 
=
ÑÑ 
$str
ÑÑ !
Session
ÖÖ 
(
ÖÖ 
$str
ÖÖ 
)
ÖÖ 
=
ÖÖ 
$str
ÖÖ  
Dim
ÜÜ 
tipoBusqueda
ÜÜ 
As
ÜÜ 
String
ÜÜ "
=
ÜÜ# $
$str
ÜÜ% -
Try
áá 
Busqueda
àà 
(
àà 
tipoBusqueda
àà !
)
àà! "
lbl_Busqueda
ââ 
.
ââ 
Text
ââ 
=
ââ 
txt_valorLector
ââ  /
.
ââ/ 0
Text
ââ0 4
Catch
ää 
ex
ää 
As
ää 
	Exception
ää 

lbl_Valida
ãã 
.
ãã 
Text
ãã 
=
ãã 
ex
ãã  
.
ãã  !
Message
ãã! (

lbl_Valida
åå 
.
åå 
	ForeColor
åå  
=
åå! "
System
åå# )
.
åå) *
Drawing
åå* 1
.
åå1 2
Color
åå2 7
.
åå7 8
Red
åå8 ;
btn_BuscarLector
çç 
.
çç 
Visible
çç $
=
çç% &
False
çç' ,
End
éé 
Try
éé 
End
èè 
Sub
èè 
	Protected
íí 
Sub
íí #
btn_BuscarLibro_Click
íí '
(
íí' (
sender
íí( .
As
íí/ 1
Object
íí2 8
,
íí8 9
e
íí: ;
As
íí< >
	EventArgs
íí? H
)
ííH I
Handles
ííJ Q
btn_BuscarLibro
ííR a
.
íía b
Click
ííb g
Dim
ìì 
tipoBusqueda
ìì 
As
ìì 
String
ìì "
=
ìì# $
$str
ìì% ,
Try
îî 
Busqueda
ïï 
(
ïï 
tipoBusqueda
ïï !
)
ïï! "
lbl_Busqueda
ññ 
.
ññ 
Text
ññ 
=
ññ 
txt_valorLector
ññ  /
.
ññ/ 0
Text
ññ0 4
Catch
óó 
ex
óó 
As
óó 
	Exception
óó 

lbl_Valida
òò 
.
òò 
Text
òò 
=
òò 
ex
òò  
.
òò  !
Message
òò! (

lbl_Valida
ôô 
.
ôô 
	ForeColor
ôô  
=
ôô! "
System
ôô# )
.
ôô) *
Drawing
ôô* 1
.
ôô1 2
Color
ôô2 7
.
ôô7 8
Red
ôô8 ;
btn_BuscarLector
öö 
.
öö 
Visible
öö $
=
öö% &
False
öö' ,
End
õõ 
Try
õõ 
End
úú 
Sub
úú 
	Protected
üü 
Sub
üü &
btn_BuscarPrestamo_Click
üü *
(
üü* +
sender
üü+ 1
As
üü2 4
Object
üü5 ;
,
üü; <
e
üü= >
As
üü? A
	EventArgs
üüB K
)
üüK L
Handles
üüM T 
btn_BuscarPrestamo
üüU g
.
üüg h
Click
üüh m
Session
†† 
(
†† 
$str
†† 
)
†† 
=
†† 
$str
†† "
Session
°° 
(
°° 
$str
°° 
)
°° 
=
°° 
$str
°° !
Session
¢¢ 
(
¢¢ 
$str
¢¢ 
)
¢¢ 
=
¢¢ 
$str
¢¢  
Dim
££ 
tipoBusqueda
££ 
As
££ 
String
££ "
=
££# $
$str
££% /
Try
§§ 
Busqueda
•• 
(
•• 
tipoBusqueda
•• !
)
••! "
lbl_Busqueda
¶¶ 
.
¶¶ 
Text
¶¶ 
=
¶¶ 
txt_valorLector
¶¶  /
.
¶¶/ 0
Text
¶¶0 4
Catch
ßß 
ex
ßß 
As
ßß 
	Exception
ßß 

lbl_Valida
®® 
.
®® 
Text
®® 
=
®® 
ex
®®  
.
®®  !
Message
®®! (

lbl_Valida
©© 
.
©© 
	ForeColor
©©  
=
©©! "
System
©©# )
.
©©) *
Drawing
©©* 1
.
©©1 2
Color
©©2 7
.
©©7 8
Red
©©8 ;
btn_BuscarLector
™™ 
.
™™ 
Visible
™™ $
=
™™% &
False
™™' ,
End
´´ 
Try
´´ 
End
¨¨ 
Sub
¨¨ 
	Protected
ØØ 
Sub
ØØ 
btnGrabar_Click
ØØ !
(
ØØ! "
ByVal
ØØ" '
sender
ØØ( .
As
ØØ/ 1
Object
ØØ2 8
,
ØØ8 9
ByVal
ØØ: ?
e
ØØ@ A
As
ØØB D
	EventArgs
ØØE N
)
ØØN O
Handles
ØØP W
	btnGrabar
ØØX a
.
ØØa b
Click
ØØb g
Try
∞∞ 
Call
±± 
grabar
±± 
(
±± 
$str
±± !
)
±±! "
Catch
≤≤ 
ex
≤≤ 
As
≤≤ 
	Exception
≤≤ "
lbl_validaNuevoPrest
≥≥  
.
≥≥  !
Text
≥≥! %
=
≥≥& '
ex
≥≥( *
.
≥≥* +
Message
≥≥+ 2"
lbl_validaNuevoPrest
¥¥  
.
¥¥  !
	ForeColor
¥¥! *
=
¥¥+ ,
Drawing
¥¥- 4
.
¥¥4 5
Color
¥¥5 :
.
¥¥: ;
Red
¥¥; >
End
µµ 
Try
µµ 
End
∂∂ 
Sub
∂∂ 
	Protected
ππ 
Sub
ππ 
btnGrabar2_Click
ππ "
(
ππ" #
sender
ππ# )
As
ππ* ,
Object
ππ- 3
,
ππ3 4
e
ππ5 6
As
ππ7 9
	EventArgs
ππ: C
)
ππC D
Handles
ππE L

btnGrabar2
ππM W
.
ππW X
Click
ππX ]
Try
∫∫ 
Call
ªª 
grabar
ªª 
(
ªª 
$str
ªª !
)
ªª! "
Catch
ºº 
ex
ºº 
As
ºº 
	Exception
ºº 

lbl_Valida
ΩΩ 
.
ΩΩ 
Text
ΩΩ 
=
ΩΩ 
ex
ΩΩ  
.
ΩΩ  !
Message
ΩΩ! (

lbl_Valida
ææ 
.
ææ 
	ForeColor
ææ  
=
ææ! "
System
ææ# )
.
ææ) *
Drawing
ææ* 1
.
ææ1 2
Color
ææ2 7
.
ææ7 8
Red
ææ8 ; 
btn_BuscarPrestamo
øø 
.
øø 
Visible
øø &
=
øø' (
False
øø) .
End
¿¿ 
Try
¿¿ 
End
¡¡ 
Sub
¡¡ 
Private
ƒƒ 
Sub
ƒƒ !
btn_Modificar_Click
ƒƒ #
(
ƒƒ# $
sender
ƒƒ$ *
As
ƒƒ+ -
Object
ƒƒ. 4
,
ƒƒ4 5
e
ƒƒ6 7
As
ƒƒ8 :
	EventArgs
ƒƒ; D
)
ƒƒD E
Handles
ƒƒF M
btnModificar
ƒƒN Z
.
ƒƒZ [
Click
ƒƒ[ `
Try
≈≈ 

lbl_Valida
∆∆ 
.
∆∆ 
	ForeColor
∆∆  
=
∆∆! "
System
∆∆# )
.
∆∆) *
Drawing
∆∆* 1
.
∆∆1 2
Color
∆∆2 7
.
∆∆7 8

DarkOrange
∆∆8 B

lbl_Valida
«« 
.
«« 
Text
«« 
=
«« 
$str
«« 7

Validacion
»» 
(
»» 
$str
»» "
)
»»" #
Catch
…… 
ex
…… 
As
…… 
	Exception
…… 

lbl_Valida
   
.
   
Text
   
=
   
ex
    
.
    !
Message
  ! (

lbl_Valida
ÀÀ 
.
ÀÀ 
	ForeColor
ÀÀ  
=
ÀÀ! "
System
ÀÀ# )
.
ÀÀ) *
Drawing
ÀÀ* 1
.
ÀÀ1 2
Color
ÀÀ2 7
.
ÀÀ7 8
Red
ÀÀ8 ; 
btn_BuscarPrestamo
ÃÃ 
.
ÃÃ 
Visible
ÃÃ &
=
ÃÃ' (
False
ÃÃ) .
End
ÕÕ 
Try
ÕÕ 
End
ŒŒ 
Sub
ŒŒ 
Private
—— 
Sub
—— 
btnCancelar_Click
—— !
(
——! "
sender
——" (
As
——) +
Object
——, 2
,
——2 3
e
——4 5
As
——6 8
	EventArgs
——9 B
)
——B C
Handles
——D K
btnCancelar
——L W
.
——W X
Click
——X ]
Try
““ 
Response
”” 
.
”” 
Redirect
”” 
(
”” 
$str
”” 6
)
””6 7
Catch
‘‘ 
ex
‘‘ 
As
‘‘ 
	Exception
‘‘ 

lbl_Valida
’’ 
.
’’ 
Text
’’ 
=
’’ 
ex
’’  
.
’’  !
Message
’’! (

lbl_Valida
÷÷ 
.
÷÷ 
	ForeColor
÷÷  
=
÷÷! "
System
÷÷# )
.
÷÷) *
Drawing
÷÷* 1
.
÷÷1 2
Color
÷÷2 7
.
÷÷7 8
Red
÷÷8 ;
End
◊◊ 
Try
◊◊ 
End
ÿÿ 
Sub
ÿÿ 
Private
⁄⁄ 
Sub
⁄⁄  
btnCancelar2_Click
⁄⁄ "
(
⁄⁄" #
sender
⁄⁄# )
As
⁄⁄* ,
Object
⁄⁄- 3
,
⁄⁄3 4
e
⁄⁄5 6
As
⁄⁄7 9
	EventArgs
⁄⁄: C
)
⁄⁄C D
Handles
⁄⁄E L
btnCancelar2
⁄⁄M Y
.
⁄⁄Y Z
Click
⁄⁄Z _
Try
€€ 
Response
‹‹ 
.
‹‹ 
Redirect
‹‹ 
(
‹‹ 
$str
‹‹ 6
)
‹‹6 7
Catch
›› 
ex
›› 
As
›› 
	Exception
›› 

lbl_Valida
ﬁﬁ 
.
ﬁﬁ 
Text
ﬁﬁ 
=
ﬁﬁ 
ex
ﬁﬁ  
.
ﬁﬁ  !
Message
ﬁﬁ! (

lbl_Valida
ﬂﬂ 
.
ﬂﬂ 
	ForeColor
ﬂﬂ  
=
ﬂﬂ! "
System
ﬂﬂ# )
.
ﬂﬂ) *
Drawing
ﬂﬂ* 1
.
ﬂﬂ1 2
Color
ﬂﬂ2 7
.
ﬂﬂ7 8
Red
ﬂﬂ8 ;
End
‡‡ 
Try
‡‡ 
End
·· 
Sub
·· 
Private
„„ 
Sub
„„ '
btn_HistorialLector_Click
„„ )
(
„„) *
sender
„„* 0
As
„„1 3
Object
„„4 :
,
„„: ;
e
„„< =
As
„„> @
	EventArgs
„„A J
)
„„J K
Handles
„„L S!
btn_HistorialLector
„„T g
.
„„g h
Click
„„h m
Try
‰‰ 
Dim
ÂÂ 
v_FormatoReporte
ÂÂ  
As
ÂÂ! #
String
ÂÂ$ *
=
ÂÂ+ ,
$str
ÂÂ- 2
Exportar_Reporte
ÊÊ 
(
ÊÊ 
v_FormatoReporte
ÊÊ -
,
ÊÊ- .
$str
ÊÊ/ L
)
ÊÊL M
Catch
ÁÁ 
ex
ÁÁ 
As
ÁÁ 
	Exception
ÁÁ 

lbl_Valida
ËË 
.
ËË 
Text
ËË 
=
ËË 
ex
ËË  
.
ËË  !
Message
ËË! (

lbl_Valida
ÈÈ 
.
ÈÈ 
	ForeColor
ÈÈ  
=
ÈÈ! "
System
ÈÈ# )
.
ÈÈ) *
Drawing
ÈÈ* 1
.
ÈÈ1 2
Color
ÈÈ2 7
.
ÈÈ7 8
Red
ÈÈ8 ;
End
ÍÍ 
Try
ÍÍ 
End
ÎÎ 
Sub
ÎÎ 
Private
ÌÌ 
Sub
ÌÌ &
btn_historialLibro_Click
ÌÌ (
(
ÌÌ( )
sender
ÌÌ) /
As
ÌÌ0 2
Object
ÌÌ3 9
,
ÌÌ9 :
e
ÌÌ; <
As
ÌÌ= ?
	EventArgs
ÌÌ@ I
)
ÌÌI J
Handles
ÌÌK R 
btn_historialLibro
ÌÌS e
.
ÌÌe f
Click
ÌÌf k
Try
ÓÓ 
Dim
ÔÔ 
v_FormatoReporte
ÔÔ  
As
ÔÔ! #
String
ÔÔ$ *
=
ÔÔ+ ,
$str
ÔÔ- 2
Exportar_Reporte
 
(
 
v_FormatoReporte
 -
,
- .
$str
/ K
)
K L
Catch
ÒÒ 
ex
ÒÒ 
As
ÒÒ 
	Exception
ÒÒ 
lbl_validaLibro
ÚÚ 
.
ÚÚ 
Text
ÚÚ  
=
ÚÚ! "
ex
ÚÚ# %
.
ÚÚ% &
Message
ÚÚ& -
lbl_validaLibro
ÛÛ 
.
ÛÛ 
	ForeColor
ÛÛ %
=
ÛÛ& '
System
ÛÛ( .
.
ÛÛ. /
Drawing
ÛÛ/ 6
.
ÛÛ6 7
Color
ÛÛ7 <
.
ÛÛ< =
Red
ÛÛ= @
End
ÙÙ 
Try
ÙÙ 
End
ıı 
Sub
ıı 
Private
¯¯ 
Sub
¯¯ 
btnVerFicha_Click
¯¯ !
(
¯¯! "
sender
¯¯" (
As
¯¯) +
Object
¯¯, 2
,
¯¯2 3
e
¯¯4 5
As
¯¯6 8
	EventArgs
¯¯9 B
)
¯¯B C
Handles
¯¯D K
btnVerFicha
¯¯L W
.
¯¯W X
Click
¯¯X ]
Try
˘˘ 
Dim
˙˙ 
v_FormatoReporte
˙˙  
As
˙˙! #
String
˙˙$ *
=
˙˙+ ,
$str
˙˙- 2
Exportar_Reporte
˚˚ 
(
˚˚ 
v_FormatoReporte
˚˚ -
,
˚˚- .
$str
˚˚/ A
)
˚˚A B
Catch
¸¸ 
ex
¸¸ 
As
¸¸ 
	Exception
¸¸ 

lbl_Valida
˝˝ 
.
˝˝ 
Text
˝˝ 
=
˝˝ 
ex
˝˝  
.
˝˝  !
Message
˝˝! (

lbl_Valida
˛˛ 
.
˛˛ 
	ForeColor
˛˛  
=
˛˛! "
System
˛˛# )
.
˛˛) *
Drawing
˛˛* 1
.
˛˛1 2
Color
˛˛2 7
.
˛˛7 8
Red
˛˛8 ;
End
ˇˇ 
Try
ˇˇ 
End
ÄÄ 
Sub
ÄÄ 
Private
ÇÇ 
Sub
ÇÇ  
btnVerFicha2_Click
ÇÇ "
(
ÇÇ" #
sender
ÇÇ# )
As
ÇÇ* ,
Object
ÇÇ- 3
,
ÇÇ3 4
e
ÇÇ5 6
As
ÇÇ7 9
	EventArgs
ÇÇ: C
)
ÇÇC D
Handles
ÇÇE L
btnVerFicha2
ÇÇM Y
.
ÇÇY Z
Click
ÇÇZ _
Try
ÉÉ 
Dim
ÑÑ 
v_FormatoReporte
ÑÑ  
As
ÑÑ! #
String
ÑÑ$ *
=
ÑÑ+ ,
$str
ÑÑ- 2
Exportar_Reporte
ÖÖ 
(
ÖÖ 
v_FormatoReporte
ÖÖ -
,
ÖÖ- .
$str
ÖÖ/ A
)
ÖÖA B
Catch
ÜÜ 
ex
ÜÜ 
As
ÜÜ 
	Exception
ÜÜ 

lbl_Valida
áá 
.
áá 
Text
áá 
=
áá 
ex
áá  
.
áá  !
Message
áá! (

lbl_Valida
àà 
.
àà 
	ForeColor
àà  
=
àà! "
System
àà# )
.
àà) *
Drawing
àà* 1
.
àà1 2
Color
àà2 7
.
àà7 8
Red
àà8 ;
End
ââ 
Try
ââ 
End
ää 
Sub
ää 
Private
åå 
Sub
åå !
btnMas8_ServerClick
åå #
(
åå# $
sender
åå$ *
As
åå+ -
Object
åå. 4
,
åå4 5
e
åå6 7
As
åå8 :
	EventArgs
åå; D
)
ååD E
Handles
ååF M
btnMas8
ååN U
.
ååU V
Click
ååV [
Dim
éé 
a√±o
éé 
As
éé 
String
éé 
=
éé 
Right
éé !
(
éé! "
(
éé" #
txt_FechaPrestamo
éé# 4
.
éé4 5
Text
éé5 9
)
éé9 :
,
éé: ;
$num
éé< =
)
éé= >
Dim
èè 
mes
èè 
As
èè 
String
èè 
=
èè 
Trim
èè  
(
èè  !
txt_FechaPrestamo
èè! 2
.
èè2 3
Text
èè3 7
)
èè7 8
.
èè8 9
	Substring
èè9 B
(
èèB C
$num
èèC D
,
èèD E
$num
èèF G
)
èèG H
Dim
êê 
dia
êê 
As
êê 
String
êê 
=
êê 
Left
êê  
(
êê  !
Trim
êê! %
(
êê% &
txt_FechaPrestamo
êê& 7
.
êê7 8
Text
êê8 <
)
êê< =
,
êê= >
$num
êê? @
)
êê@ A
Dim
ëë 
fecha
ëë 
As
ëë 
String
ëë 
=
ëë 
dia
ëë !
&
ëë" #
$str
ëë$ '
&
ëë( )
mes
ëë* -
&
ëë. /
$str
ëë0 3
&
ëë4 5
a√±o
ëë6 9
Try
ìì 
Dim
îî 
	fechadevo
îî 
As
îî 
Date
îî !
=
îî" #
DateAdd
îî$ +
(
îî+ ,
DateInterval
îî, 8
.
îî8 9
Day
îî9 <
,
îî< =
+
îî> ?
$num
îî? @
,
îî@ A
	DateValue
îîB K
(
îîK L
fecha
îîL Q
)
îîQ R
)
îîR S!
txt_FechaDevolucion
ïï 
.
ïï  
Text
ïï  $
=
ïï% &
	fechadevo
ïï' 0
Dim
ññ 
nombDia
ññ 
As
ññ 
String
ññ !
=
ññ" #
UCase
ññ$ )
(
ññ) *
WeekdayName
ññ* 5
(
ññ5 6
Weekday
ññ6 =
(
ññ= >
	fechadevo
ññ> G
)
ññG H
)
ññH I
)
ññI J
Select
óó 
Case
óó 
nombDia
óó 
Case
òò 
$str
òò 
	lblNomDia
ôô 
.
ôô 
Text
ôô "
=
ôô# $
$str
ôô% ,
Case
öö 
$str
öö 
	lblNomDia
õõ 
.
õõ 
Text
õõ "
=
õõ# $
$str
õõ% -
Case
úú 
$str
úú  
	lblNomDia
ùù 
.
ùù 
Text
ùù "
=
ùù# $
$str
ùù% 0
Case
ûû 
$str
ûû 
	lblNomDia
üü 
.
üü 
Text
üü "
=
üü# $
$str
üü% -
Case
†† 
$str
†† 
	lblNomDia
°° 
.
°° 
Text
°° "
=
°°# $
$str
°°% .
Case
¢¢ 
$str
¢¢ 
	lblNomDia
££ 
.
££ 
Text
££ "
=
££# $
$str
££% -
Case
§§ 
$str
§§ 
	lblNomDia
•• 
.
•• 
Text
•• "
=
••# $
$str
••% .
Case
¶¶ 
Else
¶¶ 
	lblNomDia
ßß 
.
ßß 
Text
ßß "
=
ßß# $
nombDia
ßß% ,
End
®® 
Select
®® 
If
™™ 
nombDia
™™ 
=
™™ 
$str
™™ !
Or
™™" $
nombDia
™™% ,
=
™™- .
$str
™™/ 8
Then
™™9 =
	lblNomDia
´´ 
.
´´ 
	ForeColor
´´ #
=
´´$ %
Drawing
´´& -
.
´´- .
Color
´´. 3
.
´´3 4
Red
´´4 7
Else
¨¨ 
	lblNomDia
≠≠ 
.
≠≠ 
	ForeColor
≠≠ #
=
≠≠$ %
Drawing
≠≠& -
.
≠≠- .
Color
≠≠. 3
.
≠≠3 4
Blue
≠≠4 8
End
ÆÆ 
If
ÆÆ 
Catch
ØØ 
ex
ØØ 
As
ØØ 
	Exception
ØØ 

lbl_Valida
∞∞ 
.
∞∞ 
Text
∞∞ 
=
∞∞ 
ex
∞∞  
.
∞∞  !
Message
∞∞! (
End
±± 
Try
±± 
End
≤≤ 
Sub
≤≤ 
	Protected
¥¥ 
Sub
¥¥ $
cBox_BusquedaLectorVAL
¥¥ (
(
¥¥( )
ByVal
¥¥) .
sender
¥¥/ 5
As
¥¥6 8
Object
¥¥9 ?
,
¥¥? @
ByVal
¥¥A F
e
¥¥G H
As
¥¥I K
	EventArgs
¥¥L U
)
¥¥U V
Handles
¥¥W ^!
cBox_BusquedaLector
¥¥_ r
.
¥¥r s#
SelectedIndexChanged¥¥s á
txt_valorLector
µµ 
.
µµ 
Text
µµ 
=
µµ 
$str
µµ !
If
∂∂ 
!
cBox_BusquedaLector
∂∂ 
.
∂∂ 
SelectedIndex
∂∂ ,
=
∂∂- .
$num
∂∂/ 0
Then
∂∂1 5
txt_valorLector
∑∑ 
.
∑∑ 
	MaxLength
∑∑ %
=
∑∑& '
$num
∑∑( )
txt_valorLector
∏∏ 
.
∏∏ 
	MaxLength
∏∏ %
=
∏∏& '
$num
∏∏( )
txt_valorLector
ππ 
.
ππ 

Attributes
ππ &
.
ππ& '
Add
ππ' *
(
ππ* +
$str
ππ+ 4
,
ππ4 5
$str
ππ6 S
)
ππS T
txt_valorLector
∫∫ 
.
∫∫ 

Attributes
∫∫ &
.
∫∫& '
Add
∫∫' *
(
∫∫* +
$str
∫∫+ 8
,
∫∫8 9
$str
∫∫: X
)
∫∫X Y
ElseIf
ªª !
cBox_BusquedaLector
ªª "
.
ªª" #
SelectedIndex
ªª# 0
=
ªª1 2
$num
ªª3 4
Then
ªª5 9
txt_valorLector
ºº 
.
ºº 
	MaxLength
ºº %
=
ºº& '
$num
ºº( )
txt_valorLector
ΩΩ 
.
ΩΩ 

Attributes
ΩΩ &
.
ΩΩ& '
Add
ΩΩ' *
(
ΩΩ* +
$str
ΩΩ+ 4
,
ΩΩ4 5
$str
ΩΩ6 S
)
ΩΩS T
txt_valorLector
ææ 
.
ææ 

Attributes
ææ &
.
ææ& '
Add
ææ' *
(
ææ* +
$str
ææ+ 8
,
ææ8 9
$str
ææ: L
)
ææL M
ElseIf
øø !
cBox_BusquedaLector
øø "
.
øø" #
SelectedIndex
øø# 0
=
øø1 2
$num
øø3 4
Then
øø5 9
txt_valorLector
¿¿ 
.
¿¿ 
	MaxLength
¿¿ %
=
¿¿& '
$num
¿¿( *
txt_valorLector
¡¡ 
.
¡¡ 

Attributes
¡¡ &
.
¡¡& '
Add
¡¡' *
(
¡¡* +
$str
¡¡+ 4
,
¡¡4 5
$str
¡¡6 S
)
¡¡S T
txt_valorLector
¬¬ 
.
¬¬ 

Attributes
¬¬ &
.
¬¬& '
Add
¬¬' *
(
¬¬* +
$str
¬¬+ 8
,
¬¬8 9
$str
¬¬: Z
)
¬¬Z [
End
√√ 
If
√√ 
End
ƒƒ 
Sub
ƒƒ 
	Protected
∆∆ 
Sub
∆∆ -
txt_FechaDevolucion_TextChanged
∆∆ 1
(
∆∆1 2
ByVal
∆∆2 7
sender
∆∆8 >
As
∆∆? A
Object
∆∆B H
,
∆∆H I
ByVal
∆∆J O
e
∆∆P Q
As
∆∆R T
	EventArgs
∆∆U ^
)
∆∆^ _
Handles
∆∆` g!
txt_FechaDevolucion
∆∆h {
.
∆∆{ |
TextChanged∆∆| á
Try
«« 
Dim
»» 
nombDia
»» 
As
»» 
String
»» !
=
»»" #
UCase
»»$ )
(
»») *
WeekdayName
»»* 5
(
»»5 6
Weekday
»»6 =
(
»»= >
Trim
»»> B
(
»»B C!
txt_FechaDevolucion
»»C V
.
»»V W
Text
»»W [
)
»»[ \
)
»»\ ]
)
»»] ^
)
»»^ _
Select
…… 
Case
…… 
nombDia
…… 
Case
   
$str
   
	lblNomDia
ÀÀ 
.
ÀÀ 
Text
ÀÀ "
=
ÀÀ# $
$str
ÀÀ% ,
Case
ÃÃ 
$str
ÃÃ 
	lblNomDia
ÕÕ 
.
ÕÕ 
Text
ÕÕ "
=
ÕÕ# $
$str
ÕÕ% -
Case
ŒŒ 
$str
ŒŒ  
	lblNomDia
œœ 
.
œœ 
Text
œœ "
=
œœ# $
$str
œœ% 0
Case
–– 
$str
–– 
	lblNomDia
—— 
.
—— 
Text
—— "
=
——# $
$str
——% -
Case
““ 
$str
““ 
	lblNomDia
”” 
.
”” 
Text
”” "
=
””# $
$str
””% .
Case
‘‘ 
$str
‘‘ 
	lblNomDia
’’ 
.
’’ 
Text
’’ "
=
’’# $
$str
’’% -
Case
÷÷ 
$str
÷÷ 
	lblNomDia
◊◊ 
.
◊◊ 
Text
◊◊ "
=
◊◊# $
$str
◊◊% .
Case
ÿÿ 
Else
ÿÿ 
	lblNomDia
ŸŸ 
.
ŸŸ 
Text
ŸŸ "
=
ŸŸ# $
nombDia
ŸŸ% ,
End
⁄⁄ 
Select
⁄⁄ 
If
‹‹ 
nombDia
‹‹ 
=
‹‹ 
$str
‹‹ !
Or
‹‹" $
nombDia
‹‹% ,
=
‹‹- .
$str
‹‹/ 8
Then
‹‹9 =
	lblNomDia
›› 
.
›› 
	ForeColor
›› #
=
››$ %
Drawing
››& -
.
››- .
Color
››. 3
.
››3 4
Red
››4 7
Else
ﬁﬁ 
	lblNomDia
ﬂﬂ 
.
ﬂﬂ 
	ForeColor
ﬂﬂ #
=
ﬂﬂ$ %
Drawing
ﬂﬂ& -
.
ﬂﬂ- .
Color
ﬂﬂ. 3
.
ﬂﬂ3 4
Blue
ﬂﬂ4 8
End
‡‡ 
If
‡‡ 
Catch
‚‚ 
ex
‚‚ 
As
‚‚ 
	Exception
‚‚ 

lbl_Valida
„„ 
.
„„ 
Text
„„ 
=
„„ 
ex
„„  
.
„„  !
Message
„„! (

lbl_Valida
‰‰ 
.
‰‰ 
	ForeColor
‰‰  
=
‰‰! "
Drawing
‰‰# *
.
‰‰* +
Color
‰‰+ 0
.
‰‰0 1
Red
‰‰1 4
End
ÂÂ 
Try
ÂÂ 
End
ÊÊ 
Sub
ÊÊ 
Private
ÈÈ 
Sub
ÈÈ 
Busqueda
ÈÈ 
(
ÈÈ 
ByVal
ÈÈ 
tipoBusqueda
ÈÈ +
As
ÈÈ, .
String
ÈÈ/ 5
)
ÈÈ5 6
If
ÎÎ 

tipoBusqueda
ÎÎ 
=
ÎÎ 
$str
ÎÎ "
Then
ÎÎ# '
If
ÌÌ 
Len
ÌÌ 
(
ÌÌ 
Trim
ÌÌ 
(
ÌÌ 
txt_valorLector
ÌÌ '
.
ÌÌ' (
Text
ÌÌ( ,
)
ÌÌ, -
)
ÌÌ- .
=
ÌÌ/ 0
$num
ÌÌ1 2
Then
ÌÌ3 7$
lbl_LectorNoSeEncontro
ÓÓ &
.
ÓÓ& '
	ForeColor
ÓÓ' 0
=
ÓÓ1 2
System
ÓÓ3 9
.
ÓÓ9 :
Drawing
ÓÓ: A
.
ÓÓA B
Color
ÓÓB G
.
ÓÓG H
Red
ÓÓH K$
lbl_LectorNoSeEncontro
ÔÔ &
.
ÔÔ& '
Text
ÔÔ' +
=
ÔÔ, -
$str
ÔÔ. C"
lbl_LectorSeEncontro
 $
.
$ %
Text
% )
=
* +
$str
, .
txt_valorLector
ÒÒ 
.
ÒÒ  
Text
ÒÒ  $
=
ÒÒ% &
$str
ÒÒ' )
txt_valorLector
ÚÚ 
.
ÚÚ  
Focus
ÚÚ  %
(
ÚÚ% &
)
ÚÚ& '
txt_A_apeYNombres
ÛÛ !
.
ÛÛ! "
	InnerText
ÛÛ" +
=
ÛÛ, -
$str
ÛÛ. 0
txt_A_tituloLibro
ÙÙ !
.
ÙÙ! "
	InnerText
ÙÙ" +
=
ÙÙ, -
$str
ÙÙ. 0
	imgLector
ıı 
.
ıı 
ImageUrl
ıı "
=
ıı# $
$str
ıı% ?

grv_Lector
ˆˆ 
.
ˆˆ 
DataBind
ˆˆ #
(
ˆˆ# $
)
ˆˆ$ %
Exit
˜˜ 
Sub
˜˜ 
End
¯¯ 
If
¯¯ 
If
˙˙ !
cBox_BusquedaLector
˙˙ "
.
˙˙" #
SelectedIndex
˙˙# 0
=
˙˙1 2
$num
˙˙3 4
Or
˙˙5 7!
cBox_BusquedaLector
˙˙8 K
.
˙˙K L
SelectedIndex
˙˙L Y
=
˙˙Z [
$num
˙˙\ ]
Then
˙˙^ b
If
˚˚ 
Len
˚˚ 
(
˚˚ 
Trim
˚˚ 
(
˚˚ 
txt_valorLector
˚˚ +
.
˚˚+ ,
Text
˚˚, 0
)
˚˚0 1
)
˚˚1 2
>
˚˚3 4
$num
˚˚5 6
And
˚˚7 :
Len
˚˚; >
(
˚˚> ?
Trim
˚˚? C
(
˚˚C D
txt_valorLector
˚˚D S
.
˚˚S T
Text
˚˚T X
)
˚˚X Y
)
˚˚Y Z
<
˚˚[ \
$num
˚˚] ^
Then
˚˚_ c"
lbl_LectorSeEncontro
¸¸ (
.
¸¸( )
	ForeColor
¸¸) 2
=
¸¸3 4
System
¸¸5 ;
.
¸¸; <
Drawing
¸¸< C
.
¸¸C D
Color
¸¸D I
.
¸¸I J
Red
¸¸J M"
lbl_LectorSeEncontro
˝˝ (
.
˝˝( )
Text
˝˝) -
=
˝˝. /
$str
˝˝0 L
txt_valorLector
˛˛ #
.
˛˛# $
Text
˛˛$ (
=
˛˛) *
$str
˛˛+ -
txt_valorLector
ˇˇ #
.
ˇˇ# $
Focus
ˇˇ$ )
(
ˇˇ) *
)
ˇˇ* +
Exit
ÄÄ 
Sub
ÄÄ 
End
ÅÅ 
If
ÅÅ 
End
ÇÇ 
If
ÇÇ $
lbl_LectorNoSeEncontro
ÉÉ "
.
ÉÉ" #
Text
ÉÉ# '
=
ÉÉ( )
$str
ÉÉ* ,
Dim
ÖÖ 
BusquedaLector
ÖÖ 
As
ÖÖ !
String
ÖÖ" (
=
ÖÖ) *
txt_valorLector
ÖÖ+ :
.
ÖÖ: ;
Text
ÖÖ; ?
Dim
ÜÜ 
vBandera
ÜÜ 
As
ÜÜ 
String
ÜÜ "
If
àà !
cBox_BusquedaLector
àà "
.
àà" #
SelectedIndex
àà# 0
=
àà1 2
$num
àà3 4
Then
àà5 9
vBandera
ââ 
=
ââ 
$str
ââ 
ElseIf
ää !
cBox_BusquedaLector
ää &
.
ää& '
SelectedIndex
ää' 4
=
ää5 6
$num
ää7 8
Then
ää9 =
vBandera
ãã 
=
ãã 
$str
ãã 
ElseIf
åå !
cBox_BusquedaLector
åå &
.
åå& '
SelectedIndex
åå' 4
=
åå5 6
$num
åå7 8
Then
åå9 =
vBandera
çç 
=
çç 
$str
çç 
End
éé 
If
éé 
Session
êê 
(
êê 
$str
êê 
)
êê  
=
êê! "
BusquedaLector
êê# 1
Session
ëë 
(
ëë 
$str
ëë 
)
ëë 
=
ëë  !
vBandera
ëë" *
Dim
îî 
ds
îî 
As
îî 
DataSet
îî 
=
îî 
cls_Metodos
îî  +
.
îî+ ,
BuscarLector
îî, 8
(
îî8 9
BusquedaLector
îî9 G
,
îîG H
vBandera
îîI Q
)
îîQ R

grv_Lector
ïï 
.
ïï 

DataSource
ïï !
=
ïï" #
ds
ïï$ &

grv_Lector
ññ 
.
ññ 
DataBind
ññ 
(
ññ  
)
ññ  !"
lbl_LectorSeEncontro
ôô  
.
ôô  !
Visible
ôô! (
=
ôô) *
True
ôô+ /"
lbl_LectorSeEncontro
öö  
.
öö  !
	ForeColor
öö! *
=
öö+ ,
System
öö- 3
.
öö3 4
Drawing
öö4 ;
.
öö; <
Color
öö< A
.
ööA B
Green
ööB G"
lbl_LectorSeEncontro
õõ  
.
õõ  !
Text
õõ! %
=
õõ& '
$str
õõ( 7
&
õõ8 9
ds
õõ: <
.
õõ< =
Tables
õõ= C
(
õõC D
$num
õõD E
)
õõE F
.
õõF G
Rows
õõG K
.
õõK L
Count
õõL Q
&
õõR S
$str
õõT p!
btn_HistorialLector
úú 
.
úú  
Enabled
úú  '
=
úú( )
True
úú* .
If
üü 
ds
üü 
.
üü 
Tables
üü 
(
üü 
$num
üü 
)
üü 
.
üü 
Rows
üü  
.
üü  !
Count
üü! &
=
üü' (
$num
üü) *
Then
üü+ /
txt_A_apeYNombres
†† !
.
††! "
	InnerText
††" +
=
††, -
$str
††. 0
	imgLector
°° 
.
°° 
ImageUrl
°° "
=
°°# $
$str
°°% ?
txt_valorLector
¢¢ 
.
¢¢  
Focus
¢¢  %
(
¢¢% &
)
¢¢& '

grv_Lector
££ 
.
££ 
DataBind
££ #
(
££# $
)
££$ %
End
§§ 
If
§§ 
ElseIf
ßß 
tipoBusqueda
ßß 
=
ßß 
$str
ßß %
Then
ßß& *
imgDisponible
®® 
.
®® 
Visible
®® !
=
®®" #
False
®®$ )
If
™™ 
Len
™™ 
(
™™ 
Trim
™™ 
(
™™ 
txt_ValorLibro
™™ &
.
™™& '
Text
™™' +
)
™™+ ,
)
™™, -
=
™™. /
$num
™™0 1
Then
™™2 6
lbl_validaLibro
´´ 
.
´´  
	ForeColor
´´  )
=
´´* +
System
´´, 2
.
´´2 3
Drawing
´´3 :
.
´´: ;
Color
´´; @
.
´´@ A
Red
´´A D
lbl_validaLibro
¨¨ 
.
¨¨  
Text
¨¨  $
=
¨¨% &
$str
¨¨' A"
lbl_LectorSeEncontro
≠≠ $
.
≠≠$ %
Text
≠≠% )
=
≠≠* +
$str
≠≠, .
txt_ValorLibro
ÆÆ 
.
ÆÆ 
Text
ÆÆ #
=
ÆÆ$ %
$str
ÆÆ& (
imgLibro
ØØ 
.
ØØ 
Src
ØØ 
=
ØØ 
$str
ØØ 9
txt_ValorLibro
∞∞ 
.
∞∞ 
Focus
∞∞ $
(
∞∞$ %
)
∞∞% &
txt_A_tituloLibro
±± !
.
±±! "
	InnerText
±±" +
=
±±, -
$str
±±. 0
Exit
≤≤ 
Sub
≤≤ 
End
≥≥ 
If
≥≥ 
Session
µµ 
(
µµ 
$str
µµ 
)
µµ  
=
µµ! "
$str
µµ# &
Session
∂∂ 
(
∂∂ 
$str
∂∂ 
)
∂∂  
=
∂∂! "
$str
∂∂# %
Session
∑∑ 
(
∑∑ 
$str
∑∑ 
)
∑∑ 
=
∑∑  !
$str
∑∑" $
lbl_validaLibro
ππ 
.
ππ 
Text
ππ  
=
ππ! "
$str
ππ# %
Dim
ªª 

ValorLibro
ªª 
As
ªª 
String
ªª $
=
ªª% &
txt_ValorLibro
ªª' 5
.
ªª5 6
Text
ªª6 :
.
ªª: ;
Trim
ªª; ?
Dim
ºº 
vBandera
ºº 
As
ºº 
String
ºº "
If
ææ #
cbox_CodRegistroLibro
ææ $
.
ææ$ %
SelectedIndex
ææ% 2
=
ææ3 4
$num
ææ5 6
Then
ææ7 ;
vBandera
øø 
=
øø 
$str
øø 
ElseIf
¿¿ #
cbox_CodRegistroLibro
¿¿ (
.
¿¿( )
SelectedIndex
¿¿) 6
=
¿¿7 8
$num
¿¿9 :
Then
¿¿; ?
vBandera
¡¡ 
=
¡¡ 
$str
¡¡ 
ElseIf
¬¬ #
cbox_CodRegistroLibro
¬¬ (
.
¬¬( )
SelectedIndex
¬¬) 6
=
¬¬7 8
$num
¬¬9 :
Then
¬¬; ?
vBandera
√√ 
=
√√ 
$str
√√ 
End
ƒƒ 
If
ƒƒ 
Session
∆∆ 
(
∆∆ 
$str
∆∆ 
)
∆∆  
=
∆∆! "

ValorLibro
∆∆# -
Session
«« 
(
«« 
$str
«« 
)
«« 
=
««  !
vBandera
««" *
Dim
   
ds
   
As
   
DataSet
   
=
   
cls_Metodos
    +
.
  + ,
BuscarLibro
  , 7
(
  7 8

ValorLibro
  8 B
,
  B C
vBandera
  D L
)
  L M
	grv_Libro
ÃÃ 
.
ÃÃ 

DataSource
ÃÃ  
=
ÃÃ! "
ds
ÃÃ# %
	grv_Libro
ÕÕ 
.
ÕÕ 
DataBind
ÕÕ 
(
ÕÕ 
)
ÕÕ  
lbl_validaLibro
ŒŒ 
.
ŒŒ 
Visible
ŒŒ #
=
ŒŒ$ %
True
ŒŒ& *
lbl_validaLibro
œœ 
.
œœ 
	ForeColor
œœ %
=
œœ& '
System
œœ( .
.
œœ. /
Drawing
œœ/ 6
.
œœ6 7
Color
œœ7 <
.
œœ< =
Green
œœ= B
lbl_validaLibro
–– 
.
–– 
Text
––  
=
––! "
$str
––# 2
&
––3 4
ds
––5 7
.
––7 8
Tables
––8 >
(
––> ?
$num
––? @
)
––@ A
.
––A B
Rows
––B F
.
––F G
Count
––G L 
btn_historialLibro
““ 
.
““ 
Enabled
““ &
=
““' (
True
““) -
ElseIf
’’ 
tipoBusqueda
’’ 
=
’’ 
$str
’’ (
Then
’’) -
Dim
◊◊ 
ValorPrestamo
◊◊ 
As
◊◊  
String
◊◊! '
=
◊◊( )
txt_ValorPrestamo
◊◊* ;
.
◊◊; <
Text
◊◊< @
Dim
ÿÿ 
vBandera
ÿÿ 
As
ÿÿ 
String
ÿÿ "
If
⁄⁄ 
cboxBusqueda
⁄⁄ 
.
⁄⁄ 
SelectedValue
⁄⁄ )
=
⁄⁄* +
$str
⁄⁄, /
Then
⁄⁄0 4
vBandera
€€ 
=
€€ 
$str
€€ 
ElseIf
‹‹ 
cboxBusqueda
‹‹ 
.
‹‹  
SelectedValue
‹‹  -
=
‹‹. /
$str
‹‹0 3
Then
‹‹4 8
vBandera
›› 
=
›› 
$str
›› 
ElseIf
ﬁﬁ 
cboxBusqueda
ﬁﬁ 
.
ﬁﬁ  
SelectedValue
ﬁﬁ  -
=
ﬁﬁ. /
$str
ﬁﬁ0 3
Then
ﬁﬁ4 8
vBandera
ﬂﬂ 
=
ﬂﬂ 
$str
ﬂﬂ 
ElseIf
‡‡ 
cboxBusqueda
‡‡ 
.
‡‡  
SelectedValue
‡‡  -
=
‡‡. /
$str
‡‡0 3
Then
‡‡4 8
vBandera
·· 
=
·· 
$str
·· 
End
‚‚ 
If
‚‚ 
Session
‰‰ 
(
‰‰ 
$str
‰‰ 
)
‰‰  
=
‰‰! "
ValorPrestamo
‰‰# 0
Session
ÂÂ 
(
ÂÂ 
$str
ÂÂ 
)
ÂÂ 
=
ÂÂ  !
vBandera
ÂÂ" *
Dim
ËË 
ds
ËË 
As
ËË 
DataSet
ËË 
=
ËË 
cls_Metodos
ËË  +
.
ËË+ ,
BuscarPestamo
ËË, 9
(
ËË9 :
ValorPrestamo
ËË: G
,
ËËG H
vBandera
ËËI Q
)
ËËQ R
grv_Prestamo
ÈÈ 
.
ÈÈ 

DataSource
ÈÈ #
=
ÈÈ$ %
ds
ÈÈ& (
grv_Prestamo
ÍÍ 
.
ÍÍ 
DataBind
ÍÍ !
(
ÍÍ! "
)
ÍÍ" #

lbl_Valida
ÎÎ 
.
ÎÎ 
Visible
ÎÎ 
=
ÎÎ  
True
ÎÎ! %

lbl_Valida
ÏÏ 
.
ÏÏ 
	ForeColor
ÏÏ  
=
ÏÏ! "
System
ÏÏ# )
.
ÏÏ) *
Drawing
ÏÏ* 1
.
ÏÏ1 2
Color
ÏÏ2 7
.
ÏÏ7 8
Green
ÏÏ8 =

lbl_Valida
ÌÌ 
.
ÌÌ 
Text
ÌÌ 
=
ÌÌ 
$str
ÌÌ -
&
ÌÌ. /
ds
ÌÌ0 2
.
ÌÌ2 3
Tables
ÌÌ3 9
(
ÌÌ9 :
$num
ÌÌ: ;
)
ÌÌ; <
.
ÌÌ< =
Rows
ÌÌ= A
.
ÌÌA B
Count
ÌÌB G
End
ÓÓ 
If
ÓÓ 
End
 
Sub
 
Private
ÚÚ 
Sub
ÚÚ 
cargarLista50
ÚÚ 
(
ÚÚ 
)
ÚÚ 
grv_Prestamo
ÛÛ 
.
ÛÛ 

DataSource
ÛÛ 
=
ÛÛ  !
cls_Metodos
ÛÛ" -
.
ÛÛ- .(
Listar_Movimiento_Prestamo
ÛÛ. H
(
ÛÛH I
)
ÛÛI J
grv_Prestamo
ÙÙ 
.
ÙÙ 
DataBind
ÙÙ 
(
ÙÙ 
)
ÙÙ 
End
ıı 
Sub
ıı 
Private
¯¯ 
Sub
¯¯ 
grabar
¯¯ 
(
¯¯ 
ByVal
¯¯ 

TipoGrabar
¯¯ '
As
¯¯( *
String
¯¯+ 1
)
¯¯1 2
Dim
˙˙ 
tupla_FechaHora
˙˙ 
As
˙˙ 
Tuple
˙˙ $
(
˙˙$ %
Of
˙˙% '
String
˙˙( .
,
˙˙. /
String
˙˙0 6
)
˙˙6 7
=
˙˙8 9 
Formato_Fecha_Hora
˙˙: L
(
˙˙L M
)
˙˙M N
Dim
˚˚ 
v_IdPrestamo
˚˚ 
As
˚˚ 
String
˚˚ "
=
˚˚# $
lbl_IdPrestamo
˚˚% 3
.
˚˚3 4
Text
˚˚4 8
.
˚˚8 9
Trim
˚˚9 =
Dim
¸¸ !
v_LectorCodEmpleado
¸¸ 
As
¸¸  "
String
¸¸# )
=
¸¸* +
txt_codEmpleado
¸¸, ;
.
¸¸; <
Text
¸¸< @
.
¸¸@ A
Trim
¸¸A E
Dim
˝˝ 
v_LectorNombre
˝˝ 
As
˝˝ 
String
˝˝ $
=
˝˝% &"
txt_A_NombreEmpleado
˝˝' ;
.
˝˝; <
	InnerText
˝˝< E
.
˝˝E F
Trim
˝˝F J
Dim
˛˛  
v_LibroCodRegistro
˛˛ 
As
˛˛ !
String
˛˛" (
=
˛˛) *"
txt_codRegistroLibro
˛˛+ ?
.
˛˛? @
Text
˛˛@ D
Dim
ˇˇ 
v_LibroTitulo
ˇˇ 
As
ˇˇ 
String
ˇˇ #
=
ˇˇ$ %
txt_A_Librotitulo
ˇˇ& 7
.
ˇˇ7 8
	InnerText
ˇˇ8 A
Dim
ÄÄ 
v_CodClasif
ÄÄ 
As
ÄÄ 
String
ÄÄ !
=
ÄÄ" #
lbl_codClasif
ÄÄ$ 1
.
ÄÄ1 2
Text
ÄÄ2 6
Dim
ÅÅ 
v_FechaPrestamo
ÅÅ 
As
ÅÅ 
String
ÅÅ %
=
ÅÅ& '
txt_FechaPrestamo
ÅÅ( 9
.
ÅÅ9 :
Text
ÅÅ: >
.
ÅÅ> ?
Trim
ÅÅ? C
Dim
ÇÇ 
v_HoraPrestamo
ÇÇ 
As
ÇÇ 
String
ÇÇ $
=
ÇÇ% &
lbl_horaPrestamo
ÇÇ' 7
.
ÇÇ7 8
Text
ÇÇ8 <
.
ÇÇ< =
Trim
ÇÇ= A
Dim
ÖÖ 
v_FechaDevolucion
ÖÖ 
As
ÖÖ  
String
ÖÖ! '
If
ÜÜ 

(
ÜÜ !
cbox_EstadoPrestamo
ÜÜ 
.
ÜÜ  
SelectedValue
ÜÜ  -
=
ÜÜ. /
$str
ÜÜ0 3
)
ÜÜ3 4
Or
ÜÜ5 7
(
ÜÜ8 9!
cbox_EstadoPrestamo
ÜÜ9 L
.
ÜÜL M
SelectedValue
ÜÜM Z
=
ÜÜ[ \
$str
ÜÜ] `
)
ÜÜ` a
Then
ÜÜb f
v_FechaDevolucion
áá 
=
áá !
txt_FechaDevolucion
áá  3
.
áá3 4
Text
áá4 8
.
áá8 9
Trim
áá9 =
End
àà 
If
àà 
Dim
ää 
v_FechaReserva
ää 
As
ää 
String
ää $
=
ää% &
txt_FechaReserva
ää' 7
.
ää7 8
Text
ää8 <
.
ää< =
Trim
ää= A
Dim
ãã 
v_TipoOperacion
ãã 
As
ãã 
String
ãã %
=
ãã& '!
cbox_EstadoPrestamo
ãã( ;
.
ãã; <
SelectedValue
ãã< I
Dim
éé 
v_FechaAnulacion
éé 
As
éé 
String
éé  &
If
èè 

(
èè !
cbox_EstadoPrestamo
èè 
.
èè  
SelectedValue
èè  -
=
èè. /
$str
èè0 3
)
èè3 4
Then
èè5 9 
lbl_FechaAnulacion
êê 
.
êê 
Text
êê #
=
êê$ %
(
êê& '
tupla_FechaHora
êê' 6
.
êê6 7
Item1
êê7 <
)
êê< =
v_FechaAnulacion
ëë 
=
ëë  
lbl_FechaAnulacion
ëë 1
.
ëë1 2
Text
ëë2 6
End
íí 
If
íí 
Dim
ïï !
v_PrestamoProvincia
ïï 
As
ïï  "
String
ïï# )
If
ññ 

(
ññ 
chk_PProvincia
ññ 
.
ññ 
Checked
ññ "
=
ññ# $
True
ññ% )
)
ññ) *
Then
ññ+ /!
v_PrestamoProvincia
óó 
=
óó  !
$str
óó" %
Else
òò !
v_PrestamoProvincia
ôô 
=
ôô  !
$str
ôô" %
End
öö 
If
öö 
Dim
ùù "
v_PrestamoEspeciales
ùù  
As
ùù! #
String
ùù$ *
If
ûû 

(
ûû 
chk_PEspecial
ûû 
.
ûû 
Checked
ûû !
=
ûû" #
True
ûû$ (
)
ûû( )
Then
ûû* ."
v_PrestamoEspeciales
üü  
=
üü! "
$str
üü# &
Else
†† "
v_PrestamoEspeciales
°°  
=
°°! "
$str
°°# &
End
¢¢ 
If
¢¢ 
If
§§ 
!
cbox_EstadoPrestamo
§§ 
.
§§ 
SelectedValue
§§ ,
=
§§- .
$str
§§/ 2
Or
§§3 5!
cbox_EstadoPrestamo
§§6 I
.
§§I J
SelectedValue
§§J W
=
§§X Y
$str
§§Z ]
Or
§§^ `!
cbox_EstadoPrestamo
§§a t
.
§§t u
SelectedValue§§u Ç
=§§É Ñ
$str§§Ö à
Then§§â ç
If
•• !
txt_FechaDevolucion
•• "
.
••" #
Text
••# '
=
••( )
$str
••* ,
Then
••- 1

lbl_Valida
¶¶ 
.
¶¶ 
Text
¶¶ 
=
¶¶  !
$str
¶¶" Z

lbl_Valida
ßß 
.
ßß 
	ForeColor
ßß $
=
ßß% &
System
ßß' -
.
ßß- .
Drawing
ßß. 5
.
ßß5 6
Color
ßß6 ;
.
ßß; <
Red
ßß< ?
Exit
®® 
Sub
®® 
End
©© 
If
©© 
End
™™ 
If
™™ 
If
¨¨ 


TipoGrabar
¨¨ 
=
¨¨ 
$str
¨¨ !
Then
¨¨" &
cls_Metodos
≠≠ 
.
≠≠  
Registrar_Prestamo
≠≠ *
(
≠≠* +!
v_LectorCodEmpleado
≠≠+ >
,
≠≠> ?
v_LectorNombre
≠≠@ N
,
≠≠N O 
v_LibroCodRegistro
ÆÆ+ =
,
ÆÆ= >
v_LibroTitulo
ÆÆ? L
,
ÆÆL M
v_CodClasif
ÆÆN Y
,
ÆÆY Z
v_FechaPrestamo
ØØ+ :
,
ØØ: ;
v_HoraPrestamo
ØØ< J
,
ØØJ K
v_FechaDevolucion
ØØL ]
,
ØØ] ^
v_TipoOperacion
∞∞+ :
,
∞∞: ;!
v_PrestamoProvincia
±±+ >
,
±±> ?"
v_PrestamoEspeciales
±±@ T
)
±±T U
	btnGrabar
≤≤ 
.
≤≤ 
Enabled
≤≤ 
=
≤≤ 
False
≤≤  %

Validacion
≥≥ 
(
≥≥ 
$str
≥≥  
)
≥≥  !"
lbl_validaNuevoPrest
¥¥  
.
¥¥  !
	ForeColor
¥¥! *
=
¥¥+ ,
System
¥¥- 3
.
¥¥3 4
Drawing
¥¥4 ;
.
¥¥; <
Color
¥¥< A
.
¥¥A B
Green
¥¥B G"
lbl_validaNuevoPrest
µµ  
.
µµ  !
Visible
µµ! (
=
µµ) *
True
µµ+ /"
lbl_validaNuevoPrest
∂∂  
.
∂∂  !
Text
∂∂! %
=
∂∂& '
$str
∂∂( I
btnVerFicha
∑∑ 
.
∑∑ 
Enabled
∑∑ 
=
∑∑  !
True
∑∑" &
btnVerFicha
∏∏ 
.
∏∏ 
Visible
∏∏ 
=
∏∏  !
True
∏∏" &
ElseIf
∫∫ 

TipoGrabar
∫∫ 
=
∫∫ 
$str
∫∫ %
Then
∫∫& *
cls_Metodos
ªª 
.
ªª !
Actualizar_Prestamo
ªª +
(
ªª+ ,
v_IdPrestamo
ªª, 8
,
ªª8 9 
v_LibroCodRegistro
ªª: L
,
ªªL M
v_FechaPrestamo
ªªN ]
,
ªª] ^
v_FechaDevolucion
ºº, =
,
ºº= >
v_TipoOperacion
ºº? N
,
ººN O
v_FechaAnulacion
ººP `
)
ºº` a

btnGrabar2
ΩΩ 
.
ΩΩ 
Enabled
ΩΩ 
=
ΩΩ  
False
ΩΩ! &

Validacion
ææ 
(
ææ 
$str
ææ #
)
ææ# $

lbl_Valida
øø 
.
øø 
	ForeColor
øø  
=
øø! "
System
øø# )
.
øø) *
Drawing
øø* 1
.
øø1 2
Color
øø2 7
.
øø7 8
Green
øø8 =

lbl_Valida
¿¿ 
.
¿¿ 
Visible
¿¿ 
=
¿¿  
True
¿¿! %

lbl_Valida
¡¡ 
.
¡¡ 
Text
¡¡ 
=
¡¡ 
$str
¡¡ B
cargarLista50
¬¬ 
(
¬¬ 
)
¬¬ 
End
√√ 
If
√√ 
End
ƒƒ 
Sub
ƒƒ 
Public
»» 

Function
»» 
f_FormatoImagen
»» #
(
»»# $
ByVal
»»$ )
Foto
»»* .
As
»»/ 1
Byte
»»2 6
(
»»6 7
)
»»7 8
)
»»8 9
As
»»: <
String
»»= C
Return
…… 
$str
…… '
+
……( )
Convert
……* 1
.
……1 2
ToBase64String
……2 @
(
……@ A
Foto
……A E
)
……E F
End
   
Function
   
Private
ÃÃ 
Function
ÃÃ 
validarImagen
ÃÃ "
(
ÃÃ" #
ByVal
ÃÃ# (
	RowImagen
ÃÃ) 2
As
ÃÃ3 5
Object
ÃÃ6 <
,
ÃÃ< =
ByVal
ÃÃ> C
Rowtype
ÃÃD K
As
ÃÃL N
String
ÃÃO U
)
ÃÃU V
Dim
ÕÕ 
imagen
ÕÕ 
As
ÕÕ 
String
ÕÕ 
If
ŒŒ 

	RowImagen
ŒŒ 
IsNot
ŒŒ 
System
ŒŒ !
.
ŒŒ! "
DBNull
ŒŒ" (
.
ŒŒ( )
Value
ŒŒ) .
Then
ŒŒ/ 3
If
œœ 
Rowtype
œœ 
=
œœ 
$num
œœ 
Then
œœ 
imagen
–– 
=
–– 
f_FormatoImagen
–– (
(
––( )
	RowImagen
––) 2
)
––2 3
ElseIf
—— 
Rowtype
—— 
=
—— 
$num
—— 
Then
—— #
imagen
““ 
=
““ 
Convert
““  
.
““  !
ToBase64String
““! /
(
““/ 0
	RowImagen
““0 9
)
““9 :
End
”” 
If
”” 
Else
‘‘ 
imagen
’’ 
=
’’ 
$str
’’ 
End
÷÷ 
If
÷÷ 
Return
◊◊ 
imagen
◊◊ 
End
ÿÿ 
Function
ÿÿ 
Public
‹‹ 

Function
‹‹ 
verificarArchivo
‹‹ $
(
‹‹$ %
ByVal
‹‹% *
rutaFile
‹‹+ 3
As
‹‹4 6
String
‹‹7 =
)
‹‹= >
As
‹‹? A
Boolean
‹‹B I
Dim
›› 
web_response
›› 
As
›› 
HttpWebResponse
›› +
=
››, -
Nothing
››. 5
Try
ﬁﬁ 
Dim
ﬂﬂ 
web_request
ﬂﬂ 
As
ﬂﬂ 
HttpWebRequest
ﬂﬂ -
=
ﬂﬂ. /
HttpWebRequest
ﬂﬂ0 >
.
ﬂﬂ> ?
Create
ﬂﬂ? E
(
ﬂﬂE F
$str
ﬂﬂF M
&
ﬂﬂN O
rutaFile
ﬂﬂP X
)
ﬂﬂX Y
web_response
‡‡ 
=
‡‡ 

DirectCast
‡‡ %
(
‡‡% &
web_request
‡‡& 1
.
‡‡1 2
GetResponse
‡‡2 =
(
‡‡= >
)
‡‡> ?
,
‡‡? @
HttpWebResponse
‡‡A P
)
‡‡P Q
Return
·· 
True
·· 
Catch
‚‚ 
ex
‚‚ 
As
‚‚ 
	Exception
‚‚ 
Return
„„ 
False
„„ 
Finally
‰‰ 
If
ÂÂ 
Not
ÂÂ 
(
ÂÂ 
web_response
ÂÂ  
Is
ÂÂ! #
Nothing
ÂÂ$ +
)
ÂÂ+ ,
Then
ÂÂ- 1
web_response
ÂÂ2 >
.
ÂÂ> ?
Close
ÂÂ? D
(
ÂÂD E
)
ÂÂE F
End
ÊÊ 
Try
ÊÊ 
End
ÁÁ 
Function
ÁÁ 
Private
ÈÈ 
Sub
ÈÈ "
Listar_RegistroLibro
ÈÈ $
(
ÈÈ$ %
ByVal
ÈÈ% *
v_CodRegistro
ÈÈ+ 8
As
ÈÈ9 ;
String
ÈÈ< B
)
ÈÈB C
Dim
ÍÍ 
dt_Movimiento
ÍÍ 
As
ÍÍ 
	DataTable
ÍÍ &
dt_Movimiento
ÌÌ 
=
ÌÌ 
CapaNegocio
ÌÌ #
.
ÌÌ# $
cls_Metodos
ÌÌ$ /
.
ÌÌ/ 0%
ListarFormLibroGridView
ÌÌ0 G
(
ÌÌG H
$str
ÌÌH ^
,
ÌÌ^ _
v_CodRegistro
ÌÌ` m
)
ÌÌm n
.
ÌÌn o
Tables
ÌÌo u
(
ÌÌu v
$num
ÌÌv w
)
ÌÌw x
Dim
 
c_cCodRegistro
 
As
 
String
 $
=
% &
dt_Movimiento
' 4
.
4 5
Rows
5 9
(
9 :
$num
: ;
)
; <
(
< =
$str
= Q
)
Q R
.
R S
ToString
S [
(
[ \
)
\ ]
Dim
ÒÒ 
	c_cTitulo
ÒÒ 
As
ÒÒ 
String
ÒÒ 
=
ÒÒ  !
dt_Movimiento
ÒÒ" /
.
ÒÒ/ 0
Rows
ÒÒ0 4
(
ÒÒ4 5
$num
ÒÒ5 6
)
ÒÒ6 7
(
ÒÒ7 8
$str
ÒÒ8 G
)
ÒÒG H
.
ÒÒH I
ToString
ÒÒI Q
(
ÒÒQ R
)
ÒÒR S
Dim
ÚÚ 
c_cCodClasif
ÚÚ 
As
ÚÚ 
String
ÚÚ "
=
ÚÚ# $
dt_Movimiento
ÚÚ% 2
.
ÚÚ2 3
Rows
ÚÚ3 7
(
ÚÚ7 8
$num
ÚÚ8 9
)
ÚÚ9 :
(
ÚÚ: ;
$str
ÚÚ; T
)
ÚÚT U
.
ÚÚU V
ToString
ÚÚV ^
(
ÚÚ^ _
)
ÚÚ_ `
Dim
ÛÛ !
c_cEstadoMovimiento
ÛÛ 
As
ÛÛ  "
String
ÛÛ# )
=
ÛÛ* +
dt_Movimiento
ÛÛ, 9
.
ÛÛ9 :
Rows
ÛÛ: >
(
ÛÛ> ?
$num
ÛÛ? @
)
ÛÛ@ A
(
ÛÛA B
$str
ÛÛB Q
)
ÛÛQ R
.
ÛÛR S
ToString
ÛÛS [
If
ıı 
!
c_cEstadoMovimiento
ıı 
=
ıı  
$str
ıı! $
Or
ıı% '!
c_cEstadoMovimiento
ıı( ;
=
ıı< =
$str
ıı> @
Then
ııA E
lbl_validaLibro
ˆˆ 
.
ˆˆ 
Visible
ˆˆ #
=
ˆˆ$ %
True
ˆˆ& *
lbl_validaLibro
˜˜ 
.
˜˜ 
	ForeColor
˜˜ %
=
˜˜& '
System
˜˜( .
.
˜˜. /
Drawing
˜˜/ 6
.
˜˜6 7
Color
˜˜7 <
.
˜˜< =
Green
˜˜= B
lbl_validaLibro
¯¯ 
.
¯¯ 
Text
¯¯  
=
¯¯! "
$str
¯¯# G
btn_Prestamo
˘˘ 
.
˘˘ 
Disabled
˘˘ !
=
˘˘" #
False
˘˘$ )
imgDisponible
˙˙ 
.
˙˙ 
Src
˙˙ 
=
˙˙ 
$str
˙˙  ?
ElseIf
˚˚ !
c_cEstadoMovimiento
˚˚ "
=
˚˚# $
$str
˚˚% (
Then
˚˚) -
lbl_validaLibro
¸¸ 
.
¸¸ 
Visible
¸¸ #
=
¸¸$ %
True
¸¸& *
lbl_validaLibro
˝˝ 
.
˝˝ 
	ForeColor
˝˝ %
=
˝˝& '
System
˝˝( .
.
˝˝. /
Drawing
˝˝/ 6
.
˝˝6 7
Color
˝˝7 <
.
˝˝< =
Red
˝˝= @
lbl_validaLibro
˛˛ 
.
˛˛ 
Text
˛˛  
=
˛˛! "
$str
˛˛# ?
btn_Prestamo
ˇˇ 
.
ˇˇ 
Disabled
ˇˇ !
=
ˇˇ" #
True
ˇˇ$ (
imgDisponible
ÄÄ 
.
ÄÄ 
Src
ÄÄ 
=
ÄÄ 
$str
ÄÄ  =
ElseIf
ÅÅ !
c_cEstadoMovimiento
ÅÅ "
=
ÅÅ# $
$str
ÅÅ% (
Then
ÅÅ) -
lbl_validaLibro
ÇÇ 
.
ÇÇ 
Visible
ÇÇ #
=
ÇÇ$ %
True
ÇÇ& *
lbl_validaLibro
ÉÉ 
.
ÉÉ 
	ForeColor
ÉÉ %
=
ÉÉ& '
System
ÉÉ( .
.
ÉÉ. /
Drawing
ÉÉ/ 6
.
ÉÉ6 7
Color
ÉÉ7 <
.
ÉÉ< =
Red
ÉÉ= @
lbl_validaLibro
ÑÑ 
.
ÑÑ 
Text
ÑÑ  
=
ÑÑ! "
$str
ÑÑ# A
btn_Prestamo
ÖÖ 
.
ÖÖ 
Disabled
ÖÖ !
=
ÖÖ" #
False
ÖÖ$ )
imgDisponible
ÜÜ 
.
ÜÜ 
Src
ÜÜ 
=
ÜÜ 
$str
ÜÜ  @
End
áá 
If
áá 
If
ââ 

True
ââ 
Then
ââ 
imgLibro
ää 
.
ää 
Src
ää 
=
ää 
vRutaPortada
ää '
&
ää( )
Trim
ää* .
(
ää. /
v_CodRegistro
ää/ <
)
ää< =
&
ää> ?
$str
ää@ J
Else
ãã 
imgLibro
åå 
.
åå 
Src
åå 
=
åå 
	noPortada
åå $
&
åå% &
$str
åå' <
End
çç 
If
çç 
txt_A_tituloLibro
èè 
.
èè 
	InnerText
èè #
=
èè$ %
	c_cTitulo
èè& /
.
èè/ 0
Trim
èè0 4
lbl_codClasif
êê 
.
êê 
Text
êê 
=
êê 
c_cCodClasif
êê )
.
êê) *
Trim
êê* ."
txt_codRegistroLibro
ëë 
.
ëë 
Text
ëë !
=
ëë" #
c_cCodRegistro
ëë$ 2
.
ëë2 3
Trim
ëë3 7
txt_A_Librotitulo
íí 
.
íí 
	InnerText
íí #
=
íí$ %
	c_cTitulo
íí& /
.
íí/ 0
Trim
íí0 4
End
ìì 
Sub
ìì 
Private
ññ 
Sub
ññ #
Listar_RegistroLector
ññ %
(
ññ% &
ByVal
ññ& +
v_CodEmpleado
ññ, 9
As
ññ: <
String
ññ= C
)
ññC D
Dim
óó 
dt_Movimiento
óó 
As
óó 
	DataTable
óó &
dt_Movimiento
öö 
=
öö 
CapaNegocio
öö #
.
öö# $
cls_Metodos
öö$ /
.
öö/ 0&
ListarFormLectorGridVieW
öö0 H
(
ööH I
v_CodEmpleado
ööI V
)
ööV W
.
ööW X
Tables
ööX ^
(
öö^ _
$num
öö_ `
)
öö` a
Dim
úú  
c_cApellidoPaterno
úú 
As
úú !
String
úú" (
=
úú) *
dt_Movimiento
úú+ 8
.
úú8 9
Rows
úú9 =
(
úú= >
$num
úú> ?
)
úú? @
(
úú@ A
$str
úúA T
)
úúT U
.
úúU V
ToString
úúV ^
(
úú^ _
)
úú_ `
Dim
ùù  
c_cApellidoMaterno
ùù 
As
ùù !
String
ùù" (
=
ùù) *
dt_Movimiento
ùù+ 8
.
ùù8 9
Rows
ùù9 =
(
ùù= >
$num
ùù> ?
)
ùù? @
(
ùù@ A
$str
ùùA T
)
ùùT U
.
ùùU V
ToString
ùùV ^
(
ùù^ _
)
ùù_ `
Dim
ûû 
c_cPrimerNombre
ûû 
As
ûû 
String
ûû %
=
ûû& '
dt_Movimiento
ûû( 5
.
ûû5 6
Rows
ûû6 :
(
ûû: ;
$num
ûû; <
)
ûû< =
(
ûû= >
$str
ûû> R
)
ûûR S
.
ûûS T
ToString
ûûT \
(
ûû\ ]
)
ûû] ^
Dim
üü 
c_cSegundoNombre
üü 
As
üü 
String
üü  &
=
üü' (
dt_Movimiento
üü) 6
.
üü6 7
Rows
üü7 ;
(
üü; <
$num
üü< =
)
üü= >
(
üü> ?
$str
üü? T
)
üüT U
.
üüU V
ToString
üüV ^
(
üü^ _
)
üü_ `
Dim
†† 
c_cCodEmpleado
†† 
As
†† 
String
†† $
=
††% &
dt_Movimiento
††' 4
.
††4 5
Rows
††5 9
(
††9 :
$num
††: ;
)
††; <
(
††< =
$str
††= L
)
††L M
.
††M N
ToString
††N V
(
††V W
)
††W X
Dim
°° 
c_cFoto_imagen
°° 
As
°° 
String
°° $
=
°°% &
validarImagen
°°' 4
(
°°4 5
dt_Movimiento
°°5 B
.
°°B C
Rows
°°C G
(
°°G H
$num
°°H I
)
°°I J
(
°°J K
$str
°°K Y
)
°°Y Z
,
°°Z [
$num
°°\ ]
)
°°] ^
txt_A_apeYNombres
££ 
.
££ 
	InnerText
££ #
=
££$ % 
c_cApellidoPaterno
££& 8
+
££9 :
$str
££; >
+
££? @ 
c_cApellidoMaterno
££A S
+
££T U
$str
££V Y
+
££Z [
c_cPrimerNombre
££\ k
+
££l m
$str
££n q
+
££r s
c_cSegundoNombre££t Ñ
txt_codEmpleado
§§ 
.
§§ 
Text
§§ 
=
§§ 
c_cCodEmpleado
§§ -
.
§§- .
Trim
§§. 2"
txt_A_NombreEmpleado
•• 
.
•• 
	InnerText
•• &
=
••' ( 
c_cApellidoPaterno
••) ;
+
••< =
$str
••> A
+
••B C 
c_cApellidoMaterno
••D V
+
••W X
$str
••Y \
+
••] ^
c_cPrimerNombre
••_ n
+
••o p
$str
••q t
+
••u v
c_cSegundoNombre••w á
	imgLector
¶¶ 
.
¶¶ 
ImageUrl
¶¶ 
=
¶¶ 
c_cFoto_imagen
¶¶ +
End
ßß 
Sub
ßß 
Private
©© 
Sub
©© %
Listar_RegistroPrestamo
©© '
(
©©' (
ByVal
©©( -
v_CodPrestamo
©©. ;
As
©©< >
String
©©? E
)
©©E F
Dim
™™ 
dt_Movimiento
™™ 
As
™™ 
	DataTable
™™ &
dt_Movimiento
≠≠ 
=
≠≠ 
CapaNegocio
≠≠ #
.
≠≠# $
cls_Metodos
≠≠$ /
.
≠≠/ 0(
ListarFormPrestamoGridVieW
≠≠0 J
(
≠≠J K
v_CodPrestamo
≠≠K X
)
≠≠X Y
.
≠≠Y Z
Tables
≠≠Z `
(
≠≠` a
$num
≠≠a b
)
≠≠b c
Dim
ØØ 
c_cIdPrestamo
ØØ 
As
ØØ 
String
ØØ #
=
ØØ$ %
dt_Movimiento
ØØ& 3
.
ØØ3 4
Rows
ØØ4 8
(
ØØ8 9
$num
ØØ9 :
)
ØØ: ;
(
ØØ; <
$str
ØØ< J
)
ØØJ K
.
ØØK L
ToString
ØØL T
Dim
∞∞ 

c_cNombres
∞∞ 
As
∞∞ 
String
∞∞  
=
∞∞! "
dt_Movimiento
∞∞# 0
.
∞∞0 1
Rows
∞∞1 5
(
∞∞5 6
$num
∞∞6 7
)
∞∞7 8
(
∞∞8 9
$str
∞∞9 I
)
∞∞I J
.
∞∞J K
ToString
∞∞K S
Dim
±± 
c_cCodEmpleado
±± 
As
±± 
String
±± $
=
±±% &
dt_Movimiento
±±' 4
.
±±4 5
Rows
±±5 9
(
±±9 :
$num
±±: ;
)
±±; <
(
±±< =
$str
±±= R
)
±±R S
.
±±S T
ToString
±±T \
(
±±\ ]
)
±±] ^
Dim
≤≤ !
c_cCodRegistroLibro
≤≤ 
As
≤≤  "
String
≤≤# )
=
≤≤* +
dt_Movimiento
≤≤, 9
.
≤≤9 :
Rows
≤≤: >
(
≤≤> ?
$num
≤≤? @
)
≤≤@ A
(
≤≤A B
$str
≤≤B V
)
≤≤V W
.
≤≤W X
ToString
≤≤X `
(
≤≤` a
)
≤≤a b
Dim
≥≥ 
c_cTituloLibro
≥≥ 
As
≥≥ 
String
≥≥ $
=
≥≥% &
dt_Movimiento
≥≥' 4
.
≥≥4 5
Rows
≥≥5 9
(
≥≥9 :
$num
≥≥: ;
)
≥≥; <
(
≥≥< =
$str
≥≥= L
)
≥≥L M
.
≥≥M N
ToString
≥≥N V
(
≥≥V W
)
≥≥W X
Dim
¥¥ 
c_cFechaPrestamo
¥¥ 
As
¥¥ 
String
¥¥  &
=
¥¥' (
dt_Movimiento
¥¥) 6
.
¥¥6 7
Rows
¥¥7 ;
(
¥¥; <
$num
¥¥< =
)
¥¥= >
(
¥¥> ?
$str
¥¥? Q
)
¥¥Q R
.
¥¥R S
ToString
¥¥S [
(
¥¥[ \
)
¥¥\ ]
Dim
µµ  
c_cFechaDevolucion
µµ 
As
µµ !
String
µµ" (
=
µµ) *
dt_Movimiento
µµ+ 8
.
µµ8 9
Rows
µµ9 =
(
µµ= >
$num
µµ> ?
)
µµ? @
(
µµ@ A
$str
µµA W
)
µµW X
.
µµX Y
ToString
µµY a
(
µµa b
)
µµb c
Dim
∂∂ 
c_cFechaReserva
∂∂ 
As
∂∂ 
String
∂∂ %
=
∂∂& '
dt_Movimiento
∂∂( 5
.
∂∂5 6
Rows
∂∂6 :
(
∂∂: ;
$num
∂∂; <
)
∂∂< =
(
∂∂= >
$str
∂∂> Q
)
∂∂Q R
.
∂∂R S
ToString
∂∂S [
(
∂∂[ \
)
∂∂\ ]
Dim
∑∑ 
	c_cEstado
∑∑ 
As
∑∑ 
String
∑∑ 
=
∑∑  !
dt_Movimiento
∑∑" /
.
∑∑/ 0
Rows
∑∑0 4
(
∑∑4 5
$num
∑∑5 6
)
∑∑6 7
(
∑∑7 8
$str
∑∑8 E
)
∑∑E F
.
∑∑F G
ToString
∑∑G O
(
∑∑O P
)
∑∑P Q
Dim
∏∏ 
c_cPrestProvincia
∏∏ 
As
∏∏  
String
∏∏! '
=
∏∏( )
dt_Movimiento
∏∏* 7
.
∏∏7 8
Rows
∏∏8 <
(
∏∏< =
$num
∏∏= >
)
∏∏> ?
(
∏∏? @
$str
∏∏@ O
)
∏∏O P
.
∏∏P Q
ToString
∏∏Q Y
(
∏∏Y Z
)
∏∏Z [
Dim
ππ 
c_cPrestEspecial
ππ 
As
ππ 
String
ππ  &
=
ππ' (
dt_Movimiento
ππ) 6
.
ππ6 7
Rows
ππ7 ;
(
ππ; <
$num
ππ< =
)
ππ= >
(
ππ> ?
$str
ππ? P
)
ππP Q
.
ππQ R
ToString
ππR Z
(
ππZ [
)
ππ[ \
txt_codEmpleado
ªª 
.
ªª 
Text
ªª 
=
ªª 
c_cCodEmpleado
ªª -
.
ªª- .
Trim
ªª. 2"
txt_A_NombreEmpleado
ºº 
.
ºº 
	InnerText
ºº &
=
ºº' (

c_cNombres
ºº) 3
.
ºº3 4
Trim
ºº4 8"
txt_codRegistroLibro
ΩΩ 
.
ΩΩ 
Text
ΩΩ !
=
ΩΩ" #!
c_cCodRegistroLibro
ΩΩ$ 7
.
ΩΩ7 8
Trim
ΩΩ8 <
txt_A_Librotitulo
ææ 
.
ææ 
	InnerText
ææ #
=
ææ$ %
c_cTituloLibro
ææ& 4
.
ææ4 5
Trim
ææ5 9
If
¿¿ 

c_cPrestProvincia
¿¿ 
=
¿¿ 
$str
¿¿ "
Then
¿¿# '
chk_PProvincia
¡¡ 
.
¡¡ 
Checked
¡¡ "
=
¡¡# $
False
¡¡% *
ElseIf
¬¬ 
c_cPrestProvincia
¬¬  
=
¬¬! "
$str
¬¬# &
Then
¬¬' +
chk_PProvincia
√√ 
.
√√ 
Checked
√√ "
=
√√# $
True
√√% )
End
ƒƒ 
If
ƒƒ 
If
∆∆ 

c_cPrestEspecial
∆∆ 
.
∆∆ 
Trim
∆∆  
=
∆∆! "
$str
∆∆# &
Then
∆∆' +
chk_PEspecial
«« 
.
«« 
Checked
«« !
=
««" #
False
««$ )
ElseIf
»» 
c_cPrestEspecial
»» 
.
»»  
Trim
»»  $
=
»»% &
$str
»»' *
Then
»»+ /
chk_PEspecial
…… 
.
…… 
Checked
…… !
=
……" #
True
……$ (
End
   
If
   
If
ÃÃ 

	c_cEstado
ÃÃ 
=
ÃÃ 
$str
ÃÃ 
Then
ÃÃ 
Dim
ÕÕ 
tupla_FechaHora
ÕÕ 
As
ÕÕ  "
Tuple
ÕÕ# (
(
ÕÕ( )
Of
ÕÕ) +
String
ÕÕ, 2
,
ÕÕ2 3
String
ÕÕ4 :
)
ÕÕ: ;
=
ÕÕ< = 
Formato_Fecha_Hora
ÕÕ> P
(
ÕÕP Q
)
ÕÕQ R
txt_FechaPrestamo
ŒŒ 
.
ŒŒ 
Text
ŒŒ "
=
ŒŒ# $
(
ŒŒ% &
tupla_FechaHora
ŒŒ& 5
.
ŒŒ5 6
Item1
ŒŒ6 ;
)
ŒŒ; <
Else
œœ 
txt_FechaPrestamo
–– 
.
–– 
Text
–– "
=
––# $
c_cFechaPrestamo
––% 5
.
––5 6
Trim
––6 :!
txt_FechaDevolucion
—— 
.
——  
Text
——  $
=
——% & 
c_cFechaDevolucion
——' 9
.
——9 :
Trim
——: >
End
““ 
If
““ 
txt_FechaReserva
‘‘ 
.
‘‘ 
Text
‘‘ 
=
‘‘ 
c_cFechaReserva
‘‘  /
.
‘‘/ 0
Trim
‘‘0 4
txt_CodPrestamo2
’’ 
.
’’ 
Text
’’ 
=
’’ 
c_cIdPrestamo
’’  -
lbl_IdPrestamo
÷÷ 
.
÷÷ 
Text
÷÷ 
=
÷÷ 
c_cIdPrestamo
÷÷ +!
cbox_EstadoPrestamo
◊◊ 
.
◊◊ 
SelectedIndex
◊◊ )
=
◊◊* +
-
◊◊, -
$num
◊◊- .
If
ŸŸ 

IsDBNull
ŸŸ 
(
ŸŸ 
	c_cEstado
ŸŸ 
.
ŸŸ 
ToString
ŸŸ &
)
ŸŸ& '
Or
ŸŸ( *
	c_cEstado
ŸŸ+ 4
.
ŸŸ4 5
ToString
ŸŸ5 =
=
ŸŸ> ?
$str
ŸŸ@ B
Then
ŸŸC G!
cbox_EstadoPrestamo
⁄⁄ 
.
⁄⁄  
Items
⁄⁄  %
.
⁄⁄% &
FindByValue
⁄⁄& 1
(
⁄⁄1 2
$str
⁄⁄2 5
)
⁄⁄5 6
.
⁄⁄6 7
Selected
⁄⁄7 ?
=
⁄⁄@ A
True
⁄⁄B F
Else
€€ !
cbox_EstadoPrestamo
‹‹ 
.
‹‹  
Items
‹‹  %
.
‹‹% &
FindByValue
‹‹& 1
(
‹‹1 2
Trim
‹‹2 6
(
‹‹6 7
Left
‹‹7 ;
(
‹‹; <
	c_cEstado
‹‹< E
.
‹‹E F
ToString
‹‹F N
,
‹‹N O
$num
‹‹P Q
)
‹‹Q R
)
‹‹R S
)
‹‹S T
.
‹‹T U
Selected
‹‹U ]
=
‹‹^ _
True
‹‹` d
End
›› 
If
›› 
End
ﬁﬁ 
Sub
ﬁﬁ 
	Protected
„„ 
Sub
„„ '
grv_Lector_OnRowDataBound
„„ +
(
„„+ ,
ByVal
„„, 1
sender
„„2 8
As
„„9 ;
Object
„„< B
,
„„B C
ByVal
„„D I
e
„„J K
As
„„L N"
GridViewRowEventArgs
„„O c
)
„„c d
Try
‰‰ 
If
ÂÂ 
e
ÂÂ 
.
ÂÂ 
Row
ÂÂ 
.
ÂÂ 
RowType
ÂÂ 
=
ÂÂ  
DataControlRowType
ÂÂ 1
.
ÂÂ1 2
DataRow
ÂÂ2 9
Then
ÂÂ: >
Dim
ÊÊ 
dr
ÊÊ 
As
ÊÊ 
DataRowView
ÊÊ %
=
ÊÊ& '
CType
ÊÊ( -
(
ÊÊ- .
e
ÊÊ. /
.
ÊÊ/ 0
Row
ÊÊ0 3
.
ÊÊ3 4
DataItem
ÊÊ4 <
,
ÊÊ< =
DataRowView
ÊÊ> I
)
ÊÊI J
Dim
ËË 
c_cCodEmpleado
ËË "
As
ËË# %
String
ËË& ,
If
ÈÈ 
Not
ÈÈ 
IsDBNull
ÈÈ 
(
ÈÈ  
dr
ÈÈ  "
(
ÈÈ" #
$str
ÈÈ# 2
)
ÈÈ2 3
)
ÈÈ3 4
Then
ÈÈ5 9
c_cCodEmpleado
ÍÍ "
=
ÍÍ# $
dr
ÍÍ% '
(
ÍÍ' (
$str
ÍÍ( 7
)
ÍÍ7 8
Else
ÎÎ 
c_cCodEmpleado
ÏÏ "
=
ÏÏ# $
$str
ÏÏ% (
End
ÌÌ 
If
ÌÌ 
Dim
ÔÔ 
c_cDniEmpleado
ÔÔ "
As
ÔÔ# %
String
ÔÔ& ,
If
 
Not
 
IsDBNull
 
(
  
dr
  "
(
" #
$str
# 2
)
2 3
)
3 4
Then
5 9
c_cDniEmpleado
ÒÒ "
=
ÒÒ# $
dr
ÒÒ% '
(
ÒÒ' (
$str
ÒÒ( 7
)
ÒÒ7 8
Else
ÚÚ 
c_cDniEmpleado
ÛÛ "
=
ÛÛ# $
$str
ÛÛ% (
End
ÙÙ 
If
ÙÙ 
Dim
ˆˆ 
c_cApellidoP
ˆˆ  
As
ˆˆ! #
String
ˆˆ$ *
If
˜˜ 
Not
˜˜ 
IsDBNull
˜˜ 
(
˜˜  
dr
˜˜  "
(
˜˜" #
$str
˜˜# 6
)
˜˜6 7
)
˜˜7 8
Then
˜˜9 =
c_cApellidoP
¯¯  
=
¯¯! "
dr
¯¯# %
(
¯¯% &
$str
¯¯& 9
)
¯¯9 :
Else
˘˘ 
c_cApellidoP
˙˙  
=
˙˙! "
$str
˙˙# &
End
˚˚ 
If
˚˚ 
Dim
˝˝ 
c_cApellidoM
˝˝  
As
˝˝! #
String
˝˝$ *
If
˛˛ 
Not
˛˛ 
IsDBNull
˛˛ 
(
˛˛  
dr
˛˛  "
(
˛˛" #
$str
˛˛# 6
)
˛˛6 7
)
˛˛7 8
Then
˛˛9 =
c_cApellidoM
ˇˇ  
=
ˇˇ! "
dr
ˇˇ# %
(
ˇˇ% &
$str
ˇˇ& 9
)
ˇˇ9 :
Else
Ä	Ä	 
c_cApellidoM
Å	Å	  
=
Å	Å	! "
$str
Å	Å	# &
End
Ç	Ç	 
If
Ç	Ç	 
Dim
Ñ	Ñ	 
c_cPrimerNombre
Ñ	Ñ	 #
As
Ñ	Ñ	$ &
String
Ñ	Ñ	' -
If
Ö	Ö	 
Not
Ö	Ö	 
IsDBNull
Ö	Ö	 
(
Ö	Ö	  
dr
Ö	Ö	  "
(
Ö	Ö	" #
$str
Ö	Ö	# 7
)
Ö	Ö	7 8
)
Ö	Ö	8 9
Then
Ö	Ö	: >
c_cPrimerNombre
Ü	Ü	 #
=
Ü	Ü	$ %
dr
Ü	Ü	& (
(
Ü	Ü	( )
$str
Ü	Ü	) =
)
Ü	Ü	= >
Else
á	á	 
c_cPrimerNombre
à	à	 #
=
à	à	$ %
$str
à	à	& )
End
â	â	 
If
â	â	 
Dim
ã	ã	 
c_cSegundoNombre
ã	ã	 $
As
ã	ã	% '
String
ã	ã	( .
If
å	å	 
Not
å	å	 
IsDBNull
å	å	 
(
å	å	  
dr
å	å	  "
(
å	å	" #
$str
å	å	# 8
)
å	å	8 9
)
å	å	9 :
Then
å	å	; ?
c_cSegundoNombre
ç	ç	 $
=
ç	ç	% &
dr
ç	ç	' )
(
ç	ç	) *
$str
ç	ç	* ?
)
ç	ç	? @
Else
é	é	 
c_cSegundoNombre
è	è	 $
=
è	è	% &
$str
è	è	' *
End
ê	ê	 
If
ê	ê	 
CType
í	í	 
(
í	í	 
e
í	í	 
.
í	í	 
Row
í	í	 
.
í	í	 
FindControl
í	í	 '
(
í	í	' (
$str
í	í	( 9
)
í	í	9 :
,
í	í	: ;
WebControls
í	í	< G
.
í	í	G H
Label
í	í	H M
)
í	í	M N
.
í	í	N O
Text
í	í	O S
=
í	í	T U
c_cCodEmpleado
í	í	V d
CType
ì	ì	 
(
ì	ì	 
e
ì	ì	 
.
ì	ì	 
Row
ì	ì	 
.
ì	ì	 
FindControl
ì	ì	 '
(
ì	ì	' (
$str
ì	ì	( 9
)
ì	ì	9 :
,
ì	ì	: ;
WebControls
ì	ì	< G
.
ì	ì	G H
Label
ì	ì	H M
)
ì	ì	M N
.
ì	ì	N O
Text
ì	ì	O S
=
ì	ì	T U
c_cDniEmpleado
ì	ì	V d
CType
î	î	 
(
î	î	 
e
î	î	 
.
î	î	 
Row
î	î	 
.
î	î	 
FindControl
î	î	 '
(
î	î	' (
$str
î	î	( 7
)
î	î	7 8
,
î	î	8 9
WebControls
î	î	: E
.
î	î	E F
Label
î	î	F K
)
î	î	K L
.
î	î	L M
Text
î	î	M Q
=
î	î	R S
c_cApellidoP
î	î	T `
+
î	î	a b
$str
î	î	c f
+
î	î	g h
c_cApellidoM
î	î	i u
CType
ï	ï	 
(
ï	ï	 
e
ï	ï	 
.
ï	ï	 
Row
ï	ï	 
.
ï	ï	 
FindControl
ï	ï	 '
(
ï	ï	' (
$str
ï	ï	( :
)
ï	ï	: ;
,
ï	ï	; <
WebControls
ï	ï	= H
.
ï	ï	H I
Label
ï	ï	I N
)
ï	ï	N O
.
ï	ï	O P
Text
ï	ï	P T
=
ï	ï	U V
c_cPrimerNombre
ï	ï	W f
CType
ñ	ñ	 
(
ñ	ñ	 
e
ñ	ñ	 
.
ñ	ñ	 
Row
ñ	ñ	 
.
ñ	ñ	 
FindControl
ñ	ñ	 '
(
ñ	ñ	' (
$str
ñ	ñ	( ;
)
ñ	ñ	; <
,
ñ	ñ	< =
WebControls
ñ	ñ	> I
.
ñ	ñ	I J
Label
ñ	ñ	J O
)
ñ	ñ	O P
.
ñ	ñ	P Q
Text
ñ	ñ	Q U
=
ñ	ñ	V W
c_cSegundoNombre
ñ	ñ	X h
End
ò	ò	 
If
ò	ò	 
Catch
ô	ô	 
ex
ô	ô	 
As
ô	ô	 
	Exception
ô	ô	 

lbl_Valida
ö	ö	 
.
ö	ö	 
Text
ö	ö	 
=
ö	ö	 
ex
ö	ö	  
.
ö	ö	  !
Message
ö	ö	! (

lbl_Valida
õ	õ	 
.
õ	õ	 
	ForeColor
õ	õ	  
=
õ	õ	! "
System
õ	õ	# )
.
õ	õ	) *
Drawing
õ	õ	* 1
.
õ	õ	1 2
Color
õ	õ	2 7
.
õ	õ	7 8
Red
õ	õ	8 ;
End
ú	ú	 
Try
ú	ú	 
End
ù	ù	 
Sub
ù	ù	 
	Protected
†	†	 
Sub
†	†	 *
grv_Lector_PageIndexChanging
†	†	 .
(
†	†	. /
ByVal
†	†	/ 4
sender
†	†	5 ;
As
†	†	< >
Object
†	†	? E
,
†	†	E F
ByVal
†	†	G L
e
†	†	M N
As
†	†	O Q
System
†	†	R X
.
†	†	X Y
Web
†	†	Y \
.
†	†	\ ]
UI
†	†	] _
.
†	†	_ `
WebControls
†	†	` k
.
†	†	k l$
GridViewPageEventArgs†	†	l Å
)†	†	Å Ç
Handles†	†	É ä

grv_Lector†	†	ã ï
.†	†	ï ñ!
PageIndexChanging†	†	ñ ß
Try
°	°	 

grv_Lector
£	£	 
.
£	£	 
	PageIndex
£	£	  
=
£	£	! "
e
£	£	# $
.
£	£	$ %
NewPageIndex
£	£	% 1
If
•	•	 
Session
•	•	 
(
•	•	 
$str
•	•	 "
)
•	•	" #
=
•	•	$ %
$str
•	•	& )
Then
•	•	* .
ElseIf
ß	ß	 
Session
ß	ß	 
(
ß	ß	 
$str
ß	ß	 &
)
ß	ß	& '
=
ß	ß	( )
$str
ß	ß	* -
Then
ß	ß	. 2
Dim
®	®	 
valor
®	®	 
As
®	®	 
String
®	®	 #
=
®	®	$ %
Session
®	®	& -
(
®	®	- .
$str
®	®	. 9
)
®	®	9 :
Dim
©	©	 
vBandera
©	©	 
As
©	©	 
String
©	©	  &
=
©	©	' (
Session
©	©	) 0
(
©	©	0 1
$str
©	©	1 ;
)
©	©	; <

grv_Lector
´	´	 
.
´	´	 

DataSource
´	´	 %
=
´	´	& '
cls_Metodos
´	´	( 3
.
´	´	3 4
BuscarLector
´	´	4 @
(
´	´	@ A
valor
´	´	A F
,
´	´	F G
vBandera
´	´	H P
)
´	´	P Q

grv_Lector
¨	¨	 
.
¨	¨	 
DataBind
¨	¨	 #
(
¨	¨	# $
)
¨	¨	$ %
End
≠	≠	 
If
≠	≠	 
Catch
Æ	Æ	 
ex
Æ	Æ	 
As
Æ	Æ	 
	Exception
Æ	Æ	 

lbl_Valida
Ø	Ø	 
.
Ø	Ø	 
Text
Ø	Ø	 
=
Ø	Ø	 
ex
Ø	Ø	  
.
Ø	Ø	  !
Message
Ø	Ø	! (

lbl_Valida
∞	∞	 
.
∞	∞	 
	ForeColor
∞	∞	  
=
∞	∞	! "
System
∞	∞	# )
.
∞	∞	) *
Drawing
∞	∞	* 1
.
∞	∞	1 2
Color
∞	∞	2 7
.
∞	∞	7 8
Red
∞	∞	8 ;
End
±	±	 
Try
±	±	 
End
≤	≤	 
Sub
≤	≤	 
	Protected
µ	µ	 
Sub
µ	µ	 -
grv_Lector_SelectedIndexChanged
µ	µ	 1
(
µ	µ	1 2
sender
µ	µ	2 8
As
µ	µ	9 ;
Object
µ	µ	< B
,
µ	µ	B C
e
µ	µ	D E
As
µ	µ	F H
	EventArgs
µ	µ	I R
)
µ	µ	R S
Handles
µ	µ	T [

grv_Lector
µ	µ	\ f
.
µ	µ	f g"
SelectedIndexChanged
µ	µ	g {
Try
∂	∂	 
Dim
∑	∑	 
v_codEmpleado
∑	∑	 
As
∑	∑	  
String
∑	∑	! '
=
∑	∑	( )
TryCast
∑	∑	* 1
(
∑	∑	1 2

grv_Lector
∑	∑	2 <
.
∑	∑	< =
SelectedRow
∑	∑	= H
.
∑	∑	H I
FindControl
∑	∑	I T
(
∑	∑	T U
$str
∑	∑	U f
)
∑	∑	f g
,
∑	∑	g h
Label
∑	∑	i n
)
∑	∑	n o
.
∑	∑	o p
Text
∑	∑	p t
Session
∏	∏	 
(
∏	∏	 
$str
∏	∏	 !
)
∏	∏	! "
=
∏	∏	# $
v_codEmpleado
∏	∏	% 2#
Listar_RegistroLector
π	π	 !
(
π	π	! "
v_codEmpleado
π	π	" /
)
π	π	/ 0
Catch
∫	∫	 
ex
∫	∫	 
As
∫	∫	 
	Exception
∫	∫	 

lbl_Valida
ª	ª	 
.
ª	ª	 
Text
ª	ª	 
=
ª	ª	 
ex
ª	ª	  
.
ª	ª	  !
Message
ª	ª	! (

lbl_Valida
º	º	 
.
º	º	 
	ForeColor
º	º	  
=
º	º	! "
System
º	º	# )
.
º	º	) *
Drawing
º	º	* 1
.
º	º	1 2
Color
º	º	2 7
.
º	º	7 8
Red
º	º	8 ;
End
Ω	Ω	 
Try
Ω	Ω	 
End
æ	æ	 
Sub
æ	æ	 
	Protected
¬	¬	 
Sub
¬	¬	 &
grv_Libro_OnRowDataBound
¬	¬	 *
(
¬	¬	* +
ByVal
¬	¬	+ 0
sender
¬	¬	1 7
As
¬	¬	8 :
Object
¬	¬	; A
,
¬	¬	A B
ByVal
¬	¬	C H
e
¬	¬	I J
As
¬	¬	K M"
GridViewRowEventArgs
¬	¬	N b
)
¬	¬	b c
Try
√	√	 
If
ƒ	ƒ	 
e
ƒ	ƒ	 
.
ƒ	ƒ	 
Row
ƒ	ƒ	 
.
ƒ	ƒ	 
RowType
ƒ	ƒ	 
=
ƒ	ƒ	  
DataControlRowType
ƒ	ƒ	 1
.
ƒ	ƒ	1 2
DataRow
ƒ	ƒ	2 9
Then
ƒ	ƒ	: >
Dim
≈	≈	 
dr
≈	≈	 
As
≈	≈	 
DataRowView
≈	≈	 %
=
≈	≈	& '
CType
≈	≈	( -
(
≈	≈	- .
e
≈	≈	. /
.
≈	≈	/ 0
Row
≈	≈	0 3
.
≈	≈	3 4
DataItem
≈	≈	4 <
,
≈	≈	< =
DataRowView
≈	≈	> I
)
≈	≈	I J
Dim
«	«	 $
c_cCodigoClasificacion
«	«	 *
As
«	«	+ -
String
«	«	. 4
If
»	»	 
Not
»	»	 
IsDBNull
»	»	 
(
»	»	  
dr
»	»	  "
(
»	»	" #
$str
»	»	# <
)
»	»	< =
)
»	»	= >
Then
»	»	? C$
c_cCodigoClasificacion
…	…	 *
=
…	…	+ ,
dr
…	…	- /
(
…	…	/ 0
$str
…	…	0 I
)
…	…	I J
Else
 	 	 $
c_cCodigoClasificacion
À	À	 *
=
À	À	+ ,
$str
À	À	- 0
End
Ã	Ã	 
If
Ã	Ã	 
Dim
Œ	Œ	 
c_cCodigoRegistro
Œ	Œ	 %
As
Œ	Œ	& (
String
Œ	Œ	) /
If
œ	œ	 
Not
œ	œ	 
IsDBNull
œ	œ	 
(
œ	œ	  
dr
œ	œ	  "
(
œ	œ	" #
$str
œ	œ	# 7
)
œ	œ	7 8
)
œ	œ	8 9
Then
œ	œ	: >
c_cCodigoRegistro
–	–	 %
=
–	–	& '
dr
–	–	( *
(
–	–	* +
$str
–	–	+ ?
)
–	–	? @
Else
—	—	 
c_cCodigoRegistro
“	“	 %
=
“	“	& '
$str
“	“	( +
End
”	”	 
If
”	”	 
Dim
’	’	 
	c_cTitulo
’	’	 
As
’	’	  
String
’	’	! '
If
÷	÷	 
Not
÷	÷	 
IsDBNull
÷	÷	 
(
÷	÷	  
dr
÷	÷	  "
(
÷	÷	" #
$str
÷	÷	# 2
)
÷	÷	2 3
)
÷	÷	3 4
Then
÷	÷	5 9
	c_cTitulo
◊	◊	 
=
◊	◊	 
dr
◊	◊	  "
(
◊	◊	" #
$str
◊	◊	# 2
)
◊	◊	2 3
Else
ÿ	ÿ	 
	c_cTitulo
Ÿ	Ÿ	 
=
Ÿ	Ÿ	 
$str
Ÿ	Ÿ	  #
End
⁄	⁄	 
If
⁄	⁄	 
Dim
‹	‹	 
c_cAutor
‹	‹	 
As
‹	‹	 
String
‹	‹	  &
If
›	›	 
Not
›	›	 
IsDBNull
›	›	 
(
›	›	  
dr
›	›	  "
(
›	›	" #
$str
›	›	# 1
)
›	›	1 2
)
›	›	2 3
Then
›	›	4 8
c_cAutor
ﬁ	ﬁ	 
=
ﬁ	ﬁ	 
dr
ﬁ	ﬁ	 !
(
ﬁ	ﬁ	! "
$str
ﬁ	ﬁ	" 0
)
ﬁ	ﬁ	0 1
Else
ﬂ	ﬂ	 
c_cAutor
‡	‡	 
=
‡	‡	 
$str
‡	‡	 "
End
·	·	 
If
·	·	 
Dim
„	„	 
	c_cEstado
„	„	 
As
„	„	  
String
„	„	! '
If
‰	‰	 
Not
‰	‰	 
IsDBNull
‰	‰	 
(
‰	‰	  
dr
‰	‰	  "
(
‰	‰	" #
$str
‰	‰	# 2
)
‰	‰	2 3
)
‰	‰	3 4
Then
‰	‰	5 9
	c_cEstado
Â	Â	 
=
Â	Â	 
dr
Â	Â	  "
(
Â	Â	" #
$str
Â	Â	# 2
)
Â	Â	2 3
Else
Ê	Ê	 
	c_cEstado
Á	Á	 
=
Á	Á	 
$str
Á	Á	  #
End
Ë	Ë	 
If
Ë	Ë	 
CType
Í	Í	 
(
Í	Í	 
e
Í	Í	 
.
Í	Í	 
Row
Í	Í	 
.
Í	Í	 
FindControl
Í	Í	 '
(
Í	Í	' (
$str
Í	Í	( >
)
Í	Í	> ?
,
Í	Í	? @
WebControls
Í	Í	A L
.
Í	Í	L M
Label
Í	Í	M R
)
Í	Í	R S
.
Í	Í	S T
Text
Í	Í	T X
=
Í	Í	Y Z$
c_cCodigoClasificacion
Í	Í	[ q
CType
Î	Î	 
(
Î	Î	 
e
Î	Î	 
.
Î	Î	 
Row
Î	Î	 
.
Î	Î	 
FindControl
Î	Î	 '
(
Î	Î	' (
$str
Î	Î	( 9
)
Î	Î	9 :
,
Î	Î	: ;
WebControls
Î	Î	< G
.
Î	Î	G H
Label
Î	Î	H M
)
Î	Î	M N
.
Î	Î	N O
Text
Î	Î	O S
=
Î	Î	T U
c_cCodigoRegistro
Î	Î	V g
CType
Ï	Ï	 
(
Ï	Ï	 
e
Ï	Ï	 
.
Ï	Ï	 
Row
Ï	Ï	 
.
Ï	Ï	 
FindControl
Ï	Ï	 '
(
Ï	Ï	' (
$str
Ï	Ï	( 4
)
Ï	Ï	4 5
,
Ï	Ï	5 6
WebControls
Ï	Ï	7 B
.
Ï	Ï	B C
Label
Ï	Ï	C H
)
Ï	Ï	H I
.
Ï	Ï	I J
Text
Ï	Ï	J N
=
Ï	Ï	O P
	c_cTitulo
Ï	Ï	Q Z
CType
Ì	Ì	 
(
Ì	Ì	 
e
Ì	Ì	 
.
Ì	Ì	 
Row
Ì	Ì	 
.
Ì	Ì	 
FindControl
Ì	Ì	 '
(
Ì	Ì	' (
$str
Ì	Ì	( 3
)
Ì	Ì	3 4
,
Ì	Ì	4 5
WebControls
Ì	Ì	6 A
.
Ì	Ì	A B
Label
Ì	Ì	B G
)
Ì	Ì	G H
.
Ì	Ì	H I
Text
Ì	Ì	I M
=
Ì	Ì	N O
c_cAutor
Ì	Ì	P X
CType
Ó	Ó	 
(
Ó	Ó	 
e
Ó	Ó	 
.
Ó	Ó	 
Row
Ó	Ó	 
.
Ó	Ó	 
FindControl
Ó	Ó	 '
(
Ó	Ó	' (
$str
Ó	Ó	( 4
)
Ó	Ó	4 5
,
Ó	Ó	5 6
WebControls
Ó	Ó	7 B
.
Ó	Ó	B C
Label
Ó	Ó	C H
)
Ó	Ó	H I
.
Ó	Ó	I J
Text
Ó	Ó	J N
=
Ó	Ó	O P
	c_cEstado
Ó	Ó	Q Z
End
Ô	Ô	 
If
Ô	Ô	 
Catch
		 
ex
		 
As
		 
	Exception
		 

lbl_Valida
Ò	Ò	 
.
Ò	Ò	 
Text
Ò	Ò	 
=
Ò	Ò	 
ex
Ò	Ò	  
.
Ò	Ò	  !
Message
Ò	Ò	! (

lbl_Valida
Ú	Ú	 
.
Ú	Ú	 
	ForeColor
Ú	Ú	  
=
Ú	Ú	! "
System
Ú	Ú	# )
.
Ú	Ú	) *
Drawing
Ú	Ú	* 1
.
Ú	Ú	1 2
Color
Ú	Ú	2 7
.
Ú	Ú	7 8
Red
Ú	Ú	8 ;
End
Û	Û	 
Try
Û	Û	 
End
Ù	Ù	 
Sub
Ù	Ù	 
	Protected
˜	˜	 
Sub
˜	˜	 )
grv_Libro_PageIndexChanging
˜	˜	 -
(
˜	˜	- .
ByVal
˜	˜	. 3
sender
˜	˜	4 :
As
˜	˜	; =
Object
˜	˜	> D
,
˜	˜	D E
ByVal
˜	˜	F K
e
˜	˜	L M
As
˜	˜	N P
System
˜	˜	Q W
.
˜	˜	W X
Web
˜	˜	X [
.
˜	˜	[ \
UI
˜	˜	\ ^
.
˜	˜	^ _
WebControls
˜	˜	_ j
.
˜	˜	j k$
GridViewPageEventArgs˜	˜	k Ä
)˜	˜	Ä Å
Handles˜	˜	Ç â
	grv_Libro˜	˜	ä ì
.˜	˜	ì î!
PageIndexChanging˜	˜	î •
Try
¯	¯	 
	grv_Libro
˙	˙	 
.
˙	˙	 
	PageIndex
˙	˙	 
=
˙	˙	  !
e
˙	˙	" #
.
˙	˙	# $
NewPageIndex
˙	˙	$ 0
If
˚	˚	 
Session
˚	˚	 
(
˚	˚	 
$str
˚	˚	 "
)
˚	˚	" #
=
˚	˚	$ %
$str
˚	˚	& )
Then
˚	˚	* .
ElseIf
˝	˝	 
Session
˝	˝	 
(
˝	˝	 
$str
˝	˝	 &
)
˝	˝	& '
=
˝	˝	( )
$str
˝	˝	* -
Then
˝	˝	. 2
Dim
˛	˛	 
valor
˛	˛	 
As
˛	˛	 
String
˛	˛	 #
=
˛	˛	$ %
Session
˛	˛	& -
(
˛	˛	- .
$str
˛	˛	. 9
)
˛	˛	9 :
Dim
ˇ	ˇ	 
vBandera
ˇ	ˇ	 
As
ˇ	ˇ	 
String
ˇ	ˇ	  &
=
ˇ	ˇ	' (
Session
ˇ	ˇ	) 0
(
ˇ	ˇ	0 1
$str
ˇ	ˇ	1 ;
)
ˇ	ˇ	; <
	grv_Libro
Å
Å
 
.
Å
Å
 

DataSource
Å
Å
 $
=
Å
Å
% &
cls_Metodos
Å
Å
' 2
.
Å
Å
2 3
BuscarLibro
Å
Å
3 >
(
Å
Å
> ?
valor
Å
Å
? D
,
Å
Å
D E
vBandera
Å
Å
F N
)
Å
Å
N O
	grv_Libro
Ç
Ç
 
.
Ç
Ç
 
DataBind
Ç
Ç
 "
(
Ç
Ç
" #
)
Ç
Ç
# $
End
É
É
 
If
É
É
 
Catch
Ñ
Ñ
 
ex
Ñ
Ñ
 
As
Ñ
Ñ
 
	Exception
Ñ
Ñ
 

lbl_Valida
Ö
Ö
 
.
Ö
Ö
 
Text
Ö
Ö
 
=
Ö
Ö
 
ex
Ö
Ö
  
.
Ö
Ö
  !
Message
Ö
Ö
! (

lbl_Valida
Ü
Ü
 
.
Ü
Ü
 
	ForeColor
Ü
Ü
  
=
Ü
Ü
! "
System
Ü
Ü
# )
.
Ü
Ü
) *
Drawing
Ü
Ü
* 1
.
Ü
Ü
1 2
Color
Ü
Ü
2 7
.
Ü
Ü
7 8
Red
Ü
Ü
8 ;
End
á
á
 
Try
á
á
 
End
à
à
 
Sub
à
à
 
	Protected
ã
ã
 
Sub
ã
ã
 ,
grv_Libro_SelectedIndexChanged
ã
ã
 0
(
ã
ã
0 1
sender
ã
ã
1 7
As
ã
ã
8 :
Object
ã
ã
; A
,
ã
ã
A B
e
ã
ã
C D
As
ã
ã
E G
	EventArgs
ã
ã
H Q
)
ã
ã
Q R
Handles
ã
ã
S Z
	grv_Libro
ã
ã
[ d
.
ã
ã
d e"
SelectedIndexChanged
ã
ã
e y
Try
å
å
 
Dim
ç
ç
 
v_codRegistro
ç
ç
 
As
ç
ç
  
String
ç
ç
! '
=
ç
ç
( )
TryCast
ç
ç
* 1
(
ç
ç
1 2
	grv_Libro
ç
ç
2 ;
.
ç
ç
; <
SelectedRow
ç
ç
< G
.
ç
ç
G H
FindControl
ç
ç
H S
(
ç
ç
S T
$str
ç
ç
T e
)
ç
ç
e f
,
ç
ç
f g
Label
ç
ç
h m
)
ç
ç
m n
.
ç
ç
n o
Text
ç
ç
o s
Session
é
é
 
(
é
é
 
$str
é
é
 &
)
é
é
& '
=
é
é
( )
v_codRegistro
é
é
* 7"
Listar_RegistroLibro
è
è
  
(
è
è
  !
v_codRegistro
è
è
! .
)
è
è
. /
imgDisponible
ê
ê
 
.
ê
ê
 
Visible
ê
ê
 !
=
ê
ê
" #
True
ê
ê
$ (
Catch
ë
ë
 
ex
ë
ë
 
As
ë
ë
 
	Exception
ë
ë
 

lbl_Valida
í
í
 
.
í
í
 
Text
í
í
 
=
í
í
 
ex
í
í
  
.
í
í
  !
Message
í
í
! (

lbl_Valida
ì
ì
 
.
ì
ì
 
	ForeColor
ì
ì
  
=
ì
ì
! "
System
ì
ì
# )
.
ì
ì
) *
Drawing
ì
ì
* 1
.
ì
ì
1 2
Color
ì
ì
2 7
.
ì
ì
7 8
Red
ì
ì
8 ;
End
î
î
 
Try
î
î
 
End
ï
ï
 
Sub
ï
ï
 
	Protected
ö
ö
 
Sub
ö
ö
 )
grv_Prestamo_OnRowDataBound
ö
ö
 -
(
ö
ö
- .
ByVal
ö
ö
. 3
sender
ö
ö
4 :
As
ö
ö
; =
Object
ö
ö
> D
,
ö
ö
D E
ByVal
ö
ö
F K
e
ö
ö
L M
As
ö
ö
N P"
GridViewRowEventArgs
ö
ö
Q e
)
ö
ö
e f
Try
õ
õ
 
If
ú
ú
 
e
ú
ú
 
.
ú
ú
 
Row
ú
ú
 
.
ú
ú
 
RowType
ú
ú
 
=
ú
ú
  
DataControlRowType
ú
ú
 1
.
ú
ú
1 2
DataRow
ú
ú
2 9
Then
ú
ú
: >
Dim
ù
ù
 
dr
ù
ù
 
As
ù
ù
 
DataRowView
ù
ù
 %
=
ù
ù
& '
CType
ù
ù
( -
(
ù
ù
- .
e
ù
ù
. /
.
ù
ù
/ 0
Row
ù
ù
0 3
.
ù
ù
3 4
DataItem
ù
ù
4 <
,
ù
ù
< =
DataRowView
ù
ù
> I
)
ù
ù
I J
Dim
ü
ü
 
c_cCodEmpleado
ü
ü
 "
As
ü
ü
# %
String
ü
ü
& ,
If
†
†
 
Not
†
†
 
IsDBNull
†
†
 
(
†
†
  
dr
†
†
  "
(
†
†
" #
$str
†
†
# 8
)
†
†
8 9
)
†
†
9 :
Then
†
†
; ?
c_cCodEmpleado
°
°
 "
=
°
°
# $
dr
°
°
% '
(
°
°
' (
$str
°
°
( =
)
°
°
= >
Else
¢
¢
 
c_cCodEmpleado
£
£
 "
=
£
£
# $
$str
£
£
% (
End
§
§
 
If
§
§
 
Dim
¶
¶
 

c_cNombres
¶
¶
 
As
¶
¶
 !
String
¶
¶
" (
If
ß
ß
 
Not
ß
ß
 
IsDBNull
ß
ß
 
(
ß
ß
  
dr
ß
ß
  "
(
ß
ß
" #
$str
ß
ß
# 3
)
ß
ß
3 4
)
ß
ß
4 5
Then
ß
ß
6 :

c_cNombres
®
®
 
=
®
®
  
dr
®
®
! #
(
®
®
# $
$str
®
®
$ 4
)
®
®
4 5
Else
©
©
 

c_cNombres
™
™
 
=
™
™
  
$str
™
™
! $
End
´
´
 
If
´
´
 
Dim
≠
≠
 !
c_cCodClasificacion
≠
≠
 '
As
≠
≠
( *
String
≠
≠
+ 1
If
Æ
Æ
 
Not
Æ
Æ
 
IsDBNull
Æ
Æ
 
(
Æ
Æ
  
dr
Æ
Æ
  "
(
Æ
Æ
" #
$str
Æ
Æ
# <
)
Æ
Æ
< =
)
Æ
Æ
= >
Then
Æ
Æ
? C!
c_cCodClasificacion
Ø
Ø
 '
=
Ø
Ø
( )
dr
Ø
Ø
* ,
(
Ø
Ø
, -
$str
Ø
Ø
- F
)
Ø
Ø
F G
Else
∞
∞
 !
c_cCodClasificacion
±
±
 '
=
±
±
( )
$str
±
±
* -
End
≤
≤
 
If
≤
≤
 
Dim
¥
¥
 !
c_cCodRegistroLibro
¥
¥
 '
As
¥
¥
( *
String
¥
¥
+ 1
If
µ
µ
 
Not
µ
µ
 
IsDBNull
µ
µ
 
(
µ
µ
  
dr
µ
µ
  "
(
µ
µ
" #
$str
µ
µ
# 7
)
µ
µ
7 8
)
µ
µ
8 9
Then
µ
µ
: >!
c_cCodRegistroLibro
∂
∂
 '
=
∂
∂
( )
dr
∂
∂
* ,
(
∂
∂
, -
$str
∂
∂
- A
)
∂
∂
A B
Else
∑
∑
 !
c_cCodRegistroLibro
∏
∏
 '
=
∏
∏
( )
$str
∏
∏
* -
End
π
π
 
If
π
π
 
Dim
ª
ª
 
c_cTituloLibro
ª
ª
 "
As
ª
ª
# %
String
ª
ª
& ,
If
º
º
 
Not
º
º
 
IsDBNull
º
º
 
(
º
º
  
dr
º
º
  "
(
º
º
" #
$str
º
º
# 2
)
º
º
2 3
)
º
º
3 4
Then
º
º
5 9
c_cTituloLibro
Ω
Ω
 "
=
Ω
Ω
# $
dr
Ω
Ω
% '
(
Ω
Ω
' (
$str
Ω
Ω
( 7
)
Ω
Ω
7 8
Else
æ
æ
 
c_cTituloLibro
ø
ø
 "
=
ø
ø
# $
$str
ø
ø
% (
End
¿
¿
 
If
¿
¿
 
Dim
¬
¬
 
c_cFechaPrestamo
¬
¬
 $
As
¬
¬
% '
String
¬
¬
( .
If
√
√
 
Not
√
√
 
IsDBNull
√
√
 
(
√
√
  
dr
√
√
  "
(
√
√
" #
$str
√
√
# 5
)
√
√
5 6
)
√
√
6 7
Then
√
√
8 <
c_cFechaPrestamo
ƒ
ƒ
 $
=
ƒ
ƒ
% &
dr
ƒ
ƒ
' )
(
ƒ
ƒ
) *
$str
ƒ
ƒ
* <
)
ƒ
ƒ
< =
Else
≈
≈
 
c_cFechaPrestamo
∆
∆
 $
=
∆
∆
% &
$str
∆
∆
' 1
End
«
«
 
If
«
«
 
Dim
…
…
  
c_cFechaDevolucion
…
…
 &
As
…
…
' )
String
…
…
* 0
If
 
 
 
Not
 
 
 
IsDBNull
 
 
 
(
 
 
  
dr
 
 
  "
(
 
 
" #
$str
 
 
# 9
)
 
 
9 :
)
 
 
: ;
Then
 
 
< @ 
c_cFechaDevolucion
À
À
 &
=
À
À
' (
dr
À
À
) +
(
À
À
+ ,
$str
À
À
, B
)
À
À
B C
Else
Ã
Ã
  
c_cFechaDevolucion
Õ
Õ
 &
=
Õ
Õ
' (
$str
Õ
Õ
) 3
End
Œ
Œ
 
If
Œ
Œ
 
Dim
–
–
 
c_cFechaReserva
–
–
 #
As
–
–
$ &
String
–
–
' -
If
—
—
 
Not
—
—
 
IsDBNull
—
—
 
(
—
—
  
dr
—
—
  "
(
—
—
" #
$str
—
—
# 6
)
—
—
6 7
)
—
—
7 8
Then
—
—
9 =
c_cFechaReserva
“
“
 #
=
“
“
$ %
dr
“
“
& (
(
“
“
( )
$str
“
“
) <
)
“
“
< =
Else
”
”
 
c_cFechaReserva
‘
‘
 #
=
‘
‘
$ %
$str
‘
‘
& 1
End
’
’
 
If
’
’
 
Dim
◊
◊
 %
c_cEstadoOperacionViejo
◊
◊
 +
As
◊
◊
, .
String
◊
◊
/ 5
If
ÿ
ÿ
 
Not
ÿ
ÿ
 
IsDBNull
ÿ
ÿ
 
(
ÿ
ÿ
  
dr
ÿ
ÿ
  "
(
ÿ
ÿ
" #
$str
ÿ
ÿ
# 4
)
ÿ
ÿ
4 5
)
ÿ
ÿ
5 6
Then
ÿ
ÿ
7 ;%
c_cEstadoOperacionViejo
Ÿ
Ÿ
 +
=
Ÿ
Ÿ
, -
dr
Ÿ
Ÿ
. 0
(
Ÿ
Ÿ
0 1
$str
Ÿ
Ÿ
1 B
)
Ÿ
Ÿ
B C
Else
⁄
⁄
 %
c_cEstadoOperacionViejo
€
€
 +
=
€
€
, -
$str
€
€
. 1
End
‹
‹
 
If
‹
‹
 
Dim
ﬁ
ﬁ
  
c_cEstadoOperacion
ﬁ
ﬁ
 &
As
ﬁ
ﬁ
' )
String
ﬁ
ﬁ
* 0
If
ﬂ
ﬂ
 
Not
ﬂ
ﬂ
 
IsDBNull
ﬂ
ﬂ
 
(
ﬂ
ﬂ
  
dr
ﬂ
ﬂ
  "
(
ﬂ
ﬂ
" #
$str
ﬂ
ﬂ
# 0
)
ﬂ
ﬂ
0 1
)
ﬂ
ﬂ
1 2
Then
ﬂ
ﬂ
3 7 
c_cEstadoOperacion
‡
‡
 &
=
‡
‡
' (
dr
‡
‡
) +
(
‡
‡
+ ,
$str
‡
‡
, 9
)
‡
‡
9 :
Else
·
·
  
c_cEstadoOperacion
‚
‚
 &
=
‚
‚
' (
$str
‚
‚
) ,
End
„
„
 
If
„
„
 
Dim
Â
Â
 
c_cIdPrestamo
Â
Â
 !
As
Â
Â
" $
String
Â
Â
% +
If
Ê
Ê
 
Not
Ê
Ê
 
IsDBNull
Ê
Ê
 
(
Ê
Ê
  
dr
Ê
Ê
  "
(
Ê
Ê
" #
$str
Ê
Ê
# 1
)
Ê
Ê
1 2
)
Ê
Ê
2 3
Then
Ê
Ê
4 8
c_cIdPrestamo
Á
Á
 !
=
Á
Á
" #
dr
Á
Á
$ &
(
Á
Á
& '
$str
Á
Á
' 5
)
Á
Á
5 6
Else
Ë
Ë
 
c_cIdPrestamo
È
È
 !
=
È
È
" #
$str
È
È
$ '
End
Í
Í
 
If
Í
Í
 
CType
Ï
Ï
 
(
Ï
Ï
 
e
Ï
Ï
 
.
Ï
Ï
 
Row
Ï
Ï
 
.
Ï
Ï
 
FindControl
Ï
Ï
 '
(
Ï
Ï
' (
$str
Ï
Ï
( 9
)
Ï
Ï
9 :
,
Ï
Ï
: ;
WebControls
Ï
Ï
< G
.
Ï
Ï
G H
Label
Ï
Ï
H M
)
Ï
Ï
M N
.
Ï
Ï
N O
Text
Ï
Ï
O S
=
Ï
Ï
T U
c_cCodEmpleado
Ï
Ï
V d
CType
Ì
Ì
 
(
Ì
Ì
 
e
Ì
Ì
 
.
Ì
Ì
 
Row
Ì
Ì
 
.
Ì
Ì
 
FindControl
Ì
Ì
 '
(
Ì
Ì
' (
$str
Ì
Ì
( <
)
Ì
Ì
< =
,
Ì
Ì
= >
WebControls
Ì
Ì
? J
.
Ì
Ì
J K
Label
Ì
Ì
K P
)
Ì
Ì
P Q
.
Ì
Ì
Q R
Text
Ì
Ì
R V
=
Ì
Ì
W X

c_cNombres
Ì
Ì
Y c
CType
Ó
Ó
 
(
Ó
Ó
 
e
Ó
Ó
 
.
Ó
Ó
 
Row
Ó
Ó
 
.
Ó
Ó
 
FindControl
Ó
Ó
 '
(
Ó
Ó
' (
$str
Ó
Ó
( >
)
Ó
Ó
> ?
,
Ó
Ó
? @
WebControls
Ó
Ó
A L
.
Ó
Ó
L M
Label
Ó
Ó
M R
)
Ó
Ó
R S
.
Ó
Ó
S T
Text
Ó
Ó
T X
=
Ó
Ó
Y Z!
c_cCodClasificacion
Ó
Ó
[ n
CType
Ô
Ô
 
(
Ô
Ô
 
e
Ô
Ô
 
.
Ô
Ô
 
Row
Ô
Ô
 
.
Ô
Ô
 
FindControl
Ô
Ô
 '
(
Ô
Ô
' (
$str
Ô
Ô
( >
)
Ô
Ô
> ?
,
Ô
Ô
? @
WebControls
Ô
Ô
A L
.
Ô
Ô
L M
Label
Ô
Ô
M R
)
Ô
Ô
R S
.
Ô
Ô
S T
Text
Ô
Ô
T X
=
Ô
Ô
Y Z!
c_cCodRegistroLibro
Ô
Ô
[ n
CType


 
(


 
e


 
.


 
Row


 
.


 
FindControl


 '
(


' (
$str


( 9
)


9 :
,


: ;
WebControls


< G
.


G H
Label


H M
)


M N
.


N O
Text


O S
=


T U
c_cTituloLibro


V d
CType
Ò
Ò
 
(
Ò
Ò
 
e
Ò
Ò
 
.
Ò
Ò
 
Row
Ò
Ò
 
.
Ò
Ò
 
FindControl
Ò
Ò
 '
(
Ò
Ò
' (
$str
Ò
Ò
( ;
)
Ò
Ò
; <
,
Ò
Ò
< =
WebControls
Ò
Ò
> I
.
Ò
Ò
I J
Label
Ò
Ò
J O
)
Ò
Ò
O P
.
Ò
Ò
P Q
Text
Ò
Ò
Q U
=
Ò
Ò
V W
c_cFechaPrestamo
Ò
Ò
X h
CType
Ú
Ú
 
(
Ú
Ú
 
e
Ú
Ú
 
.
Ú
Ú
 
Row
Ú
Ú
 
.
Ú
Ú
 
FindControl
Ú
Ú
 '
(
Ú
Ú
' (
$str
Ú
Ú
( =
)
Ú
Ú
= >
,
Ú
Ú
> ?
WebControls
Ú
Ú
@ K
.
Ú
Ú
K L
Label
Ú
Ú
L Q
)
Ú
Ú
Q R
.
Ú
Ú
R S
Text
Ú
Ú
S W
=
Ú
Ú
X Y 
c_cFechaDevolucion
Ú
Ú
Z l
CType
Û
Û
 
(
Û
Û
 
e
Û
Û
 
.
Û
Û
 
Row
Û
Û
 
.
Û
Û
 
FindControl
Û
Û
 '
(
Û
Û
' (
$str
Û
Û
( :
)
Û
Û
: ;
,
Û
Û
; <
WebControls
Û
Û
= H
.
Û
Û
H I
Label
Û
Û
I N
)
Û
Û
N O
.
Û
Û
O P
Text
Û
Û
P T
=
Û
Û
U V
c_cFechaReserva
Û
Û
W f
CType
Ù
Ù
 
(
Ù
Ù
 
e
Ù
Ù
 
.
Ù
Ù
 
Row
Ù
Ù
 
.
Ù
Ù
 
FindControl
Ù
Ù
 '
(
Ù
Ù
' (
$str
Ù
Ù
( 4
)
Ù
Ù
4 5
,
Ù
Ù
5 6
WebControls
Ù
Ù
7 B
.
Ù
Ù
B C
Label
Ù
Ù
C H
)
Ù
Ù
H I
.
Ù
Ù
I J
Text
Ù
Ù
J N
=
Ù
Ù
O P%
c_cEstadoOperacionViejo
Ù
Ù
Q h
CType
ı
ı
 
(
ı
ı
 
e
ı
ı
 
.
ı
ı
 
Row
ı
ı
 
.
ı
ı
 
FindControl
ı
ı
 '
(
ı
ı
' (
$str
ı
ı
( 5
)
ı
ı
5 6
,
ı
ı
6 7
WebControls
ı
ı
8 C
.
ı
ı
C D
Label
ı
ı
D I
)
ı
ı
I J
.
ı
ı
J K
Text
ı
ı
K O
=
ı
ı
P Q 
c_cEstadoOperacion
ı
ı
R d
CType
ˆ
ˆ
 
(
ˆ
ˆ
 
e
ˆ
ˆ
 
.
ˆ
ˆ
 
Row
ˆ
ˆ
 
.
ˆ
ˆ
 
FindControl
ˆ
ˆ
 '
(
ˆ
ˆ
' (
$str
ˆ
ˆ
( 9
)
ˆ
ˆ
9 :
,
ˆ
ˆ
: ;
WebControls
ˆ
ˆ
< G
.
ˆ
ˆ
G H
Label
ˆ
ˆ
H M
)
ˆ
ˆ
M N
.
ˆ
ˆ
N O
Text
ˆ
ˆ
O S
=
ˆ
ˆ
T U
c_cIdPrestamo
ˆ
ˆ
V c
End
˜
˜
 
If
˜
˜
 
Catch
¯
¯
 
ex
¯
¯
 
As
¯
¯
 
	Exception
¯
¯
 

lbl_Valida
˘
˘
 
.
˘
˘
 
Text
˘
˘
 
=
˘
˘
 
ex
˘
˘
  
.
˘
˘
  !
Message
˘
˘
! (

lbl_Valida
˙
˙
 
.
˙
˙
 
	ForeColor
˙
˙
  
=
˙
˙
! "
System
˙
˙
# )
.
˙
˙
) *
Drawing
˙
˙
* 1
.
˙
˙
1 2
Color
˙
˙
2 7
.
˙
˙
7 8
Red
˙
˙
8 ;
End
˚
˚
 
Try
˚
˚
 
End
¸
¸
 
Sub
¸
¸
 
	Protected
ˇ
ˇ
 
Sub
ˇ
ˇ
 ,
grv_Prestamo_PageIndexChanging
ˇ
ˇ
 0
(
ˇ
ˇ
0 1
ByVal
ˇ
ˇ
1 6
sender
ˇ
ˇ
7 =
As
ˇ
ˇ
> @
Object
ˇ
ˇ
A G
,
ˇ
ˇ
G H
ByVal
ˇ
ˇ
I N
e
ˇ
ˇ
O P
As
ˇ
ˇ
Q S
System
ˇ
ˇ
T Z
.
ˇ
ˇ
Z [
Web
ˇ
ˇ
[ ^
.
ˇ
ˇ
^ _
UI
ˇ
ˇ
_ a
.
ˇ
ˇ
a b
WebControls
ˇ
ˇ
b m
.
ˇ
ˇ
m n$
GridViewPageEventArgsˇ
ˇ
n É
)ˇ
ˇ
É Ñ
Handlesˇ
ˇ
Ö å
grv_Prestamoˇ
ˇ
ç ô
.ˇ
ˇ
ô ö!
PageIndexChangingˇ
ˇ
ö ´
Try
ÄÄ 
grv_Prestamo
ÇÇ 
.
ÇÇ 
	PageIndex
ÇÇ "
=
ÇÇ# $
e
ÇÇ% &
.
ÇÇ& '
NewPageIndex
ÇÇ' 3
If
ÉÉ 
Session
ÉÉ 
(
ÉÉ 
$str
ÉÉ "
)
ÉÉ" #
=
ÉÉ$ %
$str
ÉÉ& )
Then
ÉÉ* .
cargarLista50
ÑÑ 
(
ÑÑ 
)
ÑÑ 
ElseIf
ÖÖ 
Session
ÖÖ 
(
ÖÖ 
$str
ÖÖ &
)
ÖÖ& '
=
ÖÖ( )
$str
ÖÖ* -
Then
ÖÖ. 2
Dim
ÜÜ 
valor
ÜÜ 
As
ÜÜ 
String
ÜÜ #
=
ÜÜ$ %
Session
ÜÜ& -
(
ÜÜ- .
$str
ÜÜ. 9
)
ÜÜ9 :
Dim
áá 
vBandera
áá 
As
áá 
String
áá  &
=
áá' (
Session
áá) 0
(
áá0 1
$str
áá1 ;
)
áá; <
grv_Prestamo
ââ 
.
ââ 

DataSource
ââ '
=
ââ( )
cls_Metodos
ââ* 5
.
ââ5 6
BuscarPestamo
ââ6 C
(
ââC D
valor
ââD I
,
ââI J
vBandera
ââK S
)
ââS T
grv_Prestamo
ää 
.
ää 
DataBind
ää %
(
ää% &
)
ää& '
End
ãã 
If
ãã 
Catch
åå 
ex
åå 
As
åå 
	Exception
åå 

lbl_Valida
çç 
.
çç 
Text
çç 
=
çç 
ex
çç  
.
çç  !
Message
çç! (

lbl_Valida
éé 
.
éé 
	ForeColor
éé  
=
éé! "
System
éé# )
.
éé) *
Drawing
éé* 1
.
éé1 2
Color
éé2 7
.
éé7 8
Red
éé8 ; 
btn_BuscarPrestamo
èè 
.
èè 
Visible
èè &
=
èè' (
False
èè) .
End
êê 
Try
êê 
End
ëë 
Sub
ëë 
	Protected
îî 
Sub
îî /
!grv_Prestamo_SelectedIndexChanged
îî 3
(
îî3 4
sender
îî4 :
As
îî; =
Object
îî> D
,
îîD E
e
îîF G
As
îîH J
	EventArgs
îîK T
)
îîT U
Handles
îîV ]
grv_Prestamo
îî^ j
.
îîj k"
SelectedIndexChanged
îîk 
Try
ïï 
Dim
ññ 
v_codPrestamo
ññ 
As
ññ  
String
ññ! '
=
ññ( )
TryCast
ññ* 1
(
ññ1 2
grv_Prestamo
ññ2 >
.
ññ> ?
SelectedRow
ññ? J
.
ññJ K
FindControl
ññK V
(
ññV W
$str
ññW h
)
ññh i
,
ññi j
Label
ññk p
)
ññp q
.
ññq r
Text
ññr v%
Listar_RegistroPrestamo
óó #
(
óó# $
v_codPrestamo
óó$ 1
)
óó1 2

lbl_Valida
òò 
.
òò 
Text
òò 
=
òò 
$str
òò H

lbl_Valida
ôô 
.
ôô 
	ForeColor
ôô  
=
ôô! "
System
ôô# )
.
ôô) *
Drawing
ôô* 1
.
ôô1 2
Color
ôô2 7
.
ôô7 8

DarkOrange
ôô8 B
If
õõ 
rdb_devolucion
õõ 
.
õõ 
Checked
õõ %
Then
õõ& *!
cbox_EstadoPrestamo
úú #
.
úú# $
Items
úú$ )
.
úú) *
FindByValue
úú* 5
(
úú5 6
$str
úú6 9
)
úú9 :
.
úú: ;
Enabled
úú; B
=
úúC D
True
úúE I!
cbox_EstadoPrestamo
ùù #
.
ùù# $
Items
ùù$ )
.
ùù) *
FindByValue
ùù* 5
(
ùù5 6
$str
ùù6 9
)
ùù9 :
.
ùù: ;
Selected
ùù; C
=
ùùD E
True
ùùF J!
cbox_EstadoPrestamo
ûû #
.
ûû# $
Items
ûû$ )
.
ûû) *
FindByValue
ûû* 5
(
ûû5 6
$str
ûû6 :
)
ûû: ;
.
ûû; <
Enabled
ûû< C
=
ûûD E
False
ûûF K!
cbox_EstadoPrestamo
üü #
.
üü# $
Items
üü$ )
.
üü) *
FindByValue
üü* 5
(
üü5 6
$str
üü6 9
)
üü9 :
.
üü: ;
Enabled
üü; B
=
üüC D
False
üüE J!
cbox_EstadoPrestamo
†† #
.
††# $
Items
††$ )
.
††) *
FindByValue
††* 5
(
††5 6
$str
††6 9
)
††9 :
.
††: ;
Enabled
††; B
=
††C D
False
††E J!
cbox_EstadoPrestamo
°° #
.
°°# $
Items
°°$ )
.
°°) *
FindByValue
°°* 5
(
°°5 6
$str
°°6 9
)
°°9 :
.
°°: ;
Enabled
°°; B
=
°°C D
False
°°E J
ElseIf
¢¢ %
rdb_PrestarReservasAnul
¢¢ *
.
¢¢* +
Checked
¢¢+ 2
Then
¢¢3 7!
cbox_EstadoPrestamo
££ #
.
££# $
Items
££$ )
.
££) *
FindByValue
££* 5
(
££5 6
$str
££6 9
)
££9 :
.
££: ;
Enabled
££; B
=
££C D
False
££E J!
cbox_EstadoPrestamo
§§ #
.
§§# $
Items
§§$ )
.
§§) *
FindByValue
§§* 5
(
§§5 6
$str
§§6 9
)
§§9 :
.
§§: ;
Enabled
§§; B
=
§§C D
True
§§E I!
cbox_EstadoPrestamo
•• #
.
••# $
Items
••$ )
.
••) *
FindByValue
••* 5
(
••5 6
$str
••6 9
)
••9 :
.
••: ;
Enabled
••; B
=
••C D
True
••E I!
cbox_EstadoPrestamo
¶¶ #
.
¶¶# $
Items
¶¶$ )
.
¶¶) *
FindByValue
¶¶* 5
(
¶¶5 6
$str
¶¶6 9
)
¶¶9 :
.
¶¶: ;
Enabled
¶¶; B
=
¶¶C D
True
¶¶E I
End
ßß 
If
ßß 

Validacion
®® 
(
®® 
$str
®® )
)
®®) *
Catch
©© 
ex
©© 
As
©© 
	Exception
©© 

lbl_Valida
™™ 
.
™™ 
Text
™™ 
=
™™ 
ex
™™  
.
™™  !
Message
™™! (

lbl_Valida
´´ 
.
´´ 
	ForeColor
´´  
=
´´! "
System
´´# )
.
´´) *
Drawing
´´* 1
.
´´1 2
Color
´´2 7
.
´´7 8
Red
´´8 ;
End
¨¨ 
Try
¨¨ 
End
≠≠ 
Sub
≠≠ 
Private
ØØ 
Sub
ØØ /
!cboxBusqueda_SelectedIndexChanged
ØØ 1
(
ØØ1 2
sender
ØØ2 8
As
ØØ9 ;
Object
ØØ< B
,
ØØB C
e
ØØD E
As
ØØF H
	EventArgs
ØØI R
)
ØØR S
Handles
ØØT [
cboxBusqueda
ØØ\ h
.
ØØh i"
SelectedIndexChanged
ØØi }
txt_ValorPrestamo
∞∞ 
.
∞∞ 
Text
∞∞ 
=
∞∞  
$str
∞∞! #
If
±± 

cboxBusqueda
±± 
.
±± 
SelectedIndex
±± %
=
±±& '
$num
±±( )
Then
±±* .
txt_ValorPrestamo
≤≤ 
.
≤≤ 
	MaxLength
≤≤ '
=
≤≤( )
$num
≤≤* +
txt_ValorPrestamo
≥≥ 
.
≥≥ 

Attributes
≥≥ (
.
≥≥( )
Add
≥≥) ,
(
≥≥, -
$str
≥≥- :
,
≥≥: ;
$str
≥≥< Z
)
≥≥Z [
ElseIf
¥¥ 
cboxBusqueda
¥¥ 
.
¥¥ 
SelectedIndex
¥¥ )
=
¥¥* +
$num
¥¥, -
Then
¥¥. 2
txt_ValorPrestamo
µµ 
.
µµ 
	MaxLength
µµ '
=
µµ( )
$num
µµ* +
txt_ValorPrestamo
∂∂ 
.
∂∂ 

Attributes
∂∂ (
.
∂∂( )
Add
∂∂) ,
(
∂∂, -
$str
∂∂- :
,
∂∂: ;
$str
∂∂< N
)
∂∂N O
ElseIf
∑∑ 
cboxBusqueda
∑∑ 
.
∑∑ 
SelectedIndex
∑∑ )
=
∑∑* +
$num
∑∑, -
Then
∑∑. 2
txt_ValorPrestamo
∏∏ 
.
∏∏ 
	MaxLength
∏∏ '
=
∏∏( )
$num
∏∏* ,
txt_ValorPrestamo
ππ 
.
ππ 

Attributes
ππ (
.
ππ( )
Add
ππ) ,
(
ππ, -
$str
ππ- :
,
ππ: ;
$str
ππ< \
)
ππ\ ]
ElseIf
∫∫ 
cboxBusqueda
∫∫ 
.
∫∫ 
SelectedIndex
∫∫ )
=
∫∫* +
$num
∫∫, -
Then
∫∫. 2
txt_ValorPrestamo
ªª 
.
ªª 
	MaxLength
ªª '
=
ªª( )
$num
ªª* +
txt_ValorPrestamo
ºº 
.
ºº 

Attributes
ºº (
.
ºº( )
Add
ºº) ,
(
ºº, -
$str
ºº- :
,
ºº: ;
$str
ºº< ]
)
ºº] ^
End
ΩΩ 
If
ΩΩ 
End
ææ 
Sub
ææ 
Private
¿¿ 
Sub
¿¿ 8
*cbox_CodRegistroLibro_SelectedIndexChanged
¿¿ :
(
¿¿: ;
sender
¿¿; A
As
¿¿B D
Object
¿¿E K
,
¿¿K L
e
¿¿M N
As
¿¿O Q
	EventArgs
¿¿R [
)
¿¿[ \
Handles
¿¿] d#
cbox_CodRegistroLibro
¿¿e z
.
¿¿z {#
SelectedIndexChanged¿¿{ è
txt_ValorLibro
¡¡ 
.
¡¡ 
Text
¡¡ 
=
¡¡ 
$str
¡¡  
If
¬¬ 
#
cbox_CodRegistroLibro
¬¬  
.
¬¬  !
SelectedIndex
¬¬! .
=
¬¬/ 0
$num
¬¬1 2
Then
¬¬3 7
txt_ValorLibro
√√ 
.
√√ 
	MaxLength
√√ $
=
√√% &
$num
√√' (
txt_ValorLibro
ƒƒ 
.
ƒƒ 

Attributes
ƒƒ %
.
ƒƒ% &
Add
ƒƒ& )
(
ƒƒ) *
$str
ƒƒ* 3
,
ƒƒ3 4
$str
ƒƒ5 Z
)
ƒƒZ [
txt_ValorLibro
≈≈ 
.
≈≈ 

Attributes
≈≈ %
.
≈≈% &
Add
≈≈& )
(
≈≈) *
$str
≈≈* 7
,
≈≈7 8
$str
≈≈9 W
)
≈≈W X
ElseIf
∆∆ #
cbox_CodRegistroLibro
∆∆ $
.
∆∆$ %
SelectedIndex
∆∆% 2
=
∆∆3 4
$num
∆∆5 6
Then
∆∆7 ;
txt_ValorLibro
«« 
.
«« 
	MaxLength
«« $
=
««% &
$num
««' )
txt_ValorLibro
»» 
.
»» 

Attributes
»» %
.
»»% &
Add
»»& )
(
»») *
$str
»»* 3
,
»»3 4
$str
»»5 Z
)
»»Z [
txt_ValorLibro
…… 
.
…… 

Attributes
…… %
.
……% &
Add
……& )
(
……) *
$str
……* 7
,
……7 8
$str
……9 N
)
……N O
ElseIf
   #
cbox_CodRegistroLibro
   $
.
  $ %
SelectedIndex
  % 2
=
  3 4
$num
  5 6
Then
  7 ;
txt_ValorLibro
ÀÀ 
.
ÀÀ 
	MaxLength
ÀÀ $
=
ÀÀ% &
$num
ÀÀ' )
txt_ValorLibro
ÃÃ 
.
ÃÃ 

Attributes
ÃÃ %
.
ÃÃ% &
Add
ÃÃ& )
(
ÃÃ) *
$str
ÃÃ* 3
,
ÃÃ3 4
$str
ÃÃ5 Z
)
ÃÃZ [
txt_ValorLibro
ÕÕ 
.
ÕÕ 

Attributes
ÕÕ %
.
ÕÕ% &
Add
ÕÕ& )
(
ÕÕ) *
$str
ÕÕ* 7
,
ÕÕ7 8
$str
ÕÕ9 M
)
ÕÕM N
End
ŒŒ 
If
ŒŒ 
End
œœ 
Sub
œœ 
Private
—— 
Sub
—— 6
(cbox_EstadoPrestamo_SelectedIndexChanged
—— 8
(
——8 9
sender
——9 ?
As
——@ B
Object
——C I
,
——I J
e
——K L
As
——M O
	EventArgs
——P Y
)
——Y Z
Handles
——[ b!
cbox_EstadoPrestamo
——c v
.
——v w#
SelectedIndexChanged——w ã
If
““ 
!
cbox_EstadoPrestamo
““ 
.
““ 
SelectedValue
““ ,
=
““- .
$str
““/ 2
Then
““3 7
txt_FechaPrestamo
”” 
.
”” 
Enabled
”” %
=
””& '
False
””( -!
txt_FechaDevolucion
‘‘ 
.
‘‘  
Enabled
‘‘  '
=
‘‘( )
False
‘‘* /
btnMas8
’’ 
.
’’ 
Enabled
’’ 
=
’’ 
False
’’ #
End
÷÷ 
If
÷÷ 
End
◊◊ 
Sub
◊◊ 
Private
ŸŸ 
Sub
ŸŸ 
Exportar_Reporte
ŸŸ  
(
ŸŸ  !
ByVal
ŸŸ! &
FormatoReporte
ŸŸ' 5
As
ŸŸ6 8
String
ŸŸ9 ?
,
ŸŸ? @
ByVal
ŸŸA F
v_TipoReporte
ŸŸG T
As
ŸŸU W
String
ŸŸX ^
)
ŸŸ^ _
Dim
€€ 
vValor
€€ 
As
€€ 
String
€€ 
Dim
‹‹ 
vBandera
‹‹ 
As
‹‹ 
String
‹‹ 
If
ﬂﬂ 

v_TipoReporte
ﬂﬂ 
=
ﬂﬂ 
$str
ﬂﬂ 8
Then
ﬂﬂ9 =
vValor
·· 
=
·· 
Session
·· 
(
·· 
$str
·· *
)
··* +
vBandera
‚‚ 
=
‚‚ 
$str
‚‚ 
Dim
ÂÂ #
ds_Consulta_Reporte01
ÂÂ %
As
ÂÂ& (
DataSet
ÂÂ) 0
=
ÂÂ1 2
cls_Metodos
ÂÂ3 >
.
ÂÂ> ?
BuscarPestamo
ÂÂ? L
(
ÂÂL M
vValor
ÂÂM S
,
ÂÂS T
vBandera
ÂÂU ]
)
ÂÂ] ^
Dim
ÁÁ &
dts_HistorialPrestLector
ÁÁ (
As
ÁÁ) +
New
ÁÁ, /&
dts_HistorialPrestLector
ÁÁ0 H
(
ÁÁH I
)
ÁÁI J
For
ÈÈ 
Each
ÈÈ #
dr_Consulta_Reporte01
ÈÈ *
As
ÈÈ+ -
DataRow
ÈÈ. 5
In
ÈÈ6 8#
ds_Consulta_Reporte01
ÈÈ9 N
.
ÈÈN O
Tables
ÈÈO U
(
ÈÈU V
$num
ÈÈV W
)
ÈÈW X
.
ÈÈX Y
Rows
ÈÈY ]&
dts_HistorialPrestLector
ÍÍ (
.
ÍÍ( )
Tables
ÍÍ) /
(
ÍÍ/ 0
$num
ÍÍ0 1
)
ÍÍ1 2
.
ÍÍ2 3
Rows
ÍÍ3 7
.
ÍÍ7 8
Add
ÍÍ8 ;
(
ÍÍ; <#
dr_Consulta_Reporte01
ÍÍ< Q
.
ÍÍQ R
	ItemArray
ÍÍR [
)
ÍÍ[ \
Next
ÎÎ 

rv_General
ÌÌ 
.
ÌÌ 
ProcessingMode
ÌÌ %
=
ÌÌ& '
ProcessingMode
ÌÌ( 6
.
ÌÌ6 7
Local
ÌÌ7 <

rv_General
ÓÓ 
.
ÓÓ 
LocalReport
ÓÓ "
.
ÓÓ" #

ReportPath
ÓÓ# -
=
ÓÓ. /
Server
ÓÓ0 6
.
ÓÓ6 7
MapPath
ÓÓ7 >
(
ÓÓ> ?
$str
ÓÓ? L
&
ÓÓM N
v_TipoReporte
ÓÓO \
&
ÓÓ] ^
$str
ÓÓ_ f
)
ÓÓf g
Dim
ÔÔ 
Movimiento_Rpt
ÔÔ 
As
ÔÔ !
New
ÔÔ" %
ReportDataSource
ÔÔ& 6
(
ÔÔ6 7
$str
ÔÔ7 K
,
ÔÔK L&
dts_HistorialPrestLector
ÔÔM e
.
ÔÔe f
Tables
ÔÔf l
(
ÔÔl m
$num
ÔÔm n
)
ÔÔn o
)
ÔÔo p

rv_General
 
.
 
LocalReport
 "
.
" #
DataSources
# .
.
. /
Clear
/ 4
(
4 5
)
5 6

rv_General
ÒÒ 
.
ÒÒ 
LocalReport
ÒÒ "
.
ÒÒ" #
DataSources
ÒÒ# .
.
ÒÒ. /
Add
ÒÒ/ 2
(
ÒÒ2 3
Movimiento_Rpt
ÒÒ3 A
)
ÒÒA B
ElseIf
ÛÛ 
v_TipoReporte
ÛÛ 
=
ÛÛ 
$str
ÛÛ ;
Then
ÛÛ< @
vValor
ıı 
=
ıı 
Session
ıı 
(
ıı 
$str
ıı /
)
ıı/ 0
vBandera
ˆˆ 
=
ˆˆ 
$str
ˆˆ 
Dim
˘˘ #
ds_Consulta_Reporte01
˘˘ %
As
˘˘& (
DataSet
˘˘) 0
=
˘˘1 2
cls_Metodos
˘˘3 >
.
˘˘> ?
BuscarPestamo
˘˘? L
(
˘˘L M
vValor
˘˘M S
,
˘˘S T
vBandera
˘˘U ]
)
˘˘] ^
Dim
˚˚ 
dtsFichaPrestamo
˚˚  
As
˚˚! #
New
˚˚$ '
dtsFichaPrestamo
˚˚( 8
(
˚˚8 9
)
˚˚9 :
For
˝˝ 
Each
˝˝ #
dr_Consulta_Reporte01
˝˝ *
As
˝˝+ -
DataRow
˝˝. 5
In
˝˝6 8#
ds_Consulta_Reporte01
˝˝9 N
.
˝˝N O
Tables
˝˝O U
(
˝˝U V
$num
˝˝V W
)
˝˝W X
.
˝˝X Y
Rows
˝˝Y ]
dtsFichaPrestamo
˛˛  
.
˛˛  !
Tables
˛˛! '
(
˛˛' (
$num
˛˛( )
)
˛˛) *
.
˛˛* +
Rows
˛˛+ /
.
˛˛/ 0
Add
˛˛0 3
(
˛˛3 4#
dr_Consulta_Reporte01
˛˛4 I
.
˛˛I J
	ItemArray
˛˛J S
)
˛˛S T
Next
ˇˇ 

rv_General
ÅÅ 
.
ÅÅ 
ProcessingMode
ÅÅ %
=
ÅÅ& '
ProcessingMode
ÅÅ( 6
.
ÅÅ6 7
Local
ÅÅ7 <

rv_General
ÇÇ 
.
ÇÇ 
LocalReport
ÇÇ "
.
ÇÇ" #

ReportPath
ÇÇ# -
=
ÇÇ. /
Server
ÇÇ0 6
.
ÇÇ6 7
MapPath
ÇÇ7 >
(
ÇÇ> ?
$str
ÇÇ? L
&
ÇÇM N
v_TipoReporte
ÇÇO \
&
ÇÇ] ^
$str
ÇÇ_ f
)
ÇÇf g
Dim
ÉÉ 
Movimiento_Rpt
ÉÉ 
As
ÉÉ !
New
ÉÉ" %
ReportDataSource
ÉÉ& 6
(
ÉÉ6 7
$str
ÉÉ7 J
,
ÉÉJ K
dtsFichaPrestamo
ÉÉL \
.
ÉÉ\ ]
Tables
ÉÉ] c
(
ÉÉc d
$num
ÉÉd e
)
ÉÉe f
)
ÉÉf g

rv_General
ÑÑ 
.
ÑÑ 
LocalReport
ÑÑ "
.
ÑÑ" #
DataSources
ÑÑ# .
.
ÑÑ. /
Clear
ÑÑ/ 4
(
ÑÑ4 5
)
ÑÑ5 6

rv_General
ÖÖ 
.
ÖÖ 
LocalReport
ÖÖ "
.
ÖÖ" #
DataSources
ÖÖ# .
.
ÖÖ. /
Add
ÖÖ/ 2
(
ÖÖ2 3
Movimiento_Rpt
ÖÖ3 A
)
ÖÖA B
ElseIf
áá 
v_TipoReporte
áá 
=
áá 
$str
áá 1
Then
áá2 6
vValor
ää 
=
ää 
txt_CodPrestamo2
ää %
.
ää% &
Text
ää& *
.
ää* +
Trim
ää+ /
vBandera
ãã 
=
ãã 
$str
ãã 
Dim
çç #
ds_Consulta_Reporte01
çç %
As
çç& (
DataSet
çç) 0
=
çç1 2
cls_Metodos
çç3 >
.
çç> ?
BuscarPestamo
çç? L
(
ççL M
vValor
ççM S
,
ççS T
vBandera
ççU ]
)
çç] ^
Dim
êê 
ds_Reporte01
êê 
As
êê 
New
êê  #
dtsFichaPrestamo
êê$ 4
(
êê4 5
)
êê5 6
For
íí 
Each
íí #
dr_Consulta_Reporte01
íí *
As
íí+ -
DataRow
íí. 5
In
íí6 8#
ds_Consulta_Reporte01
íí9 N
.
ííN O
Tables
ííO U
(
ííU V
$num
ííV W
)
ííW X
.
ííX Y
Rows
ííY ]
ds_Reporte01
ìì 
.
ìì 
Tables
ìì #
(
ìì# $
$num
ìì$ %
)
ìì% &
.
ìì& '
Rows
ìì' +
.
ìì+ ,
Add
ìì, /
(
ìì/ 0#
dr_Consulta_Reporte01
ìì0 E
.
ììE F
	ItemArray
ììF O
)
ììO P
Next
îî 

rv_General
ññ 
.
ññ 
ProcessingMode
ññ %
=
ññ& '
ProcessingMode
ññ( 6
.
ññ6 7
Local
ññ7 <

rv_General
óó 
.
óó 
LocalReport
óó "
.
óó" #

ReportPath
óó# -
=
óó. /
Server
óó0 6
.
óó6 7
MapPath
óó7 >
(
óó> ?
$str
óó? L
&
óóM N
v_TipoReporte
óóO \
&
óó] ^
$str
óó_ f
)
óóf g
Dim
òò 

parameters
òò 
As
òò 
New
òò !
List
òò" &
(
òò& '
Of
òò' )
ReportParameter
òò* 9
)
òò9 :
(
òò: ;
)
òò; <

rv_General
ôô 
.
ôô 
LocalReport
ôô "
.
ôô" #
SetParameters
ôô# 0
(
ôô0 1

parameters
ôô1 ;
)
ôô; <
Dim
öö 
Movimiento_Rpt
öö 
As
öö !
New
öö" %
ReportDataSource
öö& 6
(
öö6 7
$str
öö7 J
,
ööJ K
ds_Reporte01
ööL X
.
ööX Y
Tables
ööY _
(
öö_ `
$num
öö` a
)
ööa b
)
ööb c

rv_General
õõ 
.
õõ 
LocalReport
õõ "
.
õõ" #
DataSources
õõ# .
.
õõ. /
Clear
õõ/ 4
(
õõ4 5
)
õõ5 6

rv_General
úú 
.
úú 
LocalReport
úú "
.
úú" #
DataSources
úú# .
.
úú. /
Add
úú/ 2
(
úú2 3
Movimiento_Rpt
úú3 A
)
úúA B
Else
ûû 

lbl_Valida
üü 
.
üü 
	ForeColor
üü  
=
üü! "
System
üü# )
.
üü) *
Drawing
üü* 1
.
üü1 2
Color
üü2 7
.
üü7 8
Red
üü8 ;

lbl_Valida
†† 
.
†† 
Text
†† 
=
†† 
$str
†† L
Exit
°° 
Sub
°° 
End
¢¢ 
If
¢¢ 
Dim
•• 
warnings
•• 
As
•• 
Warning
•• 
(
••  
)
••  !
=
••" #
Nothing
••$ +
Dim
¶¶ 
	streamids
¶¶ 
As
¶¶ 
String
¶¶ 
(
¶¶  
)
¶¶  !
=
¶¶" #
Nothing
¶¶$ +
Dim
ßß 
mimeType
ßß 
As
ßß 
String
ßß 
=
ßß  
Nothing
ßß! (
Dim
®® 
contentType
®® 
As
®® 
String
®® !
=
®®" #
Nothing
®®$ +
Dim
©© 
encoding
©© 
As
©© 
String
©© 
=
©©  
Nothing
©©! (
Dim
™™ 
	extension
™™ 
As
™™ 
String
™™ 
=
™™  !
Nothing
™™" )
Dim
≠≠ 
bytes
≠≠ 
As
≠≠ 
Byte
≠≠ 
(
≠≠ 
)
≠≠ 
=
≠≠ 

rv_General
≠≠ (
.
≠≠( )
LocalReport
≠≠) 4
.
≠≠4 5
Render
≠≠5 ;
(
≠≠; <
FormatoReporte
≠≠< J
,
≠≠J K
Nothing
≠≠L S
,
≠≠S T
mimeType
≠≠U ]
,
≠≠] ^
contentType
≠≠_ j
,
≠≠j k
encoding
≠≠l t
,
≠≠t u
	extension
≠≠v 
,≠≠ Ä
	streamids≠≠Å ä
,≠≠ä ã
warnings≠≠å î
)≠≠î ï
Response
∞∞ 
.
∞∞ 
Clear
∞∞ 
(
∞∞ 
)
∞∞ 
Response
±± 
.
±± 
Buffer
±± 
=
±± 
True
±± 
Response
≤≤ 
.
≤≤ 
Charset
≤≤ 
=
≤≤ 
$str
≤≤ 
Response
≥≥ 
.
≥≥ 
Cache
≥≥ 
.
≥≥ 
SetCacheability
≥≥ &
(
≥≥& '
HttpCacheability
≥≥' 7
.
≥≥7 8
NoCache
≥≥8 ?
)
≥≥? @
Response
¥¥ 
.
¥¥ 
ContentType
¥¥ 
=
¥¥ 
contentType
¥¥ *
Response
µµ 
.
µµ 
AppendHeader
µµ 
(
µµ 
$str
µµ 3
,
µµ3 4
$str
µµ5 L
&
µµM N
v_TipoReporte
µµO \
&
µµ] ^
$str
µµ_ b
&
µµc d
	extension
µµe n
)
µµn o
Response
∂∂ 
.
∂∂ 
BinaryWrite
∂∂ 
(
∂∂ 
bytes
∂∂ "
)
∂∂" #
Response
∑∑ 
.
∑∑ 
Flush
∑∑ 
(
∑∑ 
)
∑∑ 
Response
∏∏ 
.
∏∏ 
End
∏∏ 
(
∏∏ 
)
∏∏ 
End
ππ 
Sub
ππ 
Endºº 
Class
ºº 	®Ò
gC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\frm_Reportes.aspx.vb
Public 
Class 
frm_Reportes 
Inherits 
System 
. 
Web 
. 
UI 
. 
Page 
	Protected 
Sub 
	Page_Load 
( 
ByVal !
sender" (
As) +
Object, 2
,2 3
ByVal4 9
e: ;
As< >
System? E
.E F
	EventArgsF O
)O P
HandlesQ X
MeY [
.[ \
Load\ `
Session		 
(		 
$str		 
)		 
=		 
$str		 (
img_load

 
.

 
Visible

 
=

 
False

  
If 

f_validarSesion 
( 
) 
= 
True #
Then$ (
If 
Not 
Page 
. 

IsPostBack "
Then# '
Try 
cls_Metodos 
.  
culture_info  ,
(, -
)- .#
Inicializacion_Reportes +
(+ ,
), -

Validacion 
( 
$str *
)* +
Catch 
ex 
As 
	Exception %
lbl_validaLector1 %
.% &
Text& *
=+ ,
ex- /
./ 0
Message0 7
lbl_validaLector1 %
.% &
	ForeColor& /
=0 1
System2 8
.8 9
Drawing9 @
.@ A
ColorA F
.F G
RedG J
End 
Try 
End 
If 
Else 
Session 
( 
$str 
) 
= 
$str  #
Response 
. 
Redirect 
( 
$str m
)m n
End 
If 
End 
Sub 
Public 

Function 
f_validarSesion #
(# $
)$ %
As& (
Boolean) 0
If 

Session 
( 
$str !
)! "
Is# %
Nothing& -
Then. 2
Return   
False   
End!! 
If!! 
Return"" 
True"" 
End## 
Function## 
Private%% 
Sub%% #
Inicializacion_Reportes%% '
(%%' (
)%%( ) 
fs_a1BusqCodEmpleado'' 
.'' 
Visible'' $
=''% &
True''' +
fs_a2BusqAvanzada(( 
.(( 
Visible(( !
=((" #
False(($ )
fs_b1BusqPorNumReg** 
.** 
Visible** "
=**# $
False**% *
fs_b2BusqAvanzada++ 
.++ 
Visible++ !
=++" #
False++$ )
fs_c1BusqPorNum-- 
.-- 
Visible-- 
=--  !
False--" '
fs_c2BusqAvanzada.. 
... 
Visible.. !
=.." #
False..$ )

fs_e1Otros00 
.00 
Visible00 
=00 
False00 "%
btn_a1BusquedaCodEmpleado22 !
.22! "
Visible22" )
=22* +
True22, 0"
btn_a2BusquedaAvanzada33 
.33 
Visible33 &
=33' (
True33) -(
btn_b1BusquedaNumeroRegistro55 $
.55$ %
Visible55% ,
=55- .
False55/ 4"
btn_b2BusquedaAvanzada66 
.66 
Visible66 &
=66' (
False66) . 
btn_c1BusquedaNumero88 
.88 
Visible88 $
=88% &
False88' ,"
btn_c2BusquedaAvanzada99 
.99 
Visible99 &
=99' (
False99) .!
btn_e1SeguimientosWeb;; 
.;; 
Visible;; %
=;;& '
False;;( -%
btn_a1BusquedaCodEmpleado== !
.==! "

Attributes==" ,
.==, -
Add==- 0
(==0 1
$str==1 8
,==8 9
$str==: Z
)==Z [%
btn_a1BusquedaCodEmpleado>> !
.>>! "
Disabled>>" *
=>>+ ,
True>>- 1
End@@ 
Sub@@ 
PrivateBB 
SubBB 

ValidacionBB 
(BB 
ByValBB  

ValidacionBB! +
AsBB, .
StringBB/ 5
)BB5 6 
txt_ValorCodEmpleadoFF 
.FF 

AttributesFF '
.FF' (
AddFF( +
(FF+ ,
$strFF, 5
,FF5 6
$strFF7 X
)FFX Y 
txt_ValorCodEmpleadoGG 
.GG 
	MaxLengthGG &
=GG' (
$numGG) *
txt_valorLibro1HH 
.HH 

AttributesHH "
.HH" #
AddHH# &
(HH& '
$strHH' 0
,HH0 1
$strHH2 R
)HHR S
txt_valorLibro1II 
.II 
	MaxLengthII !
=II" #
$numII$ %
txt_ValorPrestamo1JJ 
.JJ 

AttributesJJ %
.JJ% &
AddJJ& )
(JJ) *
$strJJ* 3
,JJ3 4
$strJJ5 X
)JJX Y
txt_ValorPrestamo1KK 
.KK 
	MaxLengthKK $
=KK% &
$numKK' (
IfNN 


ValidacionNN 
=NN 
$strNN #
ThenNN$ ($
btn_verHistorialEmpleadoOO $
.OO$ %
EnabledOO% ,
=OO- .
FalseOO/ 4
btn_verFichaLibro1QQ 
.QQ 
EnabledQQ &
=QQ' (
FalseQQ) .!
btn_verHistorialLibroRR !
.RR! "
EnabledRR" )
=RR* +
FalseRR, 1
btn_verFichaLibro2SS 
.SS 
EnabledSS &
=SS' (
FalseSS) .!
btn_VerFichaPrestamo1UU !
.UU! "
EnabledUU" )
=UU* +
FalseUU, 1!
btn_verFichaPrestamo2VV !
.VV! "
EnabledVV" )
=VV* +
FalseVV, 1
btn_verFichaBusqWebXX 
.XX  
EnabledXX  '
=XX( )
FalseXX* /
ElseIfZZ 

ValidacionZZ 
=ZZ 
$strZZ 
ThenZZ  $
End]] 
If]] 
End__ 
Sub__ 
Privateaa 
Subaa 1
%btn_a1BusquedaCodEmpleado_ServerClickaa 5
(aa5 6
senderaa6 <
Asaa= ?
Objectaa@ F
,aaF G
eaaH I
AsaaJ L
	EventArgsaaM V
)aaV W
HandlesaaX _%
btn_a1BusquedaCodEmpleadoaa` y
.aay z
ServerClick	aaz Ö 
fs_a1BusqCodEmpleadocc 
.cc 
Visiblecc $
=cc% &
Truecc' +
fs_a2BusqAvanzadadd 
.dd 
Visibledd !
=dd" #
Falsedd$ )%
btn_a1BusquedaCodEmpleadoff !
.ff! "

Attributesff" ,
.ff, -
Addff- 0
(ff0 1
$strff1 8
,ff8 9
$strff: Z
)ffZ ["
btn_a2BusquedaAvanzadagg 
.gg 

Attributesgg )
.gg) *
Removegg* 0
(gg0 1
$strgg1 8
)gg8 9%
btn_a1BusquedaCodEmpleadoii !
.ii! "
Disabledii" *
=ii+ ,
Trueii- 1"
btn_a2BusquedaAvanzadajj 
.jj 
Disabledjj '
=jj( )
Falsejj* /
Endll 
Subll 
Privatenn 
Subnn .
"btn_a2BusquedaAvanzada_ServerClicknn 2
(nn2 3
sendernn3 9
Asnn: <
Objectnn= C
,nnC D
ennE F
AsnnG I
	EventArgsnnJ S
)nnS T
HandlesnnU \"
btn_a2BusquedaAvanzadann] s
.nns t
ServerClicknnt 
fs_a2BusqAvanzadaoo 
.oo 
Visibleoo !
=oo" #
Trueoo$ ( 
fs_a1BusqCodEmpleadopp 
.pp 
Visiblepp $
=pp% &
Falsepp' ,"
btn_a2BusquedaAvanzadarr 
.rr 

Attributesrr )
.rr) *
Addrr* -
(rr- .
$strrr. 5
,rr5 6
$strrr7 W
)rrW X%
btn_a1BusquedaCodEmpleadoss !
.ss! "

Attributesss" ,
.ss, -
Removess- 3
(ss3 4
$strss4 ;
)ss; <%
btn_a1BusquedaCodEmpleadouu !
.uu! "
Disableduu" *
=uu+ ,
Falseuu- 2"
btn_a2BusquedaAvanzadavv 
.vv 
Disabledvv '
=vv( )
Truevv* .(
btn_b1BusquedaNumeroRegistroxx $
.xx$ %
Disabledxx% -
=xx. /
Falsexx0 5"
btn_b2BusquedaAvanzadayy 
.yy 
Disabledyy '
=yy( )
Falseyy* / 
btn_c1BusquedaNumero{{ 
.{{ 
Disabled{{ %
={{& '
False{{( -"
btn_c2BusquedaAvanzada|| 
.|| 
Disabled|| '
=||( )
True||* .!
btn_e1SeguimientosWeb~~ 
.~~ 
Disabled~~ &
=~~' (
False~~) .
End 
Sub 
Private
ÅÅ 
Sub
ÅÅ 6
(btn_b1BusquedaNumeroRegistro_ServerClick
ÅÅ 8
(
ÅÅ8 9
sender
ÅÅ9 ?
As
ÅÅ@ B
Object
ÅÅC I
,
ÅÅI J
e
ÅÅK L
As
ÅÅM O
	EventArgs
ÅÅP Y
)
ÅÅY Z
Handles
ÅÅ[ b*
btn_b1BusquedaNumeroRegistro
ÅÅc 
.ÅÅ Ä
ServerClickÅÅÄ ã"
fs_a1BusqCodEmpleado
ÇÇ 
.
ÇÇ 
Visible
ÇÇ $
=
ÇÇ% &
False
ÇÇ' ,
fs_a2BusqAvanzada
ÉÉ 
.
ÉÉ 
Visible
ÉÉ !
=
ÉÉ" #
False
ÉÉ$ ) 
fs_b1BusqPorNumReg
ÑÑ 
.
ÑÑ 
Visible
ÑÑ "
=
ÑÑ# $
True
ÑÑ% )
fs_b2BusqAvanzada
ÖÖ 
.
ÖÖ 
Visible
ÖÖ !
=
ÖÖ" #
False
ÖÖ$ )
fs_c1BusqPorNum
ÜÜ 
.
ÜÜ 
Visible
ÜÜ 
=
ÜÜ  !
False
ÜÜ" '
fs_c2BusqAvanzada
áá 
.
áá 
Visible
áá !
=
áá" #
False
áá$ )

fs_e1Otros
àà 
.
àà 
Visible
àà 
=
àà 
False
àà "*
btn_b1BusquedaNumeroRegistro
ää $
.
ää$ %

Attributes
ää% /
.
ää/ 0
Add
ää0 3
(
ää3 4
$str
ää4 ;
,
ää; <
$str
ää= ]
)
ää] ^$
btn_b2BusquedaAvanzada
ãã 
.
ãã 

Attributes
ãã )
.
ãã) *
Remove
ãã* 0
(
ãã0 1
$str
ãã1 8
)
ãã8 9*
btn_b1BusquedaNumeroRegistro
çç $
.
çç$ %
Disabled
çç% -
=
çç. /
True
çç0 4$
btn_b2BusquedaAvanzada
éé 
.
éé 
Disabled
éé '
=
éé( )
False
éé* /
End
èè 
Sub
èè 
Private
ëë 
Sub
ëë 0
"btn_b2BusquedaAvanzada_ServerClick
ëë 2
(
ëë2 3
sender
ëë3 9
As
ëë: <
Object
ëë= C
,
ëëC D
e
ëëE F
As
ëëG I
	EventArgs
ëëJ S
)
ëëS T
Handles
ëëU \$
btn_b2BusquedaAvanzada
ëë] s
.
ëës t
ServerClick
ëët "
fs_a1BusqCodEmpleado
íí 
.
íí 
Visible
íí $
=
íí% &
False
íí' ,
fs_a2BusqAvanzada
ìì 
.
ìì 
Visible
ìì !
=
ìì" #
False
ìì$ ) 
fs_b1BusqPorNumReg
îî 
.
îî 
Visible
îî "
=
îî# $
False
îî% *
fs_b2BusqAvanzada
ïï 
.
ïï 
Visible
ïï !
=
ïï" #
True
ïï$ (
fs_c1BusqPorNum
ññ 
.
ññ 
Visible
ññ 
=
ññ  !
False
ññ" '
fs_c2BusqAvanzada
óó 
.
óó 
Visible
óó !
=
óó" #
False
óó$ )

fs_e1Otros
òò 
.
òò 
Visible
òò 
=
òò 
False
òò "$
btn_b2BusquedaAvanzada
öö 
.
öö 

Attributes
öö )
.
öö) *
Add
öö* -
(
öö- .
$str
öö. 5
,
öö5 6
$str
öö7 W
)
ööW X*
btn_b1BusquedaNumeroRegistro
õõ $
.
õõ$ %

Attributes
õõ% /
.
õõ/ 0
Remove
õõ0 6
(
õõ6 7
$str
õõ7 >
)
õõ> ?'
btn_a1BusquedaCodEmpleado
úú !
.
úú! "

Attributes
úú" ,
.
úú, -
Remove
úú- 3
(
úú3 4
$str
úú4 ;
)
úú; <$
btn_a2BusquedaAvanzada
ùù 
.
ùù 

Attributes
ùù )
.
ùù) *
Remove
ùù* 0
(
ùù0 1
$str
ùù1 8
)
ùù8 9"
btn_c1BusquedaNumero
ûû 
.
ûû 

Attributes
ûû '
.
ûû' (
Remove
ûû( .
(
ûû. /
$str
ûû/ 6
)
ûû6 7$
btn_c2BusquedaAvanzada
üü 
.
üü 

Attributes
üü )
.
üü) *
Remove
üü* 0
(
üü0 1
$str
üü1 8
)
üü8 9#
btn_e1SeguimientosWeb
†† 
.
†† 

Attributes
†† (
.
††( )
Remove
††) /
(
††/ 0
$str
††0 7
)
††7 8'
btn_a1BusquedaCodEmpleado
¢¢ !
.
¢¢! "
Disabled
¢¢" *
=
¢¢+ ,
False
¢¢- 2$
btn_a2BusquedaAvanzada
££ 
.
££ 
Disabled
££ '
=
££( )
False
££* /*
btn_b1BusquedaNumeroRegistro
§§ $
.
§§$ %
Disabled
§§% -
=
§§. /
False
§§0 5$
btn_b2BusquedaAvanzada
•• 
.
•• 
Disabled
•• '
=
••( )
True
••* ."
btn_c1BusquedaNumero
¶¶ 
.
¶¶ 
Disabled
¶¶ %
=
¶¶& '
False
¶¶( -$
btn_c2BusquedaAvanzada
ßß 
.
ßß 
Disabled
ßß '
=
ßß( )
False
ßß* /#
btn_e1SeguimientosWeb
®® 
.
®® 
Disabled
®® &
=
®®' (
False
®®) .
End
©© 
Sub
©© 
Private
´´ 
Sub
´´ .
 btn_c1BusquedaNumero_ServerClick
´´ 0
(
´´0 1
sender
´´1 7
As
´´8 :
Object
´´; A
,
´´A B
e
´´C D
As
´´E G
	EventArgs
´´H Q
)
´´Q R
Handles
´´S Z"
btn_c1BusquedaNumero
´´[ o
.
´´o p
ServerClick
´´p {"
fs_a1BusqCodEmpleado
¨¨ 
.
¨¨ 
Visible
¨¨ $
=
¨¨% &
False
¨¨' ,
fs_a2BusqAvanzada
≠≠ 
.
≠≠ 
Visible
≠≠ !
=
≠≠" #
False
≠≠$ ) 
fs_b1BusqPorNumReg
ÆÆ 
.
ÆÆ 
Visible
ÆÆ "
=
ÆÆ# $
False
ÆÆ% *
fs_b2BusqAvanzada
ØØ 
.
ØØ 
Visible
ØØ !
=
ØØ" #
False
ØØ$ )
fs_c1BusqPorNum
∞∞ 
.
∞∞ 
Visible
∞∞ 
=
∞∞  !
True
∞∞" &
fs_c2BusqAvanzada
±± 
.
±± 
Visible
±± !
=
±±" #
False
±±$ )

fs_e1Otros
≤≤ 
.
≤≤ 
Visible
≤≤ 
=
≤≤ 
False
≤≤ ""
btn_c1BusquedaNumero
¥¥ 
.
¥¥ 

Attributes
¥¥ '
.
¥¥' (
Add
¥¥( +
(
¥¥+ ,
$str
¥¥, 3
,
¥¥3 4
$str
¥¥5 U
)
¥¥U V$
btn_c2BusquedaAvanzada
µµ 
.
µµ 

Attributes
µµ )
.
µµ) *
Remove
µµ* 0
(
µµ0 1
$str
µµ1 8
)
µµ8 9"
btn_c1BusquedaNumero
∑∑ 
.
∑∑ 
Disabled
∑∑ %
=
∑∑& '
True
∑∑( ,$
btn_c2BusquedaAvanzada
∏∏ 
.
∏∏ 
Disabled
∏∏ '
=
∏∏( )
False
∏∏* /
End
ππ 
Sub
ππ 
Private
ªª 
Sub
ªª 0
"btn_c2BusquedaAvanzada_ServerClick
ªª 2
(
ªª2 3
sender
ªª3 9
As
ªª: <
Object
ªª= C
,
ªªC D
e
ªªE F
As
ªªG I
	EventArgs
ªªJ S
)
ªªS T
Handles
ªªU \$
btn_c2BusquedaAvanzada
ªª] s
.
ªªs t
ServerClick
ªªt "
fs_a1BusqCodEmpleado
ºº 
.
ºº 
Visible
ºº $
=
ºº% &
False
ºº' ,
fs_a2BusqAvanzada
ΩΩ 
.
ΩΩ 
Visible
ΩΩ !
=
ΩΩ" #
False
ΩΩ$ ) 
fs_b1BusqPorNumReg
ææ 
.
ææ 
Visible
ææ "
=
ææ# $
False
ææ% *
fs_b2BusqAvanzada
øø 
.
øø 
Visible
øø !
=
øø" #
False
øø$ )
fs_c1BusqPorNum
¿¿ 
.
¿¿ 
Visible
¿¿ 
=
¿¿  !
False
¿¿" '
fs_c2BusqAvanzada
¡¡ 
.
¡¡ 
Visible
¡¡ !
=
¡¡" #
True
¡¡$ (

fs_e1Otros
¬¬ 
.
¬¬ 
Visible
¬¬ 
=
¬¬ 
False
¬¬ "$
btn_c2BusquedaAvanzada
ƒƒ 
.
ƒƒ 

Attributes
ƒƒ )
.
ƒƒ) *
Add
ƒƒ* -
(
ƒƒ- .
$str
ƒƒ. 5
,
ƒƒ5 6
$str
ƒƒ7 W
)
ƒƒW X"
btn_c1BusquedaNumero
≈≈ 
.
≈≈ 

Attributes
≈≈ '
.
≈≈' (
Remove
≈≈( .
(
≈≈. /
$str
≈≈/ 6
)
≈≈6 7"
btn_c1BusquedaNumero
«« 
.
«« 
Disabled
«« %
=
««& '
False
««( -$
btn_c2BusquedaAvanzada
»» 
.
»» 
Disabled
»» '
=
»»( )
True
»»* .
End
…… 
Sub
…… 
	Protected
ÀÀ 
Sub
ÀÀ  
rdb_Lector_Checked
ÀÀ $
(
ÀÀ$ %
ByVal
ÀÀ% *
sender
ÀÀ+ 1
As
ÀÀ2 4
Object
ÀÀ5 ;
,
ÀÀ; <
ByVal
ÀÀ= B
e
ÀÀC D
As
ÀÀE G
	EventArgs
ÀÀH Q
)
ÀÀQ R
Handles
ÀÀS Z

rdb_Lector
ÀÀ[ e
.
ÀÀe f
CheckedChanged
ÀÀf t
Response
ÃÃ 
.
ÃÃ 
Redirect
ÃÃ 
(
ÃÃ 
$str
ÃÃ -
)
ÃÃ- .
End
ÕÕ 
Sub
ÕÕ 
	Protected
œœ 
Sub
œœ  
rdb_Libros_Checked
œœ $
(
œœ$ %
ByVal
œœ% *
sender
œœ+ 1
As
œœ2 4
Object
œœ5 ;
,
œœ; <
ByVal
œœ= B
e
œœC D
As
œœE G
	EventArgs
œœH Q
)
œœQ R
Handles
œœS Z

rdb_Libros
œœ[ e
.
œœe f
CheckedChanged
œœf t"
fs_a1BusqCodEmpleado
–– 
.
–– 
Visible
–– $
=
––% &
False
––' ,
fs_a2BusqAvanzada
—— 
.
—— 
Visible
—— !
=
——" #
False
——$ ) 
fs_b1BusqPorNumReg
““ 
.
““ 
Visible
““ "
=
““# $
True
““% )
fs_b2BusqAvanzada
”” 
.
”” 
Visible
”” !
=
””" #
False
””$ )
fs_c1BusqPorNum
‘‘ 
.
‘‘ 
Visible
‘‘ 
=
‘‘  !
False
‘‘" '
fs_c2BusqAvanzada
’’ 
.
’’ 
Visible
’’ !
=
’’" #
False
’’$ )

fs_e1Otros
÷÷ 
.
÷÷ 
Visible
÷÷ 
=
÷÷ 
False
÷÷ "*
btn_b1BusquedaNumeroRegistro
ÿÿ $
.
ÿÿ$ %

Attributes
ÿÿ% /
.
ÿÿ/ 0
Add
ÿÿ0 3
(
ÿÿ3 4
$str
ÿÿ4 ;
,
ÿÿ; <
$str
ÿÿ= ]
)
ÿÿ] ^'
btn_a1BusquedaCodEmpleado
ŸŸ !
.
ŸŸ! "

Attributes
ŸŸ" ,
.
ŸŸ, -
Remove
ŸŸ- 3
(
ŸŸ3 4
$str
ŸŸ4 ;
)
ŸŸ; <$
btn_a2BusquedaAvanzada
⁄⁄ 
.
⁄⁄ 

Attributes
⁄⁄ )
.
⁄⁄) *
Remove
⁄⁄* 0
(
⁄⁄0 1
$str
⁄⁄1 8
)
⁄⁄8 9$
btn_b2BusquedaAvanzada
€€ 
.
€€ 

Attributes
€€ )
.
€€) *
Remove
€€* 0
(
€€0 1
$str
€€1 8
)
€€8 9"
btn_c1BusquedaNumero
‹‹ 
.
‹‹ 

Attributes
‹‹ '
.
‹‹' (
Remove
‹‹( .
(
‹‹. /
$str
‹‹/ 6
)
‹‹6 7$
btn_c2BusquedaAvanzada
›› 
.
›› 

Attributes
›› )
.
››) *
Remove
››* 0
(
››0 1
$str
››1 8
)
››8 9#
btn_e1SeguimientosWeb
ﬁﬁ 
.
ﬁﬁ 

Attributes
ﬁﬁ (
.
ﬁﬁ( )
Remove
ﬁﬁ) /
(
ﬁﬁ/ 0
$str
ﬁﬁ0 7
)
ﬁﬁ7 8*
btn_b1BusquedaNumeroRegistro
‡‡ $
.
‡‡$ %
Disabled
‡‡% -
=
‡‡. /
True
‡‡0 4$
btn_b2BusquedaAvanzada
·· 
.
·· 
Disabled
·· '
=
··( )
False
··* /'
btn_a1BusquedaCodEmpleado
„„ !
.
„„! "
Visible
„„" )
=
„„* +
False
„„, 1$
btn_a2BusquedaAvanzada
‰‰ 
.
‰‰ 
Visible
‰‰ &
=
‰‰' (
False
‰‰) .*
btn_b1BusquedaNumeroRegistro
ÂÂ $
.
ÂÂ$ %
Visible
ÂÂ% ,
=
ÂÂ- .
True
ÂÂ/ 3$
btn_b2BusquedaAvanzada
ÊÊ 
.
ÊÊ 
Visible
ÊÊ &
=
ÊÊ' (
True
ÊÊ) -"
btn_c1BusquedaNumero
ÁÁ 
.
ÁÁ 
Visible
ÁÁ $
=
ÁÁ% &
False
ÁÁ' ,$
btn_c2BusquedaAvanzada
ËË 
.
ËË 
Visible
ËË &
=
ËË' (
False
ËË) .#
btn_e1SeguimientosWeb
ÈÈ 
.
ÈÈ 
Visible
ÈÈ %
=
ÈÈ& '
False
ÈÈ( -
End
ÍÍ 
Sub
ÍÍ 
	Protected
ÏÏ 
Sub
ÏÏ "
rdb_Prestamo_Checked
ÏÏ &
(
ÏÏ& '
ByVal
ÏÏ' ,
sender
ÏÏ- 3
As
ÏÏ4 6
Object
ÏÏ7 =
,
ÏÏ= >
ByVal
ÏÏ? D
e
ÏÏE F
As
ÏÏG I
	EventArgs
ÏÏJ S
)
ÏÏS T
Handles
ÏÏU \
rdb_Prestamo
ÏÏ] i
.
ÏÏi j
CheckedChanged
ÏÏj x"
fs_a1BusqCodEmpleado
ÓÓ 
.
ÓÓ 
Visible
ÓÓ $
=
ÓÓ% &
False
ÓÓ' ,
fs_a2BusqAvanzada
ÔÔ 
.
ÔÔ 
Visible
ÔÔ !
=
ÔÔ" #
False
ÔÔ$ ) 
fs_b1BusqPorNumReg
 
.
 
Visible
 "
=
# $
False
% *
fs_b2BusqAvanzada
ÒÒ 
.
ÒÒ 
Visible
ÒÒ !
=
ÒÒ" #
False
ÒÒ$ )
fs_c1BusqPorNum
ÚÚ 
.
ÚÚ 
Visible
ÚÚ 
=
ÚÚ  !
True
ÚÚ" &
fs_c2BusqAvanzada
ÛÛ 
.
ÛÛ 
Visible
ÛÛ !
=
ÛÛ" #
False
ÛÛ$ )

fs_e1Otros
ÙÙ 
.
ÙÙ 
Visible
ÙÙ 
=
ÙÙ 
False
ÙÙ "'
btn_a1BusquedaCodEmpleado
ˆˆ !
.
ˆˆ! "
Visible
ˆˆ" )
=
ˆˆ* +
False
ˆˆ, 1$
btn_a2BusquedaAvanzada
˜˜ 
.
˜˜ 
Visible
˜˜ &
=
˜˜' (
False
˜˜) .*
btn_b1BusquedaNumeroRegistro
¯¯ $
.
¯¯$ %
Visible
¯¯% ,
=
¯¯- .
False
¯¯/ 4$
btn_b2BusquedaAvanzada
˘˘ 
.
˘˘ 
Visible
˘˘ &
=
˘˘' (
False
˘˘) ."
btn_c1BusquedaNumero
˙˙ 
.
˙˙ 
Visible
˙˙ $
=
˙˙% &
True
˙˙' +$
btn_c2BusquedaAvanzada
˚˚ 
.
˚˚ 
Visible
˚˚ &
=
˚˚' (
True
˚˚) -#
btn_e1SeguimientosWeb
¸¸ 
.
¸¸ 
Visible
¸¸ %
=
¸¸& '
False
¸¸( -"
btn_c1BusquedaNumero
˛˛ 
.
˛˛ 

Attributes
˛˛ '
.
˛˛' (
Add
˛˛( +
(
˛˛+ ,
$str
˛˛, 3
,
˛˛3 4
$str
˛˛5 U
)
˛˛U V$
btn_c2BusquedaAvanzada
ˇˇ 
.
ˇˇ 

Attributes
ˇˇ )
.
ˇˇ) *
Remove
ˇˇ* 0
(
ˇˇ0 1
$str
ˇˇ1 8
)
ˇˇ8 9"
btn_c1BusquedaNumero
ÅÅ 
.
ÅÅ 
Disabled
ÅÅ %
=
ÅÅ& '
True
ÅÅ( ,$
btn_c2BusquedaAvanzada
ÇÇ 
.
ÇÇ 
Disabled
ÇÇ '
=
ÇÇ( )
False
ÇÇ* /"
btn_c1BusquedaNumero
ÑÑ 
.
ÑÑ 
Disabled
ÑÑ %
=
ÑÑ& '
True
ÑÑ( ,$
btn_c2BusquedaAvanzada
ÖÖ 
.
ÖÖ 
Disabled
ÖÖ '
=
ÖÖ( )
False
ÖÖ* /
End
ÜÜ 
Sub
ÜÜ 
	Protected
àà 
Sub
àà 
rdb_Otros_Checked
àà #
(
àà# $
ByVal
àà$ )
sender
àà* 0
As
àà1 3
Object
àà4 :
,
àà: ;
ByVal
àà< A
e
ààB C
As
ààD F
	EventArgs
ààG P
)
ààP Q
Handles
ààR Y
	rdb_Otros
ààZ c
.
ààc d
CheckedChanged
ààd r"
fs_a1BusqCodEmpleado
ââ 
.
ââ 
Visible
ââ $
=
ââ% &
False
ââ' ,
fs_a2BusqAvanzada
ää 
.
ää 
Visible
ää !
=
ää" #
False
ää$ ) 
fs_b1BusqPorNumReg
ãã 
.
ãã 
Visible
ãã "
=
ãã# $
False
ãã% *
fs_b2BusqAvanzada
åå 
.
åå 
Visible
åå !
=
åå" #
False
åå$ )
fs_c1BusqPorNum
çç 
.
çç 
Visible
çç 
=
çç  !
False
çç" '
fs_c2BusqAvanzada
éé 
.
éé 
Visible
éé !
=
éé" #
False
éé$ )

fs_e1Otros
èè 
.
èè 
Visible
èè 
=
èè 
True
èè !#
btn_e1SeguimientosWeb
ëë 
.
ëë 

Attributes
ëë (
.
ëë( )
Add
ëë) ,
(
ëë, -
$str
ëë- 4
,
ëë4 5
$str
ëë6 V
)
ëëV W'
btn_a1BusquedaCodEmpleado
ìì !
.
ìì! "

Attributes
ìì" ,
.
ìì, -
Remove
ìì- 3
(
ìì3 4
$str
ìì4 ;
)
ìì; <$
btn_a2BusquedaAvanzada
îî 
.
îî 

Attributes
îî )
.
îî) *
Remove
îî* 0
(
îî0 1
$str
îî1 8
)
îî8 9*
btn_b1BusquedaNumeroRegistro
ïï $
.
ïï$ %

Attributes
ïï% /
.
ïï/ 0
Remove
ïï0 6
(
ïï6 7
$str
ïï7 >
)
ïï> ?$
btn_b2BusquedaAvanzada
ññ 
.
ññ 

Attributes
ññ )
.
ññ) *
Remove
ññ* 0
(
ññ0 1
$str
ññ1 8
)
ññ8 9"
btn_c1BusquedaNumero
óó 
.
óó 

Attributes
óó '
.
óó' (
Remove
óó( .
(
óó. /
$str
óó/ 6
)
óó6 7$
btn_c2BusquedaAvanzada
òò 
.
òò 

Attributes
òò )
.
òò) *
Remove
òò* 0
(
òò0 1
$str
òò1 8
)
òò8 9'
btn_a1BusquedaCodEmpleado
öö !
.
öö! "
Visible
öö" )
=
öö* +
False
öö, 1$
btn_a2BusquedaAvanzada
õõ 
.
õõ 
Visible
õõ &
=
õõ' (
False
õõ) .*
btn_b1BusquedaNumeroRegistro
úú $
.
úú$ %
Visible
úú% ,
=
úú- .
False
úú/ 4$
btn_b2BusquedaAvanzada
ùù 
.
ùù 
Visible
ùù &
=
ùù' (
False
ùù) ."
btn_c1BusquedaNumero
ûû 
.
ûû 
Visible
ûû $
=
ûû% &
False
ûû' ,$
btn_c2BusquedaAvanzada
üü 
.
üü 
Visible
üü &
=
üü' (
False
üü) .#
btn_e1SeguimientosWeb
†† 
.
†† 
Visible
†† %
=
††& '
True
††( ,'
btn_a1BusquedaCodEmpleado
¢¢ !
.
¢¢! "
Disabled
¢¢" *
=
¢¢+ ,
False
¢¢- 2$
btn_a2BusquedaAvanzada
££ 
.
££ 
Disabled
££ '
=
££( )
False
££* /*
btn_b1BusquedaNumeroRegistro
•• $
.
••$ %
Disabled
••% -
=
••. /
False
••0 5$
btn_b2BusquedaAvanzada
¶¶ 
.
¶¶ 
Disabled
¶¶ '
=
¶¶( )
False
¶¶* /"
btn_c1BusquedaNumero
®® 
.
®® 
Disabled
®® %
=
®®& '
False
®®( -$
btn_c2BusquedaAvanzada
©© 
.
©© 
Disabled
©© '
=
©©( )
False
©©* /#
btn_e1SeguimientosWeb
™™ 
.
™™ 
Disabled
™™ &
=
™™' (
True
™™) -
End
´´ 
Sub
´´ 
Private
≠≠ 
Function
≠≠  
Formato_Fecha_Hora
≠≠ '
(
≠≠' (
)
≠≠( )
As
≠≠* ,
Tuple
≠≠- 2
(
≠≠2 3
Of
≠≠3 5
String
≠≠6 <
,
≠≠< =
String
≠≠> D
)
≠≠D E
Dim
ØØ 
dd
ØØ 
As
ØØ 
String
ØØ 
=
ØØ 
Day
ØØ 
(
ØØ 
Now
ØØ "
)
ØØ" #
If
∞∞ 

Len
∞∞ 
(
∞∞ 
dd
∞∞ 
)
∞∞ 
=
∞∞ 
$num
∞∞ 
Then
∞∞ 
dd
∞∞ 
=
∞∞  
$str
∞∞! $
&
∞∞% &
dd
∞∞' )
Dim
≤≤ 
mm
≤≤ 
As
≤≤ 
String
≤≤ 
=
≤≤ 
Month
≤≤  
(
≤≤  !
Now
≤≤! $
)
≤≤$ %
If
≥≥ 

Len
≥≥ 
(
≥≥ 
mm
≥≥ 
)
≥≥ 
=
≥≥ 
$num
≥≥ 
Then
≥≥ 
mm
≥≥ 
=
≥≥  
$str
≥≥! $
&
≥≥% &
mm
≥≥' )
Dim
µµ 
aaaa
µµ 
As
µµ 
String
µµ 
=
µµ 
Year
µµ !
(
µµ! "
Now
µµ" %
)
µµ% &
Dim
∂∂ 
formato_Fecha
∂∂ 
=
∂∂ 
dd
∂∂ 
&
∂∂  
$str
∂∂! $
&
∂∂% &
mm
∂∂' )
&
∂∂* +
$str
∂∂, /
&
∂∂0 1
aaaa
∂∂2 6
Dim
ππ 
hor
ππ 
As
ππ 
String
ππ 
=
ππ 
Hour
ππ  
(
ππ  !
Now
ππ! $
)
ππ$ %
Dim
∫∫ 
min
∫∫ 
As
∫∫ 
String
∫∫ 
=
∫∫ 
Minute
∫∫ "
(
∫∫" #
Now
∫∫# &
)
∫∫& '
Dim
ªª 
seg
ªª 
As
ªª 
String
ªª 
=
ªª 
Second
ªª "
(
ªª" #
Now
ªª# &
)
ªª& '
If
ΩΩ 

Len
ΩΩ 
(
ΩΩ 
hor
ΩΩ 
)
ΩΩ 
=
ΩΩ 
$num
ΩΩ 
Then
ΩΩ 
hor
ΩΩ  
=
ΩΩ! "
$str
ΩΩ# &
&
ΩΩ' (
hor
ΩΩ) ,
If
ææ 

Len
ææ 
(
ææ 
min
ææ 
)
ææ 
=
ææ 
$num
ææ 
Then
ææ 
min
ææ  
=
ææ! "
$str
ææ# &
&
ææ' (
min
ææ) ,
If
øø 

Len
øø 
(
øø 
seg
øø 
)
øø 
=
øø 
$num
øø 
Then
øø 
seg
øø  
=
øø! "
$str
øø# &
&
øø' (
seg
øø) ,
Dim
¡¡ 
formato_hora
¡¡ 
=
¡¡ 
hor
¡¡ 
&
¡¡  
$str
¡¡! $
&
¡¡% &
min
¡¡' *
&
¡¡+ ,
$str
¡¡- 0
&
¡¡1 2
seg
¡¡3 6
Return
√√ 
New
√√ 
Tuple
√√ 
(
√√ 
Of
√√ 
String
√√ "
,
√√" #
String
√√$ *
)
√√* +
(
√√+ ,
formato_Fecha
√√, 9
,
√√9 :
formato_hora
√√; G
)
√√G H
End
ƒƒ 
Function
ƒƒ 
Private
∆∆ 
Sub
∆∆ '
btn_CalcularLector1_Click
∆∆ )
(
∆∆) *
sender
∆∆* 0
As
∆∆1 3
Object
∆∆4 :
,
∆∆: ;
e
∆∆< =
As
∆∆> @
	EventArgs
∆∆A J
)
∆∆J K
Handles
∆∆L S!
btn_CalcularLector1
∆∆T g
.
∆∆g h
Click
∆∆h m
Try
«« 
If
…… 
Len
…… 
(
…… 
Trim
…… 
(
…… "
txt_ValorCodEmpleado
…… ,
.
……, -
Text
……- 1
)
……1 2
)
……2 3
=
……4 5
$num
……6 7
Then
……8 <
lbl_validaLector1
   !
.
  ! "
	ForeColor
  " +
=
  , -
System
  . 4
.
  4 5
Drawing
  5 <
.
  < =
Color
  = B
.
  B C
Red
  C F
lbl_validaLector1
ÀÀ !
.
ÀÀ! "
Text
ÀÀ" &
=
ÀÀ' (
$str
ÀÀ) C"
txt_ValorCodEmpleado
ÃÃ $
.
ÃÃ$ %
Text
ÃÃ% )
=
ÃÃ* +
$str
ÃÃ, ."
txt_ValorCodEmpleado
ÕÕ $
.
ÕÕ$ %
Focus
ÕÕ% *
(
ÕÕ* +
)
ÕÕ+ ,
Exit
ŒŒ 
Sub
ŒŒ 
End
œœ 
If
œœ 
Dim
—— 
Valor
—— 
As
—— 
String
—— 
=
——  !"
txt_ValorCodEmpleado
——" 6
.
——6 7
Text
——7 ;
.
——; <
Trim
——< @
Dim
““ 
vBandera
““ 
As
““ 
String
““ "
vBandera
”” 
=
”” 
$str
”” 
Dim
÷÷ #
ds_Consulta_Reporte01
÷÷ %
As
÷÷& (
DataSet
÷÷) 0
=
÷÷1 2
cls_Metodos
÷÷3 >
.
÷÷> ?
BuscarLector
÷÷? K
(
÷÷K L
Valor
÷÷L Q
,
÷÷Q R
vBandera
÷÷S [
)
÷÷[ \
Dim
ÿÿ 

countLista
ÿÿ 
=
ÿÿ #
ds_Consulta_Reporte01
ÿÿ 2
.
ÿÿ2 3
Tables
ÿÿ3 9
(
ÿÿ9 :
$num
ÿÿ: ;
)
ÿÿ; <
.
ÿÿ< =
Rows
ÿÿ= A
.
ÿÿA B
Count
ÿÿB G
If
ŸŸ 
(
ŸŸ 

countLista
ŸŸ 
=
ŸŸ 
$num
ŸŸ 
)
ŸŸ 
Then
ŸŸ  $
lbl_validaLector1
⁄⁄ !
.
⁄⁄! "
	ForeColor
⁄⁄" +
=
⁄⁄, -
System
⁄⁄. 4
.
⁄⁄4 5
Drawing
⁄⁄5 <
.
⁄⁄< =
Color
⁄⁄= B
.
⁄⁄B C
Green
⁄⁄C H
lbl_validaLector1
€€ !
.
€€! "
Text
€€" &
=
€€' (
$str
€€) 9
&
€€: ;

countLista
€€< F
lbl_validaLector1
‹‹ !
.
‹‹! "
Focus
‹‹" '
(
‹‹' (
)
‹‹( )&
btn_verHistorialEmpleado
›› (
.
››( )
Enabled
››) 0
=
››1 2
False
››3 8
rb_FormatContrato
ﬁﬁ !
.
ﬁﬁ! "
Enabled
ﬁﬁ" )
=
ﬁﬁ* +
False
ﬁﬁ, 1
Else
ﬂﬂ 
lbl_validaLector1
‡‡ !
.
‡‡! "
Visible
‡‡" )
=
‡‡* +
True
‡‡, 0
lbl_validaLector1
·· !
.
··! "
	ForeColor
··" +
=
··, -
System
··. 4
.
··4 5
Drawing
··5 <
.
··< =
Color
··= B
.
··B C
Green
··C H
lbl_validaLector1
‚‚ !
.
‚‚! "
Text
‚‚" &
=
‚‚' (
$str
‚‚) 9
&
‚‚: ;

countLista
‚‚< F&
btn_verHistorialEmpleado
„„ (
.
„„( )
Enabled
„„) 0
=
„„1 2
True
„„3 7
rb_FormatContrato
‰‰ !
.
‰‰! "
Enabled
‰‰" )
=
‰‰* +
False
‰‰, 1
End
ÊÊ 
If
ÊÊ 
Catch
ÁÁ 
ex
ÁÁ 
As
ÁÁ 
	Exception
ÁÁ !
lbl_ValidaPrestamo1
ËË 
.
ËË  
Text
ËË  $
=
ËË% &
ex
ËË' )
.
ËË) *
Message
ËË* 1!
lbl_ValidaPrestamo1
ÈÈ 
.
ÈÈ  
	ForeColor
ÈÈ  )
=
ÈÈ* +
System
ÈÈ, 2
.
ÈÈ2 3
Drawing
ÈÈ3 :
.
ÈÈ: ;
Color
ÈÈ; @
.
ÈÈ@ A
Red
ÈÈA D
End
ÍÍ 
Try
ÍÍ 
End
ÎÎ 
Sub
ÎÎ 
Private
ÌÌ 
Sub
ÌÌ %
btn_CalcularLibro_Click
ÌÌ '
(
ÌÌ' (
sender
ÌÌ( .
As
ÌÌ/ 1
Object
ÌÌ2 8
,
ÌÌ8 9
e
ÌÌ: ;
As
ÌÌ< >
	EventArgs
ÌÌ? H
)
ÌÌH I
Handles
ÌÌJ Q
btn_CalcularLibro
ÌÌR c
.
ÌÌc d
Click
ÌÌd i
Try
ÓÓ 
If
 
Len
 
(
 
Trim
 
(
 
txt_valorLibro1
 '
.
' (
Text
( ,
)
, -
)
- .
=
/ 0
$num
1 2
Then
3 7
lbl_validaLibro1
ÒÒ  
.
ÒÒ  !
	ForeColor
ÒÒ! *
=
ÒÒ+ ,
System
ÒÒ- 3
.
ÒÒ3 4
Drawing
ÒÒ4 ;
.
ÒÒ; <
Color
ÒÒ< A
.
ÒÒA B
Red
ÒÒB E
lbl_validaLibro1
ÚÚ  
.
ÚÚ  !
Text
ÚÚ! %
=
ÚÚ& '
$str
ÚÚ( A
txt_valorLibro1
ÛÛ 
.
ÛÛ  
Text
ÛÛ  $
=
ÛÛ% &
$str
ÛÛ' )
txt_valorLibro1
ÙÙ 
.
ÙÙ  
Focus
ÙÙ  %
(
ÙÙ% &
)
ÙÙ& '
Exit
ıı 
Sub
ıı 
End
ˆˆ 
If
ˆˆ 
Dim
¯¯ 
Valor
¯¯ 
As
¯¯ 
String
¯¯ 
=
¯¯  !
txt_valorLibro1
¯¯" 1
.
¯¯1 2
Text
¯¯2 6
.
¯¯6 7
Trim
¯¯7 ;
Dim
˘˘ 
vBandera
˘˘ 
As
˘˘ 
String
˘˘ "
vBandera
˙˙ 
=
˙˙ 
$str
˙˙ 
Dim
˝˝ #
ds_Consulta_Reporte01
˝˝ %
As
˝˝& (
DataSet
˝˝) 0
=
˝˝1 2
cls_Metodos
˝˝3 >
.
˝˝> ?
BuscarLibro
˝˝? J
(
˝˝J K
Valor
˝˝K P
,
˝˝P Q
vBandera
˝˝R Z
)
˝˝Z [
Dim
ˇˇ 

countLista
ˇˇ 
=
ˇˇ #
ds_Consulta_Reporte01
ˇˇ 2
.
ˇˇ2 3
Tables
ˇˇ3 9
(
ˇˇ9 :
$num
ˇˇ: ;
)
ˇˇ; <
.
ˇˇ< =
Rows
ˇˇ= A
.
ˇˇA B
Count
ˇˇB G
If
ÄÄ 
(
ÄÄ 

countLista
ÄÄ 
=
ÄÄ 
$num
ÄÄ 
)
ÄÄ 
Then
ÄÄ  $
lbl_validaLibro1
ÅÅ  
.
ÅÅ  !
	ForeColor
ÅÅ! *
=
ÅÅ+ ,
System
ÅÅ- 3
.
ÅÅ3 4
Drawing
ÅÅ4 ;
.
ÅÅ; <
Color
ÅÅ< A
.
ÅÅA B
Green
ÅÅB G
lbl_validaLibro1
ÇÇ  
.
ÇÇ  !
Text
ÇÇ! %
=
ÇÇ& '
$str
ÇÇ( 8
&
ÇÇ9 :

countLista
ÇÇ; E
lbl_validaLibro1
ÉÉ  
.
ÉÉ  !
Focus
ÉÉ! &
(
ÉÉ& '
)
ÉÉ' ( 
btn_verFichaLibro1
ÑÑ "
.
ÑÑ" #
Enabled
ÑÑ# *
=
ÑÑ+ ,
False
ÑÑ- 2#
btn_verHistorialLibro
ÖÖ %
.
ÖÖ% &
Enabled
ÖÖ& -
=
ÖÖ. /
False
ÖÖ0 5
rb_FormatContrato
ÜÜ !
.
ÜÜ! "
Enabled
ÜÜ" )
=
ÜÜ* +
False
ÜÜ, 1
Else
áá 
lbl_validaLibro1
àà  
.
àà  !
Visible
àà! (
=
àà) *
True
àà+ /
lbl_validaLibro1
ââ  
.
ââ  !
	ForeColor
ââ! *
=
ââ+ ,
System
ââ- 3
.
ââ3 4
Drawing
ââ4 ;
.
ââ; <
Color
ââ< A
.
ââA B
Green
ââB G
lbl_validaLibro1
ää  
.
ää  !
Text
ää! %
=
ää& '
$str
ää( 8
&
ää9 :

countLista
ää; E 
btn_verFichaLibro1
åå "
.
åå" #
Enabled
åå# *
=
åå+ ,
True
åå- 1#
btn_verHistorialLibro
çç %
.
çç% &
Enabled
çç& -
=
çç. /
True
çç0 4
rb_FormatContrato
éé !
.
éé! "
Enabled
éé" )
=
éé* +
False
éé, 1
End
èè 
If
èè 
Catch
êê 
ex
êê 
As
êê 
	Exception
êê !
lbl_ValidaPrestamo1
ëë 
.
ëë  
Text
ëë  $
=
ëë% &
ex
ëë' )
.
ëë) *
Message
ëë* 1!
lbl_ValidaPrestamo1
íí 
.
íí  
	ForeColor
íí  )
=
íí* +
System
íí, 2
.
íí2 3
Drawing
íí3 :
.
íí: ;
Color
íí; @
.
íí@ A
Red
ííA D
End
ìì 
Try
ìì 
End
îî 
Sub
îî 
Private
ññ 
Sub
ññ *
btn_CalcularListaLibro_Click
ññ ,
(
ññ, -
sender
ññ- 3
As
ññ4 6
Object
ññ7 =
,
ññ= >
e
ññ? @
As
ññA C
	EventArgs
ññD M
)
ññM N
Handles
ññO V$
btn_CalcularListaLibro
ññW m
.
ññm n
Click
ññn s
Try
óó 
Dim
ôô 
v_cFechaDesde
ôô 
,
ôô 
v_cFechaHasta
ôô ,
As
ôô- /
Date
ôô0 4
Dim
öö 
v_cTipoFecha
öö 
,
öö 
v_Bandera_Tipo
öö ,
As
öö- /
String
öö0 6
Dim
õõ 
v_cAutor
õõ 
v_cTipoFecha
ùù 
=
ùù 
$str
ùù &
v_cFechaDesde
ûû 
=
ûû !
txt_FechaDesdeLibro
ûû /
.
ûû/ 0
Text
ûû0 4
v_cFechaHasta
üü 
=
üü !
txt_FechaHastaLibro
üü /
.
üü/ 0
Text
üü0 4
v_Bandera_Tipo
†† 
=
†† 
$str
†† 
v_cAutor
°° 
=
°° 
	txt_autor
°°  
.
°°  !
Text
°°! %
If
££ 
	txt_autor
££ 
.
££ 
Text
££ 
=
££ 
$str
££  "
Then
££# '
v_cAutor
§§ 
=
§§ 
$str
§§ 
End
•• 
If
•• 
If
®® 
Not
®® 
IsDate
®® 
(
®® 
v_cFechaDesde
®® '
)
®®' (
Then
®®) -
lbl_ValidaLibro2
©©  
.
©©  !
	ForeColor
©©! *
=
©©+ ,
System
©©- 3
.
©©3 4
Drawing
©©4 ;
.
©©; <
Color
©©< A
.
©©A B
Red
©©B E
lbl_ValidaLibro2
™™  
.
™™  !
Text
™™! %
=
™™& '
$str
™™( @
Exit
´´ 
Sub
´´ 
End
¨¨ 
If
¨¨ 
If
ÆÆ 
Not
ÆÆ 
IsDate
ÆÆ 
(
ÆÆ 
v_cFechaHasta
ÆÆ '
)
ÆÆ' (
Then
ÆÆ) -
lbl_ValidaLibro2
ØØ  
.
ØØ  !
	ForeColor
ØØ! *
=
ØØ+ ,
System
ØØ- 3
.
ØØ3 4
Drawing
ØØ4 ;
.
ØØ; <
Color
ØØ< A
.
ØØA B
Red
ØØB E
lbl_ValidaLibro2
∞∞  
.
∞∞  !
Text
∞∞! %
=
∞∞& '
$str
∞∞( @
Exit
±± 
Sub
±± 
End
≤≤ 
If
≤≤ 
If
¥¥ 
Len
¥¥ 
(
¥¥ !
txt_FechaDesdeLibro
¥¥ &
.
¥¥& '
Text
¥¥' +
)
¥¥+ ,
=
¥¥- .
$num
¥¥/ 0
Or
¥¥1 3
Len
¥¥4 7
(
¥¥7 8!
txt_FechaHastaLibro
¥¥8 K
.
¥¥K L
Text
¥¥L P
)
¥¥P Q
=
¥¥R S
$num
¥¥T U
Then
¥¥V Z
lbl_ValidaLibro2
µµ  
.
µµ  !
	ForeColor
µµ! *
=
µµ+ ,
System
µµ- 3
.
µµ3 4
Drawing
µµ4 ;
.
µµ; <
Color
µµ< A
.
µµA B
Red
µµB E
lbl_ValidaLibro2
∂∂  
.
∂∂  !
Text
∂∂! %
=
∂∂& '
$str
∂∂( u
Exit
∑∑ 
Sub
∑∑ 
ElseIf
∏∏ 
(
∏∏ 
DateTime
∏∏ 
.
∏∏ 
Compare
∏∏ $
(
∏∏$ %!
txt_FechaDesdeLibro
∏∏% 8
.
∏∏8 9
Text
∏∏9 =
,
∏∏= >!
txt_FechaHastaLibro
∏∏? R
.
∏∏R S
Text
∏∏S W
)
∏∏W X
>
∏∏Y Z
$num
∏∏[ \
)
∏∏\ ]
Then
∏∏^ b
lbl_ValidaLibro2
ππ  
.
ππ  !
	ForeColor
ππ! *
=
ππ+ ,
System
ππ- 3
.
ππ3 4
Drawing
ππ4 ;
.
ππ; <
Color
ππ< A
.
ππA B
Red
ππB E
lbl_ValidaLibro2
∫∫  
.
∫∫  !
Text
∫∫! %
=
∫∫& '
$str
∫∫( ^
Exit
ªª 
Sub
ªª 
Else
ºº 
lbl_ValidaLibro2
ΩΩ  
.
ΩΩ  !
Text
ΩΩ! %
=
ΩΩ& '
$str
ΩΩ( *
End
ææ 
If
ææ 
Dim
¡¡ #
ds_Consulta_Reporte01
¡¡ %
As
¡¡& (
DataSet
¡¡) 0
=
¡¡1 2
cls_Metodos
¡¡3 >
.
¡¡> ?#
ConsultaRptLibroLista
¡¡? T
(
¡¡T U
v_cTipoFecha
¡¡U a
,
¡¡a b
v_cFechaDesde
¡¡c p
,
¡¡p q
v_cFechaHasta
¡¡r 
,¡¡ Ä
v_Bandera_Tipo¡¡Å è
,¡¡è ê
v_cAutor¡¡ë ô
)¡¡ô ö
Dim
√√ 

countLista
√√ 
=
√√ #
ds_Consulta_Reporte01
√√ 2
.
√√2 3
Tables
√√3 9
(
√√9 :
$num
√√: ;
)
√√; <
.
√√< =
Rows
√√= A
.
√√A B
Count
√√B G
If
ƒƒ 
(
ƒƒ 

countLista
ƒƒ 
=
ƒƒ 
$num
ƒƒ 
)
ƒƒ 
Then
ƒƒ  $
lbl_ValidaLibro2
≈≈  
.
≈≈  !
	ForeColor
≈≈! *
=
≈≈+ ,
System
≈≈- 3
.
≈≈3 4
Drawing
≈≈4 ;
.
≈≈; <
Color
≈≈< A
.
≈≈A B
Green
≈≈B G
lbl_ValidaLibro2
∆∆  
.
∆∆  !
Text
∆∆! %
=
∆∆& '
$str
∆∆( 8
&
∆∆9 :

countLista
∆∆; E
lbl_ValidaLibro2
««  
.
««  !
Focus
««! &
(
««& '
)
««' ( 
btn_verFichaLibro2
»» "
.
»»" #
Enabled
»»# *
=
»»+ ,
False
»»- 2
Else
…… 
lbl_ValidaLibro2
    
.
    !
Visible
  ! (
=
  ) *
True
  + /
lbl_ValidaLibro2
ÀÀ  
.
ÀÀ  !
	ForeColor
ÀÀ! *
=
ÀÀ+ ,
System
ÀÀ- 3
.
ÀÀ3 4
Drawing
ÀÀ4 ;
.
ÀÀ; <
Color
ÀÀ< A
.
ÀÀA B
Green
ÀÀB G
lbl_ValidaLibro2
ÃÃ  
.
ÃÃ  !
Text
ÃÃ! %
=
ÃÃ& '
$str
ÃÃ( 8
&
ÃÃ9 :

countLista
ÃÃ; E 
btn_verFichaLibro2
ÕÕ "
.
ÕÕ" #
Enabled
ÕÕ# *
=
ÕÕ+ ,
True
ÕÕ- 1
End
ŒŒ 
If
ŒŒ 
Catch
œœ 
ex
œœ 
As
œœ 
	Exception
œœ 
lbl_ValidaLibro2
–– 
.
–– 
Text
–– !
=
––" #
ex
––$ &
.
––& '
Message
––' .
lbl_ValidaLibro2
—— 
.
—— 
	ForeColor
—— &
=
——' (
System
——) /
.
——/ 0
Drawing
——0 7
.
——7 8
Color
——8 =
.
——= >
Red
——> A
End
““ 
Try
““ 
End
”” 
Sub
”” 
Private
’’ 
Sub
’’ )
btn_CalcularPrestamo1_Click
’’ +
(
’’+ ,
sender
’’, 2
As
’’3 5
Object
’’6 <
,
’’< =
e
’’> ?
As
’’@ B
	EventArgs
’’C L
)
’’L M
Handles
’’N U#
btn_CalcularPrestamo1
’’V k
.
’’k l
Click
’’l q
Try
÷÷ 
If
ÿÿ 
Len
ÿÿ 
(
ÿÿ 
Trim
ÿÿ 
(
ÿÿ  
txt_ValorPrestamo1
ÿÿ *
.
ÿÿ* +
Text
ÿÿ+ /
)
ÿÿ/ 0
)
ÿÿ0 1
=
ÿÿ2 3
$num
ÿÿ4 5
Then
ÿÿ6 :!
lbl_ValidaPrestamo1
ŸŸ #
.
ŸŸ# $
	ForeColor
ŸŸ$ -
=
ŸŸ. /
System
ŸŸ0 6
.
ŸŸ6 7
Drawing
ŸŸ7 >
.
ŸŸ> ?
Color
ŸŸ? D
.
ŸŸD E
Red
ŸŸE H!
lbl_ValidaPrestamo1
⁄⁄ #
.
⁄⁄# $
Text
⁄⁄$ (
=
⁄⁄) *
$str
⁄⁄+ J 
txt_ValorPrestamo1
€€ "
.
€€" #
Text
€€# '
=
€€( )
$str
€€* , 
txt_ValorPrestamo1
‹‹ "
.
‹‹" #
Focus
‹‹# (
(
‹‹( )
)
‹‹) *
Exit
›› 
Sub
›› 
End
ﬁﬁ 
If
ﬁﬁ 
Dim
‡‡ 
Valor
‡‡ 
As
‡‡ 
String
‡‡ 
=
‡‡  ! 
txt_ValorPrestamo1
‡‡" 4
.
‡‡4 5
Text
‡‡5 9
.
‡‡9 :
Trim
‡‡: >
Dim
·· 
vBandera
·· 
As
·· 
String
·· "
vBandera
‚‚ 
=
‚‚ 
$str
‚‚ 
Dim
ÂÂ #
ds_Consulta_Reporte01
ÂÂ %
As
ÂÂ& (
DataSet
ÂÂ) 0
=
ÂÂ1 2
cls_Metodos
ÂÂ3 >
.
ÂÂ> ?
BuscarPestamo
ÂÂ? L
(
ÂÂL M
Valor
ÂÂM R
,
ÂÂR S
vBandera
ÂÂT \
)
ÂÂ\ ]
Dim
ÁÁ 

countLista
ÁÁ 
=
ÁÁ #
ds_Consulta_Reporte01
ÁÁ 2
.
ÁÁ2 3
Tables
ÁÁ3 9
(
ÁÁ9 :
$num
ÁÁ: ;
)
ÁÁ; <
.
ÁÁ< =
Rows
ÁÁ= A
.
ÁÁA B
Count
ÁÁB G
If
ËË 
(
ËË 

countLista
ËË 
=
ËË 
$num
ËË 
)
ËË 
Then
ËË  $!
lbl_ValidaPrestamo1
ÈÈ #
.
ÈÈ# $
	ForeColor
ÈÈ$ -
=
ÈÈ. /
System
ÈÈ0 6
.
ÈÈ6 7
Drawing
ÈÈ7 >
.
ÈÈ> ?
Color
ÈÈ? D
.
ÈÈD E
Green
ÈÈE J!
lbl_ValidaPrestamo1
ÍÍ #
.
ÍÍ# $
Text
ÍÍ$ (
=
ÍÍ) *
$str
ÍÍ+ ;
&
ÍÍ< =

countLista
ÍÍ> H!
lbl_ValidaPrestamo1
ÎÎ #
.
ÎÎ# $
Focus
ÎÎ$ )
(
ÎÎ) *
)
ÎÎ* +#
btn_VerFichaPrestamo1
ÏÏ %
.
ÏÏ% &
Enabled
ÏÏ& -
=
ÏÏ. /
False
ÏÏ0 5
rb_FormatContrato
ÌÌ !
.
ÌÌ! "
Enabled
ÌÌ" )
=
ÌÌ* +
False
ÌÌ, 1
Else
ÓÓ !
lbl_ValidaPrestamo1
ÔÔ #
.
ÔÔ# $
Visible
ÔÔ$ +
=
ÔÔ, -
True
ÔÔ. 2!
lbl_ValidaPrestamo1
 #
.
# $
	ForeColor
$ -
=
. /
System
0 6
.
6 7
Drawing
7 >
.
> ?
Color
? D
.
D E
Green
E J!
lbl_ValidaPrestamo1
ÒÒ #
.
ÒÒ# $
Text
ÒÒ$ (
=
ÒÒ) *
$str
ÒÒ+ ;
&
ÒÒ< =

countLista
ÒÒ> H#
btn_VerFichaPrestamo1
ÛÛ %
.
ÛÛ% &
Enabled
ÛÛ& -
=
ÛÛ. /
True
ÛÛ0 4
rb_FormatContrato
ÙÙ !
.
ÙÙ! "
Enabled
ÙÙ" )
=
ÙÙ* +
False
ÙÙ, 1
End
ıı 
If
ıı 
Catch
ˆˆ 
ex
ˆˆ 
As
ˆˆ 
	Exception
ˆˆ !
lbl_ValidaPrestamo1
˜˜ 
.
˜˜  
Text
˜˜  $
=
˜˜% &
ex
˜˜' )
.
˜˜) *
Message
˜˜* 1!
lbl_ValidaPrestamo1
¯¯ 
.
¯¯  
	ForeColor
¯¯  )
=
¯¯* +
System
¯¯, 2
.
¯¯2 3
Drawing
¯¯3 :
.
¯¯: ;
Color
¯¯; @
.
¯¯@ A
Red
¯¯A D
End
˘˘ 
Try
˘˘ 
End
˙˙ 
Sub
˙˙ 
Private
˚˚ 
Sub
˚˚ -
btn_CalcularListaPrestamo_Click
˚˚ /
(
˚˚/ 0
sender
˚˚0 6
As
˚˚7 9
Object
˚˚: @
,
˚˚@ A
e
˚˚B C
As
˚˚D F
	EventArgs
˚˚G P
)
˚˚P Q
Handles
˚˚R Y'
btn_CalcularListaPrestamo
˚˚Z s
.
˚˚s t
Click
˚˚t y
Try
¸¸ 
Dim
˛˛ 
v_cFechaDesde
˛˛ 
,
˛˛ 
v_cFechaHasta
˛˛ ,
As
˛˛- /
Date
˛˛0 4
Dim
ˇˇ 
v_cTipoFecha
ˇˇ 
,
ˇˇ 
v_Bandera_Tipo
ˇˇ ,
As
ˇˇ- /
String
ˇˇ0 6
v_cTipoFecha
ÅÅ 
=
ÅÅ 
$str
ÅÅ &
v_cFechaDesde
ÇÇ 
=
ÇÇ $
txt_FechaDesdePrestamo
ÇÇ 2
.
ÇÇ2 3
Text
ÇÇ3 7
v_cFechaHasta
ÉÉ 
=
ÉÉ $
txt_FechaHastaPrestamo
ÉÉ 2
.
ÉÉ2 3
Text
ÉÉ3 7
v_Bandera_Tipo
ÑÑ 
=
ÑÑ !
cbox_EstadoPrestamo
ÑÑ 0
.
ÑÑ0 1
SelectedValue
ÑÑ1 >
If
áá 
Not
áá 
IsDate
áá 
(
áá 
v_cFechaDesde
áá '
)
áá' (
Then
áá) -!
lbl_ValidaPrestamo2
àà #
.
àà# $
	ForeColor
àà$ -
=
àà. /
System
àà0 6
.
àà6 7
Drawing
àà7 >
.
àà> ?
Color
àà? D
.
ààD E
Red
ààE H!
lbl_ValidaPrestamo2
ââ #
.
ââ# $
Text
ââ$ (
=
ââ) *
$str
ââ+ C
Exit
ää 
Sub
ää 
End
ãã 
If
ãã 
If
çç 
Not
çç 
IsDate
çç 
(
çç 
v_cFechaHasta
çç '
)
çç' (
Then
çç) -!
lbl_ValidaPrestamo2
éé #
.
éé# $
	ForeColor
éé$ -
=
éé. /
System
éé0 6
.
éé6 7
Drawing
éé7 >
.
éé> ?
Color
éé? D
.
ééD E
Red
ééE H!
lbl_ValidaPrestamo2
èè #
.
èè# $
Text
èè$ (
=
èè) *
$str
èè+ C
Exit
êê 
Sub
êê 
End
ëë 
If
ëë 
If
ìì 
Len
ìì 
(
ìì $
txt_FechaDesdePrestamo
ìì )
.
ìì) *
Text
ìì* .
)
ìì. /
=
ìì0 1
$num
ìì2 3
Or
ìì4 6
Len
ìì7 :
(
ìì: ;$
txt_FechaHastaPrestamo
ìì; Q
.
ììQ R
Text
ììR V
)
ììV W
=
ììX Y
$num
ììZ [
Then
ìì\ `!
lbl_ValidaPrestamo2
îî #
.
îî# $
	ForeColor
îî$ -
=
îî. /
System
îî0 6
.
îî6 7
Drawing
îî7 >
.
îî> ?
Color
îî? D
.
îîD E
Red
îîE H!
lbl_ValidaPrestamo2
ïï #
.
ïï# $
Text
ïï$ (
=
ïï) *
$str
ïï+ x
Exit
ññ 
Sub
ññ 
ElseIf
óó 
(
óó 
DateTime
óó 
.
óó 
Compare
óó $
(
óó$ %$
txt_FechaDesdePrestamo
óó% ;
.
óó; <
Text
óó< @
,
óó@ A$
txt_FechaHastaPrestamo
óóB X
.
óóX Y
Text
óóY ]
)
óó] ^
>
óó_ `
$num
óóa b
)
óób c
Then
óód h!
lbl_ValidaPrestamo2
òò #
.
òò# $
	ForeColor
òò$ -
=
òò. /
System
òò0 6
.
òò6 7
Drawing
òò7 >
.
òò> ?
Color
òò? D
.
òòD E
Red
òòE H!
lbl_ValidaPrestamo2
ôô #
.
ôô# $
Text
ôô$ (
=
ôô) *
$str
ôô+ a
Exit
öö 
Sub
öö 
Else
õõ 
End
ùù 
If
ùù 
Dim
†† #
ds_Consulta_Reporte01
†† %
As
††& (
DataSet
††) 0
=
††1 2
cls_Metodos
††3 >
.
††> ?&
ConsultaRptPrestamoLista
††? W
(
††W X
v_cTipoFecha
††X d
,
††d e
v_cFechaDesde
††f s
,
††s t
v_cFechaHasta††u Ç
,††Ç É
v_Bandera_Tipo††Ñ í
)††í ì
Dim
°° 

countLista
°° 
=
°° #
ds_Consulta_Reporte01
°° 2
.
°°2 3
Tables
°°3 9
(
°°9 :
$num
°°: ;
)
°°; <
.
°°< =
Rows
°°= A
.
°°A B
Count
°°B G
If
££ 
(
££ 

countLista
££ 
=
££ 
$num
££ 
)
££ 
Then
££  $!
lbl_ValidaPrestamo2
§§ #
.
§§# $
	ForeColor
§§$ -
=
§§. /
System
§§0 6
.
§§6 7
Drawing
§§7 >
.
§§> ?
Color
§§? D
.
§§D E
Green
§§E J!
lbl_ValidaPrestamo2
•• #
.
••# $
Text
••$ (
=
••) *
$str
••+ ;
&
••< =

countLista
••> H!
lbl_ValidaPrestamo2
¶¶ #
.
¶¶# $
Focus
¶¶$ )
(
¶¶) *
)
¶¶* +#
btn_verFichaPrestamo2
ßß %
.
ßß% &
Enabled
ßß& -
=
ßß. /
False
ßß0 5
Else
®® !
lbl_ValidaPrestamo2
©© #
.
©©# $
Visible
©©$ +
=
©©, -
True
©©. 2!
lbl_ValidaPrestamo2
™™ #
.
™™# $
	ForeColor
™™$ -
=
™™. /
System
™™0 6
.
™™6 7
Drawing
™™7 >
.
™™> ?
Color
™™? D
.
™™D E
Green
™™E J!
lbl_ValidaPrestamo2
´´ #
.
´´# $
Text
´´$ (
=
´´) *
$str
´´+ ;
&
´´< =

countLista
´´> H#
btn_verFichaPrestamo2
¨¨ %
.
¨¨% &
Enabled
¨¨& -
=
¨¨. /
True
¨¨0 4
End
≠≠ 
If
≠≠ 
Catch
ÆÆ 
ex
ÆÆ 
As
ÆÆ 
	Exception
ÆÆ !
lbl_ValidaPrestamo2
ØØ 
.
ØØ  
Text
ØØ  $
=
ØØ% &
ex
ØØ' )
.
ØØ) *
Message
ØØ* 1!
lbl_ValidaPrestamo2
∞∞ 
.
∞∞  
	ForeColor
∞∞  )
=
∞∞* +
System
∞∞, 2
.
∞∞2 3
Drawing
∞∞3 :
.
∞∞: ;
Color
∞∞; @
.
∞∞@ A
Red
∞∞A D
End
±± 
Try
±± 
End
≤≤ 
Sub
≤≤ 
Private
¥¥ 
Sub
¥¥ ,
btn_CalcularListaBusqWeb_Click
¥¥ .
(
¥¥. /
sender
¥¥/ 5
As
¥¥6 8
Object
¥¥9 ?
,
¥¥? @
e
¥¥A B
As
¥¥C E
	EventArgs
¥¥F O
)
¥¥O P
Handles
¥¥Q X&
btn_CalcularListaBusqWeb
¥¥Y q
.
¥¥q r
Click
¥¥r w
Try
µµ 
Dim
∑∑ #
ds_Consulta_Reporte01
∑∑ %
As
∑∑& (
DataSet
∑∑) 0
=
∑∑1 2
cls_Metodos
∑∑3 >
.
∑∑> ?(
ConsultaRptHccListaBusqWeb
∑∑? Y
(
∑∑Y Z
)
∑∑Z [
Dim
∏∏ 

countLista
∏∏ 
=
∏∏ #
ds_Consulta_Reporte01
∏∏ 2
.
∏∏2 3
Tables
∏∏3 9
(
∏∏9 :
$num
∏∏: ;
)
∏∏; <
.
∏∏< =
Rows
∏∏= A
.
∏∏A B
Count
∏∏B G
If
∫∫ 
(
∫∫ 

countLista
∫∫ 
=
∫∫ 
$num
∫∫ 
)
∫∫ 
Then
∫∫  $
lbl_ValidaBusqWeb
ªª !
.
ªª! "
	ForeColor
ªª" +
=
ªª, -
System
ªª. 4
.
ªª4 5
Drawing
ªª5 <
.
ªª< =
Color
ªª= B
.
ªªB C
Green
ªªC H
lbl_ValidaBusqWeb
ºº !
.
ºº! "
Text
ºº" &
=
ºº' (
$str
ºº) 9
&
ºº: ;

countLista
ºº< F
lbl_ValidaBusqWeb
ΩΩ !
.
ΩΩ! "
Focus
ΩΩ" '
(
ΩΩ' (
)
ΩΩ( )!
btn_verFichaBusqWeb
ææ #
.
ææ# $
Enabled
ææ$ +
=
ææ, -
False
ææ. 3
Else
øø 
lbl_ValidaBusqWeb
¿¿ !
.
¿¿! "
Visible
¿¿" )
=
¿¿* +
True
¿¿, 0
lbl_ValidaBusqWeb
¡¡ !
.
¡¡! "
	ForeColor
¡¡" +
=
¡¡, -
System
¡¡. 4
.
¡¡4 5
Drawing
¡¡5 <
.
¡¡< =
Color
¡¡= B
.
¡¡B C
Green
¡¡C H
lbl_ValidaBusqWeb
¬¬ !
.
¬¬! "
Text
¬¬" &
=
¬¬' (
$str
¬¬) 9
&
¬¬: ;

countLista
¬¬< F!
btn_verFichaBusqWeb
√√ #
.
√√# $
Enabled
√√$ +
=
√√, -
True
√√. 2
End
ƒƒ 
If
ƒƒ 
Catch
≈≈ 
ex
≈≈ 
As
≈≈ 
	Exception
≈≈ 
lbl_ValidaBusqWeb
∆∆ 
.
∆∆ 
Text
∆∆ "
=
∆∆# $
ex
∆∆% '
.
∆∆' (
Message
∆∆( /
lbl_ValidaBusqWeb
«« 
.
«« 
	ForeColor
«« '
=
««( )
System
««* 0
.
««0 1
Drawing
««1 8
.
««8 9
Color
««9 >
.
««> ?
Red
««? B
End
»» 
Try
»» 
End
…… 
Sub
…… 
Private
ÀÀ 
Sub
ÀÀ &
btn_verFichaLibro1_Click
ÀÀ (
(
ÀÀ( )
sender
ÀÀ) /
As
ÀÀ0 2
Object
ÀÀ3 9
,
ÀÀ9 :
e
ÀÀ; <
As
ÀÀ= ?
	EventArgs
ÀÀ@ I
)
ÀÀI J
Handles
ÀÀK R 
btn_verFichaLibro1
ÀÀS e
.
ÀÀe f
Click
ÀÀf k
Try
ÃÃ 
Dim
ÕÕ 
v_FormatoReporte
ÕÕ  
As
ÕÕ! #
String
ÕÕ$ *
=
ÕÕ+ ,
rdb_Libro1Formato
ÕÕ- >
.
ÕÕ> ?
SelectedItem
ÕÕ? K
.
ÕÕK L
Value
ÕÕL Q$
Exportar_Reporte_Libro
ŒŒ "
(
ŒŒ" #
v_FormatoReporte
ŒŒ# 3
,
ŒŒ3 4
$str
ŒŒ5 K
)
ŒŒK L
Catch
œœ 
ex
œœ 
As
œœ 
	Exception
œœ 
lbl_validaLibro1
–– 
.
–– 
Text
–– !
=
––" #
ex
––$ &
.
––& '
Message
––' .
lbl_validaLibro1
—— 
.
—— 
	ForeColor
—— &
=
——' (
System
——) /
.
——/ 0
Drawing
——0 7
.
——7 8
Color
——8 =
.
——= >
Red
——> A
End
““ 
Try
““ 
End
”” 
Sub
”” 
Private
’’ 
Sub
’’ )
btn_verHistorialLibro_Click
’’ +
(
’’+ ,
sender
’’, 2
As
’’3 5
Object
’’6 <
,
’’< =
e
’’> ?
As
’’@ B
	EventArgs
’’C L
)
’’L M
Handles
’’N U#
btn_verHistorialLibro
’’V k
.
’’k l
Click
’’l q
Try
÷÷ 
Dim
◊◊ 
v_FormatoReporte
◊◊  
As
◊◊! #
String
◊◊$ *
=
◊◊+ ,
rdb_Libro1Formato
◊◊- >
.
◊◊> ?
SelectedItem
◊◊? K
.
◊◊K L
Value
◊◊L Q-
Exportar_Reporte_LibroHistorial
ÿÿ +
(
ÿÿ+ ,
v_FormatoReporte
ÿÿ, <
,
ÿÿ< =
$str
ÿÿ> Z
)
ÿÿZ [
Catch
ŸŸ 
ex
ŸŸ 
As
ŸŸ 
	Exception
ŸŸ 
lbl_validaLibro1
⁄⁄ 
.
⁄⁄ 
Text
⁄⁄ !
=
⁄⁄" #
ex
⁄⁄$ &
.
⁄⁄& '
Message
⁄⁄' .
lbl_validaLibro1
€€ 
.
€€ 
	ForeColor
€€ &
=
€€' (
System
€€) /
.
€€/ 0
Drawing
€€0 7
.
€€7 8
Color
€€8 =
.
€€= >
Red
€€> A
End
‹‹ 
Try
‹‹ 
End
›› 
Sub
›› 
Private
ﬂﬂ 
Sub
ﬂﬂ &
btn_verFichaLibro2_Click
ﬂﬂ (
(
ﬂﬂ( )
sender
ﬂﬂ) /
As
ﬂﬂ0 2
Object
ﬂﬂ3 9
,
ﬂﬂ9 :
e
ﬂﬂ; <
As
ﬂﬂ= ?
	EventArgs
ﬂﬂ@ I
)
ﬂﬂI J
Handles
ﬂﬂK R 
btn_verFichaLibro2
ﬂﬂS e
.
ﬂﬂe f
Click
ﬂﬂf k
Try
‡‡ 
Dim
·· 
v_TipoReporte
·· 
As
··  
String
··! '
=
··( )!
cbox_TipoListaLibro
··* =
.
··= >
SelectedItem
··> J
.
··J K
Value
··K P
Dim
‚‚ 
v_FormatoReporte
‚‚  
As
‚‚! #
String
‚‚$ *
=
‚‚+ ,$
cbox_FormatoListaLibro
‚‚- C
.
‚‚C D
SelectedItem
‚‚D P
.
‚‚P Q
Value
‚‚Q V)
Exportar_Reporte_ListaLibro
„„ '
(
„„' (
v_FormatoReporte
„„( 8
,
„„8 9
v_TipoReporte
„„: G
)
„„G H
Catch
‰‰ 
ex
‰‰ 
As
‰‰ 
	Exception
‰‰ 
lbl_ValidaLibro2
ÂÂ 
.
ÂÂ 
Text
ÂÂ !
=
ÂÂ" #
ex
ÂÂ$ &
.
ÂÂ& '
Message
ÂÂ' .
lbl_ValidaLibro2
ÊÊ 
.
ÊÊ 
	ForeColor
ÊÊ &
=
ÊÊ' (
System
ÊÊ) /
.
ÊÊ/ 0
Drawing
ÊÊ0 7
.
ÊÊ7 8
Color
ÊÊ8 =
.
ÊÊ= >
Red
ÊÊ> A
End
ÁÁ 
Try
ÁÁ 
End
ËË 
Sub
ËË 
Private
ÈÈ 
Sub
ÈÈ )
btn_VerFichaPrestamo1_Click
ÈÈ +
(
ÈÈ+ ,
sender
ÈÈ, 2
As
ÈÈ3 5
Object
ÈÈ6 <
,
ÈÈ< =
e
ÈÈ> ?
As
ÈÈ@ B
	EventArgs
ÈÈC L
)
ÈÈL M
Handles
ÈÈN U#
btn_VerFichaPrestamo1
ÈÈV k
.
ÈÈk l
Click
ÈÈl q
Try
ÍÍ 
Dim
ÎÎ 
v_FormatoReporte
ÎÎ  
As
ÎÎ! #
String
ÎÎ$ *
=
ÎÎ+ ,
rb_FormatContrato
ÎÎ- >
.
ÎÎ> ?
SelectedItem
ÎÎ? K
.
ÎÎK L
Value
ÎÎL Q'
Exportar_Reporte_Prestamo
ÏÏ %
(
ÏÏ% &
v_FormatoReporte
ÏÏ& 6
,
ÏÏ6 7
$str
ÏÏ8 J
)
ÏÏJ K
Catch
ÌÌ 
ex
ÌÌ 
As
ÌÌ 
	Exception
ÌÌ !
lbl_ValidaPrestamo1
ÓÓ 
.
ÓÓ  
Text
ÓÓ  $
=
ÓÓ% &
ex
ÓÓ' )
.
ÓÓ) *
Message
ÓÓ* 1!
lbl_ValidaPrestamo1
ÔÔ 
.
ÔÔ  
	ForeColor
ÔÔ  )
=
ÔÔ* +
System
ÔÔ, 2
.
ÔÔ2 3
Drawing
ÔÔ3 :
.
ÔÔ: ;
Color
ÔÔ; @
.
ÔÔ@ A
Red
ÔÔA D
End
 
Try
 
End
ÒÒ 
Sub
ÒÒ 
Private
ÛÛ 
Sub
ÛÛ )
btn_verFichaPrestamo2_Click
ÛÛ +
(
ÛÛ+ ,
sender
ÛÛ, 2
As
ÛÛ3 5
Object
ÛÛ6 <
,
ÛÛ< =
e
ÛÛ> ?
As
ÛÛ@ B
	EventArgs
ÛÛC L
)
ÛÛL M
Handles
ÛÛN U#
btn_verFichaPrestamo2
ÛÛV k
.
ÛÛk l
Click
ÛÛl q
Try
ÙÙ 
Dim
ıı 
v_TipoReporte
ıı 
As
ıı  
String
ıı! '
=
ıı( )$
cbox_TipoListaPrestamo
ıı* @
.
ıı@ A
SelectedItem
ııA M
.
ııM N
Value
ııN S
Dim
ˆˆ 
v_FormatoReporte
ˆˆ  
As
ˆˆ! #
String
ˆˆ$ *
=
ˆˆ+ ,'
cbox_FormatoListaPrestamo
ˆˆ- F
.
ˆˆF G
SelectedItem
ˆˆG S
.
ˆˆS T
Value
ˆˆT Y,
Exportar_Reporte_ListaPrestamo
˜˜ *
(
˜˜* +
v_FormatoReporte
˜˜+ ;
,
˜˜; <
v_TipoReporte
˜˜= J
)
˜˜J K
Catch
¯¯ 
ex
¯¯ 
As
¯¯ 
	Exception
¯¯ 
End
˙˙ 
Try
˙˙ 
End
˚˚ 
Sub
˚˚ 
Private
˝˝ 
Sub
˝˝ '
btn_verFichaBusqWeb_Click
˝˝ )
(
˝˝) *
sender
˝˝* 0
As
˝˝1 3
Object
˝˝4 :
,
˝˝: ;
e
˝˝< =
As
˝˝> @
	EventArgs
˝˝A J
)
˝˝J K
Handles
˝˝L S!
btn_verFichaBusqWeb
˝˝T g
.
˝˝g h
Click
˝˝h m
Try
˛˛ 
Dim
ˇˇ 
v_TipoReporte
ˇˇ 
As
ˇˇ  
String
ˇˇ! '
=
ˇˇ( )
cbox_BusqWebTipo
ˇˇ* :
.
ˇˇ: ;
SelectedItem
ˇˇ; G
.
ˇˇG H
Value
ˇˇH M
Dim
ÄÄ 
v_FormatoReporte
ÄÄ  
As
ÄÄ! #
String
ÄÄ$ *
=
ÄÄ+ ,!
cbox_BusqWebFormato
ÄÄ- @
.
ÄÄ@ A
SelectedItem
ÄÄA M
.
ÄÄM N
Value
ÄÄN S+
Exportar_Reporte_ListaBusqWeb
ÅÅ )
(
ÅÅ) *
v_FormatoReporte
ÅÅ* :
,
ÅÅ: ;
v_TipoReporte
ÅÅ< I
)
ÅÅI J
Catch
ÇÇ 
ex
ÇÇ 
As
ÇÇ 
	Exception
ÇÇ 
End
ÑÑ 
Try
ÑÑ 
End
ÖÖ 
Sub
ÖÖ 
Private
áá 
Sub
áá %
btn_VerInventario_Click
áá '
(
áá' (
sender
áá( .
As
áá/ 1
Object
áá2 8
,
áá8 9
e
áá: ;
As
áá< >
	EventArgs
áá? H
)
ááH I
Handles
ááJ Q
btn_VerInventario
ááR c
.
áác d
Click
áád i
Try
àà 
img_load
ââ 
.
ââ 
Visible
ââ 
=
ââ 
True
ââ #
Dim
ää 
v_TipoReporte
ää 
As
ää  
String
ää! '
=
ää( )$
cbox_FormatoListaLibro
ää* @
.
ää@ A
SelectedItem
ääA M
.
ääM N
Value
ääN S.
 Exportar_Reporte_InventarioLibro
ãã ,
(
ãã, -
v_TipoReporte
ãã- :
)
ãã: ;
Catch
åå 
ex
åå 
As
åå 
	Exception
åå 
End
éé 
Try
éé 
End
èè 
Sub
èè 
Private
ëë 
Sub
ëë $
Exportar_Reporte_Libro
ëë &
(
ëë& '
ByVal
ëë' ,
FormatoReporte
ëë- ;
As
ëë< >
String
ëë? E
,
ëëE F
ByVal
ëëG L
v_TipoReporte
ëëM Z
As
ëë[ ]
String
ëë^ d
)
ëëd e
Dim
ìì 
vLibro
ìì 
As
ìì 
String
ìì 
Dim
îî 
vBandera
îî 
As
îî 
String
îî 
vLibro
ññ 
=
ññ 
txt_valorLibro1
ññ  
.
ññ  !
Text
ññ! %
.
ññ% &
Trim
ññ& *
vBandera
óó 
=
óó 
$str
óó 
If
öö 

v_TipoReporte
öö 
=
öö 
$str
öö 1
Then
öö2 6
v_TipoReporte
õõ 
=
õõ 
$str
õõ 2
ElseIf
úú 
v_TipoReporte
úú 
=
úú 
$str
úú <
Then
úú= A
v_TipoReporte
ùù 
=
ùù 
$str
ùù 9
Else
ûû 
lbl_validaLibro1
üü 
.
üü 
	ForeColor
üü &
=
üü' (
System
üü) /
.
üü/ 0
Drawing
üü0 7
.
üü7 8
Color
üü8 =
.
üü= >
Red
üü> A
lbl_validaLibro1
†† 
.
†† 
Text
†† !
=
††" #
$str
††$ R
Exit
°° 
Sub
°° 
End
¢¢ 
If
¢¢ 
Dim
•• #
ds_Consulta_Reporte01
•• !
As
••" $
DataSet
••% ,
=
••- .
cls_Metodos
••/ :
.
••: ;
BuscarLibro
••; F
(
••F G
vLibro
••G M
,
••M N
vBandera
••O W
)
••W X
Dim
®® 
dtsFichaDetalle
®® 
As
®® 
New
®® "
dtsFichaDetalle
®®# 2
(
®®2 3
)
®®3 4
For
™™ 
Each
™™ #
dr_Consulta_Reporte01
™™ &
As
™™' )
DataRow
™™* 1
In
™™2 4#
ds_Consulta_Reporte01
™™5 J
.
™™J K
Tables
™™K Q
(
™™Q R
$num
™™R S
)
™™S T
.
™™T U
Rows
™™U Y
dtsFichaDetalle
´´ 
.
´´ 
Tables
´´ "
(
´´" #
$num
´´# $
)
´´$ %
.
´´% &
Rows
´´& *
.
´´* +
Add
´´+ .
(
´´. /#
dr_Consulta_Reporte01
´´/ D
.
´´D E
	ItemArray
´´E N
)
´´N O
Next
¨¨ 

rv_General
ÆÆ 
.
ÆÆ 
ProcessingMode
ÆÆ !
=
ÆÆ" #
ProcessingMode
ÆÆ$ 2
.
ÆÆ2 3
Local
ÆÆ3 8

rv_General
ØØ 
.
ØØ 
LocalReport
ØØ 
.
ØØ 

ReportPath
ØØ )
=
ØØ* +
Server
ØØ, 2
.
ØØ2 3
MapPath
ØØ3 :
(
ØØ: ;
$str
ØØ; H
&
ØØI J
v_TipoReporte
ØØK X
&
ØØY Z
$str
ØØ[ b
)
ØØb c
Dim
±± 
Movimiento_Rpt
±± 
As
±± 
New
±± !
ReportDataSource
±±" 2
(
±±2 3
$str
±±3 K
,
±±K L
dtsFichaDetalle
±±M \
.
±±\ ]
Tables
±±] c
(
±±c d
$num
±±d e
)
±±e f
)
±±f g

rv_General
≤≤ 
.
≤≤ 
LocalReport
≤≤ 
.
≤≤ 
DataSources
≤≤ *
.
≤≤* +
Clear
≤≤+ 0
(
≤≤0 1
)
≤≤1 2

rv_General
≥≥ 
.
≥≥ 
LocalReport
≥≥ 
.
≥≥ 
DataSources
≥≥ *
.
≥≥* +
Add
≥≥+ .
(
≥≥. /
Movimiento_Rpt
≥≥/ =
)
≥≥= >
Dim
∂∂ 
warnings
∂∂ 
As
∂∂ 
Warning
∂∂ 
(
∂∂  
)
∂∂  !
=
∂∂" #
Nothing
∂∂$ +
Dim
∑∑ 
	streamids
∑∑ 
As
∑∑ 
String
∑∑ 
(
∑∑  
)
∑∑  !
=
∑∑" #
Nothing
∑∑$ +
Dim
∏∏ 
mimeType
∏∏ 
As
∏∏ 
String
∏∏ 
=
∏∏  
Nothing
∏∏! (
Dim
ππ 
contentType
ππ 
As
ππ 
String
ππ !
=
ππ" #
Nothing
ππ$ +
Dim
∫∫ 
encoding
∫∫ 
As
∫∫ 
String
∫∫ 
=
∫∫  
Nothing
∫∫! (
Dim
ªª 
	extension
ªª 
As
ªª 
String
ªª 
=
ªª  !
Nothing
ªª" )
Dim
ææ 
bytes
ææ 
As
ææ 
Byte
ææ 
(
ææ 
)
ææ 
=
ææ 

rv_General
ææ (
.
ææ( )
LocalReport
ææ) 4
.
ææ4 5
Render
ææ5 ;
(
ææ; <
FormatoReporte
ææ< J
,
ææJ K
Nothing
ææL S
,
ææS T
mimeType
ææU ]
,
ææ] ^
contentType
ææ_ j
,
ææj k
encoding
ææl t
,
ææt u
	extension
ææv 
,ææ Ä
	streamidsææÅ ä
,ææä ã
warningsææå î
)ææî ï
Response
¡¡ 
.
¡¡ 
Clear
¡¡ 
(
¡¡ 
)
¡¡ 
Response
¬¬ 
.
¬¬ 
Buffer
¬¬ 
=
¬¬ 
True
¬¬ 
Response
√√ 
.
√√ 
Charset
√√ 
=
√√ 
$str
√√ 
Response
ƒƒ 
.
ƒƒ 
Cache
ƒƒ 
.
ƒƒ 
SetCacheability
ƒƒ &
(
ƒƒ& '
HttpCacheability
ƒƒ' 7
.
ƒƒ7 8
NoCache
ƒƒ8 ?
)
ƒƒ? @
Response
≈≈ 
.
≈≈ 
ContentType
≈≈ 
=
≈≈ 
contentType
≈≈ *
Response
∆∆ 
.
∆∆ 
AppendHeader
∆∆ 
(
∆∆ 
$str
∆∆ 3
,
∆∆3 4
$str
∆∆5 L
&
∆∆M N
v_TipoReporte
∆∆O \
&
∆∆] ^
$str
∆∆_ b
&
∆∆c d
	extension
∆∆e n
)
∆∆n o
Response
«« 
.
«« 
BinaryWrite
«« 
(
«« 
bytes
«« "
)
««" #
Response
»» 
.
»» 
Flush
»» 
(
»» 
)
»» 
Response
…… 
.
…… 
End
…… 
(
…… 
)
…… 
End
   
Sub
   
Private
ÃÃ 
Sub
ÃÃ -
Exportar_Reporte_LibroHistorial
ÃÃ /
(
ÃÃ/ 0
ByVal
ÃÃ0 5
FormatoReporte
ÃÃ6 D
As
ÃÃE G
String
ÃÃH N
,
ÃÃN O
ByVal
ÃÃP U
v_TipoReporte
ÃÃV c
As
ÃÃd f
String
ÃÃg m
)
ÃÃm n
Dim
ŒŒ 
vLibro
ŒŒ 
As
ŒŒ 
String
ŒŒ 
Dim
œœ 
vBandera
œœ 
As
œœ 
String
œœ 
vLibro
—— 
=
—— 
txt_valorLibro1
——  
.
——  !
Text
——! %
.
——% &
Trim
——& *
vBandera
““ 
=
““ 
$str
““ 
If
’’ 

v_TipoReporte
’’ 
=
’’ 
$str
’’ 7
Then
’’8 <
v_TipoReporte
÷÷ 
=
÷÷ 
$str
÷÷ 8
ElseIf
◊◊ 
v_TipoReporte
◊◊ 
=
◊◊ 
$str
◊◊ <
Then
◊◊= A
v_TipoReporte
ÿÿ 
=
ÿÿ 
$str
ÿÿ 9
Else
ŸŸ 
lbl_validaLibro1
⁄⁄ 
.
⁄⁄ 
	ForeColor
⁄⁄ &
=
⁄⁄' (
System
⁄⁄) /
.
⁄⁄/ 0
Drawing
⁄⁄0 7
.
⁄⁄7 8
Color
⁄⁄8 =
.
⁄⁄= >
Red
⁄⁄> A
lbl_validaLibro1
€€ 
.
€€ 
Text
€€ !
=
€€" #
$str
€€$ R
Exit
‹‹ 
Sub
‹‹ 
End
›› 
If
›› 
Dim
‡‡ #
ds_Consulta_Reporte01
‡‡ !
As
‡‡" $
DataSet
‡‡% ,
=
‡‡- .
cls_Metodos
‡‡/ :
.
‡‡: ;
BuscarPestamo
‡‡; H
(
‡‡H I
vLibro
‡‡I O
,
‡‡O P
vBandera
‡‡Q Y
)
‡‡Y Z
Dim
„„ 
dtsFichaPrestamo
„„ 
As
„„ 
New
„„  #
dtsFichaPrestamo
„„$ 4
(
„„4 5
)
„„5 6
For
ÂÂ 
Each
ÂÂ #
dr_Consulta_Reporte01
ÂÂ &
As
ÂÂ' )
DataRow
ÂÂ* 1
In
ÂÂ2 4#
ds_Consulta_Reporte01
ÂÂ5 J
.
ÂÂJ K
Tables
ÂÂK Q
(
ÂÂQ R
$num
ÂÂR S
)
ÂÂS T
.
ÂÂT U
Rows
ÂÂU Y
dtsFichaPrestamo
ÊÊ 
.
ÊÊ 
Tables
ÊÊ #
(
ÊÊ# $
$num
ÊÊ$ %
)
ÊÊ% &
.
ÊÊ& '
Rows
ÊÊ' +
.
ÊÊ+ ,
Add
ÊÊ, /
(
ÊÊ/ 0#
dr_Consulta_Reporte01
ÊÊ0 E
.
ÊÊE F
	ItemArray
ÊÊF O
)
ÊÊO P
Next
ÁÁ 

rv_General
ÈÈ 
.
ÈÈ 
ProcessingMode
ÈÈ !
=
ÈÈ" #
ProcessingMode
ÈÈ$ 2
.
ÈÈ2 3
Local
ÈÈ3 8

rv_General
ÍÍ 
.
ÍÍ 
LocalReport
ÍÍ 
.
ÍÍ 

ReportPath
ÍÍ )
=
ÍÍ* +
Server
ÍÍ, 2
.
ÍÍ2 3
MapPath
ÍÍ3 :
(
ÍÍ: ;
$str
ÍÍ; H
&
ÍÍI J
v_TipoReporte
ÍÍK X
&
ÍÍY Z
$str
ÍÍ[ b
)
ÍÍb c
Dim
ÏÏ 
Movimiento_Rpt
ÏÏ 
As
ÏÏ 
New
ÏÏ !
ReportDataSource
ÏÏ" 2
(
ÏÏ2 3
$str
ÏÏ3 F
,
ÏÏF G
dtsFichaPrestamo
ÏÏH X
.
ÏÏX Y
Tables
ÏÏY _
(
ÏÏ_ `
$num
ÏÏ` a
)
ÏÏa b
)
ÏÏb c

rv_General
ÌÌ 
.
ÌÌ 
LocalReport
ÌÌ 
.
ÌÌ 
DataSources
ÌÌ *
.
ÌÌ* +
Clear
ÌÌ+ 0
(
ÌÌ0 1
)
ÌÌ1 2

rv_General
ÓÓ 
.
ÓÓ 
LocalReport
ÓÓ 
.
ÓÓ 
DataSources
ÓÓ *
.
ÓÓ* +
Add
ÓÓ+ .
(
ÓÓ. /
Movimiento_Rpt
ÓÓ/ =
)
ÓÓ= >
Dim
ÒÒ 
warnings
ÒÒ 
As
ÒÒ 
Warning
ÒÒ 
(
ÒÒ  
)
ÒÒ  !
=
ÒÒ" #
Nothing
ÒÒ$ +
Dim
ÚÚ 
	streamids
ÚÚ 
As
ÚÚ 
String
ÚÚ 
(
ÚÚ  
)
ÚÚ  !
=
ÚÚ" #
Nothing
ÚÚ$ +
Dim
ÛÛ 
mimeType
ÛÛ 
As
ÛÛ 
String
ÛÛ 
=
ÛÛ  
Nothing
ÛÛ! (
Dim
ÙÙ 
contentType
ÙÙ 
As
ÙÙ 
String
ÙÙ !
=
ÙÙ" #
Nothing
ÙÙ$ +
Dim
ıı 
encoding
ıı 
As
ıı 
String
ıı 
=
ıı  
Nothing
ıı! (
Dim
ˆˆ 
	extension
ˆˆ 
As
ˆˆ 
String
ˆˆ 
=
ˆˆ  !
Nothing
ˆˆ" )
Dim
˘˘ 
bytes
˘˘ 
As
˘˘ 
Byte
˘˘ 
(
˘˘ 
)
˘˘ 
=
˘˘ 

rv_General
˘˘ (
.
˘˘( )
LocalReport
˘˘) 4
.
˘˘4 5
Render
˘˘5 ;
(
˘˘; <
FormatoReporte
˘˘< J
,
˘˘J K
Nothing
˘˘L S
,
˘˘S T
mimeType
˘˘U ]
,
˘˘] ^
contentType
˘˘_ j
,
˘˘j k
encoding
˘˘l t
,
˘˘t u
	extension
˘˘v 
,˘˘ Ä
	streamids˘˘Å ä
,˘˘ä ã
warnings˘˘å î
)˘˘î ï
Response
¸¸ 
.
¸¸ 
Clear
¸¸ 
(
¸¸ 
)
¸¸ 
Response
˝˝ 
.
˝˝ 
Buffer
˝˝ 
=
˝˝ 
True
˝˝ 
Response
˛˛ 
.
˛˛ 
Charset
˛˛ 
=
˛˛ 
$str
˛˛ 
Response
ˇˇ 
.
ˇˇ 
Cache
ˇˇ 
.
ˇˇ 
SetCacheability
ˇˇ &
(
ˇˇ& '
HttpCacheability
ˇˇ' 7
.
ˇˇ7 8
NoCache
ˇˇ8 ?
)
ˇˇ? @
Response
ÄÄ 
.
ÄÄ 
ContentType
ÄÄ 
=
ÄÄ 
contentType
ÄÄ *
Response
ÅÅ 
.
ÅÅ 
AppendHeader
ÅÅ 
(
ÅÅ 
$str
ÅÅ 3
,
ÅÅ3 4
$str
ÅÅ5 L
&
ÅÅM N
v_TipoReporte
ÅÅO \
&
ÅÅ] ^
$str
ÅÅ_ b
&
ÅÅc d
	extension
ÅÅe n
)
ÅÅn o
Response
ÇÇ 
.
ÇÇ 
BinaryWrite
ÇÇ 
(
ÇÇ 
bytes
ÇÇ "
)
ÇÇ" #
Response
ÉÉ 
.
ÉÉ 
Flush
ÉÉ 
(
ÉÉ 
)
ÉÉ 
Response
ÑÑ 
.
ÑÑ 
End
ÑÑ 
(
ÑÑ 
)
ÑÑ 
End
ÖÖ 
Sub
ÖÖ 
Private
áá 
Sub
áá )
Exportar_Reporte_ListaLibro
áá +
(
áá+ ,
ByVal
áá, 1
FormatoReporte
áá2 @
As
ááA C
String
ááD J
,
ááJ K
ByVal
ááL Q
v_TipoReporte
ááR _
As
áá` b
String
áác i
)
áái j
Dim
ää 
v_cFechaDesde
ää 
,
ää 
v_cFechaHasta
ää (
As
ää) +
Date
ää, 0
Dim
ãã 
v_cTipoFecha
ãã 
,
ãã 
v_Bandera_Tipo
ãã (
As
ãã) +
String
ãã, 2
Dim
åå 
v_cAutor
åå 
v_cTipoFecha
éé 
=
éé 
$str
éé "
v_cFechaDesde
èè 
=
èè !
txt_FechaDesdeLibro
èè +
.
èè+ ,
Text
èè, 0
v_cFechaHasta
êê 
=
êê !
txt_FechaHastaLibro
êê +
.
êê+ ,
Text
êê, 0
v_Bandera_Tipo
ëë 
=
ëë 
$str
ëë 
v_cAutor
íí 
=
íí 
	txt_autor
íí 
.
íí 
Text
íí !
If
ïï 

Not
ïï 
IsDate
ïï 
(
ïï !
txt_FechaDesdeLibro
ïï )
.
ïï) *
Text
ïï* .
)
ïï. /
Then
ïï0 4
lbl_ValidaLibro2
ññ 
.
ññ 
	ForeColor
ññ &
=
ññ' (
System
ññ) /
.
ññ/ 0
Drawing
ññ0 7
.
ññ7 8
Color
ññ8 =
.
ññ= >
Red
ññ> A
lbl_ValidaLibro2
óó 
.
óó 
Text
óó !
=
óó" #
$str
óó$ <
Exit
òò 
Sub
òò 
End
ôô 
If
ôô 
If
õõ 

Not
õõ 
IsDate
õõ 
(
õõ !
txt_FechaHastaLibro
õõ )
.
õõ) *
Text
õõ* .
)
õõ. /
Then
õõ0 4
lbl_ValidaLibro2
úú 
.
úú 
	ForeColor
úú &
=
úú' (
System
úú) /
.
úú/ 0
Drawing
úú0 7
.
úú7 8
Color
úú8 =
.
úú= >
Red
úú> A
lbl_ValidaLibro2
ùù 
.
ùù 
Text
ùù !
=
ùù" #
$str
ùù$ <
Exit
ûû 
Sub
ûû 
End
üü 
If
üü 
If
°° 

Len
°° 
(
°° !
txt_FechaDesdeLibro
°° "
.
°°" #
Text
°°# '
)
°°' (
=
°°) *
$num
°°+ ,
Or
°°- /
Len
°°0 3
(
°°3 4!
txt_FechaHastaLibro
°°4 G
.
°°G H
Text
°°H L
)
°°L M
=
°°N O
$num
°°P Q
Then
°°R V
lbl_ValidaLibro2
¢¢ 
.
¢¢ 
	ForeColor
¢¢ &
=
¢¢' (
System
¢¢) /
.
¢¢/ 0
Drawing
¢¢0 7
.
¢¢7 8
Color
¢¢8 =
.
¢¢= >
Red
¢¢> A
lbl_ValidaLibro2
££ 
.
££ 
Text
££ !
=
££" #
$str
££$ q
Exit
§§ 
Sub
§§ 
ElseIf
•• 
(
•• 
DateTime
•• 
.
•• 
Compare
••  
(
••  !!
txt_FechaDesdeLibro
••! 4
.
••4 5
Text
••5 9
,
••9 :!
txt_FechaHastaLibro
••; N
.
••N O
Text
••O S
)
••S T
>
••U V
$num
••W X
)
••X Y
Then
••Z ^
lbl_ValidaLibro2
¶¶ 
.
¶¶ 
	ForeColor
¶¶ &
=
¶¶' (
System
¶¶) /
.
¶¶/ 0
Drawing
¶¶0 7
.
¶¶7 8
Color
¶¶8 =
.
¶¶= >
Red
¶¶> A
lbl_ValidaLibro2
ßß 
.
ßß 
Text
ßß !
=
ßß" #
$str
ßß$ Z
Exit
®® 
Sub
®® 
Else
©© 
lbl_ValidaLibro2
™™ 
.
™™ 
Text
™™ !
=
™™" #
$str
™™$ &
End
´´ 
If
´´ 
If
ÆÆ 

v_TipoReporte
ÆÆ 
=
ÆÆ 
$str
ÆÆ 3
Then
ÆÆ4 8
v_TipoReporte
ØØ 
=
ØØ 
$str
ØØ 4
ElseIf
∞∞ 
v_TipoReporte
∞∞ 
=
∞∞ 
$str
∞∞ B
Then
∞∞C G
v_TipoReporte
±± 
=
±± 
$str
±± ?
ElseIf
≤≤ 
v_TipoReporte
≤≤ 
=
≤≤ 
$str
≤≤ ,
Then
≤≤- 1
v_TipoReporte
≥≥ 
=
≥≥ 
$str
≥≥ .
ElseIf
¥¥ 
v_TipoReporte
¥¥ 
=
¥¥ 
$str
¥¥ ,
Then
¥¥- 1
v_TipoReporte
µµ 
=
µµ 
$str
µµ .
ElseIf
∂∂ 
v_TipoReporte
∂∂ 
=
∂∂ 
$str
∂∂ 6
Then
∂∂7 ;
v_TipoReporte
∑∑ 
=
∑∑ 
$str
∑∑ 3
Else
∏∏ 
Exit
ªª 
Sub
ªª 
End
ºº 
If
ºº 
Dim
øø #
ds_Consulta_Reporte01
øø !
As
øø" $
DataSet
øø% ,
=
øø- .
cls_Metodos
øø/ :
.
øø: ;#
ConsultaRptLibroLista
øø; P
(
øøP Q
v_cTipoFecha
øøQ ]
,
øø] ^
v_cFechaDesde
øø_ l
,
øøl m
v_cFechaHasta
øøn {
,
øø{ |
v_Bandera_Tipoøø} ã
,øøã å
v_cAutorøøç ï
)øøï ñ
Dim
¬¬ 
	dtsLibros
¬¬ 
As
¬¬ 
New
¬¬ 
	dtsLibros
¬¬ &
(
¬¬& '
)
¬¬' (
For
ƒƒ 
Each
ƒƒ #
dr_Consulta_Reporte01
ƒƒ &
As
ƒƒ' )
DataRow
ƒƒ* 1
In
ƒƒ2 4#
ds_Consulta_Reporte01
ƒƒ5 J
.
ƒƒJ K
Tables
ƒƒK Q
(
ƒƒQ R
$num
ƒƒR S
)
ƒƒS T
.
ƒƒT U
Rows
ƒƒU Y
	dtsLibros
≈≈ 
.
≈≈ 
Tables
≈≈ 
(
≈≈ 
$num
≈≈ 
)
≈≈ 
.
≈≈  
Rows
≈≈  $
.
≈≈$ %
Add
≈≈% (
(
≈≈( )#
dr_Consulta_Reporte01
≈≈) >
.
≈≈> ?
	ItemArray
≈≈? H
)
≈≈H I
Next
∆∆ 

rv_General
«« 
.
«« 
ProcessingMode
«« !
=
««" #
ProcessingMode
««$ 2
.
««2 3
Local
««3 8

rv_General
…… 
.
…… 
LocalReport
…… 
.
…… 

ReportPath
…… )
=
……* +
Server
……, 2
.
……2 3
MapPath
……3 :
(
……: ;
$str
……; H
&
……I J
v_TipoReporte
……K X
&
……Y Z
$str
……[ b
)
……b c
Dim
ÀÀ 

parameters
ÀÀ 
As
ÀÀ 
New
ÀÀ 
List
ÀÀ "
(
ÀÀ" #
Of
ÀÀ# %
ReportParameter
ÀÀ& 5
)
ÀÀ5 6
(
ÀÀ6 7
)
ÀÀ7 8

parameters
ÃÃ 
.
ÃÃ 
Add
ÃÃ 
(
ÃÃ 
New
ÃÃ 
ReportParameter
ÃÃ *
(
ÃÃ* +
$str
ÃÃ+ 8
,
ÃÃ8 9!
txt_FechaDesdeLibro
ÃÃ: M
.
ÃÃM N
Text
ÃÃN R
)
ÃÃR S
)
ÃÃS T

parameters
ÕÕ 
.
ÕÕ 
Add
ÕÕ 
(
ÕÕ 
New
ÕÕ 
ReportParameter
ÕÕ *
(
ÕÕ* +
$str
ÕÕ+ 8
,
ÕÕ8 9!
txt_FechaHastaLibro
ÕÕ: M
.
ÕÕM N
Text
ÕÕN R
)
ÕÕR S
)
ÕÕS T

rv_General
ŒŒ 
.
ŒŒ 
LocalReport
ŒŒ 
.
ŒŒ 
SetParameters
ŒŒ ,
(
ŒŒ, -

parameters
ŒŒ- 7
)
ŒŒ7 8
Dim
–– 
Movimiento_Rpt
–– 
As
–– 
New
–– !
ReportDataSource
––" 2
(
––2 3
$str
––3 D
,
––D E
	dtsLibros
––F O
.
––O P
Tables
––P V
(
––V W
$num
––W X
)
––X Y
)
––Y Z

rv_General
—— 
.
—— 
LocalReport
—— 
.
—— 
DataSources
—— *
.
——* +
Clear
——+ 0
(
——0 1
)
——1 2

rv_General
““ 
.
““ 
LocalReport
““ 
.
““ 
DataSources
““ *
.
““* +
Add
““+ .
(
““. /
Movimiento_Rpt
““/ =
)
““= >
Dim
’’ 
warnings
’’ 
As
’’ 
Warning
’’ 
(
’’  
)
’’  !
=
’’" #
Nothing
’’$ +
Dim
÷÷ 
	streamids
÷÷ 
As
÷÷ 
String
÷÷ 
(
÷÷  
)
÷÷  !
=
÷÷" #
Nothing
÷÷$ +
Dim
◊◊ 
mimeType
◊◊ 
As
◊◊ 
String
◊◊ 
=
◊◊  
Nothing
◊◊! (
Dim
ÿÿ 
contentType
ÿÿ 
As
ÿÿ 
String
ÿÿ !
=
ÿÿ" #
Nothing
ÿÿ$ +
Dim
ŸŸ 
encoding
ŸŸ 
As
ŸŸ 
String
ŸŸ 
=
ŸŸ  
Nothing
ŸŸ! (
Dim
⁄⁄ 
	extension
⁄⁄ 
As
⁄⁄ 
String
⁄⁄ 
=
⁄⁄  !
Nothing
⁄⁄" )
Dim
›› 
bytes
›› 
As
›› 
Byte
›› 
(
›› 
)
›› 
=
›› 

rv_General
›› (
.
››( )
LocalReport
››) 4
.
››4 5
Render
››5 ;
(
››; <
FormatoReporte
››< J
,
››J K
Nothing
››L S
,
››S T
mimeType
››U ]
,
››] ^
contentType
››_ j
,
››j k
encoding
››l t
,
››t u
	extension
››v 
,›› Ä
	streamids››Å ä
,››ä ã
warnings››å î
)››î ï
Response
‡‡ 
.
‡‡ 
Clear
‡‡ 
(
‡‡ 
)
‡‡ 
Response
·· 
.
·· 
Buffer
·· 
=
·· 
True
·· 
Response
‚‚ 
.
‚‚ 
Charset
‚‚ 
=
‚‚ 
$str
‚‚ 
Response
„„ 
.
„„ 
Cache
„„ 
.
„„ 
SetCacheability
„„ &
(
„„& '
HttpCacheability
„„' 7
.
„„7 8
NoCache
„„8 ?
)
„„? @
Response
‰‰ 
.
‰‰ 
ContentType
‰‰ 
=
‰‰ 
contentType
‰‰ *
Response
ÂÂ 
.
ÂÂ 
AppendHeader
ÂÂ 
(
ÂÂ 
$str
ÂÂ 3
,
ÂÂ3 4
$str
ÂÂ5 L
&
ÂÂM N
v_TipoReporte
ÂÂO \
&
ÂÂ] ^
$str
ÂÂ_ b
&
ÂÂc d
	extension
ÂÂe n
)
ÂÂn o
Response
ÊÊ 
.
ÊÊ 
BinaryWrite
ÊÊ 
(
ÊÊ 
bytes
ÊÊ "
)
ÊÊ" #
Response
ÁÁ 
.
ÁÁ 
Flush
ÁÁ 
(
ÁÁ 
)
ÁÁ 
Response
ËË 
.
ËË 
End
ËË 
(
ËË 
)
ËË 
End
ÈÈ 
Sub
ÈÈ 
Private
ÎÎ 
Sub
ÎÎ ,
Exportar_Reporte_ListaPrestamo
ÎÎ .
(
ÎÎ. /
ByVal
ÎÎ/ 4
FormatoReporte
ÎÎ5 C
As
ÎÎD F
String
ÎÎG M
,
ÎÎM N
ByVal
ÎÎO T
v_TipoReporte
ÎÎU b
As
ÎÎc e
String
ÎÎf l
)
ÎÎl m
Dim
ÓÓ 
v_cFechaDesde
ÓÓ 
,
ÓÓ 
v_cFechaHasta
ÓÓ (
As
ÓÓ) +
Date
ÓÓ, 0
Dim
ÔÔ 
v_cTipoFecha
ÔÔ 
,
ÔÔ 
v_Bandera_Tipo
ÔÔ (
As
ÔÔ) +
String
ÔÔ, 2
v_cTipoFecha
ÒÒ 
=
ÒÒ 
$str
ÒÒ "
v_cFechaDesde
ÚÚ 
=
ÚÚ $
txt_FechaDesdePrestamo
ÚÚ .
.
ÚÚ. /
Text
ÚÚ/ 3
v_cFechaHasta
ÛÛ 
=
ÛÛ $
txt_FechaHastaPrestamo
ÛÛ .
.
ÛÛ. /
Text
ÛÛ/ 3
v_Bandera_Tipo
ÙÙ 
=
ÙÙ !
cbox_EstadoPrestamo
ÙÙ ,
.
ÙÙ, -
SelectedValue
ÙÙ- :
If
˜˜ 

Not
˜˜ 
IsDate
˜˜ 
(
˜˜ $
txt_FechaDesdePrestamo
˜˜ ,
.
˜˜, -
Text
˜˜- 1
)
˜˜1 2
Then
˜˜3 7#
btn_verFichaPrestamo2
¯¯ !
.
¯¯! "
	ForeColor
¯¯" +
=
¯¯, -
System
¯¯. 4
.
¯¯4 5
Drawing
¯¯5 <
.
¯¯< =
Color
¯¯= B
.
¯¯B C
Red
¯¯C F#
btn_verFichaPrestamo2
˘˘ !
.
˘˘! "
Text
˘˘" &
=
˘˘' (
$str
˘˘) A
Exit
˙˙ 
Sub
˙˙ 
End
˚˚ 
If
˚˚ 
If
˝˝ 

Not
˝˝ 
IsDate
˝˝ 
(
˝˝ $
txt_FechaHastaPrestamo
˝˝ ,
.
˝˝, -
Text
˝˝- 1
)
˝˝1 2
Then
˝˝3 7#
btn_verFichaPrestamo2
˛˛ !
.
˛˛! "
	ForeColor
˛˛" +
=
˛˛, -
System
˛˛. 4
.
˛˛4 5
Drawing
˛˛5 <
.
˛˛< =
Color
˛˛= B
.
˛˛B C
Red
˛˛C F#
btn_verFichaPrestamo2
ˇˇ !
.
ˇˇ! "
Text
ˇˇ" &
=
ˇˇ' (
$str
ˇˇ) A
Exit
ÄÄ 
Sub
ÄÄ 
End
ÅÅ 
If
ÅÅ 
If
ÉÉ 

Len
ÉÉ 
(
ÉÉ $
txt_FechaDesdePrestamo
ÉÉ %
.
ÉÉ% &
Text
ÉÉ& *
)
ÉÉ* +
=
ÉÉ, -
$num
ÉÉ. /
Or
ÉÉ0 2
Len
ÉÉ3 6
(
ÉÉ6 7$
txt_FechaHastaPrestamo
ÉÉ7 M
.
ÉÉM N
Text
ÉÉN R
)
ÉÉR S
=
ÉÉT U
$num
ÉÉV W
Then
ÉÉX \#
btn_verFichaPrestamo2
ÑÑ !
.
ÑÑ! "
	ForeColor
ÑÑ" +
=
ÑÑ, -
System
ÑÑ. 4
.
ÑÑ4 5
Drawing
ÑÑ5 <
.
ÑÑ< =
Color
ÑÑ= B
.
ÑÑB C
Red
ÑÑC F#
btn_verFichaPrestamo2
ÖÖ !
.
ÖÖ! "
Text
ÖÖ" &
=
ÖÖ' (
$str
ÖÖ) v
Exit
ÜÜ 
Sub
ÜÜ 
ElseIf
áá 
(
áá 
DateTime
áá 
.
áá 
Compare
áá  
(
áá  !$
txt_FechaDesdePrestamo
áá! 7
.
áá7 8
Text
áá8 <
,
áá< =$
txt_FechaHastaPrestamo
áá> T
.
ááT U
Text
ááU Y
)
ááY Z
>
áá[ \
$num
áá] ^
)
áá^ _
Then
áá` d#
btn_verFichaPrestamo2
àà !
.
àà! "
	ForeColor
àà" +
=
àà, -
System
àà. 4
.
àà4 5
Drawing
àà5 <
.
àà< =
Color
àà= B
.
ààB C
Red
ààC F#
btn_verFichaPrestamo2
ââ !
.
ââ! "
Text
ââ" &
=
ââ' (
$str
ââ) _
Exit
ää 
Sub
ää 
Else
ãã #
btn_verFichaPrestamo2
åå !
.
åå! "
Text
åå" &
=
åå' (
$str
åå) +
End
çç 
If
çç 
If
êê 

v_TipoReporte
êê 
=
êê 
$str
êê 6
Then
êê7 ;
v_TipoReporte
ëë 
=
ëë 
$str
ëë 7
ElseIf
íí 
v_TipoReporte
íí 
=
íí 
$str
íí B
Then
ííC G
v_TipoReporte
ìì 
=
ìì 
$str
ìì ?
ElseIf
îî 
v_TipoReporte
îî 
=
îî 
$str
îî ,
Then
îî- 1
v_TipoReporte
ïï 
=
ïï 
$str
ïï .
ElseIf
ññ 
v_TipoReporte
ññ 
=
ññ 
$str
ññ ,
Then
ññ- 1
v_TipoReporte
óó 
=
óó 
$str
óó .
ElseIf
òò 
v_TipoReporte
òò 
=
òò 
$str
òò 6
Then
òò7 ;
v_TipoReporte
ôô 
=
ôô 
$str
ôô 3
Else
öö 
Exit
õõ 
Sub
õõ 
End
úú 
If
úú 
Dim
†† #
ds_Consulta_Reporte01
†† !
As
††" $
DataSet
††% ,
=
††- .
cls_Metodos
††/ :
.
††: ;&
ConsultaRptPrestamoLista
††; S
(
††S T
v_cTipoFecha
††T `
,
††` a
v_cFechaDesde
††b o
,
††o p
v_cFechaHasta
††q ~
,
††~ 
v_Bandera_Tipo††Ä é
)††é è
Dim
¢¢ 
dtsFichaPrestamo
¢¢ 
As
¢¢ 
New
¢¢  #
dtsFichaPrestamo
¢¢$ 4
(
¢¢4 5
)
¢¢5 6
For
§§ 
Each
§§ #
dr_Consulta_Reporte01
§§ &
As
§§' )
DataRow
§§* 1
In
§§2 4#
ds_Consulta_Reporte01
§§5 J
.
§§J K
Tables
§§K Q
(
§§Q R
$num
§§R S
)
§§S T
.
§§T U
Rows
§§U Y
dtsFichaPrestamo
•• 
.
•• 
Tables
•• #
(
••# $
$num
••$ %
)
••% &
.
••& '
Rows
••' +
.
••+ ,
Add
••, /
(
••/ 0#
dr_Consulta_Reporte01
••0 E
.
••E F
	ItemArray
••F O
)
••O P
Next
¶¶ 

rv_General
ßß 
.
ßß 
ProcessingMode
ßß !
=
ßß" #
ProcessingMode
ßß$ 2
.
ßß2 3
Local
ßß3 8

rv_General
©© 
.
©© 
LocalReport
©© 
.
©© 

ReportPath
©© )
=
©©* +
Server
©©, 2
.
©©2 3
MapPath
©©3 :
(
©©: ;
$str
©©; H
&
©©I J
v_TipoReporte
©©K X
&
©©Y Z
$str
©©[ b
)
©©b c
Dim
´´ 

parameters
´´ 
As
´´ 
New
´´ 
List
´´ "
(
´´" #
Of
´´# %
ReportParameter
´´& 5
)
´´5 6
(
´´6 7
)
´´7 8

parameters
≠≠ 
.
≠≠ 
Add
≠≠ 
(
≠≠ 
New
≠≠ 
ReportParameter
≠≠ *
(
≠≠* +
$str
≠≠+ 8
,
≠≠8 9$
txt_FechaDesdePrestamo
≠≠: P
.
≠≠P Q
Text
≠≠Q U
)
≠≠U V
)
≠≠V W

parameters
ÆÆ 
.
ÆÆ 
Add
ÆÆ 
(
ÆÆ 
New
ÆÆ 
ReportParameter
ÆÆ *
(
ÆÆ* +
$str
ÆÆ+ 8
,
ÆÆ8 9$
txt_FechaHastaPrestamo
ÆÆ: P
.
ÆÆP Q
Text
ÆÆQ U
)
ÆÆU V
)
ÆÆV W

rv_General
ØØ 
.
ØØ 
LocalReport
ØØ 
.
ØØ 
SetParameters
ØØ ,
(
ØØ, -

parameters
ØØ- 7
)
ØØ7 8
Dim
±± 
Movimiento_Rpt
±± 
As
±± 
New
±± !
ReportDataSource
±±" 2
(
±±2 3
$str
±±3 G
,
±±G H
dtsFichaPrestamo
±±I Y
.
±±Y Z
Tables
±±Z `
(
±±` a
$num
±±a b
)
±±b c
)
±±c d

rv_General
≤≤ 
.
≤≤ 
LocalReport
≤≤ 
.
≤≤ 
DataSources
≤≤ *
.
≤≤* +
Clear
≤≤+ 0
(
≤≤0 1
)
≤≤1 2

rv_General
≥≥ 
.
≥≥ 
LocalReport
≥≥ 
.
≥≥ 
DataSources
≥≥ *
.
≥≥* +
Add
≥≥+ .
(
≥≥. /
Movimiento_Rpt
≥≥/ =
)
≥≥= >
Dim
∂∂ 
warnings
∂∂ 
As
∂∂ 
Warning
∂∂ 
(
∂∂  
)
∂∂  !
=
∂∂" #
Nothing
∂∂$ +
Dim
∑∑ 
	streamids
∑∑ 
As
∑∑ 
String
∑∑ 
(
∑∑  
)
∑∑  !
=
∑∑" #
Nothing
∑∑$ +
Dim
∏∏ 
mimeType
∏∏ 
As
∏∏ 
String
∏∏ 
=
∏∏  
Nothing
∏∏! (
Dim
ππ 
contentType
ππ 
As
ππ 
String
ππ !
=
ππ" #
Nothing
ππ$ +
Dim
∫∫ 
encoding
∫∫ 
As
∫∫ 
String
∫∫ 
=
∫∫  
Nothing
∫∫! (
Dim
ªª 
	extension
ªª 
As
ªª 
String
ªª 
=
ªª  !
Nothing
ªª" )
Dim
ææ 
bytes
ææ 
As
ææ 
Byte
ææ 
(
ææ 
)
ææ 
=
ææ 

rv_General
ææ (
.
ææ( )
LocalReport
ææ) 4
.
ææ4 5
Render
ææ5 ;
(
ææ; <
FormatoReporte
ææ< J
,
ææJ K
Nothing
ææL S
,
ææS T
mimeType
ææU ]
,
ææ] ^
contentType
ææ_ j
,
ææj k
encoding
ææl t
,
ææt u
	extension
ææv 
,ææ Ä
	streamidsææÅ ä
,ææä ã
warningsææå î
)ææî ï
Response
¡¡ 
.
¡¡ 
Clear
¡¡ 
(
¡¡ 
)
¡¡ 
Response
¬¬ 
.
¬¬ 
Buffer
¬¬ 
=
¬¬ 
True
¬¬ 
Response
√√ 
.
√√ 
Charset
√√ 
=
√√ 
$str
√√ 
Response
ƒƒ 
.
ƒƒ 
Cache
ƒƒ 
.
ƒƒ 
SetCacheability
ƒƒ &
(
ƒƒ& '
HttpCacheability
ƒƒ' 7
.
ƒƒ7 8
NoCache
ƒƒ8 ?
)
ƒƒ? @
Response
≈≈ 
.
≈≈ 
ContentType
≈≈ 
=
≈≈ 
contentType
≈≈ *
Response
∆∆ 
.
∆∆ 
AppendHeader
∆∆ 
(
∆∆ 
$str
∆∆ 3
,
∆∆3 4
$str
∆∆5 L
&
∆∆M N
v_TipoReporte
∆∆O \
&
∆∆] ^
$str
∆∆_ b
&
∆∆c d
	extension
∆∆e n
)
∆∆n o
Response
«« 
.
«« 
BinaryWrite
«« 
(
«« 
bytes
«« "
)
««" #
Response
»» 
.
»» 
Flush
»» 
(
»» 
)
»» 
Response
…… 
.
…… 
End
…… 
(
…… 
)
…… 
End
   
Sub
   
Private
ÃÃ 
Sub
ÃÃ +
Exportar_Reporte_ListaBusqWeb
ÃÃ -
(
ÃÃ- .
ByVal
ÃÃ. 3
FormatoReporte
ÃÃ4 B
As
ÃÃC E
String
ÃÃF L
,
ÃÃL M
ByVal
ÃÃN S
v_TipoReporte
ÃÃT a
As
ÃÃb d
String
ÃÃe k
)
ÃÃk l
If
ŒŒ 

v_TipoReporte
ŒŒ 
=
ŒŒ 
$str
ŒŒ -
Then
ŒŒ. 2
v_TipoReporte
œœ 
=
œœ 
$str
œœ .
ElseIf
–– 
v_TipoReporte
–– 
=
–– 
$str
–– ,
Then
––- 1
v_TipoReporte
—— 
=
—— 
$str
—— .
Else
““ 
lbl_ValidaBusqWeb
”” 
.
”” 
	ForeColor
”” '
=
””( )
System
””* 0
.
””0 1
Drawing
””1 8
.
””8 9
Color
””9 >
.
””> ?
Red
””? B
lbl_ValidaBusqWeb
‘‘ 
.
‘‘ 
Text
‘‘ "
=
‘‘# $
$str
‘‘% S
Exit
’’ 
Sub
’’ 
End
÷÷ 
If
÷÷ 
Dim
ŸŸ #
ds_Consulta_Reporte01
ŸŸ !
As
ŸŸ" $
DataSet
ŸŸ% ,
=
ŸŸ- .
cls_Metodos
ŸŸ/ :
.
ŸŸ: ;(
ConsultaRptHccListaBusqWeb
ŸŸ; U
(
ŸŸU V
)
ŸŸV W
Dim
‹‹ 
dtsBusquedaWeb
‹‹ 
As
‹‹ 
New
‹‹ !
dtsBusquedaWeb
‹‹" 0
(
‹‹0 1
)
‹‹1 2
For
ﬁﬁ 
Each
ﬁﬁ #
dr_Consulta_Reporte01
ﬁﬁ &
As
ﬁﬁ' )
DataRow
ﬁﬁ* 1
In
ﬁﬁ2 4#
ds_Consulta_Reporte01
ﬁﬁ5 J
.
ﬁﬁJ K
Tables
ﬁﬁK Q
(
ﬁﬁQ R
$num
ﬁﬁR S
)
ﬁﬁS T
.
ﬁﬁT U
Rows
ﬁﬁU Y
dtsBusquedaWeb
ﬂﬂ 
.
ﬂﬂ 
Tables
ﬂﬂ !
(
ﬂﬂ! "
$num
ﬂﬂ" #
)
ﬂﬂ# $
.
ﬂﬂ$ %
Rows
ﬂﬂ% )
.
ﬂﬂ) *
Add
ﬂﬂ* -
(
ﬂﬂ- .#
dr_Consulta_Reporte01
ﬂﬂ. C
.
ﬂﬂC D
	ItemArray
ﬂﬂD M
)
ﬂﬂM N
Next
‡‡ 

rv_General
‚‚ 
.
‚‚ 
ProcessingMode
‚‚ !
=
‚‚" #
ProcessingMode
‚‚$ 2
.
‚‚2 3
Local
‚‚3 8

rv_General
„„ 
.
„„ 
LocalReport
„„ 
.
„„ 

ReportPath
„„ )
=
„„* +
Server
„„, 2
.
„„2 3
MapPath
„„3 :
(
„„: ;
$str
„„; H
&
„„I J
v_TipoReporte
„„K X
&
„„Y Z
$str
„„[ b
)
„„b c
Dim
ÂÂ 

parameters
ÂÂ 
As
ÂÂ 
New
ÂÂ 
List
ÂÂ "
(
ÂÂ" #
Of
ÂÂ# %
ReportParameter
ÂÂ& 5
)
ÂÂ5 6
(
ÂÂ6 7
)
ÂÂ7 8

rv_General
ÁÁ 
.
ÁÁ 
LocalReport
ÁÁ 
.
ÁÁ 
SetParameters
ÁÁ ,
(
ÁÁ, -

parameters
ÁÁ- 7
)
ÁÁ7 8
Dim
ÈÈ 
Movimiento_Rpt
ÈÈ 
As
ÈÈ 
New
ÈÈ !
ReportDataSource
ÈÈ" 2
(
ÈÈ2 3
$str
ÈÈ3 C
,
ÈÈC D
dtsBusquedaWeb
ÈÈE S
.
ÈÈS T
Tables
ÈÈT Z
(
ÈÈZ [
$num
ÈÈ[ \
)
ÈÈ\ ]
)
ÈÈ] ^

rv_General
ÍÍ 
.
ÍÍ 
LocalReport
ÍÍ 
.
ÍÍ 
DataSources
ÍÍ *
.
ÍÍ* +
Clear
ÍÍ+ 0
(
ÍÍ0 1
)
ÍÍ1 2

rv_General
ÎÎ 
.
ÎÎ 
LocalReport
ÎÎ 
.
ÎÎ 
DataSources
ÎÎ *
.
ÎÎ* +
Add
ÎÎ+ .
(
ÎÎ. /
Movimiento_Rpt
ÎÎ/ =
)
ÎÎ= >
Dim
ÓÓ 
warnings
ÓÓ 
As
ÓÓ 
Warning
ÓÓ 
(
ÓÓ  
)
ÓÓ  !
=
ÓÓ" #
Nothing
ÓÓ$ +
Dim
ÔÔ 
	streamids
ÔÔ 
As
ÔÔ 
String
ÔÔ 
(
ÔÔ  
)
ÔÔ  !
=
ÔÔ" #
Nothing
ÔÔ$ +
Dim
 
mimeType
 
As
 
String
 
=
  
Nothing
! (
Dim
ÒÒ 
contentType
ÒÒ 
As
ÒÒ 
String
ÒÒ !
=
ÒÒ" #
Nothing
ÒÒ$ +
Dim
ÚÚ 
encoding
ÚÚ 
As
ÚÚ 
String
ÚÚ 
=
ÚÚ  
Nothing
ÚÚ! (
Dim
ÛÛ 
	extension
ÛÛ 
As
ÛÛ 
String
ÛÛ 
=
ÛÛ  !
Nothing
ÛÛ" )
Dim
ˆˆ 
bytes
ˆˆ 
As
ˆˆ 
Byte
ˆˆ 
(
ˆˆ 
)
ˆˆ 
=
ˆˆ 

rv_General
ˆˆ (
.
ˆˆ( )
LocalReport
ˆˆ) 4
.
ˆˆ4 5
Render
ˆˆ5 ;
(
ˆˆ; <
FormatoReporte
ˆˆ< J
,
ˆˆJ K
Nothing
ˆˆL S
,
ˆˆS T
mimeType
ˆˆU ]
,
ˆˆ] ^
contentType
ˆˆ_ j
,
ˆˆj k
encoding
ˆˆl t
,
ˆˆt u
	extension
ˆˆv 
,ˆˆ Ä
	streamidsˆˆÅ ä
,ˆˆä ã
warningsˆˆå î
)ˆˆî ï
Response
˘˘ 
.
˘˘ 
Clear
˘˘ 
(
˘˘ 
)
˘˘ 
Response
˙˙ 
.
˙˙ 
Buffer
˙˙ 
=
˙˙ 
True
˙˙ 
Response
˚˚ 
.
˚˚ 
Charset
˚˚ 
=
˚˚ 
$str
˚˚ 
Response
¸¸ 
.
¸¸ 
Cache
¸¸ 
.
¸¸ 
SetCacheability
¸¸ &
(
¸¸& '
HttpCacheability
¸¸' 7
.
¸¸7 8
NoCache
¸¸8 ?
)
¸¸? @
Response
˝˝ 
.
˝˝ 
ContentType
˝˝ 
=
˝˝ 
contentType
˝˝ *
Response
˛˛ 
.
˛˛ 
AppendHeader
˛˛ 
(
˛˛ 
$str
˛˛ 3
,
˛˛3 4
$str
˛˛5 L
&
˛˛M N
v_TipoReporte
˛˛O \
&
˛˛] ^
$str
˛˛_ b
&
˛˛c d
	extension
˛˛e n
)
˛˛n o
Response
ˇˇ 
.
ˇˇ 
BinaryWrite
ˇˇ 
(
ˇˇ 
bytes
ˇˇ "
)
ˇˇ" #
Response
ÄÄ 
.
ÄÄ 
Flush
ÄÄ 
(
ÄÄ 
)
ÄÄ 
Response
ÅÅ 
.
ÅÅ 
End
ÅÅ 
(
ÅÅ 
)
ÅÅ 
End
ÇÇ 
Sub
ÇÇ 
Private
ÑÑ 
Sub
ÑÑ '
Exportar_Reporte_Prestamo
ÑÑ )
(
ÑÑ) *
ByVal
ÑÑ* /
FormatoReporte
ÑÑ0 >
As
ÑÑ? A
String
ÑÑB H
,
ÑÑH I
ByVal
ÑÑJ O
v_TipoReporte
ÑÑP ]
As
ÑÑ^ `
String
ÑÑa g
)
ÑÑg h
Dim
áá 
v_cFechaDesde
áá 
,
áá 
v_cFechaHasta
áá (
As
áá) +
Date
áá, 0
Dim
àà 
v_cTipoFecha
àà 
,
àà 
v_Bandera_OFI
àà '
,
àà' (

v_cOficina
àà) 3
,
àà3 4
v_Bandera_IFI
àà5 B
,
ààB C
	v_cEntIFI
ààD M
,
ààM N 
v_Bandera_Contrato
ààO a
,
ààa b!
v_cCustodiaContrato
ààc v
,
ààv w
v_Bandera_Pagare
ââ 
,
ââ 
v_cCustodiaPagare
ââ /
,
ââ/ 0 
v_Bandera_Garantia
ââ1 C
,
ââC D!
v_cCustodiaGarantia
ââE X
As
ââY [
String
ââ\ b
If
åå 

v_TipoReporte
åå 
=
åå 
$str
åå -
Then
åå. 2
v_TipoReporte
çç 
=
çç 
$str
çç .
ElseIf
éé 
v_TipoReporte
éé 
=
éé 
$str
éé 3
Then
éé4 8
v_TipoReporte
èè 
=
èè 
$str
èè .
ElseIf
êê 
v_TipoReporte
êê 
=
êê 
$str
êê ,
Then
êê- 1
v_TipoReporte
ëë 
=
ëë 
$str
ëë .
ElseIf
íí 
v_TipoReporte
íí 
=
íí 
$str
íí ,
Then
íí- 1
v_TipoReporte
ìì 
=
ìì 
$str
ìì .
ElseIf
îî 
v_TipoReporte
îî 
=
îî 
$str
îî 6
Then
îî7 ;
v_TipoReporte
ïï 
=
ïï 
$str
ïï 3
Else
ññ !
lbl_ValidaPrestamo1
óó 
.
óó  
	ForeColor
óó  )
=
óó* +
System
óó, 2
.
óó2 3
Drawing
óó3 :
.
óó: ;
Color
óó; @
.
óó@ A
Red
óóA D!
lbl_ValidaPrestamo1
òò 
.
òò  
Text
òò  $
=
òò% &
$str
òò' U
Exit
ôô 
Sub
ôô 
End
öö 
If
öö 
Dim
ùù 
Valor
ùù 
As
ùù 
String
ùù 
=
ùù  
txt_ValorPrestamo1
ùù 0
.
ùù0 1
Text
ùù1 5
.
ùù5 6
Trim
ùù6 :
Dim
ûû 
vBandera
ûû 
As
ûû 
String
ûû 
=
ûû  
$str
ûû! $
Dim
†† #
ds_Consulta_Reporte01
†† !
As
††" $
DataSet
††% ,
=
††- .
cls_Metodos
††/ :
.
††: ;
BuscarPestamo
††; H
(
††H I
Valor
††I N
,
††N O
vBandera
††P X
)
††X Y
Dim
££ 
ds_Reporte01
££ 
As
££ 
New
££ 
dtsFichaPrestamo
££  0
(
££0 1
)
££1 2
For
•• 
Each
•• #
dr_Consulta_Reporte01
•• &
As
••' )
DataRow
••* 1
In
••2 4#
ds_Consulta_Reporte01
••5 J
.
••J K
Tables
••K Q
(
••Q R
$num
••R S
)
••S T
.
••T U
Rows
••U Y
ds_Reporte01
¶¶ 
.
¶¶ 
Tables
¶¶ 
(
¶¶  
$num
¶¶  !
)
¶¶! "
.
¶¶" #
Rows
¶¶# '
.
¶¶' (
Add
¶¶( +
(
¶¶+ ,#
dr_Consulta_Reporte01
¶¶, A
.
¶¶A B
	ItemArray
¶¶B K
)
¶¶K L
Next
ßß 

rv_General
®® 
.
®® 
ProcessingMode
®® !
=
®®" #
ProcessingMode
®®$ 2
.
®®2 3
Local
®®3 8

rv_General
™™ 
.
™™ 
LocalReport
™™ 
.
™™ 

ReportPath
™™ )
=
™™* +
Server
™™, 2
.
™™2 3
MapPath
™™3 :
(
™™: ;
$str
™™; H
&
™™I J
v_TipoReporte
™™K X
&
™™Y Z
$str
™™[ b
)
™™b c
Dim
¨¨ 

parameters
¨¨ 
As
¨¨ 
New
¨¨ 
List
¨¨ "
(
¨¨" #
Of
¨¨# %
ReportParameter
¨¨& 5
)
¨¨5 6
(
¨¨6 7
)
¨¨7 8

rv_General
ÆÆ 
.
ÆÆ 
LocalReport
ÆÆ 
.
ÆÆ 
SetParameters
ÆÆ ,
(
ÆÆ, -

parameters
ÆÆ- 7
)
ÆÆ7 8
Dim
∞∞ 
Movimiento_Rpt
∞∞ 
As
∞∞ 
New
∞∞ !
ReportDataSource
∞∞" 2
(
∞∞2 3
$str
∞∞3 F
,
∞∞F G
ds_Reporte01
∞∞H T
.
∞∞T U
Tables
∞∞U [
(
∞∞[ \
$num
∞∞\ ]
)
∞∞] ^
)
∞∞^ _

rv_General
±± 
.
±± 
LocalReport
±± 
.
±± 
DataSources
±± *
.
±±* +
Clear
±±+ 0
(
±±0 1
)
±±1 2

rv_General
≤≤ 
.
≤≤ 
LocalReport
≤≤ 
.
≤≤ 
DataSources
≤≤ *
.
≤≤* +
Add
≤≤+ .
(
≤≤. /
Movimiento_Rpt
≤≤/ =
)
≤≤= >
Dim
µµ 
warnings
µµ 
As
µµ 
Warning
µµ 
(
µµ  
)
µµ  !
=
µµ" #
Nothing
µµ$ +
Dim
∂∂ 
	streamids
∂∂ 
As
∂∂ 
String
∂∂ 
(
∂∂  
)
∂∂  !
=
∂∂" #
Nothing
∂∂$ +
Dim
∑∑ 
mimeType
∑∑ 
As
∑∑ 
String
∑∑ 
=
∑∑  
Nothing
∑∑! (
Dim
∏∏ 
contentType
∏∏ 
As
∏∏ 
String
∏∏ !
=
∏∏" #
Nothing
∏∏$ +
Dim
ππ 
encoding
ππ 
As
ππ 
String
ππ 
=
ππ  
Nothing
ππ! (
Dim
∫∫ 
	extension
∫∫ 
As
∫∫ 
String
∫∫ 
=
∫∫  !
Nothing
∫∫" )
Dim
ΩΩ 
bytes
ΩΩ 
As
ΩΩ 
Byte
ΩΩ 
(
ΩΩ 
)
ΩΩ 
=
ΩΩ 

rv_General
ΩΩ (
.
ΩΩ( )
LocalReport
ΩΩ) 4
.
ΩΩ4 5
Render
ΩΩ5 ;
(
ΩΩ; <
FormatoReporte
ΩΩ< J
,
ΩΩJ K
Nothing
ΩΩL S
,
ΩΩS T
mimeType
ΩΩU ]
,
ΩΩ] ^
contentType
ΩΩ_ j
,
ΩΩj k
encoding
ΩΩl t
,
ΩΩt u
	extension
ΩΩv 
,ΩΩ Ä
	streamidsΩΩÅ ä
,ΩΩä ã
warningsΩΩå î
)ΩΩî ï
Response
¿¿ 
.
¿¿ 
Clear
¿¿ 
(
¿¿ 
)
¿¿ 
Response
¡¡ 
.
¡¡ 
Buffer
¡¡ 
=
¡¡ 
True
¡¡ 
Response
¬¬ 
.
¬¬ 
Charset
¬¬ 
=
¬¬ 
$str
¬¬ 
Response
√√ 
.
√√ 
Cache
√√ 
.
√√ 
SetCacheability
√√ &
(
√√& '
HttpCacheability
√√' 7
.
√√7 8
NoCache
√√8 ?
)
√√? @
Response
ƒƒ 
.
ƒƒ 
ContentType
ƒƒ 
=
ƒƒ 
contentType
ƒƒ *
Response
≈≈ 
.
≈≈ 
AppendHeader
≈≈ 
(
≈≈ 
$str
≈≈ 3
,
≈≈3 4
$str
≈≈5 L
&
≈≈M N
v_TipoReporte
≈≈O \
&
≈≈] ^
$str
≈≈_ b
&
≈≈c d
	extension
≈≈e n
)
≈≈n o
Response
∆∆ 
.
∆∆ 
BinaryWrite
∆∆ 
(
∆∆ 
bytes
∆∆ "
)
∆∆" #
Response
«« 
.
«« 
Flush
«« 
(
«« 
)
«« 
Response
»» 
.
»» 
End
»» 
(
»» 
)
»» 
End
…… 
Sub
…… 
Private
ÀÀ 
Sub
ÀÀ 
Exportar_Ficha
ÀÀ 
(
ÀÀ 
ByVal
ÀÀ $
FormatoReporte
ÀÀ% 3
As
ÀÀ4 6
String
ÀÀ7 =
,
ÀÀ= >
ByVal
ÀÀ? D
v_TipoReporte
ÀÀE R
As
ÀÀS U
String
ÀÀV \
)
ÀÀ\ ]
Dim
ŒŒ 
warnings
ŒŒ 
As
ŒŒ 
Warning
ŒŒ 
(
ŒŒ  
)
ŒŒ  !
=
ŒŒ" #
Nothing
ŒŒ$ +
Dim
œœ 
	streamids
œœ 
As
œœ 
String
œœ 
(
œœ  
)
œœ  !
=
œœ" #
Nothing
œœ$ +
Dim
–– 
mimeType
–– 
As
–– 
String
–– 
=
––  
Nothing
––! (
Dim
—— 
contentType
—— 
As
—— 
String
—— !
=
——" #
Nothing
——$ +
Dim
““ 
encoding
““ 
As
““ 
String
““ 
=
““  
Nothing
““! (
Dim
”” 
	extension
”” 
As
”” 
String
”” 
=
””  !
Nothing
””" )
Dim
÷÷ 
bytes
÷÷ 
As
÷÷ 
Byte
÷÷ 
(
÷÷ 
)
÷÷ 
=
÷÷ 

rv_General
÷÷ (
.
÷÷( )
LocalReport
÷÷) 4
.
÷÷4 5
Render
÷÷5 ;
(
÷÷; <
FormatoReporte
÷÷< J
,
÷÷J K
Nothing
÷÷L S
,
÷÷S T
mimeType
÷÷U ]
,
÷÷] ^
contentType
÷÷_ j
,
÷÷j k
encoding
÷÷l t
,
÷÷t u
	extension
÷÷v 
,÷÷ Ä
	streamids÷÷Å ä
,÷÷ä ã
warnings÷÷å î
)÷÷î ï
Response
ŸŸ 
.
ŸŸ 
Clear
ŸŸ 
(
ŸŸ 
)
ŸŸ 
Response
⁄⁄ 
.
⁄⁄ 
Buffer
⁄⁄ 
=
⁄⁄ 
True
⁄⁄ 
Response
€€ 
.
€€ 
Charset
€€ 
=
€€ 
$str
€€ 
Response
‹‹ 
.
‹‹ 
Cache
‹‹ 
.
‹‹ 
SetCacheability
‹‹ &
(
‹‹& '
HttpCacheability
‹‹' 7
.
‹‹7 8
NoCache
‹‹8 ?
)
‹‹? @
Response
›› 
.
›› 
ContentType
›› 
=
›› 
contentType
›› *
Response
ﬁﬁ 
.
ﬁﬁ 
AppendHeader
ﬁﬁ 
(
ﬁﬁ 
$str
ﬁﬁ 3
,
ﬁﬁ3 4
$str
ﬁﬁ5 L
&
ﬁﬁM N
v_TipoReporte
ﬁﬁO \
&
ﬁﬁ] ^
$str
ﬁﬁ_ b
&
ﬁﬁc d
	extension
ﬁﬁe n
)
ﬁﬁn o
Response
ﬂﬂ 
.
ﬂﬂ 
BinaryWrite
ﬂﬂ 
(
ﬂﬂ 
bytes
ﬂﬂ "
)
ﬂﬂ" #
Response
‡‡ 
.
‡‡ 
Flush
‡‡ 
(
‡‡ 
)
‡‡ 
Response
·· 
.
·· 
End
·· 
(
·· 
)
·· 
End
‚‚ 
Sub
‚‚ 
Private
‰‰ 
Sub
‰‰ .
 Exportar_Reporte_InventarioLibro
‰‰ 0
(
‰‰0 1
ByVal
‰‰1 6
FormatoReporte
‰‰7 E
As
‰‰F H
String
‰‰I O
)
‰‰O P
Dim
ÁÁ #
ds_Consulta_Reporte01
ÁÁ !
As
ÁÁ" $
DataSet
ÁÁ% ,
=
ÁÁ- .
cls_Metodos
ÁÁ/ :
.
ÁÁ: ;
InventarioLibro
ÁÁ; J
(
ÁÁJ K
)
ÁÁK L
Dim
ÍÍ  
dtsInventarioLibro
ÍÍ 
As
ÍÍ !
New
ÍÍ" % 
dtsInventarioLibro
ÍÍ& 8
(
ÍÍ8 9
)
ÍÍ9 :
For
ÏÏ 
Each
ÏÏ #
dr_Consulta_Reporte01
ÏÏ &
As
ÏÏ' )
DataRow
ÏÏ* 1
In
ÏÏ2 4#
ds_Consulta_Reporte01
ÏÏ5 J
.
ÏÏJ K
Tables
ÏÏK Q
(
ÏÏQ R
$num
ÏÏR S
)
ÏÏS T
.
ÏÏT U
Rows
ÏÏU Y 
dtsInventarioLibro
ÌÌ 
.
ÌÌ 
Tables
ÌÌ %
(
ÌÌ% &
$num
ÌÌ& '
)
ÌÌ' (
.
ÌÌ( )
Rows
ÌÌ) -
.
ÌÌ- .
Add
ÌÌ. 1
(
ÌÌ1 2#
dr_Consulta_Reporte01
ÌÌ2 G
.
ÌÌG H
	ItemArray
ÌÌH Q
)
ÌÌQ R
Next
ÓÓ 

rv_General
ÔÔ 
.
ÔÔ 
ProcessingMode
ÔÔ !
=
ÔÔ" #
ProcessingMode
ÔÔ$ 2
.
ÔÔ2 3
Local
ÔÔ3 8

rv_General
ÒÒ 
.
ÒÒ 
LocalReport
ÒÒ 
.
ÒÒ 

ReportPath
ÒÒ )
=
ÒÒ* +
Server
ÒÒ, 2
.
ÒÒ2 3
MapPath
ÒÒ3 :
(
ÒÒ: ;
$str
ÒÒ; H
&
ÒÒI J
$str
ÒÒK g
&
ÒÒh i
$str
ÒÒj q
)
ÒÒq r
Dim
ÛÛ 
Movimiento_Rpt
ÛÛ 
As
ÛÛ 
New
ÛÛ !
ReportDataSource
ÛÛ" 2
(
ÛÛ2 3
$str
ÛÛ3 I
,
ÛÛI J 
dtsInventarioLibro
ÛÛK ]
.
ÛÛ] ^
Tables
ÛÛ^ d
(
ÛÛd e
$num
ÛÛe f
)
ÛÛf g
)
ÛÛg h

rv_General
ÙÙ 
.
ÙÙ 
LocalReport
ÙÙ 
.
ÙÙ 
DataSources
ÙÙ *
.
ÙÙ* +
Clear
ÙÙ+ 0
(
ÙÙ0 1
)
ÙÙ1 2

rv_General
ıı 
.
ıı 
LocalReport
ıı 
.
ıı 
DataSources
ıı *
.
ıı* +
Add
ıı+ .
(
ıı. /
Movimiento_Rpt
ıı/ =
)
ıı= >
Dim
¯¯ 
warnings
¯¯ 
As
¯¯ 
Warning
¯¯ 
(
¯¯  
)
¯¯  !
=
¯¯" #
Nothing
¯¯$ +
Dim
˘˘ 
	streamids
˘˘ 
As
˘˘ 
String
˘˘ 
(
˘˘  
)
˘˘  !
=
˘˘" #
Nothing
˘˘$ +
Dim
˙˙ 
mimeType
˙˙ 
As
˙˙ 
String
˙˙ 
=
˙˙  
Nothing
˙˙! (
Dim
˚˚ 
contentType
˚˚ 
As
˚˚ 
String
˚˚ !
=
˚˚" #
Nothing
˚˚$ +
Dim
¸¸ 
encoding
¸¸ 
As
¸¸ 
String
¸¸ 
=
¸¸  
Nothing
¸¸! (
Dim
˝˝ 
	extension
˝˝ 
As
˝˝ 
String
˝˝ 
=
˝˝  !
Nothing
˝˝" )
Dim
Ä	Ä	 
bytes
Ä	Ä	 
As
Ä	Ä	 
Byte
Ä	Ä	 
(
Ä	Ä	 
)
Ä	Ä	 
=
Ä	Ä	 

rv_General
Ä	Ä	 (
.
Ä	Ä	( )
LocalReport
Ä	Ä	) 4
.
Ä	Ä	4 5
Render
Ä	Ä	5 ;
(
Ä	Ä	; <
FormatoReporte
Ä	Ä	< J
,
Ä	Ä	J K
Nothing
Ä	Ä	L S
,
Ä	Ä	S T
mimeType
Ä	Ä	U ]
,
Ä	Ä	] ^
contentType
Ä	Ä	_ j
,
Ä	Ä	j k
encoding
Ä	Ä	l t
,
Ä	Ä	t u
	extension
Ä	Ä	v 
,Ä	Ä	 Ä
	streamidsÄ	Ä	Å ä
,Ä	Ä	ä ã
warningsÄ	Ä	å î
)Ä	Ä	î ï
Response
É	É	 
.
É	É	 
Clear
É	É	 
(
É	É	 
)
É	É	 
Response
Ñ	Ñ	 
.
Ñ	Ñ	 
Buffer
Ñ	Ñ	 
=
Ñ	Ñ	 
True
Ñ	Ñ	 
Response
Ö	Ö	 
.
Ö	Ö	 
Charset
Ö	Ö	 
=
Ö	Ö	 
$str
Ö	Ö	 
Response
Ü	Ü	 
.
Ü	Ü	 
Cache
Ü	Ü	 
.
Ü	Ü	 
SetCacheability
Ü	Ü	 &
(
Ü	Ü	& '
HttpCacheability
Ü	Ü	' 7
.
Ü	Ü	7 8
NoCache
Ü	Ü	8 ?
)
Ü	Ü	? @
Response
á	á	 
.
á	á	 
ContentType
á	á	 
=
á	á	 
contentType
á	á	 *
Response
à	à	 
.
à	à	 
AppendHeader
à	à	 
(
à	à	 
$str
à	à	 3
,
à	à	3 4
$str
à	à	5 L
&
à	à	M N
$str
à	à	O k
&
à	à	l m
$str
à	à	n q
&
à	à	r s
	extension
à	à	t }
)
à	à	} ~
Response
â	â	 
.
â	â	 
BinaryWrite
â	â	 
(
â	â	 
bytes
â	â	 "
)
â	â	" #
Response
ä	ä	 
.
ä	ä	 
Flush
ä	ä	 
(
ä	ä	 
)
ä	ä	 
img_load
ã	ã	 
.
ã	ã	 
Visible
ã	ã	 
=
ã	ã	 
False
ã	ã	  
Response
å	å	 
.
å	å	 
End
å	å	 
(
å	å	 
)
å	å	 
End
ç	ç	 
Sub
ç	ç	 
Private
è	è	 
Sub
è	è	 '
btn_HistorialLector_Click
è	è	 )
(
è	è	) *
sender
è	è	* 0
As
è	è	1 3
Object
è	è	4 :
,
è	è	: ;
e
è	è	< =
As
è	è	> @
	EventArgs
è	è	A J
)
è	è	J K
Handles
è	è	L S&
btn_verHistorialEmpleado
è	è	T l
.
è	è	l m
Click
è	è	m r
Try
ê	ê	 
Dim
ë	ë	 
v_FormatoReporte
ë	ë	  
As
ë	ë	! #
String
ë	ë	$ *
=
ë	ë	+ ,
$str
ë	ë	- 2
Exportar_Reporte
í	í	 
(
í	í	 
v_FormatoReporte
í	í	 -
,
í	í	- .
$str
í	í	/ L
)
í	í	L M
Catch
ì	ì	 
ex
ì	ì	 
As
ì	ì	 
	Exception
ì	ì	 
lbl_validaLector1
î	î	 
.
î	î	 
Text
î	î	 "
=
î	î	# $
ex
î	î	% '
.
î	î	' (
Message
î	î	( /
lbl_validaLector1
ï	ï	 
.
ï	ï	 
	ForeColor
ï	ï	 '
=
ï	ï	( )
System
ï	ï	* 0
.
ï	ï	0 1
Drawing
ï	ï	1 8
.
ï	ï	8 9
Color
ï	ï	9 >
.
ï	ï	> ?
Red
ï	ï	? B
End
ñ	ñ	 
Try
ñ	ñ	 
End
ó	ó	 
Sub
ó	ó	 
Sub
ô	ô	 *
ExportarReporte_RDLCPrestamo
ô	ô	 $
(
ô	ô	$ %
ByVal
ô	ô	% *
nombreReporte
ô	ô	+ 8
As
ô	ô	9 ;
String
ô	ô	< B
,
ô	ô	B C
ByVal
ô	ô	D I
tituloReporte
ô	ô	J W
As
ô	ô	X Z
String
ô	ô	[ a
,
ô	ô	a b
ByVal
ô	ô	c h
	MydataSet
ô	ô	i r
As
ô	ô	s u
DataSet
ô	ô	v }
,
ô	ô	} ~
ByValô	ô	 Ñ
strFileô	ô	Ö å
Asô	ô	ç è
Stringô	ô	ê ñ
,ô	ô	ñ ó
ByValô	ô	ò ù
subtituloRptô	ô	û ™
Asô	ô	´ ≠
Stringô	ô	Æ ¥
)ô	ô	¥ µ
Dim
ö	ö	 
ds_Ficha_Prestamo
ö	ö	 
As
ö	ö	  
New
ö	ö	! $
DataSet
ö	ö	% ,
(
ö	ö	, -
)
ö	ö	- .
ds_Ficha_Prestamo
õ	õ	 
=
õ	õ	 
	MydataSet
õ	õ	 %
Try
ù	ù	 
Dim
û	û	  
rds_Ficha_Prestamo
û	û	 "
As
û	û	# %
ReportDataSource
û	û	& 6
ds_Ficha_Prestamo
ü	ü	 
.
ü	ü	 
Tables
ü	ü	 $
(
ü	ü	$ %
$num
ü	ü	% &
)
ü	ü	& '
.
ü	ü	' (
	TableName
ü	ü	( 1
=
ü	ü	2 3
$str
ü	ü	4 A

rv_General
†	†	 
.
†	†	 
LocalReport
†	†	 "
.
†	†	" #

ReportPath
†	†	# -
=
†	†	. /
$str
†	†	0 <
&
†	†	= >
nombreReporte
†	†	? L 
rds_Ficha_Prestamo
°	°	 
=
°	°	  
New
°	°	! $
ReportDataSource
°	°	% 5
(
°	°	5 6
$str
°	°	6 I
,
°	°	I J
ds_Ficha_Prestamo
°	°	K \
.
°	°	\ ]
Tables
°	°	] c
(
°	°	c d
$num
°	°	d e
)
°	°	e f
)
°	°	f g

rv_General
¢	¢	 
.
¢	¢	 
LocalReport
¢	¢	 "
.
¢	¢	" #
DataSources
¢	¢	# .
.
¢	¢	. /
Clear
¢	¢	/ 4
(
¢	¢	4 5
)
¢	¢	5 6

rv_General
£	£	 
.
£	£	 
LocalReport
£	£	 "
.
£	£	" #
DataSources
£	£	# .
.
£	£	. /
Add
£	£	/ 2
(
£	£	2 3 
rds_Ficha_Prestamo
£	£	3 E
)
£	£	E F

rv_General
§	§	 
.
§	§	 
LocalReport
§	§	 "
.
§	§	" #
Refresh
§	§	# *
(
§	§	* +
)
§	§	+ ,!
Exportar_Ficha_RDLC
•	•	 
(
•	•	  
strFile
•	•	  '
,
•	•	' (
subtituloRpt
•	•	) 5
)
•	•	5 6
Catch
¶	¶	 
ex
¶	¶	 
As
¶	¶	 
	Exception
¶	¶	 
Exit
ß	ß	 
Sub
ß	ß	 
Finally
®	®	 
ds_Ficha_Prestamo
©	©	 
=
©	©	 
Nothing
©	©	  '
End
™	™	 
Try
™	™	 
End
´	´	 
Sub
´	´	 
Sub
≠	≠	 '
ExportarReporte_RDLCLibro
≠	≠	 !
(
≠	≠	! "
ByVal
≠	≠	" '
nombreReporte
≠	≠	( 5
As
≠	≠	6 8
String
≠	≠	9 ?
,
≠	≠	? @
ByVal
≠	≠	A F
tituloReporte
≠	≠	G T
As
≠	≠	U W
String
≠	≠	X ^
,
≠	≠	^ _
ByVal
≠	≠	` e
	MydataSet
≠	≠	f o
As
≠	≠	p r
DataSet
≠	≠	s z
,
≠	≠	z {
ByVal≠	≠	| Å
strFile≠	≠	Ç â
As≠	≠	ä å
String≠	≠	ç ì
,≠	≠	ì î
ByVal≠	≠	ï ö
subtituloRpt≠	≠	õ ß
As≠	≠	® ™
String≠	≠	´ ±
)≠	≠	± ≤
Dim
Æ	Æ	 
ds_Ficha_Prestamo
Æ	Æ	 
As
Æ	Æ	  
New
Æ	Æ	! $
DataSet
Æ	Æ	% ,
(
Æ	Æ	, -
)
Æ	Æ	- .
ds_Ficha_Prestamo
Ø	Ø	 
=
Ø	Ø	 
	MydataSet
Ø	Ø	 %
Try
∞	∞	 
Dim
±	±	  
rds_Ficha_Prestamo
±	±	 "
As
±	±	# %
ReportDataSource
±	±	& 6
ds_Ficha_Prestamo
≤	≤	 
.
≤	≤	 
Tables
≤	≤	 $
(
≤	≤	$ %
$num
≤	≤	% &
)
≤	≤	& '
.
≤	≤	' (
	TableName
≤	≤	( 1
=
≤	≤	2 3
$str
≤	≤	4 A

rv_General
≥	≥	 
.
≥	≥	 
LocalReport
≥	≥	 "
.
≥	≥	" #

ReportPath
≥	≥	# -
=
≥	≥	. /
$str
≥	≥	0 <
&
≥	≥	= >
nombreReporte
≥	≥	? L 
rds_Ficha_Prestamo
¥	¥	 
=
¥	¥	  
New
¥	¥	! $
ReportDataSource
¥	¥	% 5
(
¥	¥	5 6
$str
¥	¥	6 N
,
¥	¥	N O
ds_Ficha_Prestamo
¥	¥	P a
.
¥	¥	a b
Tables
¥	¥	b h
(
¥	¥	h i
$num
¥	¥	i j
)
¥	¥	j k
)
¥	¥	k l

rv_General
µ	µ	 
.
µ	µ	 
LocalReport
µ	µ	 "
.
µ	µ	" #
DataSources
µ	µ	# .
.
µ	µ	. /
Clear
µ	µ	/ 4
(
µ	µ	4 5
)
µ	µ	5 6

rv_General
∂	∂	 
.
∂	∂	 
LocalReport
∂	∂	 "
.
∂	∂	" #
DataSources
∂	∂	# .
.
∂	∂	. /
Add
∂	∂	/ 2
(
∂	∂	2 3 
rds_Ficha_Prestamo
∂	∂	3 E
)
∂	∂	E F

rv_General
∑	∑	 
.
∑	∑	 
LocalReport
∑	∑	 "
.
∑	∑	" #
Refresh
∑	∑	# *
(
∑	∑	* +
)
∑	∑	+ ,!
Exportar_Ficha_RDLC
∏	∏	 
(
∏	∏	  
strFile
∏	∏	  '
,
∏	∏	' (
subtituloRpt
∏	∏	) 5
)
∏	∏	5 6
Catch
π	π	 
ex
π	π	 
As
π	π	 
	Exception
π	π	 
Exit
∫	∫	 
Sub
∫	∫	 
Finally
ª	ª	 
ds_Ficha_Prestamo
º	º	 
=
º	º	 
Nothing
º	º	  '
End
Ω	Ω	 
Try
Ω	Ω	 
End
æ	æ	 
Sub
æ	æ	 
Sub
¿	¿	 %
ExportarReporte_RDLCHcc
¿	¿	 
(
¿	¿	  
ByVal
¿	¿	  %
nombreReporte
¿	¿	& 3
As
¿	¿	4 6
String
¿	¿	7 =
,
¿	¿	= >
ByVal
¿	¿	? D
tituloReporte
¿	¿	E R
As
¿	¿	S U
String
¿	¿	V \
,
¿	¿	\ ]
ByVal
¿	¿	^ c
	MydataSet
¿	¿	d m
As
¿	¿	n p
DataSet
¿	¿	q x
,
¿	¿	x y
ByVal
¿	¿	z 
strFile¿	¿	Ä á
As¿	¿	à ä
String¿	¿	ã ë
,¿	¿	ë í
ByVal¿	¿	ì ò
subtituloRpt¿	¿	ô •
As¿	¿	¶ ®
String¿	¿	© Ø
)¿	¿	Ø ∞
Dim
¡	¡	 
ds_Ficha_Prestamo
¡	¡	 
As
¡	¡	  
New
¡	¡	! $
DataSet
¡	¡	% ,
(
¡	¡	, -
)
¡	¡	- .
ds_Ficha_Prestamo
¬	¬	 
=
¬	¬	 
	MydataSet
¬	¬	 %
Try
ƒ	ƒ	 
Dim
≈	≈	  
rds_Ficha_Prestamo
≈	≈	 "
As
≈	≈	# %
ReportDataSource
≈	≈	& 6
ds_Ficha_Prestamo
∆	∆	 
.
∆	∆	 
Tables
∆	∆	 $
(
∆	∆	$ %
$num
∆	∆	% &
)
∆	∆	& '
.
∆	∆	' (
	TableName
∆	∆	( 1
=
∆	∆	2 3
$str
∆	∆	4 A

rv_General
«	«	 
.
«	«	 
LocalReport
«	«	 "
.
«	«	" #

ReportPath
«	«	# -
=
«	«	. /
$str
«	«	0 <
&
«	«	= >
nombreReporte
«	«	? L 
rds_Ficha_Prestamo
»	»	 
=
»	»	  
New
»	»	! $
ReportDataSource
»	»	% 5
(
»	»	5 6
$str
»	»	6 L
,
»	»	L M
ds_Ficha_Prestamo
»	»	N _
.
»	»	_ `
Tables
»	»	` f
(
»	»	f g
$num
»	»	g h
)
»	»	h i
)
»	»	i j

rv_General
…	…	 
.
…	…	 
LocalReport
…	…	 "
.
…	…	" #
DataSources
…	…	# .
.
…	…	. /
Clear
…	…	/ 4
(
…	…	4 5
)
…	…	5 6

rv_General
 	 	 
.
 	 	 
LocalReport
 	 	 "
.
 	 	" #
DataSources
 	 	# .
.
 	 	. /
Add
 	 	/ 2
(
 	 	2 3 
rds_Ficha_Prestamo
 	 	3 E
)
 	 	E F

rv_General
À	À	 
.
À	À	 
LocalReport
À	À	 "
.
À	À	" #
Refresh
À	À	# *
(
À	À	* +
)
À	À	+ ,!
Exportar_Ficha_RDLC
Ã	Ã	 
(
Ã	Ã	  
strFile
Ã	Ã	  '
,
Ã	Ã	' (
subtituloRpt
Ã	Ã	) 5
)
Ã	Ã	5 6
Catch
Õ	Õ	 
ex
Õ	Õ	 
As
Õ	Õ	 
	Exception
Õ	Õ	 
Exit
Œ	Œ	 
Sub
Œ	Œ	 
Finally
œ	œ	 
ds_Ficha_Prestamo
–	–	 
=
–	–	 
Nothing
–	–	  '
End
—	—	 
Try
—	—	 
End
“	“	 
Sub
“	“	 
Private
‘	‘	 
Sub
‘	‘	 !
Exportar_Ficha_RDLC
‘	‘	 #
(
‘	‘	# $
ByVal
‘	‘	$ )
FormatoReporte
‘	‘	* 8
As
‘	‘	9 ;
String
‘	‘	< B
,
‘	‘	B C
ByVal
‘	‘	D I
v_TipoReporte
‘	‘	J W
As
‘	‘	X Z
String
‘	‘	[ a
)
‘	‘	a b
Dim
◊	◊	 
warnings
◊	◊	 
As
◊	◊	 
Warning
◊	◊	 
(
◊	◊	  
)
◊	◊	  !
=
◊	◊	" #
Nothing
◊	◊	$ +
Dim
ÿ	ÿ	 
	streamids
ÿ	ÿ	 
As
ÿ	ÿ	 
String
ÿ	ÿ	 
(
ÿ	ÿ	  
)
ÿ	ÿ	  !
=
ÿ	ÿ	" #
Nothing
ÿ	ÿ	$ +
Dim
Ÿ	Ÿ	 
mimeType
Ÿ	Ÿ	 
As
Ÿ	Ÿ	 
String
Ÿ	Ÿ	 
=
Ÿ	Ÿ	  
Nothing
Ÿ	Ÿ	! (
Dim
⁄	⁄	 
contentType
⁄	⁄	 
As
⁄	⁄	 
String
⁄	⁄	 !
=
⁄	⁄	" #
Nothing
⁄	⁄	$ +
Dim
€	€	 
encoding
€	€	 
As
€	€	 
String
€	€	 
=
€	€	  
Nothing
€	€	! (
Dim
‹	‹	 
	extension
‹	‹	 
As
‹	‹	 
String
‹	‹	 
=
‹	‹	  !
Nothing
‹	‹	" )
Dim
ﬂ	ﬂ	 
bytes
ﬂ	ﬂ	 
As
ﬂ	ﬂ	 
Byte
ﬂ	ﬂ	 
(
ﬂ	ﬂ	 
)
ﬂ	ﬂ	 
=
ﬂ	ﬂ	 

rv_General
ﬂ	ﬂ	 (
.
ﬂ	ﬂ	( )
LocalReport
ﬂ	ﬂ	) 4
.
ﬂ	ﬂ	4 5
Render
ﬂ	ﬂ	5 ;
(
ﬂ	ﬂ	; <
FormatoReporte
ﬂ	ﬂ	< J
,
ﬂ	ﬂ	J K
Nothing
ﬂ	ﬂ	L S
,
ﬂ	ﬂ	S T
mimeType
ﬂ	ﬂ	U ]
,
ﬂ	ﬂ	] ^
contentType
ﬂ	ﬂ	_ j
,
ﬂ	ﬂ	j k
encoding
ﬂ	ﬂ	l t
,
ﬂ	ﬂ	t u
	extension
ﬂ	ﬂ	v 
,ﬂ	ﬂ	 Ä
	streamidsﬂ	ﬂ	Å ä
,ﬂ	ﬂ	ä ã
warningsﬂ	ﬂ	å î
)ﬂ	ﬂ	î ï
Response
‚	‚	 
.
‚	‚	 
Clear
‚	‚	 
(
‚	‚	 
)
‚	‚	 
Response
„	„	 
.
„	„	 
Buffer
„	„	 
=
„	„	 
True
„	„	 
Response
‰	‰	 
.
‰	‰	 
Charset
‰	‰	 
=
‰	‰	 
$str
‰	‰	 
Response
Â	Â	 
.
Â	Â	 
Cache
Â	Â	 
.
Â	Â	 
SetCacheability
Â	Â	 &
(
Â	Â	& '
HttpCacheability
Â	Â	' 7
.
Â	Â	7 8
NoCache
Â	Â	8 ?
)
Â	Â	? @
Response
Ê	Ê	 
.
Ê	Ê	 
ContentType
Ê	Ê	 
=
Ê	Ê	 
contentType
Ê	Ê	 *
Response
Á	Á	 
.
Á	Á	 
AppendHeader
Á	Á	 
(
Á	Á	 
$str
Á	Á	 3
,
Á	Á	3 4
$str
Á	Á	5 L
&
Á	Á	M N
v_TipoReporte
Á	Á	O \
&
Á	Á	] ^
$str
Á	Á	_ b
&
Á	Á	c d
	extension
Á	Á	e n
)
Á	Á	n o
Response
Ë	Ë	 
.
Ë	Ë	 
BinaryWrite
Ë	Ë	 
(
Ë	Ë	 
bytes
Ë	Ë	 "
)
Ë	Ë	" #
Response
È	È	 
.
È	È	 
Flush
È	È	 
(
È	È	 
)
È	È	 
Response
Í	Í	 
.
Í	Í	 
End
Í	Í	 
(
Í	Í	 
)
Í	Í	 
End
Î	Î	 
Sub
Î	Î	 
Private
Ó	Ó	 
Sub
Ó	Ó	 
Exportar_Reporte
Ó	Ó	  
(
Ó	Ó	  !
ByVal
Ó	Ó	! &
FormatoReporte
Ó	Ó	' 5
As
Ó	Ó	6 8
String
Ó	Ó	9 ?
,
Ó	Ó	? @
ByVal
Ó	Ó	A F
v_TipoReporte
Ó	Ó	G T
As
Ó	Ó	U W
String
Ó	Ó	X ^
)
Ó	Ó	^ _
Dim
		 
vValor
		 
As
		 
String
		 
Dim
Ò	Ò	 
vBandera
Ò	Ò	 
As
Ò	Ò	 
String
Ò	Ò	 
vValor
Û	Û	 
=
Û	Û	 "
txt_ValorCodEmpleado
Û	Û	 %
.
Û	Û	% &
Text
Û	Û	& *
.
Û	Û	* +
Trim
Û	Û	+ /
vBandera
Ù	Ù	 
=
Ù	Ù	 
$str
Ù	Ù	 
If
˜	˜	 

v_TipoReporte
˜	˜	 
=
˜	˜	 
$str
˜	˜	 8
Then
˜	˜	9 =
Dim
˙	˙	 #
ds_Consulta_Reporte01
˙	˙	 %
As
˙	˙	& (
DataSet
˙	˙	) 0
=
˙	˙	1 2
cls_Metodos
˙	˙	3 >
.
˙	˙	> ?
BuscarPestamo
˙	˙	? L
(
˙	˙	L M
vValor
˙	˙	M S
,
˙	˙	S T
vBandera
˙	˙	U ]
)
˙	˙	] ^
Dim
˝	˝	 &
dts_HistorialPrestLector
˝	˝	 (
As
˝	˝	) +
New
˝	˝	, /&
dts_HistorialPrestLector
˝	˝	0 H
(
˝	˝	H I
)
˝	˝	I J
For
ˇ	ˇ	 
Each
ˇ	ˇ	 #
dr_Consulta_Reporte01
ˇ	ˇ	 *
As
ˇ	ˇ	+ -
DataRow
ˇ	ˇ	. 5
In
ˇ	ˇ	6 8#
ds_Consulta_Reporte01
ˇ	ˇ	9 N
.
ˇ	ˇ	N O
Tables
ˇ	ˇ	O U
(
ˇ	ˇ	U V
$num
ˇ	ˇ	V W
)
ˇ	ˇ	W X
.
ˇ	ˇ	X Y
Rows
ˇ	ˇ	Y ]&
dts_HistorialPrestLector
Ä
Ä
 (
.
Ä
Ä
( )
Tables
Ä
Ä
) /
(
Ä
Ä
/ 0
$num
Ä
Ä
0 1
)
Ä
Ä
1 2
.
Ä
Ä
2 3
Rows
Ä
Ä
3 7
.
Ä
Ä
7 8
Add
Ä
Ä
8 ;
(
Ä
Ä
; <#
dr_Consulta_Reporte01
Ä
Ä
< Q
.
Ä
Ä
Q R
	ItemArray
Ä
Ä
R [
)
Ä
Ä
[ \
Next
Å
Å
 

rv_General
É
É
 
.
É
É
 
ProcessingMode
É
É
 %
=
É
É
& '
ProcessingMode
É
É
( 6
.
É
É
6 7
Local
É
É
7 <

rv_General
Ñ
Ñ
 
.
Ñ
Ñ
 
LocalReport
Ñ
Ñ
 "
.
Ñ
Ñ
" #

ReportPath
Ñ
Ñ
# -
=
Ñ
Ñ
. /
Server
Ñ
Ñ
0 6
.
Ñ
Ñ
6 7
MapPath
Ñ
Ñ
7 >
(
Ñ
Ñ
> ?
$str
Ñ
Ñ
? L
&
Ñ
Ñ
M N
v_TipoReporte
Ñ
Ñ
O \
&
Ñ
Ñ
] ^
$str
Ñ
Ñ
_ f
)
Ñ
Ñ
f g
Dim
Ö
Ö
 
Movimiento_Rpt
Ö
Ö
 
As
Ö
Ö
 !
New
Ö
Ö
" %
ReportDataSource
Ö
Ö
& 6
(
Ö
Ö
6 7
$str
Ö
Ö
7 K
,
Ö
Ö
K L&
dts_HistorialPrestLector
Ö
Ö
M e
.
Ö
Ö
e f
Tables
Ö
Ö
f l
(
Ö
Ö
l m
$num
Ö
Ö
m n
)
Ö
Ö
n o
)
Ö
Ö
o p

rv_General
Ü
Ü
 
.
Ü
Ü
 
LocalReport
Ü
Ü
 "
.
Ü
Ü
" #
DataSources
Ü
Ü
# .
.
Ü
Ü
. /
Clear
Ü
Ü
/ 4
(
Ü
Ü
4 5
)
Ü
Ü
5 6

rv_General
á
á
 
.
á
á
 
LocalReport
á
á
 "
.
á
á
" #
DataSources
á
á
# .
.
á
á
. /
Add
á
á
/ 2
(
á
á
2 3
Movimiento_Rpt
á
á
3 A
)
á
á
A B
ElseIf
â
â
 
v_TipoReporte
â
â
 
=
â
â
 
$str
â
â
 <
Then
â
â
= A
v_TipoReporte
ä
ä
 
=
ä
ä
 
$str
ä
ä
 9
Else
ã
ã
 
lbl_validaLector1
å
å
 
.
å
å
 
	ForeColor
å
å
 '
=
å
å
( )
System
å
å
* 0
.
å
å
0 1
Drawing
å
å
1 8
.
å
å
8 9
Color
å
å
9 >
.
å
å
> ?
Red
å
å
? B
lbl_validaLector1
ç
ç
 
.
ç
ç
 
Text
ç
ç
 "
=
ç
ç
# $
$str
ç
ç
% S
Exit
é
é
 
Sub
é
é
 
End
è
è
 
If
è
è
 
Dim
í
í
 
warnings
í
í
 
As
í
í
 
Warning
í
í
 
(
í
í
  
)
í
í
  !
=
í
í
" #
Nothing
í
í
$ +
Dim
ì
ì
 
	streamids
ì
ì
 
As
ì
ì
 
String
ì
ì
 
(
ì
ì
  
)
ì
ì
  !
=
ì
ì
" #
Nothing
ì
ì
$ +
Dim
î
î
 
mimeType
î
î
 
As
î
î
 
String
î
î
 
=
î
î
  
Nothing
î
î
! (
Dim
ï
ï
 
contentType
ï
ï
 
As
ï
ï
 
String
ï
ï
 !
=
ï
ï
" #
Nothing
ï
ï
$ +
Dim
ñ
ñ
 
encoding
ñ
ñ
 
As
ñ
ñ
 
String
ñ
ñ
 
=
ñ
ñ
  
Nothing
ñ
ñ
! (
Dim
ó
ó
 
	extension
ó
ó
 
As
ó
ó
 
String
ó
ó
 
=
ó
ó
  !
Nothing
ó
ó
" )
Dim
ö
ö
 
bytes
ö
ö
 
As
ö
ö
 
Byte
ö
ö
 
(
ö
ö
 
)
ö
ö
 
=
ö
ö
 

rv_General
ö
ö
 (
.
ö
ö
( )
LocalReport
ö
ö
) 4
.
ö
ö
4 5
Render
ö
ö
5 ;
(
ö
ö
; <
FormatoReporte
ö
ö
< J
,
ö
ö
J K
Nothing
ö
ö
L S
,
ö
ö
S T
mimeType
ö
ö
U ]
,
ö
ö
] ^
contentType
ö
ö
_ j
,
ö
ö
j k
encoding
ö
ö
l t
,
ö
ö
t u
	extension
ö
ö
v 
,ö
ö
 Ä
	streamidsö
ö
Å ä
,ö
ö
ä ã
warningsö
ö
å î
)ö
ö
î ï
Response
ù
ù
 
.
ù
ù
 
Clear
ù
ù
 
(
ù
ù
 
)
ù
ù
 
Response
û
û
 
.
û
û
 
Buffer
û
û
 
=
û
û
 
True
û
û
 
Response
ü
ü
 
.
ü
ü
 
Charset
ü
ü
 
=
ü
ü
 
$str
ü
ü
 
Response
†
†
 
.
†
†
 
Cache
†
†
 
.
†
†
 
SetCacheability
†
†
 &
(
†
†
& '
HttpCacheability
†
†
' 7
.
†
†
7 8
NoCache
†
†
8 ?
)
†
†
? @
Response
°
°
 
.
°
°
 
ContentType
°
°
 
=
°
°
 
contentType
°
°
 *
Response
¢
¢
 
.
¢
¢
 
AppendHeader
¢
¢
 
(
¢
¢
 
$str
¢
¢
 3
,
¢
¢
3 4
$str
¢
¢
5 L
&
¢
¢
M N
v_TipoReporte
¢
¢
O \
&
¢
¢
] ^
$str
¢
¢
_ b
&
¢
¢
c d
	extension
¢
¢
e n
)
¢
¢
n o
Response
£
£
 
.
£
£
 
BinaryWrite
£
£
 
(
£
£
 
bytes
£
£
 "
)
£
£
" #
Response
§
§
 
.
§
§
 
Flush
§
§
 
(
§
§
 
)
§
§
 
Response
•
•
 
.
•
•
 
End
•
•
 
(
•
•
 
)
•
•
 
End
¶
¶
 
Sub
¶
¶
 
End©
©
 
Class
©
©
 	«
aC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\Global.asax.vb
Public 
Class 
Global_asax 
Inherits 
System 
. 
Web 
. 
HttpApplication '
Sub 
Application_Start 
( 
ByVal 
sender  &
As' )
Object* 0
,0 1
ByVal2 7
e8 9
As: <
	EventArgs= F
)F G
End 
Sub 
Sub

 
Session_Start

 
(

 
ByVal

 
sender

 "
As

# %
Object

& ,
,

, -
ByVal

. 3
e

4 5
As

6 8
	EventArgs

9 B
)

B C
End 
Sub 
Sub $
Application_BeginRequest  
(  !
ByVal! &
sender' -
As. 0
Object1 7
,7 8
ByVal9 >
e? @
AsA C
	EventArgsD M
)M N
End 
Sub 
Sub +
Application_AuthenticateRequest '
(' (
ByVal( -
sender. 4
As5 7
Object8 >
,> ?
ByVal@ E
eF G
AsH J
	EventArgsK T
)T U
End 
Sub 
Sub 
Application_Error 
( 
ByVal 
sender  &
As' )
Object* 0
,0 1
ByVal2 7
e8 9
As: <
	EventArgs= F
)F G
End 
Sub 
Sub 
Session_End 
( 
ByVal 
sender  
As! #
Object$ *
,* +
ByVal, 1
e2 3
As4 6
	EventArgs7 @
)@ A
End 
Sub 
Sub 
Application_End 
( 
ByVal 
sender $
As% '
Object( .
,. /
ByVal0 5
e6 7
As8 :
	EventArgs; D
)D E
End   
Sub   
End"" 
Class"" 	Õ&
aC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\Base.Master.vb
Public 
Class 
MasterInicio 
Inherits 
System 
. 
Web 
. 
UI 
. 

MasterPage %
	Protected 
Sub 
	Page_Load 
( 
ByVal !
sender" (
As) +
Object, 2
,2 3
ByVal4 9
e: ;
As< >
System? E
.E F
	EventArgsF O
)O P
HandlesQ X
MeY [
.[ \
Load\ `
If 

validarSesion 
( 
) 
Then 
Dim 
btn_menu 
= 
Session "
(" #
$str# )
)) *
If		 
btn_menu		 
=		 
$str		 ,
Then		- 1
frmPrestamoLibro

  
.

  !

Attributes

! +
.

+ ,
Add

, /
(

/ 0
$str

0 7
,

7 8
$str

9 J
)

J K
Session 
( 
$str %
)% &
=' (
$str) ,
ElseIf 
btn_menu 
= 
$str 1
Then2 6
frm_mantenimiento !
.! "

Attributes" ,
., -
Add- 0
(0 1
$str1 8
,8 9
$str: K
)K L
ElseIf 
btn_menu 
= 
$str ,
Then- 1
frm_reportes 
. 

Attributes '
.' (
Add( +
(+ ,
$str, 3
,3 4
$str5 F
)F G
ElseIf 
btn_menu 
= 
$str 1
Then2 6
frm_configuracion !
.! "

Attributes" ,
., -
Add- 0
(0 1
$str1 8
,8 9
$str: K
)K L
ElseIf 
btn_menu 
= 
$str ,
Then- 1
frm_contacto 
. 

Attributes '
.' (
Add( +
(+ ,
$str, 3
,3 4
$str5 F
)F G
End 
If 
lbl_WS_CodEmpl 
. 
Text 
=  !
Session" )
() *
$str* 9
)9 :
lbl_WS_UserAplic 
. 
Text !
=" #
Session$ +
(+ ,
$str, :
): ;!
lbl_WS_NombreCompleto !
.! "
Text" &
=' (
Session) 0
(0 1
$str1 ?
)? @
lbl_WS_Localidad 
. 
Text !
=" #
Session$ +
(+ ,
$str, :
): ;
Else 
Response 
. 
Write 
( 
$str	 â
)
â ä
End 
If 
End 
Sub 
Private!! 
Sub!!  
linkbtn_Inicio_Click!! $
(!!$ %
sender!!% +
As!!, .
Object!!/ 5
,!!5 6
e!!7 8
As!!9 ;
	EventArgs!!< E
)!!E F
Handles!!G N
linkbtn_Inicio!!O ]
.!!] ^
Click!!^ c
Try"" 
Response## 
.## 
Redirect## 
(## 
$str## /
)##/ 0
Catch$$ 
ex$$ 
As$$ 
	Exception$$ 
End%% 
Try%% 
End&& 
Sub&& 
	Protected)) 
Sub)) !
lnkcerrarSesion_Click)) '
())' (
ByVal))( -
sender)). 4
As))5 7
Object))8 >
,))> ?
ByVal))@ E
e))F G
As))H J
	EventArgs))K T
)))T U
Handles))V ]
lnkcerrarSesion))^ m
.))m n
Click))n s
CerrarSesion** 
(** 
)** 
Response++ 
.++ 
Write++ 
(++ 
$str++ O
)++O P
End,, 
Sub,, 
Sub.. 
CerrarSesion.. 
(.. 
).. 
Session// 
.// 
	RemoveAll// 
(// 
)// 
End00 
Sub00 
Public22 

Function22 
validarSesion22 !
(22! "
)22" #
As22$ &
Boolean22' .
If33 

Session33 
(33 
$str33 !
)33! "
Is33# %
Nothing33& -
Then33. 2
Return44 
False44 
End55 
If55 
Return66 
True66 
End77 
Function77 
End99 
Class99 	·
aC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\ModConexion.vb
Module 
ModConexion 
Public 

vConex_BDBiblioteca 
As !
String" (
=) *
$str+ 
Public 

vRutaPortada 
As 
String !
=" #
$str$ ?
Public 

	noPortada 
As 
String 
=  
$str! 3
Public 

tbLector_Externo 
As 
String %
=& '
$str( :
Public 

tbLibro 
As 
String 
= 
$str 6
Public 

tbLibro_ComprasReal 
As !
String" (
=) *
$str+ @
Public 

tbMovimientos 
As 
String "
=# $
$str% 6
End 
Module 
ˆ
mC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\My Project\AssemblyInfo.vb
<

 
Assembly

 	
:

	 

AssemblyTitle

 
(

 
$str

 *
)

* +
>

+ ,
< 
Assembly 	
:	 

AssemblyDescription 
( 
$str !
)! "
>" #
< 
Assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
> 
< 
Assembly 	
:	 

AssemblyProduct 
( 
$str ,
), -
>- .
< 
Assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
>1 2
< 
Assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
>  !
< 
Assembly 	
:	 


ComVisible 
( 
False 
) 
> 
< 
Assembly 	
:	 

Guid 
( 
$str 6
)6 7
>7 8
<!! 
Assembly!! 	
:!!	 

AssemblyVersion!! 
(!! 
$str!! $
)!!$ %
>!!% &
<"" 
Assembly"" 	
:""	 

AssemblyFileVersion"" 
("" 
$str"" (
)""( )
>"") *ö:
|C:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\My Project\MyExtensions\MyWebExtension.vb
	Namespace 	
My
 
< 
Global 
. 
	Microsoft 
. 
VisualBasic !
.! "
HideModuleName" 0
(0 1
)1 2
>2 3
Module		 

MyWebExtension		 
Private

 
ReadOnly

 

s_Computer

 #
As

$ &
New

' *$
ThreadSafeObjectProvider

+ C
(

C D
Of

D F
Global

G M
.

M N
	Microsoft

N W
.

W X
VisualBasic

X c
.

c d
Devices

d k
.

k l
ServerComputer

l z
)

z {
Private 
ReadOnly 
s_User 
As  "
New# &$
ThreadSafeObjectProvider' ?
(? @
Of@ B
GlobalC I
.I J
	MicrosoftJ S
.S T
VisualBasicT _
._ `
ApplicationServices` s
.s t
WebUsert {
){ |
Private 
ReadOnly 
s_Log 
As !
New" %$
ThreadSafeObjectProvider& >
(> ?
Of? A
GlobalB H
.H I
	MicrosoftI R
.R S
VisualBasicS ^
.^ _
Logging_ f
.f g
AspLogg m
)m n
< 	
Global	 
. 
System 
. 
Diagnostics "
." #
CodeAnalysis# /
./ 0$
SuppressMessageAttribute0 H
(H I
$strI `
,` a
$str	b É
)
É Ñ
>
Ñ Ö
Friend 
ReadOnly 
Property  
Computer! )
() *
)* +
As, .
Global/ 5
.5 6
	Microsoft6 ?
.? @
VisualBasic@ K
.K L
DevicesL S
.S T
ServerComputerT b
Get 
Return 

s_Computer !
.! "
GetInstance" -
(- .
). /
End 
Get 
End 
Property 
< 	
Global	 
. 
System 
. 
Diagnostics "
." #
CodeAnalysis# /
./ 0$
SuppressMessageAttribute0 H
(H I
$strI `
,` a
$str	b É
)
É Ñ
>
Ñ Ö
Friend 
ReadOnly 
Property  
User! %
(% &
)& '
As( *
Global+ 1
.1 2
	Microsoft2 ;
.; <
VisualBasic< G
.G H
ApplicationServicesH [
.[ \
WebUser\ c
Get 
Return 
s_User 
. 
GetInstance )
() *
)* +
End 
Get 
End 
Property 
<"" 	
Global""	 
."" 
System"" 
."" 
Diagnostics"" "
.""" #
CodeAnalysis""# /
.""/ 0$
SuppressMessageAttribute""0 H
(""H I
$str""I `
,""` a
$str	""b É
)
""É Ñ
>
""Ñ Ö
<## 	
Global##	 
.## 
System## 
.## 
ComponentModel## %
.##% &
Design##& ,
.##, -
HelpKeyword##- 8
(##8 9
$str##9 E
)##E F
>##F G
Friend$$ 
ReadOnly$$ 
Property$$  
Request$$! (
($$( )
)$$) *
As$$+ -
Global$$. 4
.$$4 5
System$$5 ;
.$$; <
Web$$< ?
.$$? @
HttpRequest$$@ K
<%% 
Global%% 
.%% 
System%% 
.%% 
Diagnostics%% &
.%%& '
DebuggerHidden%%' 5
(%%5 6
)%%6 7
>%%7 8
Get&& 
Dim'' 
CurrentContext'' "
As''# %
Global''& ,
.'', -
System''- 3
.''3 4
Web''4 7
.''7 8
HttpContext''8 C
=''D E
Global''F L
.''L M
System''M S
.''S T
Web''T W
.''W X
HttpContext''X c
.''c d
Current''d k
If(( 
CurrentContext(( !
IsNot((" '
Nothing((( /
Then((0 4
Return)) 
CurrentContext)) )
.))) *
Request))* 1
End** 
If** 
Return++ 
Nothing++ 
End,, 
Get,, 
End-- 
Property-- 
<11 	
Global11	 
.11 
System11 
.11 
Diagnostics11 "
.11" #
CodeAnalysis11# /
.11/ 0$
SuppressMessageAttribute110 H
(11H I
$str11I `
,11` a
$str	11b É
)
11É Ñ
>
11Ñ Ö
<22	 

Global22
 
.22 
System22 
.22 
ComponentModel22 &
.22& '
Design22' -
.22- .
HelpKeyword22. 9
(229 :
$str22: G
)22G H
>22H I
Friend33	 
ReadOnly33 
Property33 !
Response33" *
(33* +
)33+ ,
As33- /
Global330 6
.336 7
System337 =
.33= >
Web33> A
.33A B
HttpResponse33B N
<44 
Global44 
.44 
System44 
.44 
Diagnostics44 &
.44& '
DebuggerHidden44' 5
(445 6
)446 7
>447 8
Get55 
Dim66 
CurrentContext66 "
As66# %
Global66& ,
.66, -
System66- 3
.663 4
Web664 7
.667 8
HttpContext668 C
=66D E
Global66F L
.66L M
System66M S
.66S T
Web66T W
.66W X
HttpContext66X c
.66c d
Current66d k
If77 
CurrentContext77 !
IsNot77" '
Nothing77( /
Then770 4
Return88 
CurrentContext88 )
.88) *
Response88* 2
End99 
If99 
Return:: 
Nothing:: 
End;; 
Get;; 
End<< 
Property<< 
<@@ 	
Global@@	 
.@@ 
System@@ 
.@@ 
Diagnostics@@ "
.@@" #
CodeAnalysis@@# /
.@@/ 0$
SuppressMessageAttribute@@0 H
(@@H I
$str@@I `
,@@` a
$str	@@b É
)
@@É Ñ
>
@@Ñ Ö
FriendAA 
ReadOnlyAA 
PropertyAA  
LogAA! $
(AA$ %
)AA% &
AsAA' )
GlobalAA* 0
.AA0 1
	MicrosoftAA1 :
.AA: ;
VisualBasicAA; F
.AAF G
LoggingAAG N
.AAN O
AspLogAAO U
GetBB 
ReturnCC 
s_LogCC 
.CC 
GetInstanceCC (
(CC( )
)CC) *
EndDD 
GetDD 
EndEE 
PropertyEE 
EndFF 
ModuleFF	 
EndGG 
	NamespaceGG  Ö
eC:\Users\alex1\Documents\BIBL\16-08-23\ROJO\sln_BIBL_Mantenimiento\Biblioteca_Mant\frm_inicio.aspx.vb
Public 
Class 
WebForm2 
Inherits 
System 
. 
Web 
. 
UI 
. 
Page 
	Protected 
Sub 
	Page_Load 
( 
ByVal !
sender" (
As) +
Object, 2
,2 3
ByVal4 9
e: ;
As< >
System? E
.E F
	EventArgsF O
)O P
HandlesQ X
MeY [
.[ \
Load\ `
If 

f_validarSesion 
( 
) 
= 
True #
Then$ (
If 
Not 
Page 
. 

IsPostBack "
Then# '
Try 
CargarPrestamos #
(# $
)$ %
CargarReservas "
(" #
)# $

CargaLista 
( 
)  
fs_grvReservas "
." #
Visible# *
=+ ,
False- 2
fs_grvPrestamos #
.# $
Visible$ +
=, -
False. 3
Catch 
ex 
As 
	Exception %

lbl_valida 
. 
Text #
=$ %
ex& (
.( )
Message) 0

lbl_valida 
. 
Visible &
=' (
True) -

lbl_valida 
. 
	ForeColor (
=) *
System+ 1
.1 2
Drawing2 9
.9 :
Color: ?
.? @
Red@ C
End 
Try 
End 
If 
Else 
Session 
( 
$str 
) 
= 
$str  #
Response 
. 
Redirect 
( 
$str m
)m n
End 
If 
End 
Sub 
Public!! 

Function!! 
f_validarSesion!! #
(!!# $
)!!$ %
As!!& (
Boolean!!) 0
If## 

Session## 
(## 
$str## !
)##! "
Is### %
Nothing##& -
Then##. 2
Return$$ 
False$$ 
End%% 
If%% 
Return&& 
True&& 
End'' 
Function'' 
Private++ 
Sub++ 

CargaLista++ 
(++ 
)++ 
gdv_Lista_Reservas,, 
.,, 

DataSource,, %
=,,& '
cls_Metodos,,( 3
.,,3 4
Reservas,,4 <
(,,< =
$str,,= @
),,@ A
gdv_Lista_Reservas-- 
.-- 
DataBind-- #
(--# $
)--$ %
gdv_Lista_Prestamos.. 
... 

DataSource.. &
=..' (
cls_Metodos..) 4
...4 5
PrestamosPendientes..5 H
(..H I
$str..I L
)..L M
gdv_Lista_Prestamos// 
.// 
DataBind// $
(//$ %
)//% &
End00 
Sub00 
Private;; 
Sub;; 
CargarPrestamos;; 
(;;  
);;  !
Dim<< 
ds<< 
As<< 
	DataTable<< 
=<< 
cls_Metodos<< )
.<<) *
PrestamosPendientes<<* =
(<<= >
$str<<> A
)<<A B
.<<B C
Tables<<C I
(<<I J
$num<<J K
)<<K L
Dim== 
	vCantidad== 
As== 
String== 
===  !
Val==" %
(==% &
ds==& (
.==( )
Rows==) -
(==- .
$num==. /
)==/ 0
(==0 1
$str==1 9
)==9 :
)==: ;
.==; <
ToString==< D
(==D E
)==E F
btn_prestamos?? 
.?? 
Text?? 
=?? 
	vCantidad?? &
End@@ 
Sub@@ 
PrivateBB 
SubBB 
CargarReservasBB 
(BB 
)BB  
DimCC 
dsCC 
AsCC 
	DataTableCC 
=CC 
cls_MetodosCC )
.CC) *
ReservasCC* 2
(CC2 3
$strCC3 6
)CC6 7
.CC7 8
TablesCC8 >
(CC> ?
$numCC? @
)CC@ A
DimDD 
	vCantidadDD 
AsDD 
StringDD 
=DD  !
ValDD" %
(DD% &
dsDD& (
.DD( )
RowsDD) -
(DD- .
$numDD. /
)DD/ 0
(DD0 1
$strDD1 9
)DD9 :
)DD: ;
.DD; <
ToStringDD< D
(DDD E
)DDE F
btn_reservasFF 
.FF 
TextFF 
=FF 
	vCantidadFF %
EndGG 
SubGG 
	ProtectedRR 
SubRR .
"gdv_Lista_Prestamos_OnRowDataBoundRR 4
(RR4 5
ByValRR5 :
senderRR; A
AsRRB D
ObjectRRE K
,RRK L
ByValRRM R
eRRS T
AsRRU W 
GridViewRowEventArgsRRX l
)RRl m
TrySS 
IfTT 
eTT 
.TT 
RowTT 
.TT 
RowTypeTT 
=TT 
DataControlRowTypeTT 1
.TT1 2
DataRowTT2 9
ThenTT: >
DimUU 
drUU 
AsUU 
DataRowViewUU %
=UU& '
CTypeUU( -
(UU- .
eUU. /
.UU/ 0
RowUU0 3
.UU3 4
DataItemUU4 <
,UU< =
DataRowViewUU> I
)UUI J
DimWW 
c_cFechaPrestamoWW $
AsWW% '
StringWW( .
IfXX 
NotXX 
IsDBNullXX 
(XX  
drXX  "
(XX" #
$strXX# 5
)XX5 6
)XX6 7
ThenXX8 <
c_cFechaPrestamoYY $
=YY% &
drYY' )
(YY) *
$strYY* <
)YY< =
ElseZZ 
c_cFechaPrestamo[[ $
=[[% &
$str[[' 1
End\\ 
If\\ 
Dim^^ 
c_cFechaDevolucion^^ &
As^^' )
String^^* 0
If__ 
Not__ 
IsDBNull__ 
(__  
dr__  "
(__" #
$str__# 9
)__9 :
)__: ;
Then__< @
c_cFechaDevolucion`` &
=``' (
dr``) +
(``+ ,
$str``, B
)``B C
Elseaa 
c_cFechaDevolucionbb &
=bb' (
$strbb) 3
Endcc 
Ifcc 
Dimee 
c_cLectorNombreee #
Asee$ &
Stringee' -
Ifff 
Notff 
IsDBNullff 
(ff  
drff  "
(ff" #
$strff# 3
)ff3 4
)ff4 5
Thenff6 :
c_cLectorNombregg #
=gg$ %
drgg& (
(gg( )
$strgg) 9
)gg9 :
Elsehh 
c_cLectorNombreii #
=ii$ %
$strii& )
Endjj 
Ifjj 
Dimll  
c_cLectorCodEmpleadoll (
Asll) +
Stringll, 2
Ifmm 
Notmm 
IsDBNullmm 
(mm  
drmm  "
(mm" #
$strmm# 8
)mm8 9
)mm9 :
Thenmm; ? 
c_cLectorCodEmpleadonn (
=nn) *
drnn+ -
(nn- .
$strnn. C
)nnC D
Elseoo  
c_cLectorCodEmpleadopp (
=pp) *
$strpp+ .
Endqq 
Ifqq 
Dimtt 
c_cLibroTitulott "
Astt# %
Stringtt& ,
Ifuu 
Notuu 
IsDBNulluu 
(uu  
druu  "
(uu" #
$struu# 2
)uu2 3
)uu3 4
Thenuu5 9
c_cLibroTitulovv "
=vv# $
drvv% '
(vv' (
$strvv( 7
)vv7 8
Elseww 
c_cLibroTituloxx "
=xx# $
$strxx% (
Endyy 
Ifyy 
Dim{{ $
c_cLibroCodClasificacion{{ ,
As{{- /
String{{0 6
If|| 
Not|| 
IsDBNull|| 
(||  
dr||  "
(||" #
$str||# <
)||< =
)||= >
Then||? C$
c_cLibroCodClasificacion}} ,
=}}- .
dr}}/ 1
(}}1 2
$str}}2 K
)}}K L
Else~~ $
c_cLibroCodClasificacion ,
=- .
$str/ 2
End
ÄÄ 
If
ÄÄ 
Dim
ÇÇ !
c_cLibroCodNumerico
ÇÇ '
As
ÇÇ( *
String
ÇÇ+ 1
If
ÉÉ 
Not
ÉÉ 
IsDBNull
ÉÉ 
(
ÉÉ  
dr
ÉÉ  "
(
ÉÉ" #
$str
ÉÉ# 7
)
ÉÉ7 8
)
ÉÉ8 9
Then
ÉÉ: >!
c_cLibroCodNumerico
ÑÑ '
=
ÑÑ( )
dr
ÑÑ* ,
(
ÑÑ, -
$str
ÑÑ- A
)
ÑÑA B
Else
ÖÖ !
c_cLibroCodNumerico
ÜÜ '
=
ÜÜ( )
$str
ÜÜ* -
End
áá 
If
áá 
CType
ââ 
(
ââ 
e
ââ 
.
ââ 
Row
ââ 
.
ââ 
FindControl
ââ '
(
ââ' (
$str
ââ( :
)
ââ: ;
,
ââ; <
WebControls
ââ= H
.
ââH I
Label
ââI N
)
ââN O
.
ââO P
Text
ââP T
=
ââU V
c_cLectorNombre
ââW f
CType
ää 
(
ää 
e
ää 
.
ää 
Row
ää 
.
ää 
FindControl
ää '
(
ää' (
$str
ää( 9
)
ää9 :
,
ää: ;
WebControls
ää< G
.
ääG H
Label
ääH M
)
ääM N
.
ääN O
Text
ääO S
=
ääT U"
c_cLectorCodEmpleado
ääV j
CType
ãã 
(
ãã 
e
ãã 
.
ãã 
Row
ãã 
.
ãã 
FindControl
ãã '
(
ãã' (
$str
ãã( 9
)
ãã9 :
,
ãã: ;
WebControls
ãã< G
.
ããG H
Label
ããH M
)
ããM N
.
ããN O
Text
ããO S
=
ããT U
c_cLibroTitulo
ããV d
CType
åå 
(
åå 
e
åå 
.
åå 
Row
åå 
.
åå 
FindControl
åå '
(
åå' (
$str
åå( >
)
åå> ?
,
åå? @
WebControls
ååA L
.
ååL M
Label
ååM R
)
ååR S
.
ååS T
Text
ååT X
=
ååY Z&
c_cLibroCodClasificacion
åå[ s
CType
çç 
(
çç 
e
çç 
.
çç 
Row
çç 
.
çç 
FindControl
çç '
(
çç' (
$str
çç( 9
)
çç9 :
,
çç: ;
WebControls
çç< G
.
ççG H
Label
ççH M
)
ççM N
.
ççN O
Text
ççO S
=
ççT U!
c_cLibroCodNumerico
ççV i
CType
éé 
(
éé 
e
éé 
.
éé 
Row
éé 
.
éé 
FindControl
éé '
(
éé' (
$str
éé( ;
)
éé; <
,
éé< =
WebControls
éé> I
.
ééI J
Label
ééJ O
)
ééO P
.
ééP Q
Text
ééQ U
=
ééV W
c_cFechaPrestamo
ééX h
CType
èè 
(
èè 
e
èè 
.
èè 
Row
èè 
.
èè 
FindControl
èè '
(
èè' (
$str
èè( =
)
èè= >
,
èè> ?
WebControls
èè@ K
.
èèK L
Label
èèL Q
)
èèQ R
.
èèR S
Text
èèS W
=
èèX Y 
c_cFechaDevolucion
èèZ l
End
êê 
If
êê 
Catch
ëë 
ex
ëë 
As
ëë 
	Exception
ëë 

lbl_valida
ìì 
.
ìì 
Text
ìì 
=
ìì 
ex
ìì  
.
ìì  !
Message
ìì! (

lbl_valida
îî 
.
îî 
Visible
îî 
=
îî  
True
îî! %

lbl_valida
ïï 
.
ïï 
	ForeColor
ïï  
=
ïï! "
System
ïï# )
.
ïï) *
Drawing
ïï* 1
.
ïï1 2
Color
ïï2 7
.
ïï7 8
Red
ïï8 ;
End
ññ 
Try
ññ 
End
óó 
Sub
óó 
	Protected
öö 
Sub
öö 3
%gdv_Lista_Prestamos_PageIndexChanging
öö 7
(
öö7 8
ByVal
öö8 =
sender
öö> D
As
ööE G
Object
ööH N
,
ööN O
ByVal
ööP U
e
ööV W
As
ööX Z
System
öö[ a
.
ööa b
Web
ööb e
.
ööe f
UI
ööf h
.
ööh i
WebControls
ööi t
.
ööt u$
GridViewPageEventArgsööu ä
)ööä ã
Handlesööå ì#
gdv_Lista_Prestamosööî ß
.ööß ®!
PageIndexChangingöö® π
Try
õõ !
gdv_Lista_Prestamos
ùù 
.
ùù  
	PageIndex
ùù  )
=
ùù* +
e
ùù, -
.
ùù- .
NewPageIndex
ùù. :

CargaLista
ûû 
(
ûû 
)
ûû 
Catch
°° 
ex
°° 
As
°° 
	Exception
°° 

lbl_valida
££ 
.
££ 
Text
££ 
=
££ 
ex
££  
.
££  !
Message
££! (

lbl_valida
§§ 
.
§§ 
Visible
§§ 
=
§§  
True
§§! %

lbl_valida
•• 
.
•• 
	ForeColor
••  
=
••! "
System
••# )
.
••) *
Drawing
••* 1
.
••1 2
Color
••2 7
.
••7 8
Red
••8 ;
End
¶¶ 
Try
¶¶ 
End
ßß 
Sub
ßß 
	Protected
™™ 
Sub
™™ /
!gdv_Lista_Reservas_OnRowDataBound
™™ 3
(
™™3 4
ByVal
™™4 9
sender
™™: @
As
™™A C
Object
™™D J
,
™™J K
ByVal
™™L Q
e
™™R S
As
™™T V"
GridViewRowEventArgs
™™W k
)
™™k l
Try
´´ 
If
¨¨ 
e
¨¨ 
.
¨¨ 
Row
¨¨ 
.
¨¨ 
RowType
¨¨ 
=
¨¨  
DataControlRowType
¨¨ 1
.
¨¨1 2
DataRow
¨¨2 9
Then
¨¨: >
Dim
≠≠ 
dr
≠≠ 
As
≠≠ 
DataRowView
≠≠ %
=
≠≠& '
CType
≠≠( -
(
≠≠- .
e
≠≠. /
.
≠≠/ 0
Row
≠≠0 3
.
≠≠3 4
DataItem
≠≠4 <
,
≠≠< =
DataRowView
≠≠> I
)
≠≠I J
Dim
ØØ 
c_cFechaReserva
ØØ #
As
ØØ$ &
String
ØØ' -
If
∞∞ 
Not
∞∞ 
IsDBNull
∞∞ 
(
∞∞  
dr
∞∞  "
(
∞∞" #
$str
∞∞# 6
)
∞∞6 7
)
∞∞7 8
Then
∞∞9 =
c_cFechaReserva
±± #
=
±±$ %
dr
±±& (
(
±±( )
$str
±±) <
)
±±< =
Else
≤≤ 
c_cFechaReserva
≥≥ #
=
≥≥$ %
$str
≥≥& 0
End
¥¥ 
If
¥¥ 
Dim
ΩΩ 
c_cIdPrestamo
ΩΩ !
As
ΩΩ" $
String
ΩΩ% +
If
ææ 
Not
ææ 
IsDBNull
ææ 
(
ææ  
dr
ææ  "
(
ææ" #
$str
ææ# 1
)
ææ1 2
)
ææ2 3
Then
ææ4 8
c_cIdPrestamo
øø !
=
øø" #
dr
øø$ &
(
øø& '
$str
øø' 5
)
øø5 6
Else
¿¿ 
c_cIdPrestamo
¡¡ !
=
¡¡" #
$str
¡¡$ '
End
¬¬ 
If
¬¬ 
Dim
ƒƒ 
c_cLectorCod
ƒƒ  
As
ƒƒ! #
String
ƒƒ$ *
If
≈≈ 
Not
≈≈ 
IsDBNull
≈≈ 
(
≈≈  
dr
≈≈  "
(
≈≈" #
$str
≈≈# 8
)
≈≈8 9
)
≈≈9 :
Then
≈≈; ?
c_cLectorCod
∆∆  
=
∆∆! "
dr
∆∆# %
(
∆∆% &
$str
∆∆& ;
)
∆∆; <
Else
«« 
c_cLectorCod
»»  
=
»»! "
$str
»»# &
End
…… 
If
…… 
Dim
ÀÀ 
c_cLectorNombre
ÀÀ #
As
ÀÀ$ &
String
ÀÀ' -
If
ÃÃ 
Not
ÃÃ 
IsDBNull
ÃÃ 
(
ÃÃ  
dr
ÃÃ  "
(
ÃÃ" #
$str
ÃÃ# 3
)
ÃÃ3 4
)
ÃÃ4 5
Then
ÃÃ6 :
c_cLectorNombre
ÕÕ #
=
ÕÕ$ %
dr
ÕÕ& (
(
ÕÕ( )
$str
ÕÕ) 9
)
ÕÕ9 :
Else
ŒŒ 
c_cLectorNombre
œœ #
=
œœ$ %
$str
œœ& )
End
–– 
If
–– 
Dim
““ 

c_cOficina
““ 
As
““ !
String
““" (
If
”” 
Not
”” 
IsDBNull
”” 
(
””  
dr
””  "
(
””" #
$str
””# 8
)
””8 9
)
””9 :
Then
””; ?

c_cOficina
‘‘ 
=
‘‘  
dr
‘‘! #
(
‘‘# $
$str
‘‘$ 9
)
‘‘9 :
Else
’’ 

c_cOficina
÷÷ 
=
÷÷  
$str
÷÷! $
End
◊◊ 
If
◊◊ 
Dim
ŸŸ 
c_cAnexo
ŸŸ 
As
ŸŸ 
String
ŸŸ  &
If
⁄⁄ 
Not
⁄⁄ 
IsDBNull
⁄⁄ 
(
⁄⁄  
dr
⁄⁄  "
(
⁄⁄" #
$str
⁄⁄# 4
)
⁄⁄4 5
)
⁄⁄5 6
Then
⁄⁄7 ;
c_cAnexo
€€ 
=
€€ 
dr
€€ !
(
€€! "
$str
€€" 3
)
€€3 4
Else
‹‹ 
c_cAnexo
›› 
=
›› 
$str
›› "
End
ﬁﬁ 
If
ﬁﬁ 
Dim
‡‡ 
c_cLibroTitulo
‡‡ "
As
‡‡# %
String
‡‡& ,
If
·· 
Not
·· 
IsDBNull
·· 
(
··  
dr
··  "
(
··" #
$str
··# 2
)
··2 3
)
··3 4
Then
··5 9
c_cLibroTitulo
‚‚ "
=
‚‚# $
dr
‚‚% '
(
‚‚' (
$str
‚‚( 7
)
‚‚7 8
Else
„„ 
c_cLibroTitulo
‰‰ "
=
‰‰# $
$str
‰‰% (
End
ÂÂ 
If
ÂÂ 
Dim
ÈÈ !
c_cLibroCodNumerico
ÈÈ '
As
ÈÈ( *
String
ÈÈ+ 1
If
ÍÍ 
Not
ÍÍ 
IsDBNull
ÍÍ 
(
ÍÍ  
dr
ÍÍ  "
(
ÍÍ" #
$str
ÍÍ# 7
)
ÍÍ7 8
)
ÍÍ8 9
Then
ÍÍ: >!
c_cLibroCodNumerico
ÎÎ '
=
ÎÎ( )
dr
ÎÎ* ,
(
ÎÎ, -
$str
ÎÎ- A
)
ÎÎA B
Else
ÏÏ !
c_cLibroCodNumerico
ÌÌ '
=
ÌÌ( )
$str
ÌÌ* -
End
ÓÓ 
If
ÓÓ 
Dim
 &
c_cLibroCodClasificacion
 ,
As
- /
String
0 6
If
ÒÒ 
Not
ÒÒ 
IsDBNull
ÒÒ 
(
ÒÒ  
dr
ÒÒ  "
(
ÒÒ" #
$str
ÒÒ# <
)
ÒÒ< =
)
ÒÒ= >
Then
ÒÒ? C&
c_cLibroCodClasificacion
ÚÚ ,
=
ÚÚ- .
dr
ÚÚ/ 1
(
ÚÚ1 2
$str
ÚÚ2 K
)
ÚÚK L
Else
ÛÛ &
c_cLibroCodClasificacion
ÙÙ ,
=
ÙÙ- .
$str
ÙÙ/ 2
End
ıı 
If
ıı 
Dim
˜˜ 

c_cUsuario
˜˜ 
As
˜˜ !
String
˜˜" (
If
¯¯ 
Not
¯¯ 
IsDBNull
¯¯ 
(
¯¯  
dr
¯¯  "
(
¯¯" #
$str
¯¯# 4
)
¯¯4 5
)
¯¯5 6
Then
¯¯7 ;

c_cUsuario
˘˘ 
=
˘˘  
dr
˘˘! #
(
˘˘# $
$str
˘˘$ 5
)
˘˘5 6
Else
˙˙ 

c_cUsuario
˚˚ 
=
˚˚  
$str
˚˚! $
End
¸¸ 
If
¸¸ 
CType
˛˛ 
(
˛˛ 
e
˛˛ 
.
˛˛ 
Row
˛˛ 
.
˛˛ 
FindControl
˛˛ '
(
˛˛' (
$str
˛˛( 7
)
˛˛7 8
,
˛˛8 9
WebControls
˛˛: E
.
˛˛E F
Label
˛˛F K
)
˛˛K L
.
˛˛L M
Text
˛˛M Q
=
˛˛R S
c_cLectorCod
˛˛T `
CType
ˇˇ 
(
ˇˇ 
e
ˇˇ 
.
ˇˇ 
Row
ˇˇ 
.
ˇˇ 
FindControl
ˇˇ '
(
ˇˇ' (
$str
ˇˇ( :
)
ˇˇ: ;
,
ˇˇ; <
WebControls
ˇˇ= H
.
ˇˇH I
Label
ˇˇI N
)
ˇˇN O
.
ˇˇO P
Text
ˇˇP T
=
ˇˇU V
c_cLectorNombre
ˇˇW f
CType
ÄÄ 
(
ÄÄ 
e
ÄÄ 
.
ÄÄ 
Row
ÄÄ 
.
ÄÄ 
FindControl
ÄÄ '
(
ÄÄ' (
$str
ÄÄ( 5
)
ÄÄ5 6
,
ÄÄ6 7
WebControls
ÄÄ8 C
.
ÄÄC D
Label
ÄÄD I
)
ÄÄI J
.
ÄÄJ K
Text
ÄÄK O
=
ÄÄP Q

c_cOficina
ÄÄR \
CType
ÅÅ 
(
ÅÅ 
e
ÅÅ 
.
ÅÅ 
Row
ÅÅ 
.
ÅÅ 
FindControl
ÅÅ '
(
ÅÅ' (
$str
ÅÅ( 3
)
ÅÅ3 4
,
ÅÅ4 5
WebControls
ÅÅ6 A
.
ÅÅA B
Label
ÅÅB G
)
ÅÅG H
.
ÅÅH I
Text
ÅÅI M
=
ÅÅN O
c_cAnexo
ÅÅP X
CType
ÇÇ 
(
ÇÇ 
e
ÇÇ 
.
ÇÇ 
Row
ÇÇ 
.
ÇÇ 
FindControl
ÇÇ '
(
ÇÇ' (
$str
ÇÇ( 9
)
ÇÇ9 :
,
ÇÇ: ;
WebControls
ÇÇ< G
.
ÇÇG H
Label
ÇÇH M
)
ÇÇM N
.
ÇÇN O
Text
ÇÇO S
=
ÇÇT U
c_cLibroTitulo
ÇÇV d
CType
ÉÉ 
(
ÉÉ 
e
ÉÉ 
.
ÉÉ 
Row
ÉÉ 
.
ÉÉ 
FindControl
ÉÉ '
(
ÉÉ' (
$str
ÉÉ( 9
)
ÉÉ9 :
,
ÉÉ: ;
WebControls
ÉÉ< G
.
ÉÉG H
Label
ÉÉH M
)
ÉÉM N
.
ÉÉN O
Text
ÉÉO S
=
ÉÉT U!
c_cLibroCodNumerico
ÉÉV i
CType
ÑÑ 
(
ÑÑ 
e
ÑÑ 
.
ÑÑ 
Row
ÑÑ 
.
ÑÑ 
FindControl
ÑÑ '
(
ÑÑ' (
$str
ÑÑ( >
)
ÑÑ> ?
,
ÑÑ? @
WebControls
ÑÑA L
.
ÑÑL M
Label
ÑÑM R
)
ÑÑR S
.
ÑÑS T
Text
ÑÑT X
=
ÑÑY Z&
c_cLibroCodClasificacion
ÑÑ[ s
CType
ÖÖ 
(
ÖÖ 
e
ÖÖ 
.
ÖÖ 
Row
ÖÖ 
.
ÖÖ 
FindControl
ÖÖ '
(
ÖÖ' (
$str
ÖÖ( 8
)
ÖÖ8 9
,
ÖÖ9 :
WebControls
ÖÖ; F
.
ÖÖF G
Label
ÖÖG L
)
ÖÖL M
.
ÖÖM N
Text
ÖÖN R
=
ÖÖS T
c_cIdPrestamo
ÖÖU b
CType
ÜÜ 
(
ÜÜ 
e
ÜÜ 
.
ÜÜ 
Row
ÜÜ 
.
ÜÜ 
FindControl
ÜÜ '
(
ÜÜ' (
$str
ÜÜ( :
)
ÜÜ: ;
,
ÜÜ; <
WebControls
ÜÜ= H
.
ÜÜH I
Label
ÜÜI N
)
ÜÜN O
.
ÜÜO P
Text
ÜÜP T
=
ÜÜU V
c_cFechaReserva
ÜÜW f
CType
áá 
(
áá 
e
áá 
.
áá 
Row
áá 
.
áá 
FindControl
áá '
(
áá' (
$str
áá( 9
)
áá9 :
,
áá: ;
WebControls
áá< G
.
ááG H
Label
ááH M
)
ááM N
.
ááN O
Text
ááO S
=
ááT U

c_cUsuario
ááV `
End
çç 
If
çç 
Catch
éé 
ex
éé 
As
éé 
	Exception
éé 
End
ìì 
Try
ìì 
End
îî 
Sub
îî 
	Protected
óó 
Sub
óó 2
$gdv_Lista_Reservas_PageIndexChanging
óó 6
(
óó6 7
ByVal
óó7 <
sender
óó= C
As
óóD F
Object
óóG M
,
óóM N
ByVal
óóO T
e
óóU V
As
óóW Y
System
óóZ `
.
óó` a
Web
óóa d
.
óód e
UI
óóe g
.
óóg h
WebControls
óóh s
.
óós t$
GridViewPageEventArgsóót â
)óóâ ä
Handlesóóã í"
gdv_Lista_Reservasóóì •
.óó• ¶!
PageIndexChangingóó¶ ∑
Try
òò  
gdv_Lista_Reservas
öö 
.
öö 
	PageIndex
öö (
=
öö) *
e
öö+ ,
.
öö, -
NewPageIndex
öö- 9

CargaLista
õõ 
(
õõ 
)
õõ 
Catch
ûû 
ex
ûû 
As
ûû 
	Exception
ûû 
End
££ 
Try
££ 
End
§§ 
Sub
§§ 
	Protected
®® 
Sub
®® /
!grv_Prestamo_SelectedIndexChanged
®® 3
(
®®3 4
sender
®®4 :
As
®®; =
Object
®®> D
,
®®D E
e
®®F G
As
®®H J
	EventArgs
®®K T
)
®®T U
Handles
®®V ] 
gdv_Lista_Reservas
®®^ p
.
®®p q#
SelectedIndexChanged®®q Ö
Try
©© 
Dim
™™ 
v_codPrestamo
™™ 
As
™™  
String
™™! '
=
™™( )
TryCast
™™* 1
(
™™1 2 
gdv_Lista_Reservas
™™2 D
.
™™D E
SelectedRow
™™E P
.
™™P Q
FindControl
™™Q \
(
™™\ ]
$str
™™] m
)
™™m n
,
™™n o
Label
™™p u
)
™™u v
.
™™v w
Text
™™w {
Dim
´´ 
v_RcodEmpleado
´´ 
As
´´ !
String
´´" (
=
´´) *
TryCast
´´+ 2
(
´´2 3 
gdv_Lista_Reservas
´´3 E
.
´´E F
SelectedRow
´´F Q
.
´´Q R
FindControl
´´R ]
(
´´] ^
$str
´´^ m
)
´´m n
,
´´n o
Label
´´p u
)
´´u v
.
´´v w
Text
´´w {
Dim
¨¨ 
v_RnombreEmpleado
¨¨ !
As
¨¨" $
String
¨¨% +
=
¨¨, -
TryCast
¨¨. 5
(
¨¨5 6 
gdv_Lista_Reservas
¨¨6 H
.
¨¨H I
SelectedRow
¨¨I T
.
¨¨T U
FindControl
¨¨U `
(
¨¨` a
$str
¨¨a s
)
¨¨s t
,
¨¨t u
Label
¨¨v {
)
¨¨{ |
.
¨¨| }
Text¨¨} Å
Dim
≠≠ 
v_RcodRegistro
≠≠ 
As
≠≠ !
String
≠≠" (
=
≠≠) *
TryCast
≠≠+ 2
(
≠≠2 3 
gdv_Lista_Reservas
≠≠3 E
.
≠≠E F
SelectedRow
≠≠F Q
.
≠≠Q R
FindControl
≠≠R ]
(
≠≠] ^
$str
≠≠^ o
)
≠≠o p
,
≠≠p q
Label
≠≠r w
)
≠≠w x
.
≠≠x y
Text
≠≠y }
Dim
ÆÆ 
v_RtituloLibro
ÆÆ 
As
ÆÆ !
String
ÆÆ" (
=
ÆÆ) *
TryCast
ÆÆ+ 2
(
ÆÆ2 3 
gdv_Lista_Reservas
ÆÆ3 E
.
ÆÆE F
SelectedRow
ÆÆF Q
.
ÆÆQ R
FindControl
ÆÆR ]
(
ÆÆ] ^
$str
ÆÆ^ o
)
ÆÆo p
,
ÆÆp q
Label
ÆÆr w
)
ÆÆw x
.
ÆÆx y
Text
ÆÆy }
Dim
ØØ 
v_Rfechareserva
ØØ 
As
ØØ  "
String
ØØ# )
=
ØØ* +
TryCast
ØØ, 3
(
ØØ3 4 
gdv_Lista_Reservas
ØØ4 F
.
ØØF G
SelectedRow
ØØG R
.
ØØR S
FindControl
ØØS ^
(
ØØ^ _
$str
ØØ_ q
)
ØØq r
,
ØØr s
Label
ØØt y
)
ØØy z
.
ØØz {
Text
ØØ{ 
Session
≤≤ 
(
≤≤ 
$str
≤≤ !
)
≤≤! "
=
≤≤# $
$str
≤≤% (
Session
≥≥ 
(
≥≥ 
$str
≥≥ $
)
≥≥$ %
=
≥≥& '
v_codPrestamo
≥≥( 5
Session
¥¥ 
(
¥¥ 
$str
¥¥ )
)
¥¥) *
=
¥¥+ ,
v_RcodEmpleado
¥¥- ;
Session
µµ 
(
µµ 
$str
µµ )
)
µµ) *
=
µµ+ ,
v_RnombreEmpleado
µµ- >
Session
∂∂ 
(
∂∂ 
$str
∂∂ *
)
∂∂* +
=
∂∂, -
v_RcodRegistro
∂∂. <
Session
∑∑ 
(
∑∑ 
$str
∑∑ +
)
∑∑+ ,
=
∑∑- .
v_RtituloLibro
∑∑/ =
Session
∏∏ 
(
∏∏ 
$str
∏∏ ,
)
∏∏, -
=
∏∏. /
v_Rfechareserva
∏∏0 ?
Response
ªª 
.
ªª 
Redirect
ªª 
(
ªª 
$str
ªª 6
)
ªª6 7
Catch
ææ 
ex
ææ 
As
ææ 
	Exception
ææ 

lbl_valida
¿¿ 
.
¿¿ 
Text
¿¿ 
=
¿¿ 
ex
¿¿  
.
¿¿  !
Message
¿¿! (

lbl_valida
¡¡ 
.
¡¡ 
	ForeColor
¡¡  
=
¡¡! "
System
¡¡# )
.
¡¡) *
Drawing
¡¡* 1
.
¡¡1 2
Color
¡¡2 7
.
¡¡7 8
Red
¡¡8 ;
End
√√ 
Try
√√ 
End
ƒƒ 
Sub
ƒƒ 
Private
»» 
Sub
»»  
btn_reservas_Click
»» "
(
»»" #
sender
»»# )
As
»»* ,
Object
»»- 3
,
»»3 4
e
»»5 6
As
»»7 9
	EventArgs
»»: C
)
»»C D
Handles
»»E L
btn_reservas
»»M Y
.
»»Y Z
Click
»»Z _
fs_grvReservas
…… 
.
…… 
Visible
…… 
=
……  
True
……! %
fs_grvPrestamos
   
.
   
Visible
   
=
    !
False
  " '
fs_libro
ÀÀ 
.
ÀÀ 
Visible
ÀÀ 
=
ÀÀ 
False
ÀÀ  
End
ÃÃ 
Sub
ÃÃ 
Private
ŒŒ 
Sub
ŒŒ 
btn_RHay_Click
ŒŒ 
(
ŒŒ 
sender
ŒŒ %
As
ŒŒ& (
Object
ŒŒ) /
,
ŒŒ/ 0
e
ŒŒ1 2
As
ŒŒ3 5
	EventArgs
ŒŒ6 ?
)
ŒŒ? @
Handles
ŒŒA H
btn_RHay
ŒŒI Q
.
ŒŒQ R
Click
ŒŒR W
fs_grvReservas
œœ 
.
œœ 
Visible
œœ 
=
œœ  
True
œœ! %
fs_grvPrestamos
–– 
.
–– 
Visible
–– 
=
––  !
False
––" '
fs_libro
—— 
.
—— 
Visible
—— 
=
—— 
False
——  
End
““ 
Sub
““ 
Private
‘‘ 
Sub
‘‘ )
btn_RlibrosReservados_Click
‘‘ +
(
‘‘+ ,
sender
‘‘, 2
As
‘‘3 5
Object
‘‘6 <
,
‘‘< =
e
‘‘> ?
As
‘‘@ B
	EventArgs
‘‘C L
)
‘‘L M
Handles
‘‘N U#
btn_RlibrosReservados
‘‘V k
.
‘‘k l
Click
‘‘l q
fs_grvReservas
’’ 
.
’’ 
Visible
’’ 
=
’’  
True
’’! %
fs_grvPrestamos
÷÷ 
.
÷÷ 
Visible
÷÷ 
=
÷÷  !
False
÷÷" '
fs_libro
◊◊ 
.
◊◊ 
Visible
◊◊ 
=
◊◊ 
False
◊◊  
End
ÿÿ 
Sub
ÿÿ 
Private
⁄⁄ 
Sub
⁄⁄ 
btn_PHay_Click
⁄⁄ 
(
⁄⁄ 
sender
⁄⁄ %
As
⁄⁄& (
Object
⁄⁄) /
,
⁄⁄/ 0
e
⁄⁄1 2
As
⁄⁄3 5
	EventArgs
⁄⁄6 ?
)
⁄⁄? @
Handles
⁄⁄A H
btn_PHay
⁄⁄I Q
.
⁄⁄Q R
Click
⁄⁄R W
fs_grvPrestamos
€€ 
.
€€ 
Visible
€€ 
=
€€  !
True
€€" &
fs_grvReservas
‹‹ 
.
‹‹ 
Visible
‹‹ 
=
‹‹  
False
‹‹! &
fs_libro
›› 
.
›› 
Visible
›› 
=
›› 
False
››  
End
ﬁﬁ 
Sub
ﬁﬁ 
Private
‡‡ 
Sub
‡‡ !
btn_prestamos_Click
‡‡ #
(
‡‡# $
sender
‡‡$ *
As
‡‡+ -
Object
‡‡. 4
,
‡‡4 5
e
‡‡6 7
As
‡‡8 :
	EventArgs
‡‡; D
)
‡‡D E
Handles
‡‡F M
btn_prestamos
‡‡N [
.
‡‡[ \
Click
‡‡\ a
fs_grvPrestamos
·· 
.
·· 
Visible
·· 
=
··  !
True
··" &
fs_grvReservas
‚‚ 
.
‚‚ 
Visible
‚‚ 
=
‚‚  
False
‚‚! &
fs_libro
„„ 
.
„„ 
Visible
„„ 
=
„„ 
False
„„  
End
‰‰ 
Sub
‰‰ 
Private
ÊÊ 
Sub
ÊÊ (
btn_Plibrosprestados_Click
ÊÊ *
(
ÊÊ* +
sender
ÊÊ+ 1
As
ÊÊ2 4
Object
ÊÊ5 ;
,
ÊÊ; <
e
ÊÊ= >
As
ÊÊ? A
	EventArgs
ÊÊB K
)
ÊÊK L
Handles
ÊÊM T"
btn_Plibrosprestados
ÊÊU i
.
ÊÊi j
Click
ÊÊj o
fs_grvPrestamos
ÁÁ 
.
ÁÁ 
Visible
ÁÁ 
=
ÁÁ  !
True
ÁÁ" &
fs_grvReservas
ËË 
.
ËË 
Visible
ËË 
=
ËË  
False
ËË! &
fs_libro
ÈÈ 
.
ÈÈ 
Visible
ÈÈ 
=
ÈÈ 
False
ÈÈ  
End
ÍÍ 
Sub
ÍÍ 
EndÎÎ 
Class
ÎÎ 	